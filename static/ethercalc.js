// Auto-generated from make depends; all changes here will be lost.
(function(){function a(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b}function c(b){return 0===b.length?null:a(b)/b.length}function b(a){if(0===a.length)return null;for(var b=c(a),d=[],e=0;e<a.length;e++)d.push(Math.pow(a[e]-b,2));return c(d)}function d(a){return 0===a.length?null:Math.sqrt(b(a))}function e(a,b){for(var d=c(a),e=0,f=0;f<a.length;f++)e+=Math.pow(a[f]-d,b);return e}function f(a){return 1>=a.length?null:e(a,2)/(a.length-1)}function g(a){return 1>=a.length?null:Math.sqrt(f(a))}function l(a,
b){if(1>=a.length||a.length!=b.length)return null;for(var d=c(a),e=c(b),f=0,g=0;g<a.length;g++)f+=(a[g]-d)*(b[g]-e);return f/(a.length-1)}function h(a){if(0===a.length)return null;a=a.slice().sort(function(a,b){return a-b});return 1===a.length%2?a[(a.length-1)/2]:(a[a.length/2-1]+a[a.length/2])/2}function n(a,b){if(0===a.length||1<=b||0>=b)return null;var c=a.slice().sort(function(a,b){return a-b}),d=c.length*b;return 0!==d%1?c[Math.ceil(d)-1]:0===a.length%2?(c[d-1]+c[d])/2:c[d]}function p(a){return 0===
a.length?null:n(a,0.75)-n(a,0.25)}function r(a){if(!a||0===a.length)return null;for(var b=h(a),c=[],d=0;d<a.length;d++)c.push(Math.abs(a[d]-b));return h(c)}function t(a,b){var c=[],d=[],e,f,g=0;for(e=0;e<a.length+1;e++){var h=[],l=[];for(f=0;f<b+1;f++)h.push(0),l.push(0);c.push(h);d.push(l)}for(e=1;e<b+1;e++)for(c[1][e]=1,d[1][e]=0,f=2;f<a.length+1;f++)d[f][e]=Infinity;for(e=2;e<a.length+1;e++){for(var n=l=h=0,p=0,q=1;q<e+1;q++){var r=e-q+1;f=a[r-1];n++;h+=f;l+=f*f;g=l-h*h/n;p=r-1;if(0!==p)for(f=
2;f<b+1;f++)d[e][f]>=g+d[p][f-1]&&(c[e][f]=r,d[e][f]=g+d[p][f-1])}c[e][1]=1;d[e][1]=g}return{lower_class_limits:c,variance_combinations:d}}function q(a,b,c){var d=a.length-1,e=[],f=c;e[c]=a[a.length-1];for(e[0]=a[0];1<f;)e[f-1]=a[b[d][f]-2],d=b[d][f]-1,f--;return e}var s={};"undefined"!==typeof module?exports=module.exports=s:this.ss=s;var u=[0.5,0.504,0.508,0.512,0.516,0.5199,0.5239,0.5279,0.5319,0.5359,0.5398,0.5438,0.5478,0.5517,0.5557,0.5596,0.5636,0.5675,0.5714,0.5753,0.5793,0.5832,0.5871,0.591,
0.5948,0.5987,0.6026,0.6064,0.6103,0.6141,0.6179,0.6217,0.6255,0.6293,0.6331,0.6368,0.6406,0.6443,0.648,0.6517,0.6554,0.6591,0.6628,0.6664,0.67,0.6736,0.6772,0.6808,0.6844,0.6879,0.6915,0.695,0.6985,0.7019,0.7054,0.7088,0.7123,0.7157,0.719,0.7224,0.7257,0.7291,0.7324,0.7357,0.7389,0.7422,0.7454,0.7486,0.7517,0.7549,0.758,0.7611,0.7642,0.7673,0.7704,0.7734,0.7764,0.7794,0.7823,0.7852,0.7881,0.791,0.7939,0.7967,0.7995,0.8023,0.8051,0.8078,0.8106,0.8133,0.8159,0.8186,0.8212,0.8238,0.8264,0.8289,0.8315,
0.834,0.8365,0.8389,0.8413,0.8438,0.8461,0.8485,0.8508,0.8531,0.8554,0.8577,0.8599,0.8621,0.8643,0.8665,0.8686,0.8708,0.8729,0.8749,0.877,0.879,0.881,0.883,0.8849,0.8869,0.8888,0.8907,0.8925,0.8944,0.8962,0.898,0.8997,0.9015,0.9032,0.9049,0.9066,0.9082,0.9099,0.9115,0.9131,0.9147,0.9162,0.9177,0.9192,0.9207,0.9222,0.9236,0.9251,0.9265,0.9279,0.9292,0.9306,0.9319,0.9332,0.9345,0.9357,0.937,0.9382,0.9394,0.9406,0.9418,0.9429,0.9441,0.9452,0.9463,0.9474,0.9484,0.9495,0.9505,0.9515,0.9525,0.9535,0.9545,
0.9554,0.9564,0.9573,0.9582,0.9591,0.9599,0.9608,0.9616,0.9625,0.9633,0.9641,0.9649,0.9656,0.9664,0.9671,0.9678,0.9686,0.9693,0.9699,0.9706,0.9713,0.9719,0.9726,0.9732,0.9738,0.9744,0.975,0.9756,0.9761,0.9767,0.9772,0.9778,0.9783,0.9788,0.9793,0.9798,0.9803,0.9808,0.9812,0.9817,0.9821,0.9826,0.983,0.9834,0.9838,0.9842,0.9846,0.985,0.9854,0.9857,0.9861,0.9864,0.9868,0.9871,0.9875,0.9878,0.9881,0.9884,0.9887,0.989,0.9893,0.9896,0.9898,0.9901,0.9904,0.9906,0.9909,0.9911,0.9913,0.9916,0.9918,0.992,0.9922,
0.9925,0.9927,0.9929,0.9931,0.9932,0.9934,0.9936,0.9938,0.994,0.9941,0.9943,0.9945,0.9946,0.9948,0.9949,0.9951,0.9952,0.9953,0.9955,0.9956,0.9957,0.9959,0.996,0.9961,0.9962,0.9963,0.9964,0.9965,0.9966,0.9967,0.9968,0.9969,0.997,0.9971,0.9972,0.9973,0.9974,0.9974,0.9975,0.9976,0.9977,0.9977,0.9978,0.9979,0.9979,0.998,0.9981,0.9981,0.9982,0.9982,0.9983,0.9984,0.9984,0.9985,0.9985,0.9986,0.9986,0.9987,0.9987,0.9987,0.9988,0.9988,0.9989,0.9989,0.9989,0.999,0.999];s.linear_regression=function(){var a=
{},b=[];a.data=function(c){if(!arguments.length)return b;b=c.slice();return a};a.mb=function(){var a,c;c=b.length;if(1===c)a=0,c=b[0][1];else{for(var d=0,e=0,f=a=0,g,h,l=0;l<c;l++)g=b[l],h=g[0],g=g[1],d+=h,e+=g,a+=h*h,f+=h*g;a=(c*f-d*e)/(c*a-d*d);c=e/c-a*d/c}return{m:a,b:c}};a.m=function(){return a.mb().m};a.b=function(){return a.mb().b};a.line=function(){var b=a.mb(),c=b.m,d=b.b;return function(a){return d+c*a}};return a};s.standard_deviation=d;s.r_squared=function(a,b){if(2>a.length)return 1;var c=
0,d;for(d=0;d<a.length;d++)c+=a[d][1];d=c/a.length;for(var e=c=0;e<a.length;e++)c+=Math.pow(d-a[e][1],2);for(e=d=0;e<a.length;e++)d+=Math.pow(a[e][1]-b(a[e][0]),2);return 1-d/c};s.median=h;s.mean=c;s.mode=function(a){if(0===a.length)return null;if(1===a.length)return a[0];a=a.slice().sort(function(a,b){return a-b});for(var b=a[0],c,d=0,e=1,f=1;f<a.length+1;f++)a[f]!==b?(e>d&&(d=e,e=1,c=b),b=a[f]):e++;return c};s.min=function(a){for(var b,c=0;c<a.length;c++)if(a[c]<b||void 0===b)b=a[c];return b};s.max=
function(a){for(var b,c=0;c<a.length;c++)if(a[c]>b||void 0===b)b=a[c];return b};s.sum=a;s.quantile=n;s.iqr=p;s.mad=r;s.sample_covariance=l;s.sample_correlation=function(a,b){var c=l(a,b),d=g(a),e=g(b);return null===c||null===d||null===e?null:c/d/e};s.sample_variance=f;s.sample_standard_deviation=g;s.sample_skewness=function(a){if(3>a.length)return null;var b=a.length,c=Math.pow(g(a),3);a=e(a,3);return b*a/((b-1)*(b-2)*c)};s.geometric_mean=function(a){if(0===a.length)return null;for(var b=1,c=0;c<
a.length;c++){if(0>=a[c])return null;b*=a[c]}return Math.pow(b,1/a.length)};s.variance=b;s.t_test=function(a,b){var e=c(a),f=d(a),g=Math.sqrt(a.length);return(e-b)/(f/g)};s.t_test_two_sample=function(a,b,d){var e=a.length,g=b.length;if(!e||!g)return null;d||(d=0);var h=c(a),l=c(b);a=((e-1)*f(a)+(g-1)*f(b))/(e+g-2);return(h-l-d)/Math.sqrt(a*(1/e+1/g))};s.jenksMatrices=t;s.jenksBreaks=q;s.jenks=function(a,b){if(b>a.length)return null;a=a.slice().sort(function(a,b){return a-b});var c=t(a,b).lower_class_limits;
return q(a,c,b)};s.bayesian=function(){var a={},b=0,c={};a.train=function(a,d){c[d]||(c[d]={});for(var e in a){var f=a[e];void 0===c[d][e]&&(c[d][e]={});void 0===c[d][e][f]&&(c[d][e][f]=0);c[d][e][a[e]]++}b++};a.score=function(a){var d={},e,f;for(f in a){var g=a[f];for(e in c)void 0===d[e]&&(d[e]={}),d[e][f+"_"+g]=c[e][f]?(c[e][f][g]||0)/b:0}a={};for(e in d)for(var h in d[e])void 0===a[e]&&(a[e]=0),a[e]+=d[e][h];return a};return a};s.z_score=function(a,b,c){return(a-b)/c};s.cumulative_std_normal_probability=
function(a){var b=Math.abs(a),b=Math.min(10*Math.floor(10*b)+10*(Math.floor(100*b)/10-Math.floor(100*b/10)),u.length-1);return 0<=a?u[b]:(1-u[b]).toFixed(4)};s.standard_normal_table=u;s.average=c;s.interquartile_range=p;s.mixin=function(){function a(b){return function(){var a=Array.prototype.slice.apply(arguments);a.unshift(this);return s[b].apply(s,a)}}if(!Object.defineProperty||!Object.defineProperties)throw Error("without defineProperty, simple-statistics cannot be mixed in");for(var b="median standard_deviation sum sample_skewness mean min max quantile geometric_mean".split(" "),
c=0;c<b.length;c++)Object.defineProperty(Array.prototype,b[c],{value:a(b[c]),configurable:!0,enumerable:!1,writable:!0})};s.median_absolute_deviation=r})(this);var SocialCalc;SocialCalc||(SocialCalc={});
SocialCalc.Constants={textdatadefaulttype:"t",s_BrowserNotSupported:"Browser not supported.",s_InternalError:"Internal SocialCalc error (probably an internal bug): ",s_pssUnknownColType:"Unknown col type item",s_pssUnknownRowType:"Unknown row type item",s_pssUnknownLineType:"Unknown line type",s_cfspUnknownCellType:"Unknown cell type item",doCanonicalizeSheet:!0,s_escUnknownSheetCmd:"Unknown sheet command: ",s_escUnknownSetCoordCmd:"Unknown set coord command: ",s_escUnknownCmd:"Unknown command: ",
s_caccCircRef:"Circular reference to ",defaultRowNameWidth:"30",defaultAssumedRowHeight:15,defaultCellIDPrefix:"cell_",defaultCellLayout:"padding:2px 2px 1px 2px;vertical-align:top;",defaultCellFontStyle:"normal normal",defaultCellFontSize:"small",defaultCellFontFamily:"Verdana,Arial,Helvetica,sans-serif",defaultPaneDividerWidth:"2",defaultPaneDividerHeight:"3",defaultGridCSS:"1px solid #ECECEC;",defaultCommentClass:"",defaultCommentStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);",
defaultCommentNoGridClass:"",defaultCommentNoGridStyle:"",defaultReadonlyClass:"",defaultReadonlyStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-lockbg.gif);",defaultReadonlyNoGridClass:"",defaultReadonlyNoGridStyle:"",defaultReadonlyComment:"Locked cell",defaultColWidth:"80",defaultMinimumColWidth:10,defaultHighlightTypeCursorClass:"",defaultHighlightTypeCursorStyle:"color:#FFF;backgroundColor:#A6A6A6;",defaultHighlightTypeRangeClass:"",defaultHighlightTypeRangeStyle:"color:#000;backgroundColor:#E5E5E5;",
defaultColnameClass:"",defaultColnameStyle:"font-size:small;text-align:center;color:#000000;background-color:#FFFFFF;cursor:e-resize;",defaultSelectedColnameClass:"",defaultSelectedColnameStyle:"font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;cursor:e-resize;",defaultRownameClass:"",defaultRownameStyle:"font-size:small;text-align:right;color:#000000;background-color:#FFFFFF;",defaultSelectedRownameClass:"",defaultSelectedRownameStyle:"font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;",
defaultUpperLeftClass:"",defaultUpperLeftStyle:"font-size:small;",defaultSkippedCellClass:"",defaultSkippedCellStyle:"font-size:small;background-color:#CCC",defaultPaneDividerClass:"",defaultPaneDividerStyle:"font-size:small;background-color:#C0C0C0;padding:0px;",defaultUnhideLeftClass:"",defaultUnhideLeftStyle:"float:right;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideleft.gif);padding:0;",defaultUnhideRightClass:"",defaultUnhideRightStyle:"float:left;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideright.gif);padding:0;",
defaultUnhideTopClass:"",defaultUnhideTopStyle:"float:left;position:absolute;bottom:-4px;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidetop.gif);padding:0;",defaultUnhideBottomClass:"",defaultUnhideBottomStyle:"float:left;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidebottom.gif);padding:0;",s_rcMissingSheet:"Render Context must have a sheet object",defaultLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Link</span>',
defaultPageLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Page</span>',defaultFormatp:"#,##0.0%",defaultFormatc:"[$$]#,##0.00",defaultFormatdt:"d-mmm-yyyy h:mm:ss",defaultFormatd:"d-mmm-yyyy",defaultFormatt:"[h]:mm:ss",defaultDisplayTRUE:"TRUE",defaultDisplayFALSE:"FALSE",defaultImagePrefix:"images/sc-",defaultTableEditorIDPrefix:"te_",defaultPageUpDnAmount:15,AllowCtrlS:!0,defaultTableControlThickness:20,cteGriddivClass:"",s_statusline_executing:"Executing...",
s_statusline_displaying:"Displaying...",s_statusline_ordering:"Ordering...",s_statusline_calculating:"Calculating...",s_statusline_calculatingls:"Calculating... Loading Sheet...",s_statusline_doingserverfunc:"doing server function ",s_statusline_incell:" in cell ",s_statusline_calcstart:"Calculation start...",s_statusline_sum:"SUM",s_statusline_recalcneeded:'<span style="color:#999;">(Recalc needed)</span>',s_statusline_circref:'<span style="color:red;">Circular reference: ',s_inputboxdisplaymultilinetext:"[Multi-line text: Click icon on right to edit]",
defaultInputEchoClass:"",defaultInputEchoStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;fontSize:small;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoPromptClass:"",defaultInputEchoPromptStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;",ietUnknownFunction:"Unknown function ",CH_radius1:29,
CH_radius2:41,s_CHfillAllTooltip:"Fill Contents and Formats Down/Right",s_CHfillContentsTooltip:"Fill Contents Only Down/Right",s_CHmovePasteAllTooltip:"Move Contents and Formats",s_CHmovePasteContentsTooltip:"Move Contents Only",s_CHmoveInsertAllTooltip:"Slide Contents and Formats within Row/Col",s_CHmoveInsertContentsTooltip:"Slide Contents within Row/Col",s_CHindicatorOperationLookup:{Fill:"Fill",FillC:"Fill Contents",Move:"Move",MoveI:"Slide",MoveC:"Move Contents",MoveIC:"Slide Contents"},s_CHindicatorDirectionLookup:{Down:" Down",
Right:" Right",Horizontal:" Horizontal",Vertical:" Vertical"},defaultTCSliderThickness:9,defaultTCButtonThickness:20,defaultTCThumbThickness:15,TCmainStyle:"backgroundColor:#EEE;",TCmainClass:"",TCendcapStyle:"backgroundColor:#FFF;",TCendcapClass:"",TCpanesliderStyle:"backgroundColor:#CCC;",TCpanesliderClass:"",s_panesliderTooltiph:"Drag to lock pane vertically",s_panesliderTooltipv:"Drag to lock pane horizontally",TClessbuttonStyle:"backgroundColor:#AAA;",TClessbuttonClass:"",TClessbuttonRepeatWait:300,
TClessbuttonRepeatInterval:20,TCmorebuttonStyle:"backgroundColor:#AAA;",TCmorebuttonClass:"",TCmorebuttonRepeatWait:300,TCmorebuttonRepeatInterval:20,TCscrollareaStyle:"backgroundColor:#DDD;",TCscrollareaClass:"",TCscrollareaRepeatWait:500,TCscrollareaRepeatInterval:100,TCthumbClass:"",TCthumbStyle:"backgroundColor:#CCC;",TCPStrackinglineClass:"",TCPStrackinglineStyle:"overflow:hidden;position:absolute;zIndex:100;",TCPStrackinglineThickness:"2px",TCTDFSthumbstatusvClass:"",TCTDFSthumbstatusvStyle:"height:20px;width:auto;border:3px solid #808080;overflow:hidden;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",
TCTDFSthumbstatushClass:"",TCTDFSthumbstatushStyle:"height:20px;width:auto;border:1px solid black;padding:2px;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatusrownumClass:"",TCTDFSthumbstatusrownumStyle:"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;",TCTDFStopOffsetv:0,TCTDFSleftOffsetv:-80,s_TCTDFthumbstatusPrefixv:"Row ",TCTDFStopOffseth:-30,TCTDFSleftOffseth:0,s_TCTDFthumbstatusPrefixh:"Col ",TooltipOffsetX:2,TooltipOffsetY:10,
TDpopupElementClass:"",TDpopupElementStyle:"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;position:absolute;width:auto;zIndex:110;",SCToolbarbackground:"background-color:#404040;",SCTabbackground:"background-color:#CCC;",SCTabselectedCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;",SCTabplainCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;",
SCToolbartext:"font-size:x-small;font-weight:bold;color:#FFF;padding-bottom:4px;",SCFormulabarheight:30,SCStatuslineheight:20,SCStatuslineCSS:"font-size:10px;padding:3px 0px;",SCFormatNumberFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|($1,234):#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|[break]:|1\\c23:h:mm|1\\c23 PM:h:mm AM/PM|1\\c23\\c45:h:mm:ss|01\\c23\\c45:hh:mm:ss|26\\c23 (h\\cm):[hh]:mm|69\\c45 (m\\cs):[mm]:ss|69 (s):[ss]|[newcol]:|2006-01-04 01\\c23\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|",
SCFormatTextFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|",SCFormatPadsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",
SCFormatFontsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",
SCFormatFontfamilies:"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|",SCFormatFontlook:"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|%loc!Bold Italic!:italic bold",SCFormatTextAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatNumberAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",
SCFormatAlignVertical:"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|",SCFormatColwidth:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|",SCFormatRecalc:"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|",SCFormatUserMaxCol:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",
SCFormatUserMaxRow:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",ISCButtonBorderNormal:"#404040",ISCButtonBorderHover:"#999",ISCButtonBorderDown:"#FFF",ISCButtonDownBackground:"#888",s_PopupListCancel:"[Cancel]",s_PopupListCustom:"Custom",s_loc_align_center:"Align Center",s_loc_align_left:"Align Left",s_loc_align_right:"Align Right",s_loc_alignment:"Alignment",s_loc_audit:"Audit",s_loc_audit_trail_this_session:"Audit Trail This Session",
s_loc_auto:"Auto",s_loc_auto_sum:"Auto Sum",s_loc_auto_wX_commas:"Auto w/ commas",s_loc_automatic:"Automatic",s_loc_background:"Background",s_loc_bold:"Bold",s_loc_bold_XampX_italics:"Bold &amp; Italics",s_loc_bold_italic:"Bold Italic",s_loc_borders:"Borders",s_loc_borders_off:"Borders Off",s_loc_borders_on:"Borders On",s_loc_bottom:"Bottom",s_loc_bottom_border:"Bottom Border",s_loc_cell_settings:"CELL SETTINGS",s_loc_csv_format:"CSV format",s_loc_cancel:"Cancel",s_loc_category:"Category",s_loc_center:"Center",
s_loc_clear:"Clear",s_loc_clear_socialcalc_clipboard:"Clear SocialCalc Clipboard",s_loc_clipboard:"Clipboard",s_loc_color:"Color",s_loc_column_:"Column ",s_loc_comment:"Comment",s_loc_copy:"Copy",s_loc_custom:"Custom",s_loc_cut:"Cut",s_loc_default:"Default",s_loc_default_alignment:"Default Alignment",s_loc_default_column_width:"Default Column Width",s_loc_default_font:"Default Font",s_loc_default_format:"Default Format",s_loc_default_padding:"Default Padding",s_loc_delete:"Delete",s_loc_delete_column:"Delete Column",
s_loc_delete_contents:"Delete Contents",s_loc_delete_row:"Delete Row",s_loc_description:"Description",s_loc_display_clipboard_in:"Display Clipboard in",s_loc_down:"Down",s_loc_edit:"Edit",s_loc_existing_names:"Existing Names",s_loc_family:"Family",s_loc_fill_down:"Fill Down",s_loc_fill_right:"Fill Right",s_loc_font:"Font",s_loc_format:"Format",s_loc_formula:"Formula",s_loc_function_list:"Function List",s_loc_functions:"Functions",s_loc_grid:"Grid",s_loc_hidden:"Hidden",s_loc_horizontal:"Horizontal",
s_loc_insert_column:"Insert Column",s_loc_insert_row:"Insert Row",s_loc_italic:"Italic",s_loc_last_sort:"Last Sort",s_loc_left:"Left",s_loc_left_border:"Left Border",s_loc_link:"Link",s_loc_link_input_box:"Link Input Box",s_loc_list:"List",s_loc_load_socialcalc_clipboard_with_this:"Load SocialCalc Clipboard With This",s_loc_major_sort:"Major Sort",s_loc_manual:"Manual",s_loc_merge_cells:"Merge Cells",s_loc_middle:"Middle",s_loc_minor_sort:"Minor Sort",s_loc_move_insert:"Move Insert",s_loc_move_paste:"Move Paste",
s_loc_multiXline_input_box:"Multi-line Input Box",s_loc_name:"Name",s_loc_names:"Names",s_loc_no_padding:"No padding",s_loc_normal:"Normal",s_loc_number:"Number",s_loc_number_horizontal:"Number Horizontal",s_loc_ok:"OK",s_loc_padding:"Padding",s_loc_page_name:"Page Name",s_loc_paste:"Paste",s_loc_paste_formats:"Paste Formats",s_loc_plain_text:"Plain Text",s_loc_recalc:"Recalc",s_loc_recalculation:"Recalculation",s_loc_redo:"Redo",s_loc_right:"Right",s_loc_right_border:"Right Border",s_loc_sheet_settings:"SHEET SETTINGS",
s_loc_save:"Save",s_loc_save_to:"Save to",s_loc_set_cell_contents:"Set Cell Contents",s_loc_set_cells_to_sort:"Set Cells To Sort",s_loc_set_value_to:"Set Value To",s_loc_set_to_link_format:"Set to Link format",s_loc_setXclear_move_from:"Set/Clear Move From",s_loc_show_cell_settings:"Show Cell Settings",s_loc_show_sheet_settings:"Show Sheet Settings",s_loc_show_in_new_browser_window:"Show in new browser window",s_loc_size:"Size",s_loc_socialcalcXsave_format:"SocialCalc-save format",s_loc_sort:"Sort",
s_loc_sort_:"Sort ",s_loc_sort_cells:"Sort Cells",s_loc_swap_colors:"Swap Colors",s_loc_tabXdelimited_format:"Tab-delimited format",s_loc_text:"Text",s_loc_text_horizontal:"Text Horizontal",s_loc_this_is_aXbrXsample:"This is a<br>sample",s_loc_top:"Top",s_loc_top_border:"Top Border",s_loc_undone_steps:"UNDONE STEPS",s_loc_url:"URL",s_loc_undo:"Undo",s_loc_unmerge_cells:"Unmerge Cells",s_loc_up:"Up",s_loc_value:"Value",s_loc_vertical:"Vertical",s_loc_wikitext:"Wikitext",s_loc_workspace:"Workspace",
s_loc_XnewX:"[New]",s_loc_XnoneX:"[None]",s_loc_Xselect_rangeX:"[select range]",SVStatuslineheight:20,SVStatuslineCSS:"font-size:10px;padding:3px 0px;",FormatNumber_separatorchar:",",FormatNumber_decimalchar:".",FormatNumber_defaultCurrency:"$",s_FormatNumber_daynames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),s_FormatNumber_daynames3:"Sun Mon Tue Wed Thu Fri Sat".split(" "),s_FormatNumber_monthnames:"January February March April May June July August September October November December".split(" "),
s_FormatNumber_monthnames3:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),s_FormatNumber_am:"AM",s_FormatNumber_am1:"A",s_FormatNumber_pm:"PM",s_FormatNumber_pm1:"P",s_parseerrexponent:"Improperly formed number exponent",s_parseerrchar:"Unexpected character in formula",s_parseerrstring:"Improperly formed string",s_parseerrspecialvalue:"Improperly formed special value",s_parseerrtwoops:"Error in formula (two operators inappropriately in a row)",s_parseerrmissingopenparen:"Missing open parenthesis in list with comma(s). ",
s_parseerrcloseparennoopen:"Closing parenthesis without open parenthesis. ",s_parseerrmissingcloseparen:"Missing close parenthesis. ",s_parseerrmissingoperand:"Missing operand. ",s_parseerrerrorinformula:"Error in formula.",s_calcerrerrorvalueinformula:"Error value in formula",s_parseerrerrorinformulabadval:"Error in formula resulting in bad value",s_formularangeresult:"Formula results in range value:",s_calcerrnumericnan:"Formula results in an bad numeric value",s_calcerrnumericoverflow:"Numeric overflow",
s_sheetunavailable:"Sheet unavailable:",s_calcerrcellrefmissing:"Cell reference missing when expected.",s_calcerrsheetnamemissing:"Sheet name missing when expected.",s_circularnameref:"Circular name reference to name",s_calcerrunknownname:"Unknown name",s_calcerrincorrectargstofunction:"Incorrect arguments to function",s_sheetfuncunknownfunction:"Unknown function",s_sheetfunclnarg:"LN argument must be greater than 0",s_sheetfunclog10arg:"LOG10 argument must be greater than 0",s_sheetfunclogsecondarg:"LOG second argument must be numeric greater than 0",
s_sheetfunclogfirstarg:"LOG first argument must be greater than 0",s_sheetfuncroundsecondarg:"ROUND second argument must be numeric",s_sheetfuncddblife:"DDB life must be greater than 1",s_sheetfuncslnlife:"SLN life must be greater than 1",s_fdef_ABS:"Absolute value function. ",s_fdef_ACOS:"Trigonometric arccosine function. ",s_fdef_AND:"True if all arguments are true. ",s_fdef_ASIN:"Trigonometric arcsine function. ",s_fdef_ATAN:"Trigonometric arctan function. ",s_fdef_ATAN2:"Trigonometric arc tangent function (result is in radians). ",
s_fdef_AVERAGE:"Averages the values. ",s_fdef_CHOOSE:"Returns the value specified by the index. The values may be ranges of cells. ",s_fdef_COLUMNS:"Returns the number of columns in the range. ",s_fdef_CORREL:"Returns Pearsons correlation factor for two ranges. The ranges must be of equal length.",s_fdef_COS:"Trigonometric cosine function (value is in radians). ",s_fdef_COUNT:"Counts the number of numeric values, not blank, text, or error. ",s_fdef_COUNTA:"Counts the number of non-blank values. ",
s_fdef_COUNTBLANK:'Counts the number of blank values. (Note: "" is not blank.) ',s_fdef_COUNTIF:'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). ',s_fdef_DATE:'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',
s_fdef_DAVERAGE:"Averages the values in the specified field in records that meet the criteria. ",s_fdef_DAY:"Returns the day of month for a date value. ",s_fdef_DCOUNT:"Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ",s_fdef_DCOUNTA:"Counts the number of non-blank values in the specified field in records that meet the criteria. ",s_fdef_DDB:"Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ",
s_fdef_DEGREES:"Converts value in radians into degrees. ",s_fdef_DGET:"Returns the value of the specified field in the single record that meets the criteria. ",s_fdef_DMAX:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DMIN:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DPRODUCT:"Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ",
s_fdef_DSTDEV:"Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEVP:"Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSUM:"Returns the sum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVAR:"Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVARP:"Returns the variance of the numeric values in the specified field in records that meet the criteria. ",
s_fdef_EVEN:"Rounds the value up in magnitude to the nearest even integer. ",s_fdef_EXACT:'Returns "true" if the values are exactly the same, including case, type, etc. ',s_fdef_EXP:"Returns e raised to the value power. ",s_fdef_FACT:"Returns factorial of the value. ",s_fdef_FALSE:'Returns the logical value "false". ',s_fdef_FIND:'Returns the starting position within string2 of the first occurrence of string1 at or after "start". If start is omitted, 1 is assumed. ',s_fdef_FV:"Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",
s_fdef_HLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ",s_fdef_HOUR:"Returns the hour portion of a time or date/time value. ",s_fdef_IF:"Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ",s_fdef_INDEX:"Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ",
s_fdef_INT:"Returns the value rounded down to the nearest integer (towards -infinity). ",s_fdef_IRR:"Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_ISBLANK:'Returns "true" if the value is a reference to a blank cell. ',
s_fdef_ISERR:'Returns "true" if the value is of type "Error" but not "NA". ',s_fdef_ISERROR:'Returns "true" if the value is of type "Error". ',s_fdef_ISLOGICAL:'Returns "true" if the value is of type "Logical" (true/false). ',s_fdef_ISNA:'Returns "true" if the value is the error type "NA". ',s_fdef_ISNONTEXT:'Returns "true" if the value is not of type "Text". ',s_fdef_ISNUMBER:'Returns "true" if the value is of type "Number" (including logical values). ',s_fdef_ISTEXT:'Returns "true" if the value is of type "Text". ',
s_fdef_LEFT:"Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ",s_fdef_LEN:"Returns the number of characters in the text value. ",s_fdef_LN:"Returns the natural logarithm of the value. ",s_fdef_LOG:"Returns the logarithm of the value using the specified base. ",s_fdef_LOG10:"Returns the base 10 logarithm of the value. ",s_fdef_LOWER:"Returns the text value with all uppercase characters converted to lowercase. ",s_fdef_MATCH:"Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ",
s_fdef_MAX:"Returns the maximum of the numeric values. ",s_fdef_MID:"Returns the specified number of characters from the text value starting from the specified position. ",s_fdef_MIN:"Returns the minimum of the numeric values. ",s_fdef_MINUTE:"Returns the minute portion of a time or date/time value. ",s_fdef_MOD:"Returns the remainder of the first value divided by the second. ",s_fdef_MONTH:"Returns the month part of a date value. ",s_fdef_N:"Returns the value if it is a numeric value otherwise an error. ",
s_fdef_NA:"Returns the #N/A error value which propagates through most operations. ",s_fdef_NOT:"Returns FALSE if value is true, and TRUE if it is false. ",s_fdef_NOW:"Returns the current date/time. ",s_fdef_NPER:"Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ",s_fdef_NPV:"Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ",
s_fdef_ODD:"Rounds the value up in magnitude to the nearest odd integer. ",s_fdef_OR:"True if any argument is true ",s_fdef_PI:"The value 3.1415926... ",s_fdef_PMT:"Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_POWER:"Returns the first value raised to the second value power. ",
s_fdef_PRODUCT:"Returns the result of multiplying the numeric values. ",s_fdef_PROPER:"Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ",s_fdef_PV:"Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_RADIANS:"Converts value in degrees into radians. ",s_fdef_RATE:"Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",
s_fdef_REPLACE:"Returns text1 with the specified number of characters starting from the specified position replaced by text2. ",s_fdef_REPT:"Returns the text repeated the specified number of times. ",s_fdef_RIGHT:"Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ",s_fdef_ROUND:"Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ",
s_fdef_ROWS:"Returns the number of rows in the range. ",s_fdef_SECOND:"Returns the second portion of a time or date/time value (truncated to an integer). ",s_fdef_SIN:"Trigonometric sine function (value is in radians) ",s_fdef_SLN:"Returns the amount of depreciation at each period of time using the straight-line method. ",s_fdef_SQRT:"Square root of the value ",s_fdef_STDEV:"Returns the sample standard deviation of the numeric values. ",s_fdef_STDEVP:"Returns the standard deviation of the numeric values. ",
s_fdef_SUBSTITUTE:'Returns text1 with the all occurrences of oldtext replaced by newtext. If "occurrence" is present, then only that occurrence is replaced. ',s_fdef_SUM:"Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ",s_fdef_SUMIF:'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',
s_fdef_SYD:"Depreciation by Sum of Year's Digits method. ",s_fdef_T:"Returns the text value or else a null string. ",s_fdef_TAN:"Trigonometric tangent function (value is in radians) ",s_fdef_TIME:"Returns the time value given the specified hour, minute, and second. ",s_fdef_TODAY:'Returns the current date (an integer). Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',
s_fdef_TRIM:"Returns the text value with leading, trailing, and repeated spaces removed. ",s_fdef_TRUE:'Returns the logical value "true". ',s_fdef_TRUNC:"Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ",s_fdef_UPPER:"Returns the text value with all lowercase characters converted to uppercase. ",s_fdef_VALUE:"Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ",
s_fdef_VAR:"Returns the sample variance of the numeric values. ",s_fdef_VARP:"Returns the variance of the numeric values. ",s_fdef_VLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ",s_fdef_WEEKDAY:"Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ",
s_fdef_YEAR:"Returns the year part of a date value. ",s_fdef_SUMPRODUCT:"Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.",s_fdef_CEILING:"Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)",s_fdef_FLOOR:"Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)",
s_fdef_EMAIL:"Send Email. ",s_farg_email:"body,recipient",s_fdef_TWEET:"Send a tweet. ",s_farg_tweet:"body,recipient",s_farg_v:"value",s_farg_vn:"value1, value2, ...",s_farg_xy:"valueX, valueY",s_farg_choose:"index, value1, value2, ...",s_farg_range:"range",s_farg_rangec:"range, criteria",s_farg_date:"year, month, day",s_farg_dfunc:"databaserange, fieldname, criteriarange",s_farg_ddb:"cost, salvage, lifetime, period, [factor]",s_farg_find:"string1, string2, [start]",s_farg_fv:"rate, n, payment, [pv, [paytype]]",
s_farg_hlookup:"value, range, row, [rangelookup]",s_farg_iffunc:"logical-expression, true-value, [false-value]",s_farg_index:"range, rownum, colnum",s_farg_irr:"range, [guess]",s_farg_tc:"text, count",s_farg_log:"value, base",s_farg_match:"value, range, [rangelookup]",s_farg_mid:"text, start, length",s_farg_nper:"rate, payment, pv, [fv, [paytype]]",s_farg_npv:"rate, value1, value2, ...",s_farg_pmt:"rate, n, pv, [fv, [paytype]]",s_farg_pv:"rate, n, payment, [fv, [paytype]]",s_farg_rate:"n, payment, pv, [fv, [paytype, [guess]]]",
s_farg_replace:"text1, start, length, text2",s_farg_vp:"value, [precision]",s_farg_valpre:"value, precision",s_farg_csl:"cost, salvage, lifetime",s_farg_cslp:"cost, salvage, lifetime, period",s_farg_subs:"text1, oldtext, newtext, [occurrence]",s_farg_sumif:"range1, criteria, [range2]",s_farg_hms:"hour, minute, second",s_farg_txt:"text",s_farg_vlookup:"value, range, col, [rangelookup]",s_farg_weekday:"date, [type]",s_farg_dt:"date",s_farg_rangen:"range1, range2, ...",s_farg_vsig:"value, [significance]",
function_classlist:"all stat lookup datetime financial test math text".split(" "),s_fclass_all:"All",s_fclass_stat:"Statistics",s_fclass_lookup:"Lookup",s_fclass_datetime:"Date & Time",s_fclass_financial:"Financial",s_fclass_test:"Test",s_fclass_math:"Math",s_fclass_text:"Text",lastone:null};
SocialCalc.ConstantsDefaultClasses={defaultComment:"",defaultCommentNoGrid:"",defaultHighlightTypeCursor:"",defaultHighlightTypeRange:"",defaultColname:"",defaultSelectedColname:"",defaultRowname:"",defaultSelectedRowname:"",defaultUpperLeft:"",defaultSkippedCell:"",defaultPaneDivider:"",cteGriddiv:"",defaultInputEcho:{classname:"",style:"filter:alpha(opacity=90);opacity:.9;"},TCmain:"",TCendcap:"",TCpaneslider:"",TClessbutton:"",TCmorebutton:"",TCscrollarea:"",TCthumb:"",TCPStrackingline:"",TCTDFSthumbstatus:"",
TDpopupElement:""};SocialCalc.ConstantsSetClasses=function(a){var c=SocialCalc.ConstantsDefaultClasses,b=SocialCalc.Constants,d;a=a||"";for(d in c)"string"==typeof c[d]?(b[d+"Class"]=a+(c[d]||d),void 0!==b[d+"Style"]&&(b[d+"Style"]="")):"object"==typeof c[d]&&(b[d+"Class"]=a+(c[d].classname||d),b[d+"Style"]=c[d].style)};SocialCalc.ConstantsSetImagePrefix=function(a){var c=SocialCalc.Constants,b;for(b in c)"string"==typeof c[b]&&(c[b]=c[b].replace(c.defaultImagePrefix,a));c.defaultImagePrefix=a};SocialCalc||(SocialCalc={});SocialCalc.Callbacks={expand_wiki:null,expand_markup:function(a,c,b){return SocialCalc.default_expand_markup(a,c,b)},MakePageLink:null,NormalizeSheetName:null};SocialCalc.Cell=function(a){this.coord=a;this.datavalue="";this.datatype=null;this.formula="";this.valuetype="b";this.readonly=!1};
SocialCalc.CellProperties={coord:1,datavalue:1,datatype:1,formula:1,valuetype:1,errors:1,comment:1,readonly:1,bt:2,br:2,bb:2,bl:2,layout:2,font:2,color:2,bgcolor:2,cellformat:2,nontextvalueformat:2,textvalueformat:2,colspan:2,rowspan:2,cssc:2,csss:2,mod:2,displaystring:3,parseinfo:3,hcolspan:3,hrowspan:3};
SocialCalc.CellPropertiesTable={bt:"borderstyle",br:"borderstyle",bb:"borderstyle",bl:"borderstyle",layout:"layout",font:"font",color:"color",bgcolor:"color",cellformat:"cellformat",nontextvalueformat:"valueformat",textvalueformat:"valueformat"};SocialCalc.Sheet=function(){SocialCalc.ResetSheet(this);this.statuscallbackparams=this.statuscallback=null};
SocialCalc.ResetSheet=function(a,c){a.cells={};a.attribs={lastcol:1,lastrow:1,defaultlayout:0,usermaxcol:0,usermaxrow:0};a.rowattribs={hide:{},height:{}};a.colattribs={width:{},hide:{}};a.names={};a.layouts=[];a.layouthash={};a.fonts=[];a.fonthash={};a.colors=[];a.colorhash={};a.borderstyles=[];a.borderstylehash={};a.cellformats=[];a.cellformathash={};a.valueformats=[];a.valueformathash={};a.copiedfrom="";a.changes=new SocialCalc.UndoStack;a.renderneeded=!1;a.changedrendervalues=!0;a.recalcchangedavalue=
!1;a.hiddencolrow="";a.sci=new SocialCalc.SheetCommandInfo(a)};SocialCalc.Sheet.prototype.ResetSheet=function(){SocialCalc.ResetSheet(this)};SocialCalc.Sheet.prototype.AddCell=function(a){return this.cells[a.coord]=a};SocialCalc.Sheet.prototype.GetAssuredCell=function(a){return this.cells[a]||this.AddCell(new SocialCalc.Cell(a))};SocialCalc.Sheet.prototype.ParseSheetSave=function(a){SocialCalc.ParseSheetSave(a,this)};
SocialCalc.Sheet.prototype.CellFromStringParts=function(a,c,b){return SocialCalc.CellFromStringParts(this,a,c,b)};SocialCalc.Sheet.prototype.CreateSheetSave=function(a,c){return SocialCalc.CreateSheetSave(this,a,c)};SocialCalc.Sheet.prototype.Upsert=function(a,c,b,d){console.log("upsertin");return SocialCalc.Upsert(this,a,c,b,d)};SocialCalc.Sheet.prototype.CellToString=function(a){return SocialCalc.CellToString(this,a)};
SocialCalc.Sheet.prototype.CanonicalizeSheet=function(a){return SocialCalc.CanonicalizeSheet(this,a)};SocialCalc.Sheet.prototype.EncodeCellAttributes=function(a){return SocialCalc.EncodeCellAttributes(this,a)};SocialCalc.Sheet.prototype.EncodeSheetAttributes=function(){return SocialCalc.EncodeSheetAttributes(this)};SocialCalc.Sheet.prototype.DecodeCellAttributes=function(a,c,b){return SocialCalc.DecodeCellAttributes(this,a,c,b)};
SocialCalc.Sheet.prototype.DecodeSheetAttributes=function(a){return SocialCalc.DecodeSheetAttributes(this,a)};SocialCalc.Sheet.prototype.ScheduleSheetCommands=function(a,c){return SocialCalc.ScheduleSheetCommands(this,a,c)};SocialCalc.Sheet.prototype.SheetUndo=function(){return SocialCalc.SheetUndo(this)};SocialCalc.Sheet.prototype.SheetRedo=function(){return SocialCalc.SheetRedo(this)};SocialCalc.Sheet.prototype.CreateAuditString=function(){return SocialCalc.CreateAuditString(this)};
SocialCalc.Sheet.prototype.GetStyleNum=function(a,c){return SocialCalc.GetStyleNum(this,a,c)};SocialCalc.Sheet.prototype.GetStyleString=function(a,c){return SocialCalc.GetStyleString(this,a,c)};SocialCalc.Sheet.prototype.RecalcSheet=function(){return SocialCalc.RecalcSheet(this)};
SocialCalc.ParseSheetSave=function(a,c){var b=a.split(/\r\n|\n/),d=[],e,f,g,l,h=SocialCalc.Constants;for(e=0;e<b.length;e++)switch(d=b[e],d=d.split(":"),d[0]){case "cell":g=c.GetAssuredCell(d[1]);f=2;c.CellFromStringParts(g,d,f);break;case "col":l=d[1];for(f=2;g=d[f++];)switch(g){case "w":c.colattribs.width[l]=d[f++];break;case "hide":c.colattribs.hide[l]=d[f++];break;default:throw h.s_pssUnknownColType+" '"+g+"'";}break;case "row":l=d[1]-0;for(f=2;g=d[f++];)switch(g){case "h":c.rowattribs.height[l]=
d[f++]-0;break;case "hide":c.rowattribs.hide[l]=d[f++];break;default:throw h.s_pssUnknownRowType+" '"+g+"'";}break;case "sheet":l=c.attribs;for(f=1;g=d[f++];)switch(g){case "c":l.lastcol=d[f++]-0;break;case "r":l.lastrow=d[f++]-0;break;case "w":l.defaultcolwidth=d[f++]+"";break;case "h":l.defaultrowheight=d[f++]-0;break;case "tf":l.defaulttextformat=d[f++]-0;break;case "ntf":l.defaultnontextformat=d[f++]-0;break;case "layout":l.defaultlayout=d[f++]-0;break;case "font":l.defaultfont=d[f++]-0;break;
case "tvf":l.defaulttextvalueformat=d[f++]-0;break;case "ntvf":l.defaultnontextvalueformat=d[f++]-0;break;case "color":l.defaultcolor=d[f++]-0;break;case "bgcolor":l.defaultbgcolor=d[f++]-0;break;case "circularreferencecell":l.circularreferencecell=d[f++];break;case "recalc":l.recalc=d[f++];break;case "needsrecalc":l.needsrecalc=d[f++];break;case "usermaxcol":l.usermaxcol=d[f++]-0;break;case "usermaxrow":l.usermaxrow=d[f++]-0;break;default:f+=1}break;case "name":f=SocialCalc.decodeFromSave(d[1]).toUpperCase();
c.names[f]={desc:SocialCalc.decodeFromSave(d[2])};c.names[f].definition=SocialCalc.decodeFromSave(d[3]);break;case "layout":d=b[e].match(/^layout\:(\d+)\:(.+)$/);c.layouts[d[1]-0]=d[2];c.layouthash[d[2]]=d[1]-0;break;case "font":c.fonts[d[1]-0]=d[2];c.fonthash[d[2]]=d[1]-0;break;case "color":c.colors[d[1]-0]=d[2];c.colorhash[d[2]]=d[1]-0;break;case "border":c.borderstyles[d[1]-0]=d[2];c.borderstylehash[d[2]]=d[1]-0;break;case "cellformat":f=SocialCalc.decodeFromSave(d[2]);c.cellformats[d[1]-0]=f;
c.cellformathash[f]=d[1]-0;break;case "valueformat":f=SocialCalc.decodeFromSave(d[2]);c.valueformats[d[1]-0]=f;c.valueformathash[f]=d[1]-0;break;case "version":break;case "copiedfrom":c.copiedfrom=d[1]+":"+d[2];break;case "clipboardrange":case "clipboard":break;case "":break;default:throw console.log("RCVD WRONG API CMD:",h.s_pssUnknownLineType+" '"+d[0]+"'"),h.s_pssUnknownLineType+" '"+d[0]+"'";}};
SocialCalc.CellFromStringParts=function(a,c,b,d){for(;a=b[d++];)switch(a){case "v":c.datavalue=SocialCalc.decodeFromSave(b[d++])-0;c.datatype="v";c.valuetype="n";break;case "t":c.datavalue=SocialCalc.decodeFromSave(b[d++]);c.datatype="t";c.valuetype=SocialCalc.Constants.textdatadefaulttype;break;case "vt":a=b[d++];c.valuetype=a;"n"==a.charAt(0)?(c.datatype="v",c.datavalue=SocialCalc.decodeFromSave(b[d++])-0):(c.datatype="t",c.datavalue=SocialCalc.decodeFromSave(b[d++]));break;case "vtf":a=b[d++];
c.valuetype=a;"n"==a.charAt(0)?c.datavalue=SocialCalc.decodeFromSave(b[d++])-0:c.datavalue=SocialCalc.decodeFromSave(b[d++]);c.formula=SocialCalc.decodeFromSave(b[d++]);c.datatype="f";break;case "vtc":a=b[d++];c.valuetype=a;"n"==a.charAt(0)?c.datavalue=SocialCalc.decodeFromSave(b[d++])-0:c.datavalue=SocialCalc.decodeFromSave(b[d++]);c.formula=SocialCalc.decodeFromSave(b[d++]);c.datatype="c";break;case "ro":ro=SocialCalc.decodeFromSave(b[d++]);c.readonly="yes"==ro.toLowerCase();break;case "e":c.errors=
SocialCalc.decodeFromSave(b[d++]);break;case "b":c.bt=b[d++]-0;c.br=b[d++]-0;c.bb=b[d++]-0;c.bl=b[d++]-0;break;case "l":c.layout=b[d++]-0;break;case "f":c.font=b[d++]-0;break;case "c":c.color=b[d++]-0;break;case "bg":c.bgcolor=b[d++]-0;break;case "cf":c.cellformat=b[d++]-0;break;case "ntvf":c.nontextvalueformat=b[d++]-0;break;case "tvf":c.textvalueformat=b[d++]-0;break;case "colspan":c.colspan=b[d++]-0;break;case "rowspan":c.rowspan=b[d++]-0;break;case "cssc":c.cssc=b[d++];break;case "csss":c.csss=
SocialCalc.decodeFromSave(b[d++]);break;case "mod":d+=1;break;case "comment":c.comment=SocialCalc.decodeFromSave(b[d++]);break;default:throw SocialCalc.Constants.s_cfspUnknownCellType+" '"+a+"'";}};SocialCalc.sheetfields="defaultrowheight defaultcolwidth circularreferencecell recalc needsrecalc usermaxcol usermaxrow".split(" ");SocialCalc.sheetfieldsshort="h w circularreferencecell recalc needsrecalc usermaxcol usermaxrow".split(" ");SocialCalc.sheetfieldsxlat="defaulttextformat defaultnontextformat defaulttextvalueformat defaultnontextvalueformat defaultcolor defaultbgcolor defaultfont defaultlayout".split(" ");
SocialCalc.sheetfieldsxlatshort="tf ntf tvf ntvf color bgcolor font layout".split(" ");SocialCalc.sheetfieldsxlatxlt="cellformat cellformat valueformat valueformat color color font layout".split(" ");
SocialCalc.Upsert=function(a,c,b,d,e){var f,g;console.log("sc.upsert");var l,h,n,p,r=[],t={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,L:10,M:11,N:12,O:13,P:14};a.CanonicalizeSheet(!0);var q=a.xlt;f=q.maxrow;g=q.maxcol;l=q.maxrow+1;console.log("target:"+l);console.log(q);for(n=1;n<=f;n++)for(p=1;p<=g;p++)if(h=SocialCalc.crToCoord(p,n),h=a.cells[h])h.datavalue==d&&p==t[e]&&(l=n),console.log(h.datavalue);console.log("after looping targetrow is:"+l+" and xlt.maxrow="+q.maxrow);r.push("stored :"+c+" at "+(b+
l));console.log("stored :"+c+" at "+(b+l));r.push("stored :"+d+" at "+(e+l));console.log("stored :"+d+" at "+(e+l));delete a.xlt;return[200,l,b+l,e+l,c,d]};
SocialCalc.CreateSheetSave=function(a,c,b){var d,e,f,g,l,h=[];a.CanonicalizeSheet(b||SocialCalc.Constants.doCanonicalizeSheet);var n=a.xlt;e=c?SocialCalc.ParseRange(c):{cr1:{row:1,col:1},cr2:{row:n.maxrow,col:n.maxcol}};b=e.cr1;e=e.cr2;h.push("version:1.5");for(f=b.row;f<=e.row;f++)for(g=b.col;g<=e.col;g++)if(l=SocialCalc.crToCoord(g,f),d=a.cells[l])d=a.CellToString(d),0!=d.length&&(d="cell:"+l+d,h.push(d));for(g=1;g<=n.maxcol;g++)l=SocialCalc.rcColname(g),a.colattribs.width[l]&&h.push("col:"+l+":w:"+
a.colattribs.width[l]),a.colattribs.hide[l]&&h.push("col:"+l+":hide:"+a.colattribs.hide[l]);for(f=1;f<=n.maxrow;f++)a.rowattribs.height[f]&&h.push("row:"+f+":h:"+a.rowattribs.height[f]),a.rowattribs.hide[f]&&h.push("row:"+f+":hide:"+a.rowattribs.hide[f]);d="sheet:c:"+n.maxcol+":r:"+n.maxrow;for(f=0;f<SocialCalc.sheetfields.length;f++)(g=SocialCalc.encodeForSave(a.attribs[SocialCalc.sheetfields[f]]))&&(d+=":"+SocialCalc.sheetfieldsshort[f]+":"+g);for(f=0;f<SocialCalc.sheetfieldsxlat.length;f++)(g=
a.attribs[SocialCalc.sheetfieldsxlat[f]])&&(d+=":"+SocialCalc.sheetfieldsxlatshort[f]+":"+n[SocialCalc.sheetfieldsxlatxlt[f]+"sxlat"][g]);h.push(d);for(f=1;f<n.newborderstyles.length;f++)h.push("border:"+f+":"+n.newborderstyles[f]);for(f=1;f<n.newcellformats.length;f++)h.push("cellformat:"+f+":"+SocialCalc.encodeForSave(n.newcellformats[f]));for(f=1;f<n.newcolors.length;f++)h.push("color:"+f+":"+n.newcolors[f]);for(f=1;f<n.newfonts.length;f++)h.push("font:"+f+":"+n.newfonts[f]);for(f=1;f<n.newlayouts.length;f++)h.push("layout:"+
f+":"+n.newlayouts[f]);for(f=1;f<n.newvalueformats.length;f++)h.push("valueformat:"+f+":"+SocialCalc.encodeForSave(n.newvalueformats[f]));for(f=0;f<n.namesorder.length;f++)d=n.namesorder[f],h.push("name:"+SocialCalc.encodeForSave(d).toUpperCase()+":"+SocialCalc.encodeForSave(a.names[d].desc)+":"+SocialCalc.encodeForSave(a.names[d].definition));c&&h.push("copiedfrom:"+SocialCalc.crToCoord(b.col,b.row)+":"+SocialCalc.crToCoord(e.col,e.row));h.push("");delete a.xlt;return h.join("\n")};
SocialCalc.CellToString=function(a,c){var b,d,e,f,g,l;b="";if(!c)return b;d=SocialCalc.encodeForSave(c.datavalue);"v"==c.datatype?b="n"==c.valuetype?b+(":v:"+d):b+(":vt:"+c.valuetype+":"+d):"t"==c.datatype?b=c.valuetype==SocialCalc.Constants.textdatadefaulttype?b+(":t:"+d):b+(":vt:"+c.valuetype+":"+d):(e=SocialCalc.encodeForSave(c.formula),"f"==c.datatype?b+=":vtf:"+c.valuetype+":"+d+":"+e:"c"==c.datatype&&(b+=":vtc:"+c.valuetype+":"+d+":"+e));c.readonly&&(b+=":ro:yes");c.errors&&(b+=":e:"+SocialCalc.encodeForSave(c.errors));
d=c.bt||"";e=c.br||"";f=c.bb||"";g=c.bl||"";if(a.xlt){l=a.xlt;if(d||e||f||g)b+=":b:"+l.borderstylesxlat[d||0]+":"+l.borderstylesxlat[e||0]+":"+l.borderstylesxlat[f||0]+":"+l.borderstylesxlat[g||0];c.layout&&(b+=":l:"+l.layoutsxlat[c.layout]);c.font&&(b+=":f:"+l.fontsxlat[c.font]);c.color&&(b+=":c:"+l.colorsxlat[c.color]);c.bgcolor&&(b+=":bg:"+l.colorsxlat[c.bgcolor]);c.cellformat&&(b+=":cf:"+l.cellformatsxlat[c.cellformat]);c.textvalueformat&&(b+=":tvf:"+l.valueformatsxlat[c.textvalueformat]);c.nontextvalueformat&&
(b+=":ntvf:"+l.valueformatsxlat[c.nontextvalueformat])}else{if(d||e||f||g)b+=":b:"+d+":"+e+":"+f+":"+g;c.layout&&(b+=":l:"+c.layout);c.font&&(b+=":f:"+c.font);c.color&&(b+=":c:"+c.color);c.bgcolor&&(b+=":bg:"+c.bgcolor);c.cellformat&&(b+=":cf:"+c.cellformat);c.textvalueformat&&(b+=":tvf:"+c.textvalueformat);c.nontextvalueformat&&(b+=":ntvf:"+c.nontextvalueformat)}c.colspan&&(b+=":colspan:"+c.colspan);c.rowspan&&(b+=":rowspan:"+c.rowspan);c.cssc&&(b+=":cssc:"+c.cssc);c.csss&&(b+=":csss:"+SocialCalc.encodeForSave(c.csss));
c.mod&&(b+=":mod:"+c.mod);c.comment&&(b+=":comment:"+SocialCalc.encodeForSave(c.comment));return b};
SocialCalc.CanonicalizeSheet=function(a,c){var b,d,e,f,g,l,h,n=0,p=0,r="borderstyle cellformat color font layout valueformat".split(" "),t={namesorder:[]};for(g in a.names)t.namesorder.push(g);t.namesorder.sort();if(SocialCalc.Constants.doCanonicalizeSheet&&c){for(f=0;f<r.length;f++)g=r[f],t[g+"sUsed"]={};h=t.colorsUsed;l=t.borderstylesUsed;var q=t.fontsUsed,s=t.layoutsUsed,u=t.cellformatsUsed,v=t.valueformatsUsed;for(d in a.cells)e=SocialCalc.coordToCr(d),f=a.cells[d],g=!1,f.valuetype&&"b"!=f.valuetype&&
(g=!0),f.color&&(h[f.color]=1,g=!0),f.bgcolor&&(h[f.bgcolor]=1,g=!0),f.bt&&(l[f.bt]=1,g=!0),f.br&&(l[f.br]=1,g=!0),f.bb&&(l[f.bb]=1,g=!0),f.bl&&(l[f.bl]=1,g=!0),f.layout&&(s[f.layout]=1,g=!0),f.font&&(q[f.font]=1,g=!0),f.cellformat&&(u[f.cellformat]=1,g=!0),f.textvalueformat&&(v[f.textvalueformat]=1,g=!0),f.nontextvalueformat&&(v[f.nontextvalueformat]=1,g=!0),g&&(e.row>n&&(n=e.row),e.col>p&&(p=e.col));for(h=0;h<SocialCalc.sheetfieldsxlat.length;h++)(b=a.attribs[SocialCalc.sheetfieldsxlat[h]])&&(t[SocialCalc.sheetfieldsxlatxlt[h]+
"sUsed"][b]=1);g={height:1,hide:1};for(b in g)for(e in a.rowattribs[b])e>n&&(n=e);g={hide:1,width:1};for(b in g)for(d in a.colattribs[b])e=SocialCalc.coordToCr(d+"1"),e.col>p&&(p=e.col);for(f=0;f<r.length;f++){g=r[f];d=[];e=t[g+"sUsed"];for(b in e)d.push(a[g+"s"][b]);d.sort();d.unshift("");e=[""];l=a[g+"hash"];for(h=1;h<d.length;h++)e[l[d[h]]]=h;t[g+"sxlat"]=e;t["new"+g+"s"]=d}t.maxrow=n||1;t.maxcol=p||1}else{for(f=0;f<r.length;f++){g=r[f];t["new"+g+"s"]=a[g+"s"];b=a[g+"s"].length;e=Array(b);e[0]=
"";for(h=1;h<b;h++)e[h]=h;t[g+"sxlat"]=e}t.maxrow=a.attribs.lastrow;t.maxcol=a.attribs.lastcol}a.xlt=t};
SocialCalc.EncodeCellAttributes=function(a,c){var b,d,e={},f=function(a){e[a]={def:!0,val:""}},g=function(a){for(var b=0;b<a.length;b++)f(a[b])},l=function(a,b){e[a].def=!1;e[a].val=b||""};b=function(a,b){"*"!=b&&(e[a].def=!1,e[a].val=b)};var h=a.GetAssuredCell(c);f("alignhoriz");h.cellformat&&l("alignhoriz",a.cellformats[h.cellformat]);g(["alignvert","padtop","padright","padbottom","padleft"]);h.layout&&(parts=a.layouts[h.layout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),
b("padtop",parts[1]),b("padright",parts[2]),b("padbottom",parts[3]),b("padleft",parts[4]),b("alignvert",parts[5]));g(["fontfamily","fontlook","fontsize"]);h.font&&(parts=a.fonts[h.font].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),b("fontfamily",parts[3]),b("fontsize",parts[2]),b("fontlook",parts[1]));f("textcolor");h.color&&l("textcolor",a.colors[h.color]);f("bgcolor");h.bgcolor&&l("bgcolor",a.colors[h.bgcolor]);g(["numberformat","textformat"]);h.nontextvalueformat&&l("numberformat",a.valueformats[h.nontextvalueformat]);
h.textvalueformat&&l("textformat",a.valueformats[h.textvalueformat]);g(["colspan","rowspan"]);l("colspan",h.colspan||1);l("rowspan",h.rowspan||1);for(b=0;4>b;b++)d="trbl".charAt(b),d="b"+d,f(d),l(d,h[d]?a.borderstyles[h[d]]:""),f(d+"thickness"),f(d+"style"),f(d+"color"),h[d]&&(parts=a.borderstyles[h[d]].match(/(\S+)\s+(\S+)\s+(\S.+)/),l(d+"thickness",parts[1]),l(d+"style",parts[2]),l(d+"color",parts[3]));g(["cssc","csss","mod"]);l("cssc",h.cssc||"");l("csss",h.csss||"");l("mod",h.mod||"n");return e};
SocialCalc.EncodeSheetAttributes=function(a){var c=a.attribs,b={},d=function(a){b[a]={def:!0,val:""}},e=function(a){for(var b=0;b<a.length;b++)d(a[b])},f=function(a,c){b[a].def=!1;b[a].val=c||void 0},g=function(a,c){"*"!=c&&(b[a].def=!1,b[a].val=c)};d("colwidth");c.defaultcolwidth&&f("colwidth",c.defaultcolwidth);d("rowheight");c.rowheight&&f("rowheight",c.defaultrowheight);d("textalignhoriz");c.defaulttextformat&&f("textalignhoriz",a.cellformats[c.defaulttextformat]);d("numberalignhoriz");c.defaultnontextformat&&
f("numberalignhoriz",a.cellformats[c.defaultnontextformat]);e(["alignvert","padtop","padright","padbottom","padleft"]);c.defaultlayout&&(parts=a.layouts[c.defaultlayout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),g("padtop",parts[1]),g("padright",parts[2]),g("padbottom",parts[3]),g("padleft",parts[4]),g("alignvert",parts[5]));e(["fontfamily","fontlook","fontsize"]);c.defaultfont&&(parts=a.fonts[c.defaultfont].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),g("fontfamily",
parts[3]),g("fontsize",parts[2]),g("fontlook",parts[1]));d("textcolor");c.defaultcolor&&f("textcolor",a.colors[c.defaultcolor]);d("bgcolor");c.defaultbgcolor&&f("bgcolor",a.colors[c.defaultbgcolor]);e(["numberformat","textformat"]);c.defaultnontextvalueformat&&f("numberformat",a.valueformats[c.defaultnontextvalueformat]);c.defaulttextvalueformat&&f("textformat",a.valueformats[c.defaulttextvalueformat]);d("recalc");c.recalc&&f("recalc",c.recalc);d("usermaxcol");c.usermaxcol&&f("usermaxcol",c.usermaxcol);
d("usermaxrow");c.usermaxrow&&f("usermaxrow",c.usermaxrow);return b};
SocialCalc.DecodeCellAttributes=function(a,c,b,d){var e,f=a.GetAssuredCell(c),g=!1,l=function(a,c,d){b[a]&&(a=b[a].def?"":b[a].val,a!=(c||"")&&n(d+" "+a))},h="",n=function(a){h&&(h+="\n");h+="set "+(d||c)+" "+a;g=!0};l("alignhoriz",a.cellformats[f.cellformat],"cellformat");e=b.alignvert.def&&b.padtop.def&&b.padright.def&&b.padbottom.def&&b.padleft.def?"":"padding:"+(b.padtop.def?"* ":b.padtop.val+" ")+(b.padright.def?"* ":b.padright.val+" ")+(b.padbottom.def?"* ":b.padbottom.val+" ")+(b.padleft.def?
"*":b.padleft.val)+";vertical-align:"+(b.alignvert.def?"*;":b.alignvert.val+";");e!=(a.layouts[f.layout]||"")&&n("layout "+e);e=b.fontlook.def&&b.fontsize.def&&b.fontfamily.def?"":(b.fontlook.def?"* ":b.fontlook.val+" ")+(b.fontsize.def?"* ":b.fontsize.val+" ")+(b.fontfamily.def?"*":b.fontfamily.val);e!=(a.fonts[f.font]||"")&&n("font "+e);l("textcolor",a.colors[f.color],"color");l("bgcolor",a.colors[f.bgcolor],"bgcolor");l("numberformat",a.valueformats[f.nontextvalueformat],"nontextvalueformat");
l("textformat",a.valueformats[f.textvalueformat],"textvalueformat");for(i=0;4>i;i++)e="trbl".charAt(i),e="b"+e,l(e,a.borderstyles[f[e]],e);l("cssc",f.cssc,"cssc");l("csss",f.csss,"csss");b.mod&&(e=b.mod.def?"n":b.mod.val,e!=(f.mod||"n")&&("n"==e&&(e=""),n("mod "+e)));return g?h:null};
SocialCalc.DecodeSheetAttributes=function(a,c){var b,d=a.attribs,e=!1,f=function(a,b,d){c[a]&&(a=c[a].def?"":c[a].val,a!=(b||"")&&l(d+" "+a))},g="",l=function(a){g&&(g+="\n");g+="set sheet "+a;e=!0};f("colwidth",d.defaultcolwidth,"defaultcolwidth");f("rowheight",d.defaultrowheight,"defaultrowheight");f("textalignhoriz",a.cellformats[d.defaulttextformat],"defaulttextformat");f("numberalignhoriz",a.cellformats[d.defaultnontextformat],"defaultnontextformat");b=c.alignvert.def&&c.padtop.def&&c.padright.def&&
c.padbottom.def&&c.padleft.def?"":"padding:"+(c.padtop.def?"* ":c.padtop.val+" ")+(c.padright.def?"* ":c.padright.val+" ")+(c.padbottom.def?"* ":c.padbottom.val+" ")+(c.padleft.def?"*":c.padleft.val)+";vertical-align:"+(c.alignvert.def?"*;":c.alignvert.val+";");b!=(a.layouts[d.defaultlayout]||"")&&l("defaultlayout "+b);b=c.fontlook.def&&c.fontsize.def&&c.fontfamily.def?"":(c.fontlook.def?"* ":c.fontlook.val+" ")+(c.fontsize.def?"* ":c.fontsize.val+" ")+(c.fontfamily.def?"*":c.fontfamily.val);b!=(a.fonts[d.defaultfont]||
"")&&l("defaultfont "+b);f("textcolor",a.colors[d.defaultcolor],"defaultcolor");f("bgcolor",a.colors[d.defaultbgcolor],"defaultbgcolor");f("numberformat",a.valueformats[d.defaultnontextvalueformat],"defaultnontextvalueformat");f("textformat",a.valueformats[d.defaulttextvalueformat],"defaulttextvalueformat");f("recalc",a.attribs.recalc,"recalc");f("usermaxcol",a.attribs.usermaxcol,"usermaxcol");f("usermaxrow",a.attribs.usermaxrow,"usermaxrow");return e?g:null};
SocialCalc.SheetCommandInfo=function(a){this.sheetobj=a;this.timerobj=this.parseobj=null;this.firsttimerdelay=50;this.timerdelay=1;this.maxtimeslice=100;this.saveundo=!1;this.CmdExtensionCallbacks={};this.cmdextensionbusy=""};
SocialCalc.ScheduleSheetCommands=function(a,c,b){var d=a.sci;d.parseobj=new SocialCalc.Parse(c);d.saveundo=b;d.sheetobj.statuscallback&&a.statuscallback(d,"cmdstart","",d.sheetobj.statuscallbackparams);d.saveundo&&d.sheetobj.changes.PushChange("");d.timerobj=SocialCalc.Callbacks.broadcast?window.setTimeout(function(){var a=d.parseobj;d.parseobj=new SocialCalc.Parse(c);SocialCalc.SheetCommandsTimerRoutine(d);d.parseobj=a},d.firsttimerdelay):window.setTimeout(function(){SocialCalc.SheetCommandsTimerRoutine(d)},
d.firsttimerdelay)};
SocialCalc.SheetCommandsTimerRoutine=function(a){var c,b=new Date;for(a.timerobj=null;!a.parseobj.EOF();){(c=SocialCalc.ExecuteSheetCommand(a.sheetobj,a.parseobj,a.saveundo))&&alert(c);a.parseobj.NextLine();if(0<a.cmdextensionbusy.length){a.sheetobj.statuscallback&&a.sheetobj.statuscallback(a,"cmdextension",a.cmdextensionbusy,a.sheetobj.statuscallbackparams);return}if(new Date-b>=a.maxtimeslice){a.timerobj=window.setTimeout(function(){SocialCalc.SheetCommandsTimerRoutine(a)},a.timerdelay);return}}a.sheetobj.statuscallback&&
a.sheetobj.statuscallback(a,"cmdend","",a.sheetobj.statuscallbackparams)};SocialCalc.ResumeFromCmdExtension=function(a){a.cmdextensionbusy="";SocialCalc.SheetCommandsTimerRoutine(a)};
SocialCalc.ExecuteSheetCommand=function(a,c,b){var d,e,f,g,l,h,n,p,r,t,q,s,u,v,w,x,y,z,A,C,F,I,O,G,N,D,B=a.attribs;D=a.changes;F=SocialCalc.CellProperties;w=SocialCalc.Constants;t=function(){var a=SocialCalc.ParseRange(g);p=a.cr1;r=a.cr2;r.col>B.lastcol&&(B.lastcol=r.col);r.row>B.lastrow&&(B.lastrow=r.row)};n="";d=c.RestOfStringNoMove();b&&a.changes.AddDo(d);e=c.NextToken();switch(e){case "set":g=c.NextToken();l=c.NextToken();f=c.RestOfString();c="set "+g+" "+l;if("sheet"==g)switch(a.renderneeded=
!0,l){case "defaultcolwidth":b&&D.AddUndo(c,B[l]);B[l]=f;break;case "defaultcolor":case "defaultbgcolor":b&&D.AddUndo(c,a.GetStyleString("color",B[l]));B[l]=a.GetStyleNum("color",f);break;case "defaultlayout":b&&D.AddUndo(c,a.GetStyleString("layout",B[l]));B[l]=a.GetStyleNum("layout",f);break;case "defaultfont":b&&D.AddUndo(c,a.GetStyleString("font",B[l]));"* * *"==f&&(f="");B[l]=a.GetStyleNum("font",f);break;case "defaulttextformat":case "defaultnontextformat":b&&D.AddUndo(c,a.GetStyleString("cellformat",
B[l]));B[l]=a.GetStyleNum("cellformat",f);break;case "defaulttextvalueformat":case "defaultnontextvalueformat":b&&D.AddUndo(c,a.GetStyleString("valueformat",B[l]));B[l]=a.GetStyleNum("valueformat",f);for(h in a.cells)delete a.cells[h].displaystring;break;case "lastcol":case "lastrow":b&&D.AddUndo(c,B[l]-0);a=f-0;"number"==typeof a&&(B[l]=0<a?a:1);break;case "recalc":b&&D.AddUndo(c,B[l]);"off"==f?B.recalc=f:delete B.recalc;break;case "usermaxcol":case "usermaxrow":b&&D.AddUndo(c,B[l]-0);a=f-0;"number"==
typeof a&&(B[l]=0<a?a:0);break;case "":break;case "\n":break;default:n=w.s_escUnknownSheetCmd+":::"+d+":::"}else if(/^[a-z]{1,2}(:[a-z]{1,2})?$/i.test(g))for(a.renderneeded=!0,g=g.toUpperCase(),h=g.indexOf(":"),0<=h?(p=SocialCalc.coordToCr(g.substring(0,h)+"1"),r=SocialCalc.coordToCr(g.substring(h+1)+"1")):r=p=SocialCalc.coordToCr(g+"1"),c=p.col;c<=r.col;c++)"width"==l?(h=SocialCalc.rcColname(c),b&&D.AddUndo("set "+h+" width",a.colattribs.width[h]),0<f.length?a.colattribs.width[h]=f:delete a.colattribs.width[h]):
"hide"==l&&(a.hiddencolrow="col",h=SocialCalc.rcColname(c),b&&D.AddUndo("set "+h+" hide",a.colattribs.hide[h]),0<f.length?a.colattribs.hide[h]=f:delete a.colattribs.hide[h]);else if(/^\d+(:\d+)?$/i.test(g))for(a.renderneeded=!0,g=g.toUpperCase(),h=g.indexOf(":"),0<=h?(p=SocialCalc.coordToCr("A"+g.substring(0,h)),r=SocialCalc.coordToCr("A"+g.substring(h+1))):r=p=SocialCalc.coordToCr("A"+g),t=p.row;t<=r.row;t++)"height"==l?(b&&D.AddUndo("set "+t+" height",a.rowattribs.height[t]),0<f.length?a.rowattribs.height[t]=
f:delete a.rowattribs.height[t]):"hide"==l&&(a.hiddencolrow="row",b&&D.AddUndo("set "+t+" hide",a.rowattribs.hide[t]),0<f.length?a.rowattribs.hide[t]=f:delete a.rowattribs.hide[t]);else if(/^[a-z]{1,2}\d+(:[a-z]{1,2}\d+)?$/i.test(g))for(t(),p.row!=r.row||p.col!=r.col||a.celldisplayneeded||a.renderneeded?(a.renderneeded=!0,a.celldisplayneeded=""):a.celldisplayneeded=SocialCalc.crToCoord(p.col,p.row),t=p.row;t<=r.row;t++)for(c=p.col;c<=r.col;c++)h=SocialCalc.crToCoord(c,t),q=a.GetAssuredCell(h),q.readonly&&
"readonly"!=l||(b&&D.AddUndo("set "+h+" all",a.CellToString(q)),"value"==l?(h=f.indexOf(" "),q.datavalue=f.substring(h+1)-0,delete q.errors,q.datatype="v",q.valuetype=f.substring(0,h),delete q.displaystring,delete q.parseinfo,B.needsrecalc="yes"):"text"==l?(h=f.indexOf(" "),q.datavalue=SocialCalc.decodeFromSave(f.substring(h+1)),delete q.errors,q.datatype="t",q.valuetype=f.substring(0,h),delete q.displaystring,delete q.parseinfo,B.needsrecalc="yes"):"formula"==l?(q.datavalue=0,delete q.errors,q.datatype=
"f",q.valuetype="e#N/A",q.formula=f,delete q.displaystring,delete q.parseinfo,B.needsrecalc="yes"):"constant"==l?(h=f.indexOf(" "),e=f.substring(h+1).indexOf(" "),q.datavalue=f.substring(h+1,h+1+e)-0,q.valuetype=f.substring(0,h),"e"==q.valuetype.charAt(0)?q.errors=q.valuetype.substring(1):delete q.errors,q.datatype="c",q.formula=f.substring(h+e+2),delete q.displaystring,delete q.parseinfo,B.needsrecalc="yes"):"empty"==l?(q.datavalue="",delete q.errors,q.datatype=null,q.formula="",q.valuetype="b",
delete q.displaystring,delete q.parseinfo,B.needsrecalc="yes"):"all"==l?(0<f.length?(q=new SocialCalc.Cell(h),a.CellFromStringParts(q,f.split(":"),1),a.cells[h]=q):delete a.cells[h],B.needsrecalc="yes"):/^b[trbl]$/.test(l)?(q[l]=a.GetStyleNum("borderstyle",f),a.renderneeded=!0):"color"==l||"bgcolor"==l?q[l]=a.GetStyleNum("color",f):"layout"==l||"cellformat"==l?q[l]=a.GetStyleNum(l,f):"font"==l?("* * *"==f&&(f=""),q[l]=a.GetStyleNum("font",f)):"textvalueformat"==l||"nontextvalueformat"==l?(q[l]=a.GetStyleNum("valueformat",
f),delete q.displaystring):"cssc"==l?(f=f.replace(/[^a-zA-Z0-9\-]/g,""),q.cssc=f):"csss"==l?(f=f.replace(/\n/g,""),q.csss=f):"mod"==l?(f=f.replace(/[^yY]/g,"").toLowerCase(),q.mod=f):"comment"==l?q.comment=SocialCalc.decodeFromSave(f):"readonly"==l?q.readonly="yes"==f.toLowerCase():n=w.s_escUnknownSetCoordCmd+"::"+d+"::");break;case "merge":a.renderneeded=!0;g=c.NextToken();f=c.RestOfString();t();q=a.GetAssuredCell(p.coord);if(q.readonly)break;b&&D.AddUndo("unmerge "+p.coord);r.col>p.col?q.colspan=
r.col-p.col+1:delete q.colspan;r.row>p.row?q.rowspan=r.row-p.row+1:delete q.rowspan;a.changedrendervalues=!0;break;case "unmerge":a.renderneeded=!0;g=c.NextToken();f=c.RestOfString();t();q=a.GetAssuredCell(p.coord);if(q.readonly)break;b&&D.AddUndo("merge "+p.coord+":"+SocialCalc.crToCoord(p.col+(q.colspan||1)-1,p.row+(q.rowspan||1)-1));delete q.colspan;delete q.rowspan;a.changedrendervalues=!0;break;case "erase":case "cut":a.renderneeded=!0;a.changedrendervalues=!0;g=c.NextToken();f=c.RestOfString();
t();b&&D.AddUndo("changedrendervalues");"cut"==e&&(b&&D.AddUndo("loadclipboard",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard)),SocialCalc.Clipboard.clipboard=SocialCalc.CreateSheetSave(a,g));for(t=p.row;t<=r.row;t++)for(c=p.col;c<=r.col;c++)h=SocialCalc.crToCoord(c,t),q=a.GetAssuredCell(h),q.readonly||(b&&D.AddUndo("set "+h+" all",a.CellToString(q)),"all"==f?delete a.cells[h]:"formulas"==f?(q.datavalue="",q.datatype=null,q.formula="",q.valuetype="b",delete q.errors,delete q.displaystring,
delete q.parseinfo,q.comment&&delete q.comment):"formats"==f&&(l=new SocialCalc.Cell(h),l.datavalue=q.datavalue,l.datatype=q.datatype,l.formula=q.formula,l.valuetype=q.valuetype,q.comment&&(l.comment=q.comment),a.cells[h]=l));B.needsrecalc="yes";break;case "fillright":case "filldown":a.renderneeded=!0;a.changedrendervalues=!0;b&&D.AddUndo("changedrendervalues");g=c.NextToken();f=c.RestOfString();t();"fillright"==e?(e=!0,s=p.row,u=p.col+1):(e=!1,s=p.row+1,u=p.col);for(t=s;t<=r.row;t++)for(c=u;c<=r.col;c++)if(h=
SocialCalc.crToCoord(c,t),q=a.GetAssuredCell(h),!q.readonly){b&&D.AddUndo("set "+h+" all",a.CellToString(q));e?(v=SocialCalc.crToCoord(p.col,t),w=c-u+1,d=0):(v=SocialCalc.crToCoord(c,p.row),w=0,d=t-s+1);x=a.GetAssuredCell(v);if("all"==f||"formats"==f)for(l in F)1!=F[l]&&(void 0===typeof x[l]||3==F[l]?delete q[l]:q[l]=x[l]);if("all"==f||"formulas"==f)q.datavalue=x.datavalue,q.datatype=x.datatype,q.valuetype=x.valuetype,q.formula="f"==q.datatype?SocialCalc.OffsetFormulaCoords(x.formula,w,d):x.formula,
delete q.parseinfo,q.errors=x.errors;delete q.displaystring}B.needsrecalc="yes";break;case "copy":g=c.NextToken();f=c.RestOfString();b&&D.AddUndo("loadclipboard",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard=SocialCalc.CreateSheetSave(a,g);break;case "loadclipboard":f=c.RestOfString();b&&D.AddUndo("loadclipboard",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard=SocialCalc.decodeFromSave(f);break;case "clearclipboard":b&&
D.AddUndo("loadclipboard",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard="";break;case "paste":a.renderneeded=!0;a.changedrendervalues=!0;b&&D.AddUndo("changedrendervalues");g=c.NextToken();f=c.RestOfString();t();if(!SocialCalc.Clipboard.clipboard)break;e=new SocialCalc.Sheet;e.ParseSheetSave(SocialCalc.Clipboard.clipboard);console.log("clipsheet.copiedfrom:");console.log(e.copiedfrom);y=SocialCalc.ParseRange(e.copiedfrom);console.log("cliprange:");console.log(y);
w=p.col-y.cr1.col;d=p.row-y.cr1.row;z=Math.max(r.col-p.col+1,y.cr2.col-y.cr1.col+1);A=Math.max(r.row-p.row+1,y.cr2.row-y.cr1.row+1);p.col+z-1>B.lastcol&&(B.lastcol=p.col+z-1);p.row+A-1>B.lastrow&&(B.lastrow=p.row+A-1);for(t=p.row;t<p.row+A;t++)for(c=p.col;c<p.col+z;c++)if(h=SocialCalc.crToCoord(c,t),q=a.GetAssuredCell(h),!q.readonly){b&&D.AddUndo("set "+h+" all",a.CellToString(q));v=SocialCalc.crToCoord(y.cr1.col+(c-p.col)%(y.cr2.col-y.cr1.col+1),y.cr1.row+(t-p.row)%(y.cr2.row-y.cr1.row+1));x=e.GetAssuredCell(v);
if("all"==f||"formats"==f)for(l in F)1!=F[l]&&(void 0===typeof x[l]||3==F[l]?delete q[l]:(h=SocialCalc.CellPropertiesTable[l],q[l]=h&&x[l]?a.GetStyleNum(h,e.GetStyleString(h,x[l])):x[l]));if("all"==f||"formulas"==f)q.datavalue=x.datavalue,q.datatype=x.datatype,q.valuetype=x.valuetype,q.formula="f"==q.datatype?SocialCalc.OffsetFormulaCoords(x.formula,w,d):x.formula,delete q.parseinfo,q.errors=x.errors,x.comment?q.comment=x.comment:q.comment&&delete q.comment;delete q.displaystring}B.needsrecalc="yes";
break;case "sort":a.renderneeded=!0;a.changedrendervalues=!0;b&&D.AddUndo("changedrendervalues");g=c.NextToken();t();d=[];I=[];for(w=O=0;3>=w;w++)d[w]=c.NextToken(),I[w]=c.NextToken(),d[w]&&(O=w);e={};l=[];G=[];N=[];for(t=p.row;t<=r.row;t++){for(c=p.col;c<=r.col;c++)h=SocialCalc.crToCoord(c,t),(q=a.cells[h])?(e[h]=a.CellToString(q),b&&D.AddUndo("set "+h+" all",e[h])):b&&D.AddUndo("set "+h+" all");l.push(l.length);G.push([]);N.push([]);slast=N.length-1;for(w=0;w<=O;w++)h=d[w]+t,q=a.GetAssuredCell(h),
h=q.datavalue,c=q.valuetype.charAt(0)||"b","t"==c&&(h=h.toLowerCase()),G[slast].push(h),N[slast].push(c)}b=function(a,b){var c,d,e,f,g;for(c=0;c<=O;c++)if("up"==I[c]?(d=a,e=b):(d=b,e=a),f=N[d][c],tb=N[e][c],"t"==f?"t"==tb?(d=G[d][c],e=G[e][c],g=d>e?1:d<e?-1:0):"n"==tb?g=1:"b"==tb?g="up"==I[c]?-1:1:"e"==tb&&(g=-1):"n"==f?"t"==tb?g=-1:"n"==tb?(d=G[d][c]-0,e=G[e][c]-0,g=d>e?1:d<e?-1:0):"b"==tb?g="up"==I[c]?-1:1:"e"==tb&&(g=-1):"e"==f?"e"==tb?(d=G[d][c],e=G[e][c],g=d>e?1:d<e?-1:0):g="b"==tb?"up"==I[c]?
-1:1:1:"b"==f&&(g="b"==tb?0:"up"==I[c]?1:-1),g)return g;return a>b?1:a<b?-1:0};l.sort(b);for(t=p.row;t<=r.row;t++)for(b=l[t-p.row],c=p.col;c<=r.col;c++)h=SocialCalc.crToCoord(c,t),D=SocialCalc.crToCoord(c,b+p.row),e[D]?(q=new SocialCalc.Cell(h),a.CellFromStringParts(q,e[D].split(":"),1),"f"==q.datatype&&(q.formula=SocialCalc.OffsetFormulaCoords(q.formula,0,t-p.row-b)),a.cells[h]=q):delete a.cells[h];B.needsrecalc="yes";break;case "insertcol":case "insertrow":a.renderneeded=!0;a.changedrendervalues=
!0;g=c.NextToken();f=c.RestOfString();t();"insertcol"==e?(w=1,f=p.col,d=0,u=1,C=s=p.col,q=1,z=B.lastrow,b&&D.AddUndo("deletecol "+p.coord)):(w=0,d=f=1,u=p.row,s=1,C=B.lastcol,z=q=p.row,b&&D.AddUndo("deleterow "+p.coord));for(t=B.lastrow;t>=u;t--)for(c=B.lastcol;c>=f;c--)v=SocialCalc.crToCoord(c,t),h=SocialCalc.crToCoord(c+w,t+d),a.cells[v]?a.cells[h]=a.cells[v]:delete a.cells[h];for(t=q;t<=z;t++)for(c=s;c<=C;c++)for(l in h=SocialCalc.crToCoord(c,t),q=new SocialCalc.Cell(h),a.cells[h]=q,v=SocialCalc.crToCoord(c-
w,t-d),x=a.GetAssuredCell(v),F)2==F[l]&&(q[l]=x[l]);for(h in a.cells)(q=a.cells[h])&&"f"==q.datatype&&(q.formula=SocialCalc.AdjustFormulaCoords(q.formula,p.col,w,p.row,d)),q&&delete q.parseinfo;for(y in a.names)a.names[y]&&(c=a.names[y].definition,h="","="==c.charAt(0)&&(h="=",c=c.substring(1)),a.names[y].definition=h+SocialCalc.AdjustFormulaCoords(c,p.col,w,p.row,d));for(t=B.lastrow;t>=u&&"insertrow"==e;t--)for(l in b=t+d,a.rowattribs)h=a.rowattribs[l][t],a.rowattribs[l][b]!=h&&(h?a.rowattribs[l][b]=
h:delete a.rowattribs[l][b]);for(c=B.lastcol;c>=f&&"insertcol"==e;c--)for(l in t=SocialCalc.rcColname(c),b=SocialCalc.rcColname(c+w),a.colattribs)h=a.colattribs[l][t],a.colattribs[l][b]!=h&&(h?a.colattribs[l][b]=h:delete a.colattribs[l][b]);B.lastcol+=w;B.lastrow+=d;B.needsrecalc="yes";break;case "deletecol":case "deleterow":a.renderneeded=!0;a.changedrendervalues=!0;g=c.NextToken();f=c.RestOfString();f=B.lastcol;F=B.lastrow;t();"deletecol"==e?(w=p.col-r.col-1,d=0,u=r.col+1,s=1):(w=0,d=p.row-r.row-
1,u=1,s=r.row+1);for(t=s;t<=F-d;t++)for(c=u;c<=f-w;c++)if(h=SocialCalc.crToCoord(c+w,t+d),(q=a.cells[h])&&q.readonly)return n;for(t=s;t<=F-d;t++)for(c=u;c<=f-w;c++)h=SocialCalc.crToCoord(c+w,t+d),b&&(t<s-d||c<u-w)&&((q=a.cells[h])?D.AddUndo("set "+h+" all",a.CellToString(q)):D.AddUndo("erase "+h+" all")),v=SocialCalc.crToCoord(c,t),(q=a.cells[v])?a.cells[h]=q:delete a.cells[h];for(h in a.cells)if(q=a.cells[h])"f"==q.datatype?(t=q.formula,q.formula=SocialCalc.AdjustFormulaCoords(t,p.col,w,p.row,d),
q.formula!=t&&(delete q.parseinfo,b&&-1!=q.formula.indexOf("#REF!")&&(c=SocialCalc.coordToCr(h),D.AddUndo("set "+SocialCalc.rcColname(c.col-w)+(c.row-d)+" formula "+t)))):delete q.parseinfo;for(y in a.names)a.names[y]&&(c=a.names[y].definition,h="","="==c.charAt(0)&&(h="=",c=c.substring(1)),a.names[y].definition=h+SocialCalc.AdjustFormulaCoords(c,p.col,w,p.row,d));for(t=s;t<=F-d&&"deleterow"==e;t++)for(l in c=t+d,a.rowattribs)h=a.rowattribs[l][t],a.rowattribs[l][c]!=h&&(b&&D.AddUndo("set "+c+" "+
l,a.rowattribs[l][c]),h?a.rowattribs[l][c]=h:delete a.rowattribs[l][c]);for(c=u;c<=f-w&&"deletecol"==e;c++)for(l in t=SocialCalc.rcColname(c),q=SocialCalc.rcColname(c+w),a.colattribs)h=a.colattribs[l][t],a.colattribs[l][q]!=h&&(b&&D.AddUndo("set "+q+" "+l,a.colattribs[l][q]),h?a.colattribs[l][q]=h:delete a.colattribs[l][q]);if(b)if("deletecol"==e)for(c=p.col;c<=r.col;c++)D.AddUndo("insertcol "+SocialCalc.rcColname(c));else for(t=p.row;t<=r.row;t++)D.AddUndo("insertrow "+t);"deletecol"==e?p.col<=f&&
(B.lastcol=r.col<=f?B.lastcol+w:p.col-1):p.row<=F&&(B.lastrow=r.row<=F?B.lastrow+d:p.row-1);B.needsrecalc="yes";break;case "movepaste":case "moveinsert":var X,H;a.renderneeded=!0;a.changedrendervalues=!0;b&&D.AddUndo("changedrendervalues");g=c.NextToken();q=c.NextToken();f=c.RestOfString();""==f&&(f="all");t();H=SocialCalc.coordToCr(q);w=H.col-p.col;d=H.row-p.row;z=r.col-p.col+1;A=r.row-p.row+1;X={};for(t=p.row;t<=r.row;t++)for(c=p.col;c<=r.col;c++)if(h=SocialCalc.crToCoord(c,t),q=a.GetAssuredCell(h),
!q.readonly&&(b&&D.AddUndo("set "+h+" all",a.CellToString(q)),a.cells[h])){X[h]=new SocialCalc.Cell(h);for(l in F)void 0!==typeof q[l]&&(X[h][l]=q[l],"all"==f&&delete q[l],"formulas"==f&&(1!=F[l]&&3!=F[l]||delete q[l]),"formats"==f&&2==F[l]&&delete q[l]);"formulas"==f&&(q.datavalue="",q.datatype=null,q.formula="",q.valuetype="b");"all"==f&&delete a.cells[h]}"moveinsert"==e&&(s=u=!1,0==d&&(H.col<p.col||H.col>r.col)?H.col<p.col?(C=p.col-H.col,u=-1):(H.col-=1,w=H.col-r.col,C=H.col-r.col,u=1):0==w&&(H.row<
p.row||H.row>r.row)?H.row<p.row?(C=p.row-H.row,s=-1):(H.row-=1,d=H.row-r.row,C=H.row-r.row,s=1):e="movepaste");e={};if(s)for(t=0;t<C;t++)for(c=p.col;c<=r.col;c++){0>s?(v=SocialCalc.crToCoord(c,H.row+C-t-1),h=SocialCalc.crToCoord(c,r.row-t)):(v=SocialCalc.crToCoord(c,H.row-C+t+1),h=SocialCalc.crToCoord(c,p.row+t));x=a.GetAssuredCell(v);b&&D.AddUndo("set "+v+" all",a.CellToString(x));q=a.GetAssuredCell(h);if("all"==f||"formats"==f)for(l in F)1!=F[l]&&(void 0===typeof x[l]||3==F[l]?delete q[l]:q[l]=
x[l]);if("all"==f||"formulas"==f)q.datavalue=x.datavalue,q.datatype=x.datatype,q.valuetype=x.valuetype,q.formula=x.formula,delete q.parseinfo,q.errors=x.errors;delete q.displaystring;e[v]=h}if(u)for(c=0;c<C;c++)for(t=p.row;t<=r.row;t++){0>u?(v=SocialCalc.crToCoord(H.col+C-c-1,t),h=SocialCalc.crToCoord(r.col-c,t)):(v=SocialCalc.crToCoord(H.col-C+c+1,t),h=SocialCalc.crToCoord(p.col+c,t));x=a.GetAssuredCell(v);b&&D.AddUndo("set "+v+" all",a.CellToString(x));q=a.GetAssuredCell(h);if("all"==f||"formats"==
f)for(l in F)1!=F[l]&&(void 0===typeof x[l]||3==F[l]?delete q[l]:q[l]=x[l]);if("all"==f||"formulas"==f)q.datavalue=x.datavalue,q.datatype=x.datatype,q.valuetype=x.valuetype,q.formula=x.formula,delete q.parseinfo,q.errors=x.errors;delete q.displaystring;e[v]=h}H.col+z-1>B.lastcol&&(B.lastcol=H.col+z-1);H.row+A-1>B.lastrow&&(B.lastrow=H.row+A-1);for(t=p.row;t<p.row+A;t++)for(c=p.col;c<p.col+z;c++)if(h=SocialCalc.crToCoord(c+w,t+d),q=a.GetAssuredCell(h),!q.readonly)if(b&&D.AddUndo("set "+h+" all",a.CellToString(q)),
v=SocialCalc.crToCoord(c,t),e[v]=h,"all"!=f||X[v]){(x=X[v])||(x=a.GetAssuredCell(v));if("all"==f||"formats"==f)for(l in F)1!=F[l]&&(void 0===typeof x[l]||3==F[l]?delete q[l]:q[l]=x[l]);if("all"==f||"formulas"==f)q.datavalue=x.datavalue,q.datatype=x.datatype,q.valuetype=x.valuetype,q.formula=x.formula,delete q.parseinfo,q.errors=x.errors,x.comment?q.comment=x.comment:q.comment&&delete q.comment;delete q.displaystring}else delete a.cells[h];for(h in a.cells)if(q=a.cells[h])"f"==q.datatype?(t=q.formula,
q.formula=SocialCalc.ReplaceFormulaCoords(t,e),q.formula!=t&&(delete q.parseinfo,b&&!e[h]&&D.AddUndo("set "+h+" formula "+t))):delete q.parseinfo;for(y in a.names)a.names[y]&&(t=c=a.names[y].definition,h="","="==c.charAt(0)&&(h="=",c=c.substring(1)),a.names[y].definition=h+SocialCalc.ReplaceFormulaCoords(c,e),b&&a.names[y].definition!=t&&D.AddUndo("name define "+y+" "+t));B.needsrecalc="yes";break;case "name":g=c.NextToken();y=c.NextToken();f=c.RestOfString();y=y.toUpperCase().replace(/[^A-Z0-9_\.]/g,
"");if(""==y)break;if("define"==g){if(""==f)break;a.names[y]?(b&&D.AddUndo("name define "+y+" "+a.names[y].definition),a.names[y].definition=f):(b&&D.AddUndo("name delete "+y),a.names[y]={definition:f,desc:""})}else"desc"==g?a.names[y]&&(b&&D.AddUndo("name desc "+y+" "+a.names[y].desc),a.names[y].desc=f):"delete"==g&&(b&&(a.names[y].desc&&D.AddUndo("name desc "+y+" "+a.names[y].desc),D.AddUndo("name define "+y+" "+a.names[y].definition)),delete a.names[y]);B.needsrecalc="yes";break;case "recalc":B.needsrecalc=
"yes";a.recalconce=!0;break;case "redisplay":a.renderneeded=!0;break;case "changedrendervalues":a.changedrendervalues=!0;break;case "startcmdextension":y=c.NextToken();(D=a.sci.CmdExtensionCallbacks[y])&&D.func(y,D.data,a,c,b);break;case "":break;case "\n":break;default:n=w.s_escUnknownCmd+":"+d+":"}return n};SocialCalc.SheetUndo=function(a){var c,b=a.changes.TOS(),d="";for(c=b?b.undo.length-1:-1;0<=c;c--)d&&(d+="\n"),d+=b.undo[c];a.changes.Undo();a.ScheduleSheetCommands(d,!1)};
SocialCalc.SheetRedo=function(a){var c,b;if(a.changes.Redo()){c=a.changes.TOS();var d="";for(b=0;c&&b<c.command.length;b++)d&&(d+="\n"),d+=c.command[b];a.ScheduleSheetCommands(d,!1)}else a.ScheduleSheetCommands("",!1)};SocialCalc.CreateAuditString=function(a){var c,b="",d=a.changes.stack,e=a.changes.tos;for(a=0;a<=e;a++)for(c=0;c<d[a].command.length;c++)b+=d[a].command[c]+"\n";return b};
SocialCalc.GetStyleNum=function(a,c,b){var d;if(0==b.length)return 0;d=a[c+"hash"][b];d||(1>a[c+"s"].length&&a[c+"s"].push(""),d=a[c+"s"].push(b)-1,a[c+"hash"][b]=d,a.changedrendervalues=!0);return d};SocialCalc.GetStyleString=function(a,c,b){return b?a[c+"s"][b]:null};
SocialCalc.OffsetFormulaCoords=function(a,c,b){var d,e,f,g,l="";d=SocialCalc.Formula;if(!d)return"Need SocialCalc.Formula";var h=d.TokenType,n=h.op,p=h.string,h=h.coord,r=d.TokenOpExpansion;a=d.ParseFormulaIntoTokens(a);for(f=0;f<a.length;f++)if(e=a[f].type,d=a[f].text,e==h){g="";e=SocialCalc.coordToCr(d);"$"!=d.charAt(0)?e.col+=c:g+="$";g+=SocialCalc.rcColname(e.col);-1==d.indexOf("$",1)?e.row+=b:g+="$";g+=e.row;if(1>e.row||1>e.col)g="#REF!";l+=g}else e==p?0<=d.indexOf('"')?(console.log("ttext:"+
d),l+='"'+d.replace(/"/g,'""')+'"',console.log("updatedformula:"+l)):l+='"'+d+'"':l=e==n?l+(r[d]||d):l+d;return l};
SocialCalc.AdjustFormulaCoords=function(a,c,b,d,e){var f,g,l="",h=!1,n=SocialCalc.Formula;if(!n)return"Need SocialCalc.Formula";var p=n.TokenType,r=p.op,t=p.string,p=p.coord,n=n.TokenOpExpansion;parseinfo=SocialCalc.Formula.ParseFormulaIntoTokens(a);for(g=0;g<parseinfo.length;g++){f=parseinfo[g].type;a=parseinfo[g].text;f==r&&("!"==a?h=!0:":"!=a&&(h=!1),a=n[a]||a);if(f==p){cr=SocialCalc.coordToCr(a);(0>b&&cr.col>=c&&cr.col<c-b||0>e&&cr.row>=d&&cr.row<d-e)&&!h&&(cr.col=0,cr.row=0);h||(cr.col>=c&&(cr.col+=
b),cr.row>=d&&(cr.row+=e));f="$"==a.charAt(0)?"$"+SocialCalc.rcColname(cr.col):SocialCalc.rcColname(cr.col);f=-1!=a.indexOf("$",1)?f+("$"+cr.row):f+cr.row;if(1>cr.row||1>cr.col)f="#REF!";a=f}else f==t&&(a=0<=a.indexOf('"')?'"'+a.replace(/"/,'""')+'"':'"'+a+'"');l+=a}return l};
SocialCalc.ReplaceFormulaCoords=function(a,c){var b,d,e,f="",g=!1;d=SocialCalc.Formula;if(!d)return"Need SocialCalc.Formula";var l=d.TokenType,h=l.op,n=l.string,l=l.coord,p=d.TokenOpExpansion;parseinfo=SocialCalc.Formula.ParseFormulaIntoTokens(a);for(e=0;e<parseinfo.length;e++)b=parseinfo[e].type,d=parseinfo[e].text,b==h&&("!"==d?g=!0:":"!=d&&(g=!1),d=p[d]||d),b==l?(cr=SocialCalc.coordToCr(d),b=SocialCalc.crToCoord(cr.col,cr.row),c[b]&&!g&&(cr=SocialCalc.coordToCr(c[b]),b="$"==d.charAt(0)?"$"+SocialCalc.rcColname(cr.col):
SocialCalc.rcColname(cr.col),d=b=-1!=d.indexOf("$",1)?b+("$"+cr.row):b+cr.row)):b==n&&(d=0<=d.indexOf('"')?'"'+d.replace(/"/,'""')+'"':'"'+d+'"'),f+=d;return f};SocialCalc.RecalcInfo={sheet:null,currentState:0,state:{idle:0,start_calc:1,order:2,calc:3,start_wait:4,done_wait:5},recalctimer:null,maxtimeslice:100,timeslicedelay:1,starttime:0,queue:[],LoadSheet:function(a){return!1}};
SocialCalc.RecalcData=function(){this.inrecalc=!0;this.celllist=[];this.celllistitem=0;this.calclist=null;this.calclistlength=0;this.nextcalc=this.lastcalc=this.firstcalc=null;this.count=0;this.checkinfo={}};SocialCalc.RecalcCheckInfo=function(){this.oldcoord=null;this.parsepos=0;this.inrangestart=this.inrange=!1;this.r=this.c=this.r2=this.r1=this.c2=this.c1=this.cr2=this.cr1=null};
SocialCalc.RecalcSheet=function(a){var c=SocialCalc.RecalcInfo;c.currentState!=c.state.idle?c.queue.push(a):(delete a.attribs.circularreferencecell,SocialCalc.Formula.FreshnessInfoReset(),SocialCalc.RecalcClearTimeout(),c.sheet=a,c.currentState=c.state.start_calc,c.starttime=new Date,a.statuscallback&&a.statuscallback(c,"calcstart",null,a.statuscallbackparams),SocialCalc.RecalcSetTimeout())};
SocialCalc.RecalcSetTimeout=function(){var a=SocialCalc.RecalcInfo;a.recalctimer=window.setTimeout(SocialCalc.RecalcTimerRoutine,a.timeslicedelay)};SocialCalc.RecalcClearTimeout=function(){var a=SocialCalc.RecalcInfo;a.recalctimer&&(window.clearTimeout(a.recalctimer),a.recalctimer=null)};
SocialCalc.RecalcLoadedSheet=function(a,c,b,d){var e=SocialCalc.RecalcInfo,f=SocialCalc.Formula;a=SocialCalc.Formula.AddSheetToCache(a||f.SheetCache.waitingForLoading,c,d);b&&(a&&"off"!=a.attribs.recalc)&&(a.previousrecalcsheet=e.sheet,e.sheet=a,e.currentState=e.state.start_calc);f.SheetCache.waitingForLoading=null;SocialCalc.RecalcSetTimeout()};
SocialCalc.RecalcTimerRoutine=function(){var a,c,b,d=new Date,e=0,f=SocialCalc.Formula;if(!f)return"Need SocialCalc.Formula";var g=SocialCalc.RecalcInfo,l=g.sheet;if(l){var h=l.recalcdata,n=function(a,b){l.statuscallback&&l.statuscallback(h,a,b,l.statuscallbackparams)};SocialCalc.RecalcClearTimeout();if(g.currentState==g.state.start_calc){h=new SocialCalc.RecalcData;l.recalcdata=h;for(b in l.cells)b&&h.celllist.push(b);h.calclist={};g.currentState=g.state.order}if(g.currentState==g.state.order){for(;h.celllistitem<
h.celllist.length;)if(b=h.celllist[h.celllistitem++],SocialCalc.RecalcCheckCell(l,b),new Date-d>=g.maxtimeslice){n("calcorder",{coord:b,total:h.celllist.length,count:h.celllistitem});SocialCalc.RecalcSetTimeout();return}n("calccheckdone",h.calclistlength);h.nextcalc=h.firstcalc;g.currentState=g.state.calc;SocialCalc.RecalcSetTimeout()}else if(g.currentState==g.state.start_wait){g.currentState=g.state.done_wait;if(g.LoadSheet&&(a=g.LoadSheet(f.SheetCache.waitingForLoading)))return;SocialCalc.RecalcLoadedSheet(null,
"",!1)}else if(g.currentState==g.state.done_wait)g.currentState=g.state.calc,SocialCalc.RecalcSetTimeout();else{g.currentState!=g.state.calc&&alert("Recalc state error: "+g.currentState+". Error in SocialCalc code.");for(b=l.recalcdata.nextcalc;b;){_GCR_=b;c=l.cells[b];a=f.evaluate_parsed_formula(c.parseinfo,l,!1);if(f.SheetCache.waitingForLoading){h.nextcalc=b;h.count+=e;n("calcloading",{sheetname:f.SheetCache.waitingForLoading});g.currentState=g.state.start_wait;SocialCalc.RecalcSetTimeout();return}if(f.RemoteFunctionInfo.waitingForServer){h.nextcalc=
b;h.count+=e;n("calcserverfunc",{funcname:f.RemoteFunctionInfo.waitingForServer,coord:b,total:h.calclistlength,count:h.count});g.currentState=g.state.done_wait;return}if(c.datavalue!=a.value||c.valuetype!=a.type)c.datavalue=a.value,c.valuetype=a.type,delete c.displaystring,l.recalcchangedavalue=!0;a.error&&(c.errors=a.error);e++;b=l.recalcdata.calclist[b];if(new Date-d>=g.maxtimeslice){h.nextcalc=b;h.count+=e;n("calcstep",{coord:b,total:h.calclistlength,count:h.count});SocialCalc.RecalcSetTimeout();
return}}h.inrecalc=!1;delete l.recalcdata;delete l.attribs.needsrecalc;g.sheet=l.previousrecalcsheet||null;g.sheet?(g.currentState=g.state.calc,SocialCalc.RecalcSetTimeout()):(f.FreshnessInfo.recalc_completed=!0,g.currentState=g.state.idle,n("calcfinished",new Date-g.starttime),0<g.queue.length&&(l=g.queue.shift(),l.RecalcSheet()))}}};
SocialCalc.RecalcCheckCell=function(a,c){var b,d,e,f,g,l,h,n,p=SocialCalc.Formula;if(!p)return"Need SocialCalc.Formula";f=p.TokenType;var r=f.op,t=f.name,q=f.coord,s=a.recalcdata,u=s.checkinfo,v=!1,w=null,x=c;a:for(;x;)if(h=a.cells[x],n=u[x],!h||"f"!=h.datatype||n&&"object"!=typeof n)x=w,u[x]&&(w=u[x].oldcoord);else{n||(n=new SocialCalc.RecalcCheckInfo,u[x]=n);h.errors&&delete h.errors;h.parseinfo||(h.parseinfo=p.ParseFormulaIntoTokens(h.formula));b=h.parseinfo;for(f=n.parsepos;f<b.length;f++){if(n.inrange){n.inrangestart&&
(n.cr1.col>n.cr2.col?(n.c1=n.cr2.col,n.c2=n.cr1.col):(n.c1=n.cr1.col,n.c2=n.cr2.col),n.c=n.c1-1,n.cr1.row>n.cr2.row?(n.r1=n.cr2.row,n.r2=n.cr1.row):(n.r1=n.cr1.row,n.r2=n.cr2.row),n.r=n.r1,n.inrangestart=!1);n.c+=1;if(n.c>n.c2){n.r+=1;if(n.r>n.r2){n.inrange=!1;continue}n.c=n.c1}b=SocialCalc.crToCoord(n.c,n.r);n.parsepos=f;n.oldcoord=w;w=x;x=b;if(u[x]&&"object"==typeof u[x])return h.errors=SocialCalc.Constants.s_caccCircRef+c,u[c]=!0,s.firstcalc?s.calclist[s.lastcalc]=c:s.firstcalc=c,s.lastcalc=c,
s.calclistlength++,a.attribs.circularreferencecell=x+"|"+w,h.errors;continue a}e=b[f].type;d=b[f].text;e==r&&("!"==d?v=!0:":"!=d&&(v=!1));if(e==t)if(g=p.LookupName(a,d),"range"==g.type){if(l=g.value.indexOf("|"),-1!=l){n.cr1=SocialCalc.coordToCr(g.value.substring(0,l));d=g.value.indexOf("|",l+1);n.cr2=SocialCalc.coordToCr(g.value.substring(l+1,d));n.inrange=!0;n.inrangestart=!0;f-=1;continue}}else"coord"==g.type&&(e=q,d=g.value);if(e==q)if(2<=f&&b[f-1].type==r&&":"==b[f-1].text&&b[f-2].type==q&&!v)n.cr1=
SocialCalc.coordToCr(b[f-2].text),n.cr2=SocialCalc.coordToCr(d),n.inrange=!0,n.inrangestart=!0,f-=1;else if(!v){-1!=d.indexOf("$")&&(d=d.replace(/\$/g,""));n.parsepos=f+1;n.oldcoord=w;w=x;x=d;if(u[x]&&"object"==typeof u[x])return h.errors=SocialCalc.Constants.s_caccCircRef+c,u[c]=!0,s.firstcalc?s.calclist[s.lastcalc]=c:s.firstcalc=c,s.lastcalc=c,s.calclistlength++,a.attribs.circularreferencecell=x+"|"+w,h.errors;continue a}}v=!1;u[x]=!0;s.firstcalc?s.calclist[s.lastcalc]=x:s.firstcalc=x;s.lastcalc=
x;s.calclistlength++;x=w;w=u[x]?u[x].oldcoord:null}return""};SocialCalc.Parse=function(a){this.str=a;this.pos=0;this.delimiter=" ";this.lineEnd=a.indexOf("\n");0>this.lineEnd&&(this.lineEnd=a.length)};SocialCalc.Parse.prototype.NextToken=function(){if(0>this.pos)return"";var a=this.str.indexOf(this.delimiter,this.pos),c=this.pos;a>this.lineEnd&&(a=this.lineEnd);if(0<=a)return this.pos=a+1,this.str.substring(c,a);this.pos=this.lineEnd;return this.str.substring(c,this.lineEnd)};
SocialCalc.Parse.prototype.RestOfString=function(){var a=this.pos;if(0>this.pos||this.pos>=this.lineEnd)return"";this.pos=this.lineEnd;return this.str.substring(a,this.lineEnd)};SocialCalc.Parse.prototype.RestOfStringNoMove=function(){return 0>this.pos||this.pos>=this.lineEnd?"":this.str.substring(this.pos,this.lineEnd)};SocialCalc.Parse.prototype.NextLine=function(){this.pos=this.lineEnd+1;this.lineEnd=this.str.indexOf("\n",this.pos);0>this.lineEnd&&(this.lineEnd=this.str.length)};
SocialCalc.Parse.prototype.EOF=function(){return 0>this.pos||this.pos>=this.str.length?!0:!1};SocialCalc.UndoStack=function(){this.stack=[];this.tos=-1;this.maxRedo=0;this.maxUndo=50};
SocialCalc.UndoStack.prototype.PushChange=function(a){for(;0<this.stack.length&&this.stack.length-1>this.tos;)this.stack.pop();this.stack.push({command:[],type:a,undo:[]});this.maxRedo&&this.stack.length>this.maxRedo&&this.stack.shift();this.maxUndo&&this.stack.length>this.maxUndo&&(this.stack[this.stack.length-this.maxUndo-1].undo=[]);this.tos=this.stack.length-1};
SocialCalc.UndoStack.prototype.AddDo=function(){for(var a=[],c=0;c<arguments.length;c++)null!=arguments[c]&&a.push(arguments[c]);a=a.join(" ");this.stack[this.stack.length-1].command.push(a)};SocialCalc.UndoStack.prototype.AddUndo=function(){for(var a=[],c=0;c<arguments.length;c++)null!=arguments[c]&&a.push(arguments[c]);a=a.join(" ");this.stack[this.stack.length-1].undo.push(a)};SocialCalc.UndoStack.prototype.TOS=function(){return 0<=this.tos?this.stack[this.tos]:null};
SocialCalc.UndoStack.prototype.Undo=function(){return 0<=this.tos&&(!this.maxUndo||this.tos>this.stack.length-this.maxUndo-1)?(this.tos-=1,!0):!1};SocialCalc.UndoStack.prototype.Redo=function(){return this.tos<this.stack.length-1?(this.tos+=1,!0):!1};SocialCalc.Clipboard={clipboard:""};
SocialCalc.RenderContext=function(a){var c=a.attribs,b=SocialCalc.Constants;this.sheetobj=a;this.showRCHeaders=this.showGrid=this.hideRowsCols=!1;this.rownamewidth=b.defaultRowNameWidth;this.pixelsPerRow=b.defaultAssumedRowHeight;this.cellskip={};this.coordToCR={};this.colwidth=[];this.totalwidth=0;this.rowpanes=[];this.colpanes=[];this.colunhideleft=[];this.colunhideright=[];this.rowunhidetop=[];this.rowunhidebottom=[];this.maxrow=this.maxcol=0;this.highlights={};this.cursorsuffix="";this.highlightTypes=
{cursor:{style:b.defaultHighlightTypeCursorStyle,className:b.defaultHighlightTypeCursorClass},range:{style:b.defaultHighlightTypeRangeStyle,className:b.defaultHighlightTypeRangeClass},cursorinsertup:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url("+b.defaultImagePrefix+"cursorinsertup.gif);",className:b.defaultHighlightTypeCursorClass},cursorinsertleft:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url("+
b.defaultImagePrefix+"cursorinsertleft.gif);",className:b.defaultHighlightTypeCursorClass},range2:{style:"color:#000;backgroundColor:#FFF;backgroundImage:url("+b.defaultImagePrefix+"range2.gif);",className:""}};this.cellIDprefix=b.defaultCellIDPrefix;this.defaultlinkstyle=null;this.defaultHTMLlinkstyle={type:"html"};this.defaultfontstyle=b.defaultCellFontStyle;this.defaultfontsize=b.defaultCellFontSize;this.defaultfontfamily=b.defaultCellFontFamily;this.defaultlayout=b.defaultCellLayout;this.defaultpanedividerwidth=
b.defaultPaneDividerWidth;this.defaultpanedividerheight=b.defaultPaneDividerHeight;this.gridCSS=b.defaultGridCSS;this.commentClassName=b.defaultCommentClass;this.commentCSS=b.defaultCommentStyle;this.commentNoGridClassName=b.defaultCommentNoGridClass;this.commentNoGridCSS=b.defaultCommentNoGridStyle;this.readonlyClassName=b.defaultReadonlyClass;this.readonlyCSS=b.defaultReadonlyStyle;this.readonlyNoGridClassName=b.defaultReadonlyNoGridClass;this.readonlyNoGridCSS=b.defaultReadonlyNoGridStyle;this.readonlyComment=
b.defaultReadonlyComment;this.classnames={colname:b.defaultColnameClass,rowname:b.defaultRownameClass,selectedcolname:b.defaultSelectedColnameClass,selectedrowname:b.defaultSelectedRownameClass,upperleft:b.defaultUpperLeftClass,skippedcell:b.defaultSkippedCellClass,panedivider:b.defaultPaneDividerClass,unhideleft:b.defaultUnhideLeftClass,unhideright:b.defaultUnhideRightClass,unhidetop:b.defaultUnhideTopClass,unhidebottom:b.defaultUnhideBottomClass};this.explicitStyles={colname:b.defaultColnameStyle,
rowname:b.defaultRownameStyle,selectedcolname:b.defaultSelectedColnameStyle,selectedrowname:b.defaultSelectedRownameStyle,upperleft:b.defaultUpperLeftStyle,skippedcell:b.defaultSkippedCellStyle,panedivider:b.defaultPaneDividerStyle,unhideleft:b.defaultUnhideLeftStyle,unhideright:b.defaultUnhideRightStyle,unhidetop:b.defaultUnhideTopStyle,unhidebottom:b.defaultUnhideBottomStyle};this.cellskip=null;this.needcellskip=!0;this.fonts=[];this.layouts=[];this.needprecompute=!0;if(c)this.rowpanes[0]={first:1,
last:c.lastrow},this.colpanes[0]={first:1,last:c.lastcol},this.usermaxcol=c.usermaxcol,this.usermaxrow=c.usermaxrow;else throw b.s_rcMissingSheet;};SocialCalc.RenderContext.prototype.PrecomputeSheetFontsAndLayouts=function(){SocialCalc.PrecomputeSheetFontsAndLayouts(this)};SocialCalc.RenderContext.prototype.CalculateCellSkipData=function(){SocialCalc.CalculateCellSkipData(this)};SocialCalc.RenderContext.prototype.CalculateColWidthData=function(){SocialCalc.CalculateColWidthData(this)};
SocialCalc.RenderContext.prototype.SetRowPaneFirstLast=function(a,c,b){this.rowpanes[a]={first:c,last:b}};SocialCalc.RenderContext.prototype.SetColPaneFirstLast=function(a,c,b){this.colpanes[a]={first:c,last:b}};SocialCalc.RenderContext.prototype.CoordInPane=function(a,c,b){return SocialCalc.CoordInPane(this,a,c,b)};SocialCalc.RenderContext.prototype.CellInPane=function(a,c,b,d){return SocialCalc.CellInPane(this,a,c,b,d)};
SocialCalc.RenderContext.prototype.InitializeTable=function(a){SocialCalc.InitializeTable(this,a)};SocialCalc.RenderContext.prototype.RenderSheet=function(a,c){return SocialCalc.RenderSheet(this,a,c)};SocialCalc.RenderContext.prototype.RenderColGroup=function(){return SocialCalc.RenderColGroup(this)};SocialCalc.RenderContext.prototype.RenderColHeaders=function(){return SocialCalc.RenderColHeaders(this)};SocialCalc.RenderContext.prototype.RenderSizingRow=function(){return SocialCalc.RenderSizingRow(this)};
SocialCalc.RenderContext.prototype.RenderRow=function(a,c,b){return SocialCalc.RenderRow(this,a,c,b)};SocialCalc.RenderContext.prototype.RenderSpacingRow=function(){return SocialCalc.RenderSpacingRow(this)};SocialCalc.RenderContext.prototype.RenderCell=function(a,c,b,d,e,f){return SocialCalc.RenderCell(this,a,c,b,d,e,f)};
SocialCalc.PrecomputeSheetFontsAndLayouts=function(a){var c,b,d,e,f,g,l=a.sheetobj;e=l.attribs;e.defaultfont&&(c=l.fonts[e.defaultfont],c=c.replace(/^\*/,SocialCalc.Constants.defaultCellFontStyle),c=c.replace(/(.+)\*(.+)/,"$1"+SocialCalc.Constants.defaultCellFontSize+"$2"),c=c.replace(/\*$/,SocialCalc.Constants.defaultCellFontFamily),b=c.match(/^(\S+? \S+?) (\S+?) (\S.*)$/),a.defaultfontstyle=b[1],a.defaultfontsize=b[2],a.defaultfontfamily=b[3]);for(f=1;f<l.fonts.length;f++)b=l.fonts[f],b=b.replace(/^\*/,
a.defaultfontstyle),b=b.replace(/(.+)\*(.+)/,"$1"+a.defaultfontsize+"$2"),b=b.replace(/\*$/,a.defaultfontfamily),b=b.match(/^(\S+?) (\S+?) (\S+?) (\S.*)$/),a.fonts[f]={style:b[1],weight:b[2],size:b[3],family:b[4]};c=/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/;d=SocialCalc.Constants.defaultCellLayout.match(c);e=e.defaultlayout?l.layouts[e.defaultlayout].match(c):" * * * * *".split(" ");for(f=1;f<l.layouts.length;f++){b=l.layouts[f];b=b.match(c);for(g=1;5>=g;g++)"*"==b[g]&&
(b[g]="*"!=e[g]?e[g]:d[g]);a.layouts[f]="padding:"+b[1]+" "+b[2]+" "+b[3]+" "+b[4]+";vertical-align:"+b[5]+";"}a.needprecompute=!1};
SocialCalc.CalculateCellSkipData=function(a){var c,b,d,e,f,g,l,h,n=a.sheetobj;a.maxrow=0;a.maxcol=0;a.cellskip={};for(c=1;c<=n.attribs.lastrow;c++)for(b=1;b<=n.attribs.lastcol;b++)if(d=SocialCalc.crToCoord(b,c),e=n.cells[d],void 0!==e&&!a.cellskip[d]&&(f=e.colspan||1,e=e.rowspan||1,1<f||1<e))for(g=c;g<c+e;g++)for(l=b;l<b+f;l++)h=SocialCalc.crToCoord(l,g),h==d?a.coordToCR[d]={row:c,col:b}:a.cellskip[h]=d,g>a.maxrow&&(maxrow=g),l>a.maxcol&&(maxcol=l);a.needcellskip=!1};
SocialCalc.CalculateColWidthData=function(a){var c,b,d,e=a.sheetobj;d=a.showRCHeaders?a.rownamewidth-0:0;for(colpane=0;colpane<a.colpanes.length;colpane++)for(c=a.colpanes[colpane].first;c<=a.colpanes[colpane].last;c++)if(b=SocialCalc.rcColname(c),"yes"==e.colattribs.hide[b])a.colwidth[c]=0;else{b=e.colattribs.width[b]||e.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if("blank"==b||"auto"==b)b="";a.colwidth[c]=b+"";d+=b&&0<b-0?b-0:10}a.totalwidth=d};
SocialCalc.InitializeTable=function(a,c){c.style.borderCollapse="collapse";c.cellSpacing="0";c.cellPadding="0";c.style.width=a.totalwidth+"px"};
SocialCalc.RenderSheet=function(a,c,b){var d,e,f,g;a.sheetobj.changedrendervalues&&(a.needcellskip=!0,a.needprecompute=!0,a.sheetobj.changedrendervalues=!1);a.needcellskip&&a.CalculateCellSkipData();a.needprecompute&&a.PrecomputeSheetFontsAndLayouts();a.CalculateColWidthData();f=document.createElement("table");a.InitializeTable(f);d=a.RenderColGroup();f.appendChild(d);g=document.createElement("tbody");g.appendChild(a.RenderSizingRow());a.showRCHeaders&&(d=a.RenderColHeaders())&&g.appendChild(d);for(e=
0;e<a.rowpanes.length;e++){for(rownum=a.rowpanes[e].first;rownum<=a.rowpanes[e].last;rownum++)d=a.RenderRow(rownum,e,b),g.appendChild(d);e<a.rowpanes.length-1&&(d=a.RenderSpacingRow(),g.appendChild(d))}f.appendChild(g);c&&(a=c.parentNode)&&a.replaceChild(f,c);return f};
SocialCalc.RenderRow=function(a,c,b,d){var e=a.sheetobj,f=document.createElement("tr"),g,l,h;a.showRCHeaders&&(l=document.createElement("td"),a.classnames&&(l.className=a.classnames.rowname),a.explicitStyles&&(l.style.cssText=a.explicitStyles.rowname),l.width=a.rownamewidth,l.style.verticalAlign="top",l.innerHTML=c+"",c<a.rowpanes[a.rowpanes.length-1].last&&"yes"==e.rowattribs.hide[c+1]&&(h=document.createElement("div"),h.style.position="relative",g=document.createElement("div"),a.classnames&&(g.className=
a.classnames.unhidetop),a.explicitStyles&&(g.style.cssText=a.explicitStyles.unhidetop),a.rowunhidetop[c]=g,h.appendChild(g),l.appendChild(h)),1<c&&"yes"==e.rowattribs.hide[c-1]&&(g=document.createElement("div"),a.classnames&&(g.className=a.classnames.unhidebottom),a.explicitStyles&&(g.style.cssText=a.explicitStyles.unhidebottom),a.rowunhidebottom[c]=g,l.appendChild(g)),f.appendChild(l));for(h=0;h<a.colpanes.length;h++){for(g=a.colpanes[h].first;g<=a.colpanes[h].last;g++)(l=a.RenderCell(c,g,b,h,null,
d))&&f.appendChild(l);h<a.colpanes.length-1&&(l=document.createElement("td"),l.width=a.defaultpanedividerwidth,a.classnames.panedivider&&(l.className=a.classnames.panedivider),a.explicitStyles.panedivider&&(l.style.cssText=a.explicitStyles.panedivider),g=document.createElement("div"),g.style.width=a.defaultpanedividerwidth+"px",g.style.overflow="hidden",l.appendChild(g),f.appendChild(l))}"yes"==e.rowattribs.hide[c]&&(f.style.cssText+=";display:none");return f};
SocialCalc.RenderSpacingRow=function(a){var c,b,d,e,f=document.createElement("tr");a.showRCHeaders&&(b=document.createElement("td"),b.width=a.rownamewidth,b.height=a.defaultpanedividerheight,a.classnames.panedivider&&(b.className=a.classnames.panedivider),a.explicitStyles.panedivider&&(b.style.cssText=a.explicitStyles.panedivider),f.appendChild(b));for(d=0;d<a.colpanes.length;d++){for(c=a.colpanes[d].first;c<=a.colpanes[d].last;c++){b=document.createElement("td");if(e=a.colwidth[c])b.width=e;b.height=
a.defaultpanedividerheight;a.classnames.panedivider&&(b.className=a.classnames.panedivider);a.explicitStyles.panedivider&&(b.style.cssText=a.explicitStyles.panedivider);b&&f.appendChild(b)}d<a.colpanes.length-1&&(b=document.createElement("td"),b.width=a.defaultpanedividerwidth,b.height=a.defaultpanedividerheight,a.classnames.panedivider&&(b.className=a.classnames.panedivider),a.explicitStyles.panedivider&&(b.style.cssText=a.explicitStyles.panedivider),f.appendChild(b))}return f};
SocialCalc.RenderColHeaders=function(a){var c=a.sheetobj,b=document.createElement("tr"),d,e;if(!a.showRCHeaders)return null;e=document.createElement("td");a.classnames&&(e.className=a.classnames.upperleft);a.explicitStyles&&(e.style.cssText=a.explicitStyles.upperleft);e.width=a.rownamewidth;b.appendChild(e);for(colpane=0;colpane<a.colpanes.length;colpane++){for(d=a.colpanes[colpane].first;d<=a.colpanes[colpane].last;d++){e=document.createElement("td");a.classnames&&(e.className=a.classnames.colname);
a.explicitStyles&&(e.style.cssText=a.explicitStyles.colname);"yes"==c.colattribs.hide[SocialCalc.rcColname(d)]&&(e.style.cssText+=";display:none");e.innerHTML=SocialCalc.rcColname(d);if(d<a.colpanes[a.colpanes.length-1].last&&"yes"==c.colattribs.hide[SocialCalc.rcColname(d+1)]){var f=document.createElement("div");a.classnames&&(f.className=a.classnames.unhideleft);a.explicitStyles&&(f.style.cssText=a.explicitStyles.unhideleft);a.colunhideleft[d]=f;e.appendChild(f)}1<d&&"yes"==c.colattribs.hide[SocialCalc.rcColname(d-
1)]&&(f=document.createElement("div"),a.classnames&&(f.className=a.classnames.unhideright),a.explicitStyles&&(f.style.cssText=a.explicitStyles.unhideright),a.colunhideright[d]=f,e.appendChild(f));b.appendChild(e)}colpane<a.colpanes.length-1&&(e=document.createElement("td"),e.width=a.defaultpanedividerwidth,a.classnames.panedivider&&(e.className=a.classnames.panedivider),a.explicitStyles.panedivider&&(e.style.cssText=a.explicitStyles.panedivider),b.appendChild(e))}return b};
SocialCalc.RenderColGroup=function(a){var c,b,d,e,f=a.sheetobj,g=document.createElement("colgroup");a.showRCHeaders&&(d=document.createElement("col"),d.width=a.rownamewidth,g.appendChild(d));for(c=0;c<a.colpanes.length;c++){for(b=a.colpanes[c].first;b<=a.colpanes[c].last;b++)if(d=document.createElement("col"),"yes"==f.colattribs.hide[SocialCalc.rcColname(b)])d.width="1";else{if(e=a.colwidth[b])d.width=e;g.appendChild(d)}c<a.colpanes.length-1&&(d=document.createElement("col"),d.width=a.defaultpanedividerwidth,
g.appendChild(d))}return g};
SocialCalc.RenderSizingRow=function(a){var c,b,d,e,f=a.sheetobj,g=document.createElement("tr");a.showRCHeaders&&(d=document.createElement("td"),d.style.width=a.rownamewidth+"px",d.height="1",g.appendChild(d));for(c=0;c<a.colpanes.length;c++){for(b=a.colpanes[c].first;b<=a.colpanes[c].last;b++){d=document.createElement("td");if("yes"==f.colattribs.hide[SocialCalc.rcColname(b)])d.width="1";else if(e=a.colwidth[b])d.width=e;d.height="1";g.appendChild(d)}c<a.colpanes.length-1&&(d=document.createElement("td"),
d.width=a.defaultpanedividerwidth,d.height="1",g.appendChild(d))}return g};
SocialCalc.RenderCell=function(a,c,b,d,e,f,g){var l=a.sheetobj,h,n,p,r,t,q="";c-=0;b-=0;var s=SocialCalc.crToCoord(b,c);if(a.cellskip[s]){if(a.CoordInPane(a.cellskip[s],d,e))return null;f=f?SocialCalc.CreatePseudoElement():document.createElement("td");a.classnames.skippedcell&&(f.className=a.classnames.skippedcell);a.explicitStyles.skippedcell&&(f.style.cssText=a.explicitStyles.skippedcell);f.innerHTML="&nbsp;";return f}f=f?SocialCalc.CreatePseudoElement():document.createElement("td");a.cellIDprefix&&
(f.id=a.cellIDprefix+s);(p=l.cells[s])||(p=new SocialCalc.Cell(s));t=l.attribs;scc=SocialCalc.Constants;if(1<p.colspan){for(h=n=1;h<p.colspan;h++)"yes"!=l.colattribs.hide[SocialCalc.rcColname(b+h)]&&a.CellInPane(c,b+h,d,e)&&n++;f.colSpan=n}if(1<p.rowspan){for(h=n=1;h<p.rowspan;h++)"yes"!=l.rowattribs.hide[c+h+""]&&a.CellInPane(c+h,b,d,e)&&n++;f.rowSpan=n}void 0==p.displaystring&&(p.displaystring=SocialCalc.FormatValueForDisplay(l,p.datavalue,s,g||a.defaultlinkstyle));f.innerHTML=p.displaystring;q=
(h=p.layout||t.defaultlayout)&&"undefined"!==typeof a.layouts[h]?q+a.layouts[h]:q+scc.defaultCellLayout;(h=p.font||t.defaultfont)&&"undefined"!==typeof a.fonts[h]?(g=a.fonts[h],q+="font-style:"+g.style+";font-weight:"+g.weight+";font-size:"+g.size+";font-family:"+g.family+";"):(scc.defaultCellFontSize&&(q+="font-size:"+scc.defaultCellFontSize+";"),scc.defaultCellFontFamily&&(q+="font-family:"+scc.defaultCellFontFamily+";"));(h=p.color||t.defaultcolor)&&"undefined"!==typeof l.colors[h]&&(q+="color:"+
l.colors[h]+";");(h=p.bgcolor||t.defaultbgcolor)&&"undefined"!==typeof l.colors[h]&&(q+="background-color:"+l.colors[h]+";");(h=p.cellformat)&&"undefined"!==typeof l.cellformats[h]?q+="text-align:"+l.cellformats[h]+";":(g=p.valuetype.charAt(0),"t"==g?(h=t.defaulttextformat)&&"undefined"!==typeof l.cellformats[h]&&(q+="text-align:"+l.cellformats[h]+";"):"n"==g?q=(h=t.defaultnontextformat)&&"undefined"!==typeof l.cellformats[h]?q+("text-align:"+l.cellformats[h]+";"):q+"text-align:right;":q+="text-align:left;");
if(1<p.colspan||1<p.rowspan)r=l.cells[SocialCalc.crToCoord(b+(p.colspan||1)-1,c+(p.rowspan||1)-1)];(h=p.bt)&&"undefined"!==typeof l.borderstyles[h]&&(q+="border-top:"+l.borderstyles[h]+";");(h="undefined"!=typeof r?r.br:p.br)&&"undefined"!==typeof l.borderstyles[h]?q+="border-right:"+l.borderstyles[h]+";":a.showGrid&&(g=a.CellInPane(c,b+(p.colspan||1),d,e)?SocialCalc.crToCoord(b+(p.colspan||1),c):"nomatch",a.cellskip[g]&&(g=a.cellskip[g]),l.cells[g]&&l.cells[g].bl||(q+="border-right:"+a.gridCSS));
(h="undefined"!=typeof r?r.bb:p.bb)&&"undefined"!==typeof l.borderstyles[h]?q+="border-bottom:"+l.borderstyles[h]+";":a.showGrid&&(g=a.CellInPane(c+(p.rowspan||1),b,d,e)?SocialCalc.crToCoord(b,c+(p.rowspan||1)):"nomatch",a.cellskip[g]&&(g=a.cellskip[g]),l.cells[g]&&l.cells[g].bt||(q+="border-bottom:"+a.gridCSS));(h=p.bl)&&"undefined"!==typeof l.borderstyles[h]&&(q+="border-left:"+l.borderstyles[h]+";");p.comment&&(f.title=p.comment,a.showGrid?(a.commentClassName&&(f.className=(f.className?f.className+
" ":"")+a.commentClassName),q+=a.commentCSS):(a.commentNoGridClassName&&(f.className=(f.className?f.className+" ":"")+a.commentNoGridClassName),q+=a.commentNoGridCSS));p.readonly&&(p.comment||(f.title=a.readonlyComment),a.showGrid?(a.readonlyClassName&&(f.className=(f.className?f.className+" ":"")+a.readonlyClassName),q+=a.readonlyCSS):(a.readonlyNoGridClassName&&(f.className=(f.className?f.className+" ":"")+a.readonlyNoGridClassName),q+=a.readonlyNoGridCSS));f.style.cssText=q;if(g=a.highlights[s])"cursor"==
g&&(g+=a.cursorsuffix),a.highlightTypes[g].className&&(f.className=(f.className?f.className+" ":"")+a.highlightTypes[g].className),SocialCalc.setStyles(f,a.highlightTypes[g].style);"yes"==l.colattribs.hide[SocialCalc.rcColname(b)]&&(f.style.cssText+=";display:none");"yes"==l.rowattribs.hide[c]&&(f.style.cssText+=";display:none");return f};SocialCalc.CoordInPane=function(a,c,b,d){var e=a.coordToCR[c];if(!e||!e.row||!e.col)throw"Bad coordToCR for "+c;return a.CellInPane(e.row,e.col,b,d)};
SocialCalc.CellInPane=function(a,c,b,d,e){var f=a.rowpanes[d];a=a.colpanes[e];if(!f||!a)throw"CellInPane called with unknown panes "+d+"/"+e;return c<f.first||c>f.last||b<a.first||b>a.last?!1:!0};SocialCalc.CreatePseudoElement=function(){return{style:{cssText:""},innerHTML:"",className:""}};SocialCalc.rcColname=function(a){702<a&&(a=702);1>a&&(a=1);var c=(a-1)%26+65;return(a=Math.floor((a-1)/26))?String.fromCharCode(a+64)+String.fromCharCode(c):String.fromCharCode(c)};SocialCalc.letters="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
SocialCalc.crToCoord=function(a,c){1>a&&(a=1);702<a&&(a=702);1>c&&(c=1);var b=(a-1)%26,d=Math.floor((a-1)/26);return d?SocialCalc.letters[d-1]+SocialCalc.letters[b]+c:SocialCalc.letters[b]+c};SocialCalc.coordToCol={};SocialCalc.coordToRow={};
SocialCalc.coordToCr=function(a){var c,b,d,e=SocialCalc.coordToRow[a];if(e)return{row:e,col:SocialCalc.coordToCol[a]};for(b=e=c=0;b<a.length;b++)d=a.charCodeAt(b),36!=d&&(57>=d?e=10*e+d-48:97<=d?c=26*c+d-96:65<=d&&(c=26*c+d-64));SocialCalc.coordToCol[a]=c;SocialCalc.coordToRow[a]=e;return{row:e,col:c}};
SocialCalc.ParseRange=function(a){var c,b,d;a||(a="A1:A1");a=a.toUpperCase();c=a.indexOf(":");0<=c?(b=a.substring(0,c),d=SocialCalc.coordToCr(b),d.coord=b,b=a.substring(c+1),c=SocialCalc.coordToCr(b),c.coord=b):(d=SocialCalc.coordToCr(a),d.coord=a,c=SocialCalc.coordToCr(a),c.coord=a);return{cr1:d,cr2:c}};SocialCalc.decodeFromSave=function(a){if("string"!=typeof a||-1==a.indexOf("\\"))return a;a=a.replace(/\\c/g,":");a=a.replace(/\\n/g,"\n");return a.replace(/\\b/g,"\\")};
SocialCalc.decodeFromAjax=function(a){if("string"!=typeof a||-1==a.indexOf("\\"))return a;a=a.replace(/\\c/g,":");a=a.replace(/\\n/g,"\n");a=a.replace(/\\e/g,"]]");return a.replace(/\\b/g,"\\")};SocialCalc.encodeForSave=function(a){if("string"!=typeof a)return a;-1!=a.indexOf("\\")&&(a=a.replace(/\\/g,"\\b"));-1!=a.indexOf(":")&&(a=a.replace(/:/g,"\\c"));-1!=a.indexOf("\n")&&(a=a.replace(/\n/g,"\\n"));return a};
SocialCalc.special_chars=function(a){/[&<>"]/.test(a)&&(a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/"/g,"&quot;"));return a};SocialCalc.Lookup=function(a,c){for(i=0;i<c.length;i++)if(c[i]>a)return 0<i?i-1:null;return c.length-1};SocialCalc.setStyles=function(a,c){var b,d,e,f;if(c)for(b=c.split(";"),d=0;d<b.length;d++)e=b[d].indexOf(":"),-1!=e&&(f=b[d].substring(0,e),e=b[d].substring(e+1),f&&e&&(a.style[f]=e))};
SocialCalc.GetViewportInfo=function(){var a={};window.innerWidth?(a.width=window.innerWidth,a.height=window.innerHeight,a.horizontalScroll=window.pageXOffset,a.verticalScroll=window.pageYOffset):document.documentElement&&document.documentElement.clientWidth?(a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight,a.horizontalScroll=document.documentElement.scrollLeft,a.verticalScroll=document.documentElement.scrollTop):document.body.clientWidth&&(a.width=document.body.clientWidth,
a.height=document.body.clientHeight,a.horizontalScroll=document.body.scrollLeft,a.verticalScroll=document.body.scrollTop);return a};SocialCalc.GetElementPosition=function(a){for(var c=0,b=0;a&&"relative"!=SocialCalc.GetComputedStyle(a,"position");)c+=a.offsetLeft,b+=a.offsetTop,a=a.offsetParent;return{left:c,top:b}};
SocialCalc.GetElementPositionWithScroll=function(a){a=a.getBoundingClientRect();return{left:a.left,right:a.right,top:a.top,bottom:a.bottom,width:a.width?a.width:a.right-a.left,height:a.height?a.height:a.bottom-a.top}};SocialCalc.GetElementFixedParent=function(a){for(;a&&"HTML"!=a.tagName;){if("fixed"==SocialCalc.GetComputedStyle(a,"position"))return a;a=a.parentNode}return!1};
SocialCalc.GetComputedStyle=function(a,c){return("undefined"!=typeof a.currentStyle?a.currentStyle:document.defaultView.getComputedStyle(a,null))[c]};SocialCalc.LookupElement=function(a,c){var b;for(b=0;b<c.length;b++)if(c[b].element==a)return c[b];return null};SocialCalc.AssignID=function(a,c,b){a.idPrefix&&(c.id=a.idPrefix+b)};
SocialCalc.GetCellContents=function(a,c){var b="",d=a.cells[c];if(d)switch(d.datatype){case "v":b=d.datavalue+"";break;case "t":b="'"+d.datavalue;break;case "f":b="="+d.formula;break;case "c":b=d.formula}return b};
SocialCalc.FormatValueForDisplay=function(a,c,b,d){var e,f=a.attribs,g=a.cells[b];g||(g=new SocialCalc.Cell(b));b=g.valuetype||"";e=b.substring(1);b=b.charAt(0);if(g.errors||"e"==b)return c=g.errors||e||"Error in cell";if("t"==b){b=a.valueformats[g.textvalueformat-0]||a.valueformats[f.defaulttextvalueformat-0]||"";if("formula"==b)return c="f"==g.datatype?SocialCalc.special_chars("="+g.formula)||"&nbsp;":"c"==g.datatype?SocialCalc.special_chars("'"+g.formula)||"&nbsp;":SocialCalc.special_chars("'"+
c)||"&nbsp;";c=SocialCalc.format_text_for_display(c,g.valuetype,b,a,d,g.nontextvalueformat)}else if("n"==b){b=g.nontextvalueformat;if(null==b||""==b)b=f.defaultnontextvalueformat;b=a.valueformats[b-0];if(null==b||"none"==b)b="";if("formula"==b)return c="f"==g.datatype?SocialCalc.special_chars("="+g.formula)||"&nbsp;":"c"==g.datatype?SocialCalc.special_chars("'"+g.formula)||"&nbsp;":SocialCalc.special_chars("'"+c)||"&nbsp;";if("forcetext"==b)return c="f"==g.datatype?SocialCalc.special_chars("="+g.formula)||
"&nbsp;":"c"==g.datatype?SocialCalc.special_chars(g.formula)||"&nbsp;":SocialCalc.special_chars(c)||"&nbsp;";c=SocialCalc.format_number_for_display(c,g.valuetype,b)}else c="&nbsp;";return c};
SocialCalc.format_text_for_display=function(a,c,b,d,e,f){var g,l,h;g=c.substring(1);h=a;if("none"==b||null==b)b="";/^(text-|custom|hidden)/.test(b)||(b="");if(""==b||"General"==b){"h"==g&&(b="text-html");if("w"==g||"r"==g)b="text-wiki";"l"==g&&(b="text-link");g||(b="text-plain")}"text-html"!=b&&(SocialCalc.Callbacks.expand_wiki&&/^text-wiki/.test(b)?h=SocialCalc.Callbacks.expand_wiki(h,d,e,b):"text-wiki"==b?h=SocialCalc.Callbacks.expand_markup&&SocialCalc.Callbacks.expand_markup(h,d,e)||SocialCalc.special_chars("wiki-text:"+
h):"text-url"==b?(a=SocialCalc.special_chars(h),c=encodeURI(h),h='<a href="'+c+'">'+a+"</a>"):"text-link"==b?h=SocialCalc.expand_text_link(h,d,e,b):"text-image"==b?(c=encodeURI(h),h='<img src="'+c+'">'):"text-custom:"==b.substring(0,12)?(a=SocialCalc.special_chars(h),a=a.replace(/  /g,"&nbsp; "),a=a.replace(/\n/g,"<br>"),c=encodeURI(h),l={},l.r=h,l.s=a,l.u=c,h=b.substring(12),h=h.replace(/@(r|s|u)/g,function(a,b){return l[b]})):"custom"==b.substring(0,6)?(h=SocialCalc.special_chars(h),h=h.replace(/  /g,
"&nbsp; "),h=h.replace(/\n/g,"<br>"),h+=" (custom format)"):"hidden"==b?h="&nbsp;":null!=f&&""!=f&&"none"!=d.valueformats[f-0]&&""!=d.valueformats[f-0]?(b=d.valueformats[f],h=SocialCalc.format_number_for_display(a,c,b)):(h=SocialCalc.special_chars(h),h=h.replace(/  /g,"&nbsp; "),h=h.replace(/\n/g,"<br>")));return h};
SocialCalc.format_number_for_display=function(a,c,b){var d,e=SocialCalc.Constants;d=a-0;c=c.substring(1);if("Auto"==b||""==b)b="%"==c?e.defaultFormatp:"$"==c?e.defaultFormatc:"dt"==c?e.defaultFormatdt:"d"==c?e.defaultFormatd:"t"==c?e.defaultFormatt:"l"==c?"logical":"General";return"logical"==b?d?e.defaultDisplayTRUE:e.defaultDisplayFALSE:"hidden"==b?"&nbsp;":SocialCalc.FormatNumber.formatNumberWithFormat(a,b,"")};
SocialCalc.DetermineValueType=function(a){var c=a+"",b="t",d,e;d=c.replace(/^\s+/,"");d=d.replace(/\s+$/,"");0==c.length?b="":c.match(/^\s+$/)||(d.match(/^[-+]?\d*(?:\.)?\d*(?:[eE][-+]?\d+)?$/)?(c=d-0,isNaN(c)?c=a+"":b="n"):d.match(/^[-+]?\d*(?:\.)?\d*\s*%$/)?(c=(d.slice(0,-1)-0)/100,b="n%"):d.match(/^[-+]?\$\s*\d*(?:\.)?\d*\s*$/)&&d.match(/\d/)?(c=d.replace(/\$/,"")-0,b="n$"):d.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*$/)?(c=d.replace(/,/g,"")-0,b="n"):d.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*\s*%$/)?(c=(d.replace(/[%,]/g,
"")-0)/100,b="n%"):d.match(/^[-+]?\$\s*(\d*,\d*)+(?:\.)?\d*$/)&&d.match(/\d/)?(c=d.replace(/[\$,]/g,"")-0,b="n$"):(a=c.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{1,4})\s*$/))?(c=a[3]-0,c=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(1E3>c?c+2E3:c,a[1]-0,a[2]-0)-2415019,b="nd"):(a=c.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})\s*$/))?(c=a[1]-0,c=1E3>c?c+2E3:c,c=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(c,a[2]-0,a[3]-0)-2415019,b="nd"):(a=c.match(/^(\d{1,2}):(\d{1,2})\s*$/))?
(d=a[1]-0,e=a[2]-0,24>d&&60>e&&(c=d/24+e/1440,b="nt")):(a=c.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))?(d=a[1]-0,e=a[2]-0,a=a[3]-0,24>d&&(60>e&&60>a)&&(c=d/24+e/1440+a/86400,b="nt")):(a=c.match(/^\s*([-+]?\d+) (\d+)\/(\d+)\s*$/))?(e=a[1]-0,d=a[2]-0,(a=a[3]-0)&&0<a&&(c=e+(0>e?-d/a:d/a),b="n")):(a=SocialCalc.InputConstants[c.toUpperCase()])?(d=a.indexOf(","),c=a.substring(0,d)-0,b=a.substring(d+1)):7<d.length&&"http://"==d.substring(0,7).toLowerCase()?(c=d,b="tl"):d.match(/<([A-Z][A-Z0-9]*)\b[^>]*>[\s\S]*?<\/\1>/i)&&
(c=d,b="th"));return{value:c,type:b}};SocialCalc.InputConstants={TRUE:"1,nl",FALSE:"0,nl","#N/A":"0,e#N/A","#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"};SocialCalc.default_expand_markup=function(a,c,b){a=SocialCalc.special_chars(a);a=a.replace(/  /g,"&nbsp; ");return a=a.replace(/\n/g,"<br>")};
SocialCalc.expand_text_link=function(a,c,b,d){var e;e=SocialCalc.Constants;c="";var f=SocialCalc.ParseCellLinkText(a+"");e=f.desc?SocialCalc.special_chars(f.desc):f.pagename?e.defaultPageLinkFormatString:e.defaultLinkFormatString;7<a.length&&("http://"==a.substring(0,7).toLowerCase()&&">"!=a.charAt(a.length-1))&&(e=e.substring(7));a=f.newwin||!b?' target="_blank"':"";f.pagename?SocialCalc.Callbacks.MakePageLink&&(c=SocialCalc.Callbacks.MakePageLink(f.pagename,f.workspacename,b,d)):c=encodeURI(f.url);
return'<a href="'+c+'"'+a+">"+e+"</a>"};
SocialCalc.ParseCellLinkText=function(a){var c={url:"",desc:"",newwin:!1,pagename:"",workspace:""},b=!1,d=a.length-1,e=0,f=a.lastIndexOf("<"),g=a.lastIndexOf("["),l=a.lastIndexOf("{"),h=-1;">"==a.charAt(d)&&-1!=f||"]"==a.charAt(d)&&-1!=g||!("}"!=a.charAt(d)||"]"!=a.charAt(d-1)||-1==l||-1==g||g<l)?(">"==a.charAt(d)?(h=f-1,0<f&&("<"==a.charAt(h)&&">"==a.charAt(d-1))&&(h--,d--,c.newwin=!0)):"]"==a.charAt(d)?(h=g-1,b=!0,0<g&&("["==a.charAt(h)&&"]"==a.charAt(d-1))&&(h--,d--,c.newwin=!0)):"}"==a.charAt(d)&&
(h=l-1,b=!0,wsend=g,d--,0<g&&("["==a.charAt(g-1)&&"]"==a.charAt(d-1))&&(wsend=g-1,d--,c.newwin=!0)," "==a.charAt(wsend-1)&&wsend--,c.workspace=a.substring(l+1,wsend)||"")," "==a.charAt(h)&&h--,'"'==a.charAt(e)&&'"'==a.charAt(h)&&(e++,h--)):(d++,h=d);b?c.pagename=a.substring(g+1,d)||"":c.url=a.substring(f+1,d)||"";h>=e&&(c.desc=a.substring(e,h+1));return c};
SocialCalc.ConvertSaveToOtherFormat=function(a,c,b){var d,e,f,g;e="";if("scsave"==c)return a;if(""==a)return"";d=new SocialCalc.Sheet;d.ParseSheetSave(a);if(b)throw"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.";a=d.copiedfrom?SocialCalc.ParseRange(d.copiedfrom):{cr1:{row:1,col:1},cr2:{row:d.attribs.lastrow,col:d.attribs.lastcol}};if("html"==c)return e=new SocialCalc.RenderContext(d),d.copiedfrom&&(e.rowpanes[0]={first:a.cr1.row,last:a.cr2.row},e.colpanes[0]={first:a.cr1.col,last:a.cr2.col}),
c=document.createElement("div"),a=e.RenderSheet(null,e.defaultHTMLlinkstyle),c.appendChild(a),delete e,delete d,e=c.innerHTML,delete a,delete c,e;for(b=a.cr1.row;b<=a.cr2.row;b++){for(f=a.cr1.col;f<=a.cr2.col;f++)g=SocialCalc.crToCoord(f,b),g=d.GetAssuredCell(g),g=g.errors?g.errors:g.datavalue+"","csv"==c?(-1!=g.indexOf('"')&&(g=g.replace(/"/g,'""')),/[, \n"]/.test(g)&&(g='"'+g+'"'),f>a.cr1.col&&(g=","+g)):"tab"==c&&(-1!=g.indexOf("\n")&&(-1!=g.indexOf('"')&&(g=g.replace(/"/g,'""')),g='"'+g+'"'),
f>a.cr1.col&&(g="\t"+g)),e+=g;e+="\n"}return e};
SocialCalc.ConvertSaveToColumn=function(a,c,b,d){var e,f,g,l="";void 0==d&&(d=2);if("scsave"==c)return a;if(""==a)return"";e=new SocialCalc.Sheet;e.ParseSheetSave(a);if(b)throw"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.";a=e.copiedfrom?SocialCalc.ParseRange(e.copiedfrom):{cr1:{row:1,col:1},cr2:{row:e.attribs.lastrow,col:e.attribs.lastcol}};for(b=a.cr1.row;b<=a.cr2.row;b++){for(f=d;f<=d;f++)g=SocialCalc.crToCoord(f,b),g=e.GetAssuredCell(g),console.log(g),g=g.errors?g.errors:g.datavalue+
"","csv"==c&&(-1!=g.indexOf('"')&&(g=g.replace(/"/g,'""')),/[, \n"]/.test(g)&&(g='"'+g+'"')),l+=g;b!=a.cr2.row&&(l+=",")}return l};
SocialCalc.ConvertOtherFormatToSave=function(a,c){var b,d,e,f,g,l,h,n,p,r,t,q,s="",u=function(){r++;r>q&&(q=r);t=SocialCalc.crToCoord(r,p);SocialCalc.SetConvertedCell(b,t,g);g=""};if("scsave"==c)return a;b=new SocialCalc.Sheet;d=a.split(/\r\n|\n/);q=0;if("csv"==c){p=0;l=!1;for(e=0;e<d.length&&(e!=d.length-1||""!=d[e]);e++)for(l?g+="\n":(g="",p++,r=0),f=d[e],h=0;h<f.length;h++)n=f.charAt(h),'"'==n?l?h<f.length-1&&'"'==f.charAt(h+1)?(h++,g+='"'):(l=!1,h==f.length-1&&u()):l=!0:(","!=n||l?g+=n:u(),h!=
f.length-1||l||u());0<q&&(b.attribs.lastrow=p,b.attribs.lastcol=q,s=b.CreateSheetSave("A1:"+SocialCalc.crToCoord(q,p)))}if("tab"==c){p=0;l=!1;for(e=0;e<d.length&&(e!=d.length-1||""!=d[e]);e++)for(l?g+="\n":(g="",p++,r=0),f=d[e],h=0;h<f.length;h++){n=f.charAt(h);if('"'==n){if(l){h<f.length-1?'"'==f.charAt(h+1)?(h++,g+='"'):"\t"==f.charAt(h+1)&&(h++,l=!1,u()):(l=!1,u());continue}if(""==g){l=!0;continue}}"\t"!=n||l?g+=n:u();h!=f.length-1||l||u()}0<q&&(b.attribs.lastrow=p,b.attribs.lastcol=q,s=b.CreateSheetSave("A1:"+
SocialCalc.crToCoord(q,p)))}return s};SocialCalc.SetConvertedCell=function(a,c,b){a=a.GetAssuredCell(c);c=SocialCalc.DetermineValueType(b);"n"==c.type&&c.value==b?(a.datatype="v",a.valuetype="n",a.datavalue=c.value):"t"==c.type.charAt(0)?(a.datatype="t",a.valuetype=c.type,a.datavalue=c.value):(a.datatype="c",a.valuetype=c.type,a.datavalue=c.value,a.formula=b)};SocialCalc||(SocialCalc={});
SocialCalc.TableEditor=function(a){var c=SocialCalc.Constants;this.context=a;this.fullgrid=this.toplevel=null;this.noEdit=!1;this.logo=this.horizontaltablecontrol=this.verticaltablecontrol=this.inputEcho=this.inputBox=this.tableheight=this.height=this.tablewidth=this.width=null;this.recalcNo=0;this.timeout=this.cellhandles=null;this.ensureecell=this.busy=!1;this.deferredCommands=[];this.lastvisiblecol=this.lastnonscrollingcol=this.firstscrollingcolleft=this.firstscrollingcol=this.lastvisiblerow=this.lastnonscrollingrow=
this.firstscrollingrowtop=this.firstscrollingrow=this.headposition=this.gridposition=null;this.rowpositions=[];this.colpositions=[];this.rowheight=[];this.colwidth=[];this.ecell=null;this.state="start";this.workingvalues={};this.imageprefix=c.defaultImagePrefix;this.idPrefix=c.defaultTableEditorIDPrefix;this.pageUpDnAmount=c.defaultPageUpDnAmount;this.recalcFunction=function(a){if(a.context.sheetobj.RecalcSheet)a.context.sheetobj.RecalcSheet(SocialCalc.EditorSheetStatusCallback,a);else return null};
this.ctrlkeyFunction=function(a,c){var e,f,g,l;switch(c){case "[ctrl-c]":case "[ctrl-x]":e=a.pasteTextarea;e.value="";if(f=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col))f=SocialCalc.GetElementPosition(f.element),e.style.left=f.left-1+"px",e.style.top=f.top-1+"px";l=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom):a.ecell.coord;f=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(a.context.sheetobj,l),"tab");
g="[ctrl-c]"==c||a.noEdit||a.ECellReadonly()?"copy "+l+" formulas":"cut "+l+" formulas";a.EditorScheduleSheetCommands(g,!0,!1);e.style.display="block";e.value=f;e.focus();e.select();window.setTimeout(function(){var c=a.pasteTextarea;c.blur();c.style.display="none";SocialCalc.KeyboardFocus()},200);break;case "[ctrl-v]":if(a.noEdit||a.ECellReadonly())break;e=a.pasteTextarea;e.value="";if(f=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col))f=SocialCalc.GetElementPosition(f.element),e.style.left=
f.left-1+"px",e.style.top=f.top-1+"px";e.style.display="block";e.value="";e.focus();window.setTimeout(function(){var c=a.pasteTextarea,d=c.value;c.blur();c.style.display="none";var c="",e=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,"tab"),d=d.replace(/\r\n/g,"\n");d==e||1==d.length-e.length&&d.substring(0,d.length-1)==e||(c="loadclipboard "+SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(d,"tab"))+"\n");d=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top):
a.ecell.coord;a.EditorScheduleSheetCommands(c+("paste "+d+" formulas"),!0,!1);SocialCalc.KeyboardFocus()},200);break;case "[ctrl-z]":return a.EditorScheduleSheetCommands("undo",!0,!1),!1;case "[ctrl-s]":if(!SocialCalc.Constants.AllowCtrlS)break;window.setTimeout(function(){var c=a.context.sheetobj,d=c.GetAssuredCell(a.ecell.coord),c=window.prompt("Advanced Feature:\n\nCustom Numeric Format or Command",d.nontextvalueformat?c.valueformats[d.nontextvalueformat-0]||"":"");if(null!=c){if(c.match(/^cmd:/))g=
c.substring(4);else{if(c.match(/^edit:/)){g=c.substring(5);SocialCalc.CtrlSEditor&&SocialCalc.CtrlSEditor(g);return}l=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom):a.ecell.coord;g="set "+l+" nontextvalueformat "+c}a.EditorScheduleSheetCommands(g,!0,!1)}},200);return!1}return!0};a.sheetobj.statuscallback=SocialCalc.EditorSheetStatusCallback;a.sheetobj.statuscallbackparams=this;this.StatusCallback={};this.MoveECellCallback={};
this.RangeChangeCallback={};this.SettingsCallbacks={};this.ecell={coord:"A1",row:1,col:1};a.highlights[this.ecell.coord]="cursor";this.range={hasrange:!1};this.range2={hasrange:!1}};SocialCalc.TableEditor.prototype.CreateTableEditor=function(a,c){return SocialCalc.CreateTableEditor(this,a,c)};SocialCalc.TableEditor.prototype.ResizeTableEditor=function(a,c){return SocialCalc.ResizeTableEditor(this,a,c)};SocialCalc.TableEditor.prototype.SaveEditorSettings=function(){return SocialCalc.SaveEditorSettings(this)};
SocialCalc.TableEditor.prototype.LoadEditorSettings=function(a,c){return SocialCalc.LoadEditorSettings(this,a,c)};SocialCalc.TableEditor.prototype.EditorRenderSheet=function(){SocialCalc.EditorRenderSheet(this)};SocialCalc.TableEditor.prototype.EditorScheduleSheetCommands=function(a,c,b){SocialCalc.EditorScheduleSheetCommands(this,a,c,b)};SocialCalc.TableEditor.prototype.ScheduleSheetCommands=function(a,c){this.context.sheetobj.ScheduleSheetCommands(a,c)};
SocialCalc.TableEditor.prototype.SheetUndo=function(){this.context.sheetobj.SheetUndo()};SocialCalc.TableEditor.prototype.SheetRedo=function(){this.context.sheetobj.SheetRedo()};SocialCalc.TableEditor.prototype.EditorStepSet=function(a,c){SocialCalc.EditorStepSet(this,a,c)};SocialCalc.TableEditor.prototype.GetStatuslineString=function(a,c,b){return SocialCalc.EditorGetStatuslineString(this,a,c,b)};SocialCalc.TableEditor.prototype.EditorMouseRegister=function(){return SocialCalc.EditorMouseRegister(this)};
SocialCalc.TableEditor.prototype.EditorMouseUnregister=function(){return SocialCalc.EditorMouseUnregister(this)};SocialCalc.TableEditor.prototype.EditorMouseRange=function(a){return SocialCalc.EditorMouseRange(this,a)};SocialCalc.TableEditor.prototype.EditorProcessKey=function(a,c){return SocialCalc.EditorProcessKey(this,a,c)};SocialCalc.TableEditor.prototype.EditorAddToInput=function(a,c){return SocialCalc.EditorAddToInput(this,a,c)};SocialCalc.TableEditor.prototype.DisplayCellContents=function(){return SocialCalc.EditorDisplayCellContents(this)};
SocialCalc.TableEditor.prototype.EditorSaveEdit=function(a){return SocialCalc.EditorSaveEdit(this,a)};SocialCalc.TableEditor.prototype.EditorApplySetCommandsToRange=function(a,c){return SocialCalc.EditorApplySetCommandsToRange(this,a,c)};SocialCalc.TableEditor.prototype.MoveECellWithKey=function(a){return SocialCalc.MoveECellWithKey(this,a)};SocialCalc.TableEditor.prototype.MoveECell=function(a){return SocialCalc.MoveECell(this,a)};
SocialCalc.TableEditor.prototype.ReplaceCell=function(a,c,b){SocialCalc.ReplaceCell(this,a,c,b)};SocialCalc.TableEditor.prototype.UpdateCellCSS=function(a,c,b){SocialCalc.UpdateCellCSS(this,a,c,b)};SocialCalc.TableEditor.prototype.SetECellHeaders=function(a){SocialCalc.SetECellHeaders(this,a)};SocialCalc.TableEditor.prototype.EnsureECellVisible=function(){SocialCalc.EnsureECellVisible(this)};SocialCalc.TableEditor.prototype.ECellReadonly=function(a){return SocialCalc.ECellReadonly(this,a)};
SocialCalc.TableEditor.prototype.RangeAnchor=function(a){SocialCalc.RangeAnchor(this,a)};SocialCalc.TableEditor.prototype.RangeExtend=function(a){SocialCalc.RangeExtend(this,a)};SocialCalc.TableEditor.prototype.RangeRemove=function(){SocialCalc.RangeRemove(this)};SocialCalc.TableEditor.prototype.Range2Remove=function(){SocialCalc.Range2Remove(this)};SocialCalc.TableEditor.prototype.FitToEditTable=function(){SocialCalc.FitToEditTable(this)};
SocialCalc.TableEditor.prototype.CalculateEditorPositions=function(){SocialCalc.CalculateEditorPositions(this)};SocialCalc.TableEditor.prototype.ScheduleRender=function(){SocialCalc.ScheduleRender(this)};SocialCalc.TableEditor.prototype.DoRenderStep=function(){SocialCalc.DoRenderStep(this)};SocialCalc.TableEditor.prototype.SchedulePositionCalculations=function(){SocialCalc.SchedulePositionCalculations(this)};SocialCalc.TableEditor.prototype.DoPositionCalculations=function(){SocialCalc.DoPositionCalculations(this)};
SocialCalc.TableEditor.prototype.CalculateRowPositions=function(a,c,b){return SocialCalc.CalculateRowPositions(this,a,c,b)};SocialCalc.TableEditor.prototype.CalculateColPositions=function(a,c,b){return SocialCalc.CalculateColPositions(this,a,c,b)};SocialCalc.TableEditor.prototype.ScrollRelative=function(a,c){SocialCalc.ScrollRelative(this,a,c)};SocialCalc.TableEditor.prototype.ScrollRelativeBoth=function(a,c){SocialCalc.ScrollRelativeBoth(this,a,c)};
SocialCalc.TableEditor.prototype.PageRelative=function(a,c){SocialCalc.PageRelative(this,a,c)};SocialCalc.TableEditor.prototype.LimitLastPanes=function(){SocialCalc.LimitLastPanes(this)};SocialCalc.TableEditor.prototype.ScrollTableUpOneRow=function(){return SocialCalc.ScrollTableUpOneRow(this)};SocialCalc.TableEditor.prototype.ScrollTableDownOneRow=function(){return SocialCalc.ScrollTableDownOneRow(this)};SocialCalc.TableEditor.prototype.ScrollTableLeftOneCol=function(){return SocialCalc.ScrollTableLeftOneCol(this)};
SocialCalc.TableEditor.prototype.ScrollTableRightOneCol=function(){return SocialCalc.ScrollTableRightOneCol(this)};
SocialCalc.CreateTableEditor=function(a,c,b){var d=SocialCalc.Constants,e=SocialCalc.AssignID;a.toplevel=document.createElement("div");a.toplevel.style.position="relative";e(a,a.toplevel,"toplevel");a.width=c;a.height=b;a.griddiv=document.createElement("div");a.tablewidth=Math.max(0,c-d.defaultTableControlThickness);a.tableheight=Math.max(0,b-d.defaultTableControlThickness);a.griddiv.style.width=a.tablewidth+"px";a.griddiv.style.height=a.tableheight+"px";a.griddiv.style.overflow="hidden";a.griddiv.style.cursor=
"default";d.cteGriddivClass&&(a.griddiv.className=d.cteGriddivClass);e(a,a.griddiv,"griddiv");a.FitToEditTable();a.EditorRenderSheet();a.griddiv.appendChild(a.fullgrid);a.verticaltablecontrol=new SocialCalc.TableControl(a,!0,a.tableheight);a.verticaltablecontrol.CreateTableControl();e(a,a.verticaltablecontrol.main,"tablecontrolv");a.horizontaltablecontrol=new SocialCalc.TableControl(a,!1,a.tablewidth);a.horizontaltablecontrol.CreateTableControl();e(a,a.horizontaltablecontrol.main,"tablecontrolh");
b=document.createElement("table");a.layouttable=b;b.cellSpacing=0;b.cellPadding=0;e(a,b,"layouttable");c=document.createElement("tbody");b.appendChild(c);b=document.createElement("tr");c.appendChild(b);d=document.createElement("td");d.appendChild(a.griddiv);b.appendChild(d);d=document.createElement("td");d.appendChild(a.verticaltablecontrol.main);b.appendChild(d);b=document.createElement("tr");c.appendChild(b);d=document.createElement("td");d.appendChild(a.horizontaltablecontrol.main);b.appendChild(d);
d=document.createElement("td");d.style.background="url("+a.imageprefix+"logo.gif) no-repeat center center";d.innerHTML="<div style='cursor:pointer;font-size:1px;'><img src='"+a.imageprefix+"1x1.gif' border='0' width='18' height='18'></div>";b.appendChild(d);a.logo=d;e(a,a.logo,"logo");SocialCalc.TooltipRegister(d.firstChild.firstChild,"SocialCalc",null,a.toplevel);a.toplevel.appendChild(a.layouttable);a.noEdit||(a.inputEcho=new SocialCalc.InputEcho(a),e(a,a.inputEcho.main,"inputecho"));a.cellhandles=
new SocialCalc.CellHandles(a);c=document.createElement("textarea");SocialCalc.setStyles(c,"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);");c.value="";a.pasteTextarea=c;e(a,a.pasteTextarea,"pastetextarea");navigator.userAgent.match(/Safari\//)&&!navigator.userAgent.match(/Chrome\//)&&(window.removeEventListener("beforepaste",SocialCalc.SafariPasteFunction,!1),window.addEventListener("beforepaste",SocialCalc.SafariPasteFunction,!1),window.removeEventListener("beforecopy",
SocialCalc.SafariPasteFunction,!1),window.addEventListener("beforecopy",SocialCalc.SafariPasteFunction,!1),window.removeEventListener("beforecut",SocialCalc.SafariPasteFunction,!1),window.addEventListener("beforecut",SocialCalc.SafariPasteFunction,!1));a.toplevel.appendChild(a.pasteTextarea);SocialCalc.MouseWheelRegister(a.toplevel,{WheelMove:SocialCalc.EditorProcessMouseWheel,editor:a});SocialCalc.KeyboardSetFocus(a);SocialCalc.EditorSheetStatusCallback(null,"startup",null,a);return a.toplevel};
SocialCalc.SafariPasteFunction=function(a){a.preventDefault()};
SocialCalc.ResizeTableEditor=function(a,c,b){var d=SocialCalc.Constants;a.width=c;a.height=b;a.toplevel.style.width=c+"px";a.toplevel.style.height=b+"px";a.tablewidth=Math.max(0,c-d.defaultTableControlThickness);a.tableheight=Math.max(0,b-d.defaultTableControlThickness);a.griddiv.style.width=a.tablewidth+"px";a.griddiv.style.height=a.tableheight+"px";a.verticaltablecontrol.main.style.height=a.tableheight+"px";a.horizontaltablecontrol.main.style.width=a.tablewidth+"px";a.FitToEditTable();a.ScheduleRender()};
SocialCalc.SaveEditorSettings=function(a){var c,b,d=a.context,e=a.range,f;f="version:1.0\n";for(c=0;c<d.rowpanes.length;c++)f+="rowpane:"+c+":"+d.rowpanes[c].first+":"+d.rowpanes[c].last+"\n";for(c=0;c<d.colpanes.length;c++)f+="colpane:"+c+":"+d.colpanes[c].first+":"+d.colpanes[c].last+"\n";a.ecell&&(f+="ecell:"+a.ecell.coord+"\n");e.hasrange&&(f+="range:"+e.anchorcoord+":"+e.top+":"+e.bottom+":"+e.left+":"+e.right+"\n");for(b in a.SettingsCallbacks)f+=a.SettingsCallbacks[b].save(a,b);return f};
SocialCalc.LoadEditorSettings=function(a,c,b){c=c.split(/\r\n|\n/);var d=[],e,f,g,l=a.context,h,n;l.rowpanes=[{first:1,last:1}];l.colpanes=[{first:1,last:1}];a.ecell=null;a.range={hasrange:!1};a.range2={hasrange:!1};n=a.range;l.highlights={};h=l.highlights;for(f=0;f<c.length;f++)switch(e=c[f],d=e.split(":"),g=d[0],g){case "version":break;case "rowpane":l.rowpanes[d[1]-0]={first:d[2]-0,last:d[3]-0};break;case "colpane":l.colpanes[d[1]-0]={first:d[2]-0,last:d[3]-0};break;case "ecell":a.ecell=SocialCalc.coordToCr(d[1]);
a.ecell.coord=d[1];h[d[1]]="cursor";break;case "range":n.hasrange=!0;n.anchorcoord=d[1];e=SocialCalc.coordToCr(n.anchorcoord);n.anchorrow=e.row;n.anchorcol=e.col;n.top=d[2]-0;n.bottom=d[3]-0;n.left=d[4]-0;n.right=d[5]-0;for(d=n.top;d<=n.bottom;d++)for(e=n.left;e<=n.right;e++)g=SocialCalc.crToCoord(e,d),"cursor"!=h[g]&&(h[g]="range");break;default:a.SettingsCallbacks[g]&&a.SettingsCallbacks[g].load(a,g,e,b)}};
SocialCalc.EditorRenderSheet=function(a){a.EditorMouseUnregister();a.fullgrid=a.context.RenderSheet(a.fullgrid);a.ecell&&a.SetECellHeaders("selected");SocialCalc.AssignID(a,a.fullgrid,"fullgrid");a.EditorMouseRegister()};
SocialCalc.EditorScheduleSheetCommands=function(a,c,b,d){if("start"==a.state||d)if(a.busy&&!d)a.deferredCommands.push({cmdstr:c,saveundo:b});else switch(c){case "recalc":case "redisplay":a.context.sheetobj.ScheduleSheetCommands(c,!1);break;case "undo":a.SheetUndo();break;case "redo":a.SheetRedo();break;default:a.context.sheetobj.ScheduleSheetCommands(c,b)}};
SocialCalc.EditorSheetStatusCallback=function(a,c,b,d){var e;a=d.context.sheetobj;var f=function(a){for(e in d.StatusCallback)d.StatusCallback[e].func&&d.StatusCallback[e].func(d,a,b,d.StatusCallback[e].params)};switch(c){case "startup":break;case "cmdstart":d.busy=!0;a.celldisplayneeded="";break;case "cmdextension":break;case "cmdend":f(c);a.changedrendervalues&&(d.context.PrecomputeSheetFontsAndLayouts(),d.context.CalculateCellSkipData(),a.changedrendervalues=!1);a.celldisplayneeded&&!a.renderneeded&&
(cr=SocialCalc.coordToCr(a.celldisplayneeded),c=SocialCalc.GetEditorCellElement(d,cr.row,cr.col),d.ReplaceCell(c,cr.row,cr.col));if(d.deferredCommands.length){a=d.deferredCommands.shift();d.EditorScheduleSheetCommands(a.cmdstr,a.saveundo,!0);return}a.attribs.needsrecalc&&("off"!=a.attribs.recalc||a.recalconce)&&d.recalcFunction?(d.FitToEditTable(),a.renderneeded=!1,a.recalconce&&delete a.recalconce,d.recalcFunction(d)):a.renderneeded?(d.FitToEditTable(),a.renderneeded=!1,d.ScheduleRender()):d.SchedulePositionCalculations();
if("col"==a.hiddencolrow){for(c=d.ecell.col;"yes"==a.colattribs.hide[SocialCalc.rcColname(c)];)c++;c=SocialCalc.crToCoord(c,d.ecell.row);d.MoveECell(c);a.hiddencolrow=""}if("row"==a.hiddencolrow){for(c=d.ecell.row;"yes"==a.rowattribs.hide[c];)c++;c=SocialCalc.crToCoord(d.ecell.col,c);d.MoveECell(c);a.hiddencolrow=""}return;case "calcstart":d.busy=!0;break;case "calccheckdone":case "calcorder":break;case "calcstep":break;case "calcloading":case "calcserverfunc":break;case "calcfinished":f(c);d.ScheduleRender();
break;case "schedrender":d.busy=!0;break;case "renderdone":break;case "schedposcalc":d.busy=!0;break;case "doneposcalc":if(d.deferredCommands.length)f(c),a=d.deferredCommands.shift(),d.EditorScheduleSheetCommands(a.cmdstr,a.saveundo,!0);else{d.busy=!1;f(c);"start"==d.state&&d.DisplayCellContents();d.recalcNo++;SocialCalc.postCalc&&SocialCalc.postCalc(d.recalcNo);try{if("undefined"!=typeof top.navigator&&extwindows)for(ea in extwindows)if(null!=extwindows[ea].wref&&(!1==extwindows[ea].wref.closed&&
"DYG"==extwindows[ea].typ&&extwindows[ea].wref.g3.updateOptions({file:SocialCalc.Formula.RangeTo2D(extwindows[ea].humanrange)}),!1==extwindows[ea].wref.closed&&"GRD"==extwindows[ea].typ)){var g=SocialCalc.Formula.RangeTo2D(extwindows[ea].humanrange);extwindows[ea].withheaders&&g.shift();extwindows[ea].wref.Ext.getCmp("gengrid").getStore().loadData(g);extwindows[ea].wref.grid.reconfigure(extwindows[ea].wref.Ext.getCmp("gengrid").getStore())}}catch(l){}break}return;default:addmsg("Unknown status: "+
c)}f(c)};
SocialCalc.EditorGetStatuslineString=function(a,c,b,d){var e=SocialCalc.Constants,f,g,l;f="";switch(c){case "moveecell":case "rangechange":case "startup":break;case "cmdstart":d.command=!0;document.body.style.cursor="progress";a.griddiv.style.cursor="progress";f=e.s_statusline_executing;break;case "cmdextension":f="Command Extension: "+b;break;case "cmdend":d.command=!1;break;case "schedrender":f=e.s_statusline_displaying;break;case "renderdone":f=" ";break;case "schedposcalc":f=e.s_statusline_displaying;break;
case "cmdendnorender":case "doneposcalc":document.body.style.cursor="default";a.griddiv.style.cursor="default";break;case "calcorder":f=e.s_statusline_ordering+Math.floor(100*b.count/(b.total||1))+"%";break;case "calcstep":f=e.s_statusline_calculating+Math.floor(100*b.count/(b.total||1))+"%";break;case "calcloading":f=e.s_statusline_calculatingls+": "+b.sheetname;break;case "calcserverfunc":f=e.s_statusline_calculating+Math.floor(100*b.count/(b.total||1))+"%, "+e.s_statusline_doingserverfunc+b.funcname+
e.s_statusline_incell+b.coord;break;case "calcstart":d.calculating=!0;document.body.style.cursor="progress";a.griddiv.style.cursor="progress";f=e.s_statusline_calcstart;break;case "calccheckdone":break;case "calcfinished":d.calculating=!1;break;default:f=c}!f&&d.calculating&&(f=e.s_statusline_calculating);if(!(d.calculating||d.command||f||!a.range.hasrange||a.range.left==a.range.right&&a.range.top==a.range.bottom)){c=0;for(b=a.range.top;b<=a.range.bottom;b++)for(g=a.range.left;g<=a.range.right;g++)(l=
a.context.sheetobj.cells[SocialCalc.crToCoord(g,b)])&&l.valuetype&&"n"==l.valuetype.charAt(0)&&(c+=l.datavalue-0);c=SocialCalc.FormatNumber.formatNumberWithFormat(c,"[,]General","");b=SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom);f=b+" ("+(a.range.right-a.range.left+1)+"x"+(a.range.bottom-a.range.top+1)+") "+e.s_statusline_sum+"="+c+" "+f}f=a.ecell.coord+" &nbsp; "+f;d.calculating||"yes"!=a.context.sheetobj.attribs.needsrecalc||(f+=" &nbsp; "+
e.s_statusline_recalcneeded);if(a=a.context.sheetobj.attribs.circularreferencecell)a=a.replace(/\|/," referenced by "),f+=" &nbsp; "+e.s_statusline_circref+a+"</span>";return f};SocialCalc.EditorMouseInfo={registeredElements:[],editor:null,element:null,ignore:!1,mousedowncoord:"",mouselastcoord:"",mouseresizecol:"",mouseresizeclientx:null,mouseresizedisplay:null};
SocialCalc.EditorMouseRegister=function(a){var c=SocialCalc.EditorMouseInfo,b=a.fullgrid,d;for(d=0;d<c.registeredElements.length;d++)if(c.registeredElements[d].editor==a){if(c.registeredElements[d].element==b)return;break}d<c.registeredElements.length?c.registeredElements[d].element=b:c.registeredElements.push({element:b,editor:a});if(b.addEventListener)b.addEventListener("mousedown",SocialCalc.ProcessEditorMouseDown,!1),b.addEventListener("dblclick",SocialCalc.ProcessEditorDblClick,!1);else if(b.attachEvent)b.attachEvent("onmousedown",
SocialCalc.ProcessEditorMouseDown),b.attachEvent("ondblclick",SocialCalc.ProcessEditorDblClick);else throw"Browser not supported";c.ignore=!1};
SocialCalc.EditorMouseUnregister=function(a){var c=SocialCalc.EditorMouseInfo,b;for(b=0;b<c.registeredElements.length&&c.registeredElements[b].editor!=a;b++);b<c.registeredElements.length&&(a=c.registeredElements[b].element,a.removeEventListener?(a.removeEventListener("mousedown",SocialCalc.ProcessEditorMouseDown,!1),a.removeEventListener("dblclick",SocialCalc.ProcessEditorDblClick,!1)):a.detachEvent&&(a.detachEvent("onmousedown",SocialCalc.ProcessEditorMouseDown),a.detachEvent("ondblclick",SocialCalc.ProcessEditorDblClick)),
c.registeredElements.splice(b,1))};
SocialCalc.ProcessEditorMouseDown=function(a){var c,b,d,e=a||window.event,f=SocialCalc.EditorMouseInfo,g=e.target||e.srcElement;if(!f.ignore){for(c=null;!c&&g;g=g.parentNode)c=SocialCalc.LookupElement(g,f.registeredElements);if(c){if(c=c.editor,f.element=g,d=c.range,b=SocialCalc.GetElementPositionWithScroll(c.toplevel),b=SocialCalc.GridMousePosition(c,e.clientX-b.left,e.clientY-b.top))f.editor=c,b.rowheader&&b.rowtounhide?SocialCalc.ProcessEditorRowsizeMouseDown(a,g,b):b.colheader&&b.coltoresize?
SocialCalc.ProcessEditorColsizeMouseDown(a,g,b):b.coord&&(d.hasrange||a.shiftKey&&c.RangeAnchor(),b=c.MoveECell(b.coord),d.hasrange&&(a.shiftKey?c.RangeExtend():c.RangeRemove()),f.mousedowncoord=b,f.mouselastcoord=b,c.EditorMouseRange(b),SocialCalc.KeyboardSetFocus(c),"start"!=c.state&&c.inputBox&&c.inputBox.element.focus(),document.addEventListener?(document.addEventListener("mousemove",SocialCalc.ProcessEditorMouseMove,!0),document.addEventListener("mouseup",SocialCalc.ProcessEditorMouseUp,!0)):
g.attachEvent&&(g.setCapture(),g.attachEvent("onmousemove",SocialCalc.ProcessEditorMouseMove),g.attachEvent("onmouseup",SocialCalc.ProcessEditorMouseUp),g.attachEvent("onlosecapture",SocialCalc.ProcessEditorMouseUp)),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1)}else f.editor=null}};
SocialCalc.EditorMouseRange=function(a,c){var b,d,e=a.range;switch(a.state){case "input":b=a.inputBox.GetText();d=a.workingvalues;if(0<="(+-*/,:!&<>=^".indexOf(b.slice(-1))&&"="==b.slice(0,1)||"="==b)d.partialexpr=b;d.partialexpr?c&&(e.hasrange?a.inputBox.SetText(d.partialexpr+SocialCalc.crToCoord(e.left,e.top)+":"+SocialCalc.crToCoord(e.right,e.bottom)):a.inputBox.SetText(d.partialexpr+c)):(a.inputBox.Blur(),a.inputBox.ShowInputBox(!1),a.state="start",a.cellhandles.ShowCellHandles(!0),a.EditorSaveEdit(),
a.inputBox.DisplayCellContents(null));break;case "inputboxdirect":a.inputBox.Blur(),a.inputBox.ShowInputBox(!1),a.state="start",a.cellhandles.ShowCellHandles(!0),a.EditorSaveEdit(),a.inputBox.DisplayCellContents(null)}};
SocialCalc.ProcessEditorMouseMove=function(a){var c,b,d=a||window.event,e=SocialCalc.EditorMouseInfo;(c=e.editor)&&!e.ignore&&(b=SocialCalc.GetElementPositionWithScroll(c.toplevel),b=SocialCalc.GridMousePosition(c,d.clientX-b.left,d.clientY-b.top))&&(b&&!b.coord?SocialCalc.SetDragAutoRepeat(c,b):(SocialCalc.SetDragAutoRepeat(c,null),b.coord&&(b.coord!=e.mouselastcoord&&(a.shiftKey||c.range.hasrange||c.RangeAnchor(e.mousedowncoord),c.MoveECell(b.coord),c.RangeExtend()),e.mouselastcoord=b.coord,c.EditorMouseRange(b.coord),
d.stopPropagation?d.stopPropagation():d.cancelBubble=!0,d.preventDefault?d.preventDefault():d.returnValue=!1)))};
SocialCalc.ProcessEditorMouseUp=function(a){var c,b,d=a||window.event,e=SocialCalc.EditorMouseInfo;if((a=e.editor)&&!e.ignore&&(c=e.element,b=SocialCalc.GetElementPositionWithScroll(a.toplevel),b=SocialCalc.GridMousePosition(a,d.clientX-b.left,d.clientY-b.top),SocialCalc.SetDragAutoRepeat(a,null),b))return b.coord||(b.coord=a.ecell.coord),a.range.hasrange?(a.MoveECell(b.coord),a.RangeExtend()):b.coord&&b.coord!=e.mousedowncoord&&(a.RangeAnchor(e.mousedowncoord),a.MoveECell(b.coord),a.RangeExtend()),
a.EditorMouseRange(b.coord),d.stopPropagation?d.stopPropagation():d.cancelBubble=!0,d.preventDefault?d.preventDefault():d.returnValue=!1,document.removeEventListener?(document.removeEventListener("mousemove",SocialCalc.ProcessEditorMouseMove,!0),document.removeEventListener("mouseup",SocialCalc.ProcessEditorMouseUp,!0)):c.detachEvent&&(c.detachEvent("onlosecapture",SocialCalc.ProcessEditorMouseUp),c.detachEvent("onmouseup",SocialCalc.ProcessEditorMouseUp),c.detachEvent("onmousemove",SocialCalc.ProcessEditorMouseMove),
c.releaseCapture()),e.editor=null,!1};
SocialCalc.ProcessEditorColsizeMouseDown=function(a,c,b){a=a||window.event;c=SocialCalc.EditorMouseInfo;var d=c.editor,e=SocialCalc.GetElementPositionWithScroll(d.toplevel),e=a.clientX-e.left;c.mouseresizecolnum=b.coltoresize;c.mouseresizecol=SocialCalc.rcColname(b.coltoresize);c.mousedownclientx=e;c.mousecoltounhide=b.coltounhide;c.mousecoltounhide||(e=document.createElement("div"),c.mouseresizedisplay=e,e.style.width="auto",e.style.position="absolute",e.style.zIndex=100,e.style.top=d.headposition.top+
"px",e.style.left=d.colpositions[b.coltoresize]+"px",e.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(d.context.colwidth[c.mouseresizecolnum]-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+d.context.colwidth[c.mouseresizecolnum]+"</div></td></tr></table>",SocialCalc.setStyles(e.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;"),
d.toplevel.appendChild(e));document.addEventListener?(document.addEventListener("mousemove",SocialCalc.ProcessEditorColsizeMouseMove,!0),document.addEventListener("mouseup",SocialCalc.ProcessEditorColsizeMouseUp,!0)):d.toplevel.attachEvent&&(d.toplevel.setCapture(),d.toplevel.attachEvent("onmousemove",SocialCalc.ProcessEditorColsizeMouseMove),d.toplevel.attachEvent("onmouseup",SocialCalc.ProcessEditorColsizeMouseUp),d.toplevel.attachEvent("onlosecapture",SocialCalc.ProcessEditorColsizeMouseUp));a.stopPropagation?
a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1};
SocialCalc.ProcessEditorColsizeMouseMove=function(a){a=a||window.event;var c=SocialCalc.EditorMouseInfo,b=c.editor;if(b){if(!c.mousecoltounhide){var d=SocialCalc.GetElementPositionWithScroll(b.toplevel),b=b.context.colwidth[c.mouseresizecolnum]-0+(a.clientX-d.left-c.mousedownclientx);b<SocialCalc.Constants.defaultMinimumColWidth&&(b=SocialCalc.Constants.defaultMinimumColWidth);c=c.mouseresizedisplay;c.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+
(b-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+b+"</div></td></tr></table>";SocialCalc.setStyles(c.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;")}a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1}};
SocialCalc.ProcessEditorColsizeMouseUp=function(a){var c=a||window.event;a=SocialCalc.EditorMouseInfo;var b=a.editor;if(b){element=a.element;var d=SocialCalc.GetElementPositionWithScroll(b.toplevel),d=c.clientX-d.left;c.stopPropagation?c.stopPropagation():c.cancelBubble=!0;c.preventDefault?c.preventDefault():c.returnValue=!1;document.removeEventListener?(document.removeEventListener("mousemove",SocialCalc.ProcessEditorColsizeMouseMove,!0),document.removeEventListener("mouseup",SocialCalc.ProcessEditorColsizeMouseUp,
!0)):b.toplevel.detachEvent&&(b.toplevel.detachEvent("onlosecapture",SocialCalc.ProcessEditorColsizeMouseUp),b.toplevel.detachEvent("onmouseup",SocialCalc.ProcessEditorColsizeMouseUp),b.toplevel.detachEvent("onmousemove",SocialCalc.ProcessEditorColsizeMouseMove),b.toplevel.releaseCapture());a.mousecoltounhide?b.EditorScheduleSheetCommands("set "+SocialCalc.rcColname(a.mousecoltounhide)+" hide",!0,!1):(c=b.context.colwidth[a.mouseresizecolnum]-0+(d-a.mousedownclientx),c<SocialCalc.Constants.defaultMinimumColWidth&&
(c=SocialCalc.Constants.defaultMinimumColWidth),b.EditorScheduleSheetCommands("set "+a.mouseresizecol+" width "+c,!0,!1),b.timeout&&window.clearTimeout(b.timeout),b.timeout=window.setTimeout(SocialCalc.FinishColsize,1));return!1}};SocialCalc.FinishColsize=function(){var a=SocialCalc.EditorMouseInfo,c=a.editor;c&&(c.toplevel.removeChild(a.mouseresizedisplay),a.mouseresizedisplay=null,a.editor=null)};
SocialCalc.ProcessEditorRowsizeMouseDown=function(a,c,b){a=a||window.event;c=SocialCalc.EditorMouseInfo;var d=c.editor;SocialCalc.GetElementPositionWithScroll(d.toplevel);c.mouserowtounhide=b.rowtounhide;document.addEventListener?(document.addEventListener("mousemove",SocialCalc.ProcessEditorRowsizeMouseMove,!0),document.addEventListener("mouseup",SocialCalc.ProcessEditorRowsizeMouseUp,!0)):d.toplevel.attachEvent&&(d.toplevel.setCapture(),d.toplevel.attachEvent("onmousemove",SocialCalc.ProcessEditorRowsizeMouseMove),
d.toplevel.attachEvent("onmouseup",SocialCalc.ProcessEditorRowsizeMouseUp),d.toplevel.attachEvent("onlosecapture",SocialCalc.ProcessEditorRowsizeMouseUp));a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1};SocialCalc.ProcessEditorRowsizeMouseMove=function(a){a=a||window.event;SocialCalc.EditorMouseInfo.editor&&(a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1)};
SocialCalc.ProcessEditorRowsizeMouseUp=function(a){a=a||window.event;var c=SocialCalc.EditorMouseInfo,b=c.editor;if(b)return element=c.element,SocialCalc.GetElementPositionWithScroll(b.toplevel),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,document.removeEventListener?(document.removeEventListener("mousemove",SocialCalc.ProcessEditorRowsizeMouseMove,!0),document.removeEventListener("mouseup",SocialCalc.ProcessEditorRowsizeMouseUp,!0)):
b.toplevel.detachEvent&&(b.toplevel.detachEvent("onlosecapture",SocialCalc.ProcessEditorRowsizeMouseUp),b.toplevel.detachEvent("onmouseup",SocialCalc.ProcessEditorRowsizeMouseUp),b.toplevel.detachEvent("onmousemove",SocialCalc.ProcessEditorRowsizeMouseMove),b.toplevel.releaseCapture()),c.mouserowtounhide&&b.EditorScheduleSheetCommands("set "+c.mouserowtounhide+" hide",!0,!1),!1};SocialCalc.AutoRepeatInfo={timer:null,mouseinfo:null,repeatinterval:1E3,editor:null,repeatcallback:null};
SocialCalc.SetDragAutoRepeat=function(a,c,b){var d=SocialCalc.AutoRepeatInfo;d.repeatcallback=b;if(c){d.editor=a;d.mouseinfo&&(c.rowheader||c.rowfooter?c.row!=d.mouseinfo.row&&(b=SocialCalc.crToCoord(a.ecell.col,c.row),d.repeatcallback?(a=c.row<d.mouseinfo.row?"left":c.row>d.mouseinfo.row?"right":"",d.repeatcallback(b,a)):(a.MoveECell(b),a.MoveECell(b),a.RangeExtend(),a.EditorMouseRange(b))):(c.colheader||c.colfooter)&&c.col!=d.mouseinfo.col&&(b=SocialCalc.crToCoord(c.col,a.ecell.row),d.repeatcallback?
(a=c.row<d.mouseinfo.row?"left":c.row>d.mouseinfo.row?"right":"",d.repeatcallback(b,a)):(a.MoveECell(b),a.RangeExtend(),a.EditorMouseRange(b))));d.mouseinfo=c;if(5>c.distance)d.repeatinterval=333;else if(10>c.distance)d.repeatinterval=250;else if(25>c.distance)d.repeatinterval=100;else if(35>c.distance)d.repeatinterval=75;else{d.timer&&(window.clearTimeout(d.timer),d.timer=null);return}d.timer||(d.timer=window.setTimeout(SocialCalc.DragAutoRepeat,d.repeatinterval))}else d.timer&&(window.clearTimeout(d.timer),
d.timer=null),d.mouseinfo=null};
SocialCalc.DragAutoRepeat=function(){var a=SocialCalc.AutoRepeatInfo,c=a.mouseinfo,b;c.rowheader?b="left":c.rowfooter?b="right":c.colheader?b="up":c.colfooter&&(b="down");a.repeatcallback?(c=SocialCalc.coordToCr(a.editor.ecell.coord),"left"==b&&1<c.col?c.col--:"right"==b?c.col++:"up"==b&&1<c.row?c.row--:"down"==b&&c.row++,c=SocialCalc.crToCoord(c.col,c.row),a.repeatcallback(c,b)):(c=a.editor.MoveECellWithKey("[a"+b+"]shifted"))&&a.editor.EditorMouseRange(c);a.timer=window.setTimeout(SocialCalc.DragAutoRepeat,
a.repeatinterval)};
SocialCalc.ProcessEditorDblClick=function(a){var c,b;a=a||window.event;var d=SocialCalc.EditorMouseInfo,e=a.target||a.srcElement;if(!d.ignore){for(c=null;!c&&e;e=e.parentNode)c=SocialCalc.LookupElement(e,d.registeredElements);if(c){if(c=c.editor,b=SocialCalc.GetElementPositionWithScroll(c.toplevel),(b=SocialCalc.GridMousePosition(c,a.clientX-b.left,a.clientY-b.top))&&b.coord){d.editor=c;d.element=e;sheetobj=c.context.sheetobj;switch(c.state){case "start":SocialCalc.EditorOpenCellEdit(c)}a.stopPropagation?a.stopPropagation():
a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1}}else d.editor=null}};SocialCalc.EditorOpenCellEdit=function(a){var c;if(!a.ecell||!a.inputBox||a.inputBox.element.disabled)return!0;a.inputBox.ShowInputBox(!0);a.inputBox.Focus();a.state="inputboxdirect";a.inputBox.SetText("");a.inputBox.DisplayCellContents();a.inputBox.Select("end");c=a.workingvalues;c.partialexpr="";c.ecoord=a.ecell.coord;c.erow=a.ecell.row;c.ecol=a.ecell.col};
SocialCalc.EditorProcessKey=function(a,c,b){var d,e=a.workingvalues,f=a.range;"string"!=typeof c&&(c="");switch(a.state){case "start":b.shiftKey&&"[a"==c.substr(0,2)&&(c+="shifted");"[enter]"==c&&(c="[adown]");"[tab]"==c&&(c=b.shiftKey?"[aleft]":"[aright]");if("[a"==c.substr(0,2)||"[pg"==c.substr(0,3)||"[home]"==c)return a=a.MoveECellWithKey(c),!a;if("[del]"==c||"[backspace]"==c){a.noEdit||a.ECellReadonly()||a.EditorApplySetCommandsToRange("empty","");break}if("[esc]"==c){if(f.hasrange)for(d in a.RangeRemove(),
a.MoveECell(f.anchorcoord),a.StatusCallback)a.StatusCallback[d].func(a,"specialkey",c,a.StatusCallback[d].params);break}if("[f2]"==c){if(a.noEdit||a.ECellReadonly())return!0;SocialCalc.EditorOpenCellEdit(a);break}if(1<c.length&&"["==c.substr(0,1)||0==c.length)return a.ctrlkeyFunction&&0<c.length?a.ctrlkeyFunction(a,c):!0;if(!a.ecell||!a.inputBox||a.ECellReadonly())return!0;a.inputBox.element.disabled=!1;a.state="input";a.inputBox.ShowInputBox(!0);a.inputBox.Focus();a.inputBox.SetText(c);a.inputBox.Select("end");
e.partialexpr="";e.ecoord=a.ecell.coord;e.erow=a.ecell.row;e.ecol=a.ecell.col;a.RangeRemove();break;case "input":d=a.inputBox.GetText();if(a.inputBox.skipOne)break;if("[esc]"==c||"[enter]"==c||"[tab]"==c||c&&"[a"==c.substr(0,2)){if(0<="(+-*/,:!&<>=^".indexOf(d.slice(-1))&&"="==d.slice(0,1)||"="==d)e.partialexpr=d;if(e.partialexpr&&(b.shiftKey&&"[a"==c.substr(0,2)&&(c+="shifted"),d=a.MoveECellWithKey(c))){f.hasrange?a.inputBox.SetText(e.partialexpr+SocialCalc.crToCoord(f.left,f.top)+":"+SocialCalc.crToCoord(f.right,
f.bottom)):a.inputBox.SetText(e.partialexpr+d);break}a.inputBox.Blur();a.inputBox.ShowInputBox(!1);a.state="start";a.cellhandles.ShowCellHandles(!0);"[esc]"!=c?(a.EditorSaveEdit(),a.ecell.coord!=e.ecoord&&a.MoveECell(e.ecoord),"[enter]"==c&&(c="[adown]"),"[tab]"==c&&(c=b.shiftKey?"[aleft]":"[aright]"),"[a"==c.substr(0,2)&&a.MoveECellWithKey(c)):(a.inputBox.DisplayCellContents(),a.RangeRemove(),a.MoveECell(e.ecoord));break}if(e.partialexpr&&"[backspace]"==c){a.inputBox.SetText(e.partialexpr);e.partialexpr=
"";a.RangeRemove();a.MoveECell(e.ecoord);a.inputBox.ShowInputBox(!0);break}if("[f2]"==c)break;f.hasrange&&a.RangeRemove();a.MoveECell(e.ecoord);e.partialexpr&&(a.inputBox.ShowInputBox(!0),e.partialexpr="");return!0;case "inputboxdirect":a.inputBox.GetText();if("[esc]"==c||"[enter]"==c||"[tab]"==c){a.inputBox.Blur();a.inputBox.ShowInputBox(!1);a.state="start";a.cellhandles.ShowCellHandles(!0);"[esc]"==c?a.inputBox.DisplayCellContents():(a.EditorSaveEdit(),a.ecell.coord!=e.ecoord&&a.MoveECell(e.ecoord),
"[enter]"==c&&(c="[adown]"),"[tab]"==c&&(c=b.shiftKey?"[aleft]":"[aright]"),"[a"==c.substr(0,2)&&a.MoveECellWithKey(c));break}if("[f2]"==c)break;return!0;case "skip-and-start":a.state="start";a.cellhandles.ShowCellHandles(!0);break;default:return!0}return!1};
SocialCalc.EditorAddToInput=function(a,c,b){var d=a.workingvalues;if(!a.noEdit&&!a.ECellReadonly())switch(a.state){case "start":a.state="input";a.inputBox.ShowInputBox(!0);a.inputBox.element.disabled=!1;a.inputBox.Focus();a.inputBox.SetText((b||"")+c);a.inputBox.Select("end");d.partialexpr="";d.ecoord=a.ecell.coord;d.erow=a.ecell.row;d.ecol=a.ecell.col;a.RangeRemove();break;case "input":case "inputboxdirect":a.inputBox.element.focus(),d.partialexpr&&(a.inputBox.SetText(d.partialexpr),d.partialexpr=
"",a.RangeRemove(),a.MoveECell(d.ecoord)),a.inputBox.SetText(a.inputBox.GetText()+c)}};SocialCalc.EditorDisplayCellContents=function(a){a.inputBox&&a.inputBox.DisplayCellContents()};
SocialCalc.EditorSaveEdit=function(a,c){var b,d,e;b=a.context.sheetobj;var f=a.workingvalues;e="string"==typeof c?c:a.inputBox.GetText();b=SocialCalc.GetCellContents(b,f.ecoord)+"";e!=b&&(b=e.charAt(0),"="==b&&-1==e.indexOf("\n")?(d="formula",e=e.substring(1)):"'"==b?(d="text t",e=e.substring(1),b=SocialCalc.DetermineValueType(e),"t"==b.type.charAt(0)&&(d="text "+b.type)):0==e.length?d="empty":(b=SocialCalc.DetermineValueType(e),d="n"==b.type&&e==b.value+""?"value n":"t"==b.type.charAt(0)?"text "+
b.type:""==b.type?"text t":"constant "+b.type+" "+b.value),"t"==d.charAt(0)&&(e=SocialCalc.encodeForSave(e)),e="set "+f.ecoord+" "+d+" "+e,a.EditorScheduleSheetCommands(e,!0,!1))};SocialCalc.EditorApplySetCommandsToRange=function(a,c){var b;b=a.ecell;var d=a.range;d.hasrange?(coord=SocialCalc.crToCoord(d.left,d.top)+":"+SocialCalc.crToCoord(d.right,d.bottom),b="set "+coord+" "+c):b="set "+b.coord+" "+c;a.EditorScheduleSheetCommands(b,!0,!1);a.DisplayCellContents()};
SocialCalc.EditorProcessMouseWheel=function(a,c,b,d){d.functionobj.editor.busy||(0<c&&d.functionobj.editor.ScrollRelative(!0,-1),0>c&&d.functionobj.editor.ScrollRelative(!0,1))};
SocialCalc.GridMousePosition=function(a,c,b){var d,e,f={};for(d=1;d<a.rowpositions.length&&!(a.rowheight[d]&&a.rowpositions[d]+a.rowheight[d]>b);d++);for(e=1;e<a.colpositions.length&&!(a.colwidth[e]&&a.colpositions[e]+a.colwidth[e]>c);e++);f.row=d;f.col=e;if(a.headposition){if(c<a.headposition.left&&c>=a.gridposition.left){f.rowheader=!0;f.distance=a.headposition.left-c;f.rowtounhide="";if(unhide=a.context.rowunhidetop[d])pos=SocialCalc.GetElementPosition(unhide),c>=pos.left&&(c<pos.left+unhide.offsetWidth&&
b>=pos.top&&b<pos.top+unhide.offsetHeight)&&(f.rowtounhide=d+1);if(unhide=a.context.rowunhidebottom[d])pos=SocialCalc.GetElementPosition(unhide),c>=pos.left&&(c<pos.left+unhide.offsetWidth&&b>=pos.top&&b<pos.top+unhide.offsetHeight)&&(f.rowtounhide=d-1)}else if(b<a.headposition.top&&b>a.gridposition.top){f.colheader=!0;f.distance=a.headposition.top-b;f.coltoresize=e-(a.colpositions[e]+a.colwidth[e]/2>c?1:0)||1;if(unhide=a.context.colunhideleft[e])pos=SocialCalc.GetElementPosition(unhide),c>=pos.left&&
(c<pos.left+unhide.offsetWidth&&b>=pos.top&&b<pos.top+unhide.offsetHeight)&&(f.coltounhide=e+1);if(unhide=a.context.colunhideright[e])pos=SocialCalc.GetElementPosition(unhide),c>=pos.left&&(c<pos.left+unhide.offsetWidth&&b>=pos.top&&b<pos.top+unhide.offsetHeight)&&(f.coltounhide=e-1);for(c=0;c<a.context.colpanes.length;c++)if(f.coltoresize>=a.context.colpanes[c].first&&f.coltoresize<=a.context.colpanes[c].last)return f;delete f.coltoresize}else c>=a.verticaltablecontrol.controlborder?(f.rowfooter=
!0,f.distance=c-a.verticaltablecontrol.controlborder):b>=a.horizontaltablecontrol.controlborder?(f.colfooter=!0,f.distance=b-a.horizontaltablecontrol.controlborder):c<a.gridposition.left?(f.rowheader=!0,f.distance=a.headposition.left-c):b<=a.gridposition.top?(f.colheader=!0,f.distance=a.headposition.top-b):(f.coord=SocialCalc.crToCoord(f.col,f.row),a.context.cellskip[f.coord]&&(f.coord=a.context.cellskip[f.coord]));return f}return null};
SocialCalc.GetEditorCellElement=function(a,c,b){var d,e,f,g,l=0,h=0;for(d=0;d<a.context.rowpanes.length;d++){if(c>=a.context.rowpanes[d].first&&c<=a.context.rowpanes[d].last)for(e=0;e<a.context.colpanes.length;e++){if(b>=a.context.colpanes[e].first&&b<=a.context.colpanes[e].last){l+=c-a.context.rowpanes[d].first+2;for(f=a.context.colpanes[e].first;f<=b;f++)(g=a.context.cellskip[SocialCalc.crToCoord(f,c)])&&a.context.CoordInPane(g,d,e)||h++;return{element:a.griddiv.firstChild.lastChild.childNodes[l].childNodes[h],
rowpane:d,colpane:e}}for(f=a.context.colpanes[e].first;f<=a.context.colpanes[e].last;f++)(g=a.context.cellskip[SocialCalc.crToCoord(f,c)])&&a.context.CoordInPane(g,d,e)||h++;h+=1}l+=a.context.rowpanes[d].last-a.context.rowpanes[d].first+2}return null};
SocialCalc.MoveECellWithKey=function(a,c){var b,d,e,f=!1,g=1;if(!a.ecell)return null;"shifted"==c.slice(-7)&&(c=c.slice(0,-7),f=!0);b=a.ecell.row;d=a.ecell.col;e=a.context.sheetobj.cells[a.ecell.coord];switch(c){case "[adown]":b+=e&&e.rowspan||1;break;case "[aup]":b--;g=-1;break;case "[pgdn]":b+=a.pageUpDnAmount-1+(e&&e.rowspan||1);break;case "[pgup]":b-=a.pageUpDnAmount;g=-1;break;case "[aright]":d+=e&&e.colspan||1;break;case "[aleft]":d--;g=-1;break;case "[home]":d=b=1;break;default:return null}a.context.sheetobj.attribs.usermaxcol&&
(d=Math.min(a.context.sheetobj.attribs.usermaxcol,d));for(a.context.sheetobj.attribs.usermaxrow&&(b=Math.min(a.context.sheetobj.attribs.usermaxrow,b));"yes"==a.context.sheetobj.colattribs.hide[SocialCalc.rcColname(d)];)d+=g,1>d&&(g=-g,d=1);for(;"yes"==a.context.sheetobj.rowattribs.hide[b];)b+=g,1>b&&(g=-g,b=1);a.range.hasrange||f&&a.RangeAnchor();b=a.MoveECell(SocialCalc.crToCoord(d,b));a.range.hasrange&&(f?a.RangeExtend():a.RangeRemove());return b};
SocialCalc.MoveECell=function(a,c){var b,d,e=a.context.highlights;b=SocialCalc.coordToCr(c);a.context.sheetobj.attribs.usermaxcol&&b.col>a.context.sheetobj.attribs.usermaxcol&&(b.col=a.context.sheetobj.attribs.usermaxcol);a.context.sheetobj.attribs.usermaxrow&&b.row>a.context.sheetobj.attribs.usermaxrow&&(b.row=a.context.sheetobj.attribs.usermaxrow);c=SocialCalc.crToCoord(b.col,b.row);if(a.ecell){if(a.ecell.coord==c)return c;b=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col);delete e[a.ecell.coord];
a.range2.hasrange&&(a.ecell.row>=a.range2.top&&a.ecell.row<=a.range2.bottom&&a.ecell.col>=a.range2.left&&a.ecell.col<=a.range2.right)&&(e[a.ecell.coord]="range2");a.UpdateCellCSS(b,a.ecell.row,a.ecell.col);a.SetECellHeaders("");a.cellhandles.ShowCellHandles(!1)}c=a.context.cellskip[c]||c;a.ecell=SocialCalc.coordToCr(c);a.ecell.coord=c;b=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col);e[c]="cursor";for(d in a.MoveECellCallback)a.MoveECellCallback[d](a);a.UpdateCellCSS(b,a.ecell.row,a.ecell.col);
a.SetECellHeaders("selected");for(d in a.StatusCallback)a.StatusCallback[d].func(a,"moveecell",c,a.StatusCallback[d].params);a.busy?a.ensureecell=!0:(a.ensureecell=!1,a.EnsureECellVisible());return c};
SocialCalc.EnsureECellVisible=function(a){var c=0,b=0;a.ecell.row>a.lastnonscrollingrow&&(a.ecell.row<a.firstscrollingrow?c=a.ecell.row-a.firstscrollingrow:a.ecell.row>a.lastvisiblerow&&(c=a.ecell.row-a.lastvisiblerow));a.ecell.col>a.lastnonscrollingcol&&(a.ecell.col<a.firstscrollingcol?b=a.ecell.col-a.firstscrollingcol:a.ecell.col>a.lastvisiblecol&&(b=a.ecell.col-a.lastvisiblecol));0!=c||0!=b?a.ScrollRelativeBoth(c,b):a.cellhandles.ShowCellHandles(!0)};
SocialCalc.ReplaceCell=function(a,c,b,d){var e;if(c&&(a=a.context.RenderCell(b,d,c.rowpane,c.colpane,!0,null)))for(e in c.element.innerHTML=a.innerHTML,c.element.style.cssText="",c.element.className=a.className,a.style)"cssText"!=a.style[e]&&(c.element.style[e]=a.style[e])};
SocialCalc.UpdateCellCSS=function(a,c,b,d){var e;if(c&&(a=a.context.RenderCell(b,d,c.rowpane,c.colpane,!0,null)))for(e in c.element.style.cssText="",c.element.className=a.className,a.style)"cssText"!=a.style[e]&&(c.element.style[e]=a.style[e])};
SocialCalc.SetECellHeaders=function(a,c){var b=a.ecell,d=a.context,e,f,g,l=0,h=0,n;if(b){for(;"yes"==d.sheetobj.colattribs.hide[SocialCalc.rcColname(b.col)];)b.col++;for(;"yes"==d.sheetobj.rowattribs.hide[b.row];)b.row++;b.coord=SocialCalc.crToCoord(b.col,b.row);for(e=0;e<d.rowpanes.length;e++)f=d.rowpanes[e].first,g=d.rowpanes[e].last,b.row>=f&&b.row<=g&&(n=a.fullgrid.childNodes[1].childNodes[2+l+b.row-f].childNodes[0])&&(d.classnames&&(n.className=d.classnames[c+"rowname"]),d.explicitStyles&&(n.style.cssText=
d.explicitStyles[c+"rowname"]),n.style.verticalAlign="top"),l+=g-f+2;for(e=0;e<d.colpanes.length;e++)f=d.colpanes[e].first,g=d.colpanes[e].last,b.col>=f&&b.col<=g&&(n=a.fullgrid.childNodes[1].childNodes[1].childNodes[1+h+b.col-f])&&(d.classnames&&(n.className=d.classnames[c+"colname"]),d.explicitStyles&&(n.style.cssText=d.explicitStyles[c+"colname"])),h+=g-f+2}};SocialCalc.ECellReadonly=function(a,c){!c&&a.ecell&&(c=a.ecell.coord);if(!c)return!1;var b=a.context.sheetobj.cells[c];return b&&b.readonly};
SocialCalc.RangeAnchor=function(a,c){a.range.hasrange&&a.RangeRemove();a.RangeExtend(c)};
SocialCalc.RangeExtend=function(a,c){var b,d,e,f,g,l,h=a.context.highlights;b=a.range;d=a.range2;c?(f=SocialCalc.coordToCr(c),f.coord=c):f=a.ecell;if(f){b.hasrange||(b.anchorcoord=f.coord,b.anchorrow=f.row,b.top=f.row,b.bottom=f.row,b.anchorcol=f.col,b.left=f.col,b.right=f.col,b.hasrange=!0);b.anchorrow<f.row?(b.top=b.anchorrow,b.bottom=f.row):(b.top=f.row,b.bottom=b.anchorrow);b.anchorcol<f.col?(b.left=b.anchorcol,b.right=f.col):(b.left=f.col,b.right=b.anchorcol);for(e in h)switch(h[e]){case "range":h[e]=
"unrange";break;case "range2":h[e]="unrange2"}for(f=b.top;f<=b.bottom;f++)for(g=b.left;g<=b.right;g++)switch(e=SocialCalc.crToCoord(g,f),h[e]){case "unrange":h[e]="range";break;case "cursor":break;default:h[e]="newrange"}for(f=d.top;d.hasrange&&f<=d.bottom;f++)for(g=d.left;g<=d.right;g++)switch(e=SocialCalc.crToCoord(g,f),h[e]){case "unrange2":h[e]="range2";break;case "range":case "newrange":case "cursor":break;default:h[e]="newrange2"}for(e in h){switch(h[e]){case "unrange":delete h[e];break;case "newrange":h[e]=
"range";break;case "newrange2":h[e]="range2";break;case "range":case "range2":case "cursor":continue}d=SocialCalc.coordToCr(e);b=SocialCalc.GetEditorCellElement(a,d.row,d.col);a.UpdateCellCSS(b,d.row,d.col)}for(l in a.RangeChangeCallback)a.RangeChangeCallback[l](a);e=SocialCalc.crToCoord(a.range.left,a.range.top);if(a.range.left!=a.range.right||a.range.top!=a.range.bottom)e+=":"+SocialCalc.crToCoord(a.range.right,a.range.bottom);for(l in a.StatusCallback)a.StatusCallback[l].func(a,"rangechange",e,
a.StatusCallback[l].params)}};
SocialCalc.RangeRemove=function(a){var c,b,d,e,f=a.context.highlights,g=a.range,l=a.range2;if(g.hasrange||l.hasrange){for(c=l.top;l.hasrange&&c<=l.bottom;c++)for(b=l.left;b<=l.right;b++)switch(d=SocialCalc.crToCoord(b,c),f[d]){case "range":f[d]="newrange2";break;case "range2":case "cursor":break;default:f[d]="newrange2"}for(d in f){switch(f[d]){case "range":delete f[d];break;case "newrange2":f[d]="range2";break;case "cursor":continue}b=SocialCalc.coordToCr(d);c=SocialCalc.GetEditorCellElement(a,b.row,
b.col);a.UpdateCellCSS(c,b.row,b.col)}g.hasrange=!1;for(e in a.RangeChangeCallback)a.RangeChangeCallback[e](a);for(e in a.StatusCallback)a.StatusCallback[e].func(a,"rangechange","",a.StatusCallback[e].params)}};
SocialCalc.Range2Remove=function(a){var c,b,d,e=a.context.highlights,f=a.range2;if(f.hasrange){for(d in e){switch(e[d]){case "range2":delete e[d];break;case "range":case "cursor":continue}b=SocialCalc.coordToCr(d);c=SocialCalc.GetEditorCellElement(a,b.row,b.col);a.UpdateCellCSS(c,b.row,b.col)}f.hasrange=!1}};
SocialCalc.FitToEditTable=function(a){var c,b,d,e=a.context,f=e.sheetobj;d=e.showRCHeaders?e.rownamewidth-0:0;for(colpane=0;colpane<e.colpanes.length-1;colpane++)for(c=e.colpanes[colpane].first;c<=e.colpanes[colpane].last;c++)if(b=SocialCalc.rcColname(c),"yes"!=f.colattribs.hide[b]){b=f.colattribs.width[b]||f.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if("blank"==b||"auto"==b)b="";d+=b&&0<b-0?b-0:10}for(c=e.colpanes[colpane].first;1E4>=c;c++){b=SocialCalc.rcColname(c);if("yes"!=
f.colattribs.hide[b]){b=f.colattribs.width[b]||f.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if("blank"==b||"auto"==b)b="";d+=b&&0<b-0?b-0:10}if(d>a.tablewidth)break}e.colpanes[colpane].last=e.sheetobj.attribs.usermaxcol||c;d=e.showRCHeaders?1:0;for(c=0;c<e.rowpanes.length-1;c++)for(d+=e.rowpanes[c].last-e.rowpanes[c].first+1,b=e.rowpanes[c].first;b<=e.rowpanes[c].last;b++)"yes"==f.rowattribs.hide[b]&&d--;a=a.tableheight-d*e.pixelsPerRow;e.rowpanes[c].last=e.sheetobj.attribs.usermaxrow||
e.rowpanes[c].first+Math.floor(a/e.pixelsPerRow)+1};
SocialCalc.CalculateEditorPositions=function(a){var c;a.gridposition=SocialCalc.GetElementPosition(a.griddiv);c=a.griddiv.firstChild.lastChild.childNodes[1].childNodes[0];a.headposition=SocialCalc.GetElementPosition(c);a.headposition.left+=c.offsetWidth;a.headposition.top+=c.offsetHeight;a.rowpositions=[];for(c=0;c<a.context.rowpanes.length;c++)a.CalculateRowPositions(c,a.rowpositions,a.rowheight);for(c=0;c<a.rowpositions.length&&!(a.rowpositions[c]>a.gridposition.top+a.tableheight);c++);a.lastvisiblerow=
c-1;a.colpositions=[];for(c=0;c<a.context.colpanes.length;c++)a.CalculateColPositions(c,a.colpositions,a.colwidth);for(c=0;c<a.colpositions.length&&!(a.colpositions[c]>a.gridposition.left+a.tablewidth);c++);a.lastvisiblecol=c-1;for(a.firstscrollingrow=a.context.rowpanes[a.context.rowpanes.length-1].first;"yes"==a.context.sheetobj.rowattribs.hide[a.firstscrollingrow];)a.firstscrollingrow++;a.firstscrollingrowtop=a.rowpositions[a.firstscrollingrow]||a.headposition.top;a.lastnonscrollingrow=0<a.context.rowpanes.length-
1?a.context.rowpanes[a.context.rowpanes.length-2].last:0;for(a.firstscrollingcol=a.context.colpanes[a.context.colpanes.length-1].first;"yes"==a.context.sheetobj.colattribs.hide[SocialCalc.rcColname(a.firstscrollingcol)];)a.firstscrollingcol++;a.firstscrollingcolleft=a.colpositions[a.firstscrollingcol]||a.headposition.left;a.lastnonscrollingcol=0<a.context.colpanes.length-1?a.context.colpanes[a.context.colpanes.length-2].last:0;a.verticaltablecontrol.ComputeTableControlPositions();a.horizontaltablecontrol.ComputeTableControlPositions()};
SocialCalc.ScheduleRender=function(a){a.timeout&&window.clearTimeout(a.timeout);SocialCalc.EditorSheetStatusCallback(null,"schedrender",null,a);a.timeout=window.setTimeout(function(){SocialCalc.DoRenderStep(a)},1)};SocialCalc.DoRenderStep=function(a){a.timeout=null;a.EditorRenderSheet();SocialCalc.EditorSheetStatusCallback(null,"renderdone",null,a);SocialCalc.EditorSheetStatusCallback(null,"schedposcalc",null,a);a.timeout=window.setTimeout(function(){SocialCalc.DoPositionCalculations(a)},1)};
SocialCalc.SchedulePositionCalculations=function(a){SocialCalc.EditorSheetStatusCallback(null,"schedposcalc",null,a);a.timeout=window.setTimeout(function(){SocialCalc.DoPositionCalculations(a)},1)};
SocialCalc.DoPositionCalculations=function(a){a.timeout=null;a.CalculateEditorPositions();a.verticaltablecontrol.PositionTableControlElements();a.horizontaltablecontrol.PositionTableControlElements();SocialCalc.EditorSheetStatusCallback(null,"doneposcalc",null,a);a.ensureecell&&(a.ecell&&!a.deferredCommands.length)&&(a.ensureecell=!1,a.EnsureECellVisible());a.cellhandles.ShowCellHandles(!0)};
SocialCalc.CalculateRowPositions=function(a,c,b,d){var e,f,g,l,h=a.context,n;if(!h.showRCHeaders)throw"Needs showRCHeaders=true";n=a.fullgrid.lastChild;a=2;for(e=0;e<c;e++)a+=h.rowpanes[e].last-h.rowpanes[e].first+2;f=0;for(c=h.rowpanes[e].first;c<=h.rowpanes[e].last;c++)g=n.childNodes[a+f],f++,l=SocialCalc.GetElementPosition(g.firstChild),b[c]||(b[c]=l.top,d[c]=g.firstChild.offsetHeight)};
SocialCalc.CalculateColPositions=function(a,c,b,d){var e,f,g,l,h=a.context;if(!h.showRCHeaders)throw"Needs showRCHeaders=true";f=a.fullgrid.lastChild;a=1;for(e=0;e<c;e++)a+=h.colpanes[e].last-h.colpanes[e].first+2;g=f.childNodes[1];f=0;for(c=h.colpanes[e].first;c<=h.colpanes[e].last;c++)l=SocialCalc.GetElementPosition(g.childNodes[a+f]),b[c]||(b[c]=l.left,g.childNodes[a+f]&&(d[c]=g.childNodes[a+f].offsetWidth)),f++};
SocialCalc.ScrollRelative=function(a,c,b){c?a.ScrollRelativeBoth(b,0):a.ScrollRelativeBoth(0,b)};
SocialCalc.ScrollRelativeBoth=function(a,c,b){var d=a.context,e=0<c?1:-1,f=0<b?1:-1,g=d.rowpanes.length,l=1<g?d.rowpanes[g-2].last+1:1;d.rowpanes[g-1].first+c<l&&(c=-d.rowpanes[g-1].first+l);var l=d.colpanes.length,h=1<l?d.colpanes[l-2].last+1:1;for(d.colpanes[l-1].first+b<h&&(b=-d.colpanes[l-1].first+h);"yes"==d.sheetobj.colattribs.hide[SocialCalc.rcColname(d.colpanes[l-1].first+b)];)if(b+=f,1>b){b=0;break}for(;"yes"==d.sheetobj.rowattribs.hide[d.rowpanes[g-1].first+c];)if(c+=e,1>c){c=0;break}if((1==
c||-1==c)&&0==b)1==c?a.ScrollTableUpOneRow():a.ScrollTableDownOneRow(),a.ecell&&a.SetECellHeaders("selected"),a.SchedulePositionCalculations();else if(0!=c||0!=b)d.rowpanes[g-1].first+=c,d.rowpanes[g-1].last+=c,d.colpanes[l-1].first+=b,d.colpanes[l-1].last+=b,a.LimitLastPanes(),a.FitToEditTable(),a.ScheduleRender()};
SocialCalc.PageRelative=function(a,c,b){var d=a.context,e=c?"rowpanes":"colpanes",d=d[e][d[e].length-1],f=c?"lastvisiblerow":"lastvisiblecol",e=c?a.rowheight:a.colwidth,g=c?SocialCalc.Constants.defaultAssumedRowHeight:SocialCalc.Constants.defaultColWidth;if(0<b)c=a[f],c==d.first&&(c+=1);else{b=c?a.tableheight-(a.firstscrollingrowtop-a.gridposition.top):a.tablewidth-(a.firstscrollingcolleft-a.gridposition.left);b-=0<e[a[f]]?e[a[f]]:g;for(c=d.first-1;0<c;c--){f=0<e[c]?e[c]:g;if(b<f)break;b-=f}e=d.first;
c>=e&&(c=e-1);1>c&&(c=1)}d.first=c;d.last=c+1;a.LimitLastPanes();a.FitToEditTable();a.ScheduleRender()};
SocialCalc.LimitLastPanes=function(a){a=a.context;var c;c=a.rowpanes.length;1<c&&a.rowpanes[c-1].first<=a.rowpanes[c-2].last&&(a.rowpanes[c-1].first=a.rowpanes[c-2].last+1);a.sheetobj.attribs.usermaxrow&&a.rowpanes[c-1].first>a.sheetobj.attribs.usermaxrow&&(a.rowpanes[c-1].first=a.sheetobj.attribs.usermaxrow);c=a.colpanes.length;1<c&&a.colpanes[c-1].first<=a.colpanes[c-2].last&&(a.colpanes[c-1].first=a.colpanes[c-2].last+1);a.sheetobj.attribs.usermaxcol&&a.colpanes[c-1].first>a.sheetobj.attribs.usermaxcol&&
(a.colpanes[c-1].first=a.sheetobj.attribs.usermaxcol)};
SocialCalc.ScrollTableUpOneRow=function(a){var c,b,d,e,f,g,l={},h=a.context,n=h.sheetobj,p=a.fullgrid,r;r=p.lastChild;c=h.showRCHeaders?2:1;for(b=0;b<h.rowpanes.length-1;b++)c+=h.rowpanes[b].last-h.rowpanes[b].first+2;if(h.sheetobj.attribs.usermaxrow&&1>h.sheetobj.attribs.usermaxrow-h.rowpanes[b].first)return p;r.removeChild(r.childNodes[c]);h.rowpanes[b].first++;h.rowpanes[b].last++;a.FitToEditTable();h.CalculateColWidthData();h.sheetobj.attribs.usermaxrow&&h.rowpanes[b].last==h.sheetobj.attribs.usermaxrow||
(a=h.RenderRow(h.rowpanes[b].last,b),r.appendChild(a));maxrowspan=1;a=h.rowpanes[b].first-1;for(f=0;f<h.colpanes.length;f++)for(e=h.colpanes[f].first;e<=h.colpanes[f].last;e++)coord=SocialCalc.crToCoord(e,a),h.cellskip[coord]||(g=n.cells[coord])&&g.rowspan>maxrowspan&&(maxrowspan=g.rowspan);if(1<maxrowspan)for(d=1;d<maxrowspan&&!(d+a>=h.rowpanes[b].last);d++)e=h.RenderRow(d+a,b),f=r.childNodes[c+d-1],r.replaceChild(e,f);a=h.rowpanes[b].last;for(f=0;f<h.colpanes.length;f++)for(e=h.colpanes[f].first;e<=
h.colpanes[f].last;e++)if(coord=h.cellskip[SocialCalc.crToCoord(e,a)])d=h.coordToCR[coord].row-0,d==h.rowpanes[b].last||d<h.rowpanes[b].first||(g=n.cells[coord])&&1<g.rowspan&&(l[d]=!0);for(d in l)e=h.RenderRow(d,b),f=r.childNodes[c+(d-h.rowpanes[b].first)],r.replaceChild(e,f);return p};
SocialCalc.ScrollTableDownOneRow=function(a){var c,b,d,e,f,g,l={},h=a.context,n=h.sheetobj,p=a.fullgrid,r;r=p.lastChild;c=h.showRCHeaders?2:1;for(b=0;b<h.rowpanes.length-1;b++)c+=h.rowpanes[b].last-h.rowpanes[b].first+2;h.sheetobj.attribs.usermaxrow||r.removeChild(r.childNodes[c+(h.rowpanes[b].last-h.rowpanes[b].first)]);h.rowpanes[b].first--;h.rowpanes[b].last--;a.FitToEditTable();h.CalculateColWidthData();e=h.RenderRow(h.rowpanes[b].first,b);r.insertBefore(e,r.childNodes[c]);maxrowspan=1;a=h.rowpanes[b].first;
for(f=0;f<h.colpanes.length;f++)for(e=h.colpanes[f].first;e<=h.colpanes[f].last;e++)coord=SocialCalc.crToCoord(e,a),h.cellskip[coord]||(g=n.cells[coord])&&g.rowspan>maxrowspan&&(maxrowspan=g.rowspan);if(1<maxrowspan)for(d=1;d<maxrowspan&&!(d+a>h.rowpanes[b].last);d++)e=h.RenderRow(d+a,b),f=r.childNodes[c+d],r.replaceChild(e,f);a=h.rowpanes[b].last;for(f=0;f<h.colpanes.length;f++)for(e=h.colpanes[f].first;e<=h.colpanes[f].last;e++)if(coord=SocialCalc.crToCoord(e,a),(g=n.cells[coord])&&1<g.rowspan)l[a]=
!0;else if(coord=h.cellskip[SocialCalc.crToCoord(e,a)])d=h.coordToCR[coord].row-0,d==a||d<h.rowpanes[b].first||(g=n.cells[coord])&&1<g.rowspan&&(l[d]=!0);for(d in l)e=h.RenderRow(d,b),f=r.childNodes[c+(d-h.rowpanes[b].first)],r.replaceChild(e,f);return p};SocialCalc.InputBox=function(a,c){a&&(this.element=a,this.editor=c,this.inputEcho=null,c.inputBox=this,a.onmousedown=SocialCalc.InputBoxOnMouseDown,c.MoveECellCallback.formulabar=function(a){"start"==a.state&&c.inputBox.DisplayCellContents(a.ecell.coord)})};
SocialCalc.InputBox.prototype.DisplayCellContents=function(a){SocialCalc.InputBoxDisplayCellContents(this,a)};SocialCalc.InputBox.prototype.ShowInputBox=function(a){this.editor.inputEcho.ShowInputEcho(a)};SocialCalc.InputBox.prototype.GetText=function(){return this.element.value};SocialCalc.InputBox.prototype.SetText=function(a){this.element&&(this.element.value=a,this.editor.inputEcho.SetText(a+"_"))};SocialCalc.InputBox.prototype.Focus=function(){SocialCalc.InputBoxFocus(this)};
SocialCalc.InputBox.prototype.Blur=function(){return this.element.blur()};
SocialCalc.InputBox.prototype.Select=function(a){if(this.element)switch(a){case "end":if(document.selection&&document.selection.createRange)try{var c=document.selection.createRange().duplicate();c.moveToElementText(this.element);c.collapse(!1);c.select()}catch(b){void 0!=this.element.selectionStart&&(this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length)}else void 0!=this.element.selectionStart&&(this.element.selectionStart=this.element.value.length,
this.element.selectionEnd=this.element.value.length)}};SocialCalc.InputBoxDisplayCellContents=function(a,c){var b=SocialCalc.Constants;if(a){c||(c=a.editor.ecell.coord);var d=SocialCalc.GetCellContents(a.editor.context.sheetobj,c);-1!=d.indexOf("\n")?(d=b.s_inputboxdisplaymultilinetext,a.element.disabled=!0):a.editor.ECellReadonly()?a.element.disabled=!0:a.element.disabled=!1;a.SetText(d)}};
SocialCalc.InputBoxFocus=function(a){if(a){a.element.focus();a=a.editor;a.state="input";var c=a.workingvalues;c.partialexpr="";c.ecoord=a.ecell.coord;c.erow=a.ecell.row;c.ecol=a.ecell.col}};
SocialCalc.InputBoxOnMouseDown=function(a){a=SocialCalc.Keyboard.focusTable;if(!a)return!0;var c=a.workingvalues;switch(a.state){case "start":a.state="inputboxdirect";c.partialexpr="";c.ecoord=a.ecell.coord;c.erow=a.ecell.row;c.ecol=a.ecell.col;a.inputEcho.ShowInputEcho(!0);break;case "input":c.partialexpr="",a.MoveECell(c.ecoord),a.state="inputboxdirect",SocialCalc.KeyboardFocus()}};
SocialCalc.InputEcho=function(a){var c=SocialCalc.Constants;this.editor=a;this.text="";this.functionbox=this.prompt=this.main=this.container=this.interval=null;this.container=document.createElement("div");SocialCalc.setStyles(this.container,"display:none;position:absolute;zIndex:10;");this.main=document.createElement("div");c.defaultInputEchoClass&&(this.main.className=c.defaultInputEchoClass);c.defaultInputEchoStyle&&SocialCalc.setStyles(this.main,c.defaultInputEchoStyle);this.main.innerHTML="&nbsp;";
this.container.appendChild(this.main);this.prompt=document.createElement("div");c.defaultInputEchoPromptClass&&(this.prompt.className=c.defaultInputEchoPromptClass);c.defaultInputEchoPromptStyle&&SocialCalc.setStyles(this.prompt,c.defaultInputEchoPromptStyle);this.prompt.innerHTML="";this.container.appendChild(this.prompt);SocialCalc.DragRegister(this.main,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,
positionobj:this.container},this.editor.toplevel);a.toplevel.appendChild(this.container)};SocialCalc.InputEcho.prototype.ShowInputEcho=function(a){return SocialCalc.ShowInputEcho(this,a)};SocialCalc.InputEcho.prototype.SetText=function(a){return SocialCalc.SetInputEchoText(this,a)};
SocialCalc.ShowInputEcho=function(a,c){var b;if(b=a.editor)if(c){b.cellhandles.ShowCellHandles(!1);if(b=SocialCalc.GetEditorCellElement(b,b.ecell.row,b.ecell.col))b=SocialCalc.GetElementPosition(b.element),a.container.style.left=b.left-1+"px",a.container.style.top=b.top-1+"px";a.container.style.display="block";a.interval&&window.clearInterval(a.interval);a.interval=window.setInterval(SocialCalc.InputEchoHeartbeat,50)}else a.interval&&window.clearInterval(a.interval),a.container.style.display="none"};
SocialCalc.SetInputEchoText=function(a,c){var b=SocialCalc.Constants,d;d=SocialCalc.special_chars(c);d=d.replace(/\n/g,"<br>");a.text!=d&&(a.main.innerHTML=d,a.text=d);d=c.match(/.*[\+\-\*\/\&\^\<\>\=\,\(]([A-Za-z][A-Za-z][\w\.]*?)\([^\)]*$/);"="==c.charAt(0)&&d?(d=d[1].toUpperCase(),SocialCalc.Formula.FunctionList[d]?(SocialCalc.Formula.FillFunctionInfo(),b=SocialCalc.special_chars(d+"("+SocialCalc.Formula.FunctionArgString(d)+")")):b=b.ietUnknownFunction+d,a.prompt.innerHTML!=b&&(a.prompt.innerHTML=
b,a.prompt.style.display="block")):"none"!=a.prompt.style.display&&(a.prompt.innerHTML="",a.prompt.style.display="none")};SocialCalc.InputEchoHeartbeat=function(){var a=SocialCalc.Keyboard.focusTable;if(!a)return!0;a.inputEcho.SetText(a.inputBox.GetText()+"_")};SocialCalc.InputEchoMouseDown=function(a){a=SocialCalc.Keyboard.focusTable;if(!a)return!0;a.inputBox.element.focus()};
SocialCalc.CellHandles=function(a){if(!a.noEdit){this.editor=a;this.movedmouse=this.noCursorSuffix=!1;this.draghandle=document.createElement("div");SocialCalc.setStyles(this.draghandle,"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;");this.draghandle.innerHTML="&nbsp;";a.toplevel.appendChild(this.draghandle);SocialCalc.AssignID(a,this.draghandle,"draghandle");var c="png";navigator.userAgent.match(/MSIE 6\.0/)&&
(c="gif");this.dragpalette=document.createElement("div");SocialCalc.setStyles(this.dragpalette,"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;backgroundImage:url("+SocialCalc.Constants.defaultImagePrefix+"drag-handles."+c+");");this.dragpalette.innerHTML="&nbsp;";a.toplevel.appendChild(this.dragpalette);SocialCalc.AssignID(a,this.dragpalette,"dragpalette");this.dragtooltip=document.createElement("div");SocialCalc.setStyles(this.dragtooltip,
"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;");this.dragtooltip.innerHTML="&nbsp;";a.toplevel.appendChild(this.dragtooltip);SocialCalc.AssignID(a,this.dragtooltip,"dragtooltip");this.fillinghandle=document.createElement("div");SocialCalc.setStyles(this.fillinghandle,"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;");this.fillinghandle.innerHTML=
"&nbsp;";a.toplevel.appendChild(this.fillinghandle);SocialCalc.AssignID(a,this.fillinghandle,"fillinghandle");if(this.draghandle.addEventListener)this.draghandle.addEventListener("mousemove",SocialCalc.CellHandlesMouseMoveOnHandle,!1),this.dragpalette.addEventListener("mousedown",SocialCalc.CellHandlesMouseDown,!1),this.dragpalette.addEventListener("mousemove",SocialCalc.CellHandlesMouseMoveOnHandle,!1);else if(this.draghandle.attachEvent)this.draghandle.attachEvent("onmousemove",SocialCalc.CellHandlesMouseMoveOnHandle),
this.dragpalette.attachEvent("onmousedown",SocialCalc.CellHandlesMouseDown),this.dragpalette.attachEvent("onmousemove",SocialCalc.CellHandlesMouseMoveOnHandle);else throw"Browser not supported";}};SocialCalc.CellHandles.prototype.ShowCellHandles=function(a,c){return SocialCalc.ShowCellHandles(this,a,c)};
SocialCalc.ShowCellHandles=function(a,c,b){var d=a.editor,e=!1,f,g,l=1,h=1;if(d){if(c&&(f=d.ecell.row,g=d.ecell.col,"start"==d.state&&!(f>=d.lastvisiblerow||g>=d.lastvisiblecol||f<d.firstscrollingrow||g<d.firstscrollingcol))){for(;"yes"==d.context.sheetobj.colattribs.hide[SocialCalc.rcColname(g+l)];)l++;for(;"yes"==d.context.sheetobj.rowattribs.hide[f+h];)h++;c=d.context.sheetobj.cells[SocialCalc.crToCoord(g+l-1,f+h-1)];"undefined"!=typeof c&&(l+=(c.colspan||1)-1,h+=(c.rowspan||1)-1);d.rowpositions[f+
h]+20>d.horizontaltablecontrol.controlborder||(d.rowpositions[f+h]-10<d.headposition.top||d.colpositions[g+l]+20>d.verticaltablecontrol.controlborder||d.colpositions[g+l]-30<d.headposition.left)||(a.draghandle.style.left=d.colpositions[g+l]-1+"px",a.draghandle.style.top=d.rowpositions[f+h]-1+"px",a.draghandle.style.display="block",b&&(a.draghandle.style.display="none",a.dragpalette.style.left=d.colpositions[g+l]-45+"px",a.dragpalette.style.top=d.rowpositions[f+h]-45+"px",a.dragpalette.style.display=
"block",a.dragtooltip.style.left=d.colpositions[g+l]-45+"px",a.dragtooltip.style.top=d.rowpositions[f+h]+45+"px",a.dragtooltip.style.display="none"),e=!0)}e||(a.draghandle.style.display="none");b||(a.dragpalette.style.display="none",a.dragtooltip.style.display="none")}};
SocialCalc.CellHandlesMouseMoveOnHandle=function(a){var c=SocialCalc.Constants,b=a||window.event,d=b.target||b.srcElement,e=SocialCalc.Keyboard.focusTable;if(!e)return!0;a=e.cellhandles;if(!a.editor)return!0;var f=SocialCalc.GetElementPositionWithScroll(e.toplevel),g=b.clientX-f.left,b=b.clientY-f.top;if(!e.cellhandles.mouseDown){e.cellhandles.ShowCellHandles(!0,!0);if(d==a.dragpalette){c=SocialCalc.SegmentDivHit([c.CH_radius1,c.CH_radius2],e.cellhandles.dragpalette,g,b);if(0==c){SocialCalc.CellHandlesHoverTimeout();
return}a.tooltipstimer&&(window.clearTimeout(a.tooltipstimer),a.tooltipstimer=null);a.tooltipswhichhandle=c;a.tooltipstimer=window.setTimeout(SocialCalc.CellHandlesTooltipsTimeout,700)}a.timer&&(window.clearTimeout(a.timer),a.timer=null);a.timer=window.setTimeout(SocialCalc.CellHandlesHoverTimeout,3E3)}};
SocialCalc.SegmentDivHit=function(a,c,b,d){var e=c.offsetWidth,f=c.offsetHeight,g=c.offsetLeft;c=c.offsetTop;var l=0,h=a,n=Math.sqrt(Math.pow(b-g-(e/2-0.5),2)+Math.pow(d-c-(f/2-0.5),2));if(2==h.length)return b>=g&&(b<g+e/2&&d>=c&&d<c+f/2)&&(n<=a[0]?l=-1:n<=a[1]&&(l=1)),b>=g+e/2&&(b<g+e&&d>=c&&d<c+f/2)&&(n<=a[0]?l=-2:n<=a[1]&&(l=2)),b>=g+e/2&&(b<g+e&&d>=c+f/2&&d<c+f)&&(n<=a[0]?l=-3:n<=a[1]&&(l=3)),b>=g&&(b<g+e/2&&d>=c+f/2&&d<c+f)&&(n<=a[0]?l=-4:n<=a[1]&&(l=4)),l;for(;;)if(b>=g&&b<g+e/2&&d>=c&&d<c+
f/2){quadrant+="1";l=h[0];if("number"==typeof l)break;h=l;e/=2;f/=2}else if(b>=g+e/2&&b<g+e&&d>=c&&d<c+f/2){quadrant+="2";l=h[1];if("number"==typeof l)break;h=l;e/=2;g+=e;f/=2}else if(b>=g+e/2&&b<g+e&&d>=c+f/2&&d<c+f){quadrant+="3";l=h[2];if("number"==typeof l)break;h=l;e/=2;g+=e;f/=2;c+=f}else if(b>=g&&b<g+e/2&&d>=c+f/2&&d<c+f){quadrant+="4";l=h[3];if("number"==typeof l)break;h=l;e/=2;f/=2;c+=f}else return 0;return l};
SocialCalc.CellHandlesHoverTimeout=function(){editor=SocialCalc.Keyboard.focusTable;if(!editor)return!0;var a=editor.cellhandles;a.timer&&(window.clearTimeout(a.timer),a.timer=null);a.tooltipstimer&&(window.clearTimeout(a.tooltipstimer),a.tooltipstimer=null);editor.cellhandles.ShowCellHandles(!0,!1)};
SocialCalc.CellHandlesTooltipsTimeout=function(){editor=SocialCalc.Keyboard.focusTable;if(!editor)return!0;var a=editor.cellhandles;a.tooltipstimer&&(window.clearTimeout(a.tooltipstimer),a.tooltipstimer=null);var c=a.tooltipswhichhandle;if(0==c)SocialCalc.CellHandlesHoverTimeout();else{if(-3==c)a.dragtooltip.innerHTML=scc.s_CHfillAllTooltip;else if(3==c)a.dragtooltip.innerHTML=scc.s_CHfillContentsTooltip;else if(-2==c)a.dragtooltip.innerHTML=scc.s_CHmovePasteAllTooltip;else if(-4==c)a.dragtooltip.innerHTML=
scc.s_CHmoveInsertAllTooltip;else if(2==c)a.dragtooltip.innerHTML=scc.s_CHmovePasteContentsTooltip;else if(4==c)a.dragtooltip.innerHTML=scc.s_CHmoveInsertContentsTooltip;else{a.dragtooltip.innerHTML="&nbsp;";a.dragtooltip.style.display="none";return}a.dragtooltip.style.display="block"}};
SocialCalc.CellHandlesMouseDown=function(a){var c=SocialCalc.Constants,b,d=a||window.event,e=SocialCalc.EditorMouseInfo;a=SocialCalc.Keyboard.focusTable;if(!a)return!0;if(!a.busy){var f=a.cellhandles;f.movedmouse=!1;var g=SocialCalc.GetElementPositionWithScroll(a.toplevel),l=d.clientX-g.left,g=d.clientY-g.top;f.timer&&(window.clearTimeout(f.timer),f.timer=null);f.tooltipstimer&&(window.clearTimeout(f.tooltipstimer),f.tooltipstimer=null);f.dragtooltip.innerHTML="&nbsp;";f.dragtooltip.style.display=
"none";b=a.range;var h=SocialCalc.SegmentDivHit([c.CH_radius1,c.CH_radius2],a.cellhandles.dragpalette,l,g);if(1==h||-1==h||0==h)f.ShowCellHandles(!0,!1);else{e.ignore=!0;-3==h?(f.dragtype="Fill",f.noCursorSuffix=!1):3==h?(f.dragtype="FillC",f.noCursorSuffix=!1):-2==h?(f.dragtype="Move",f.noCursorSuffix=!0):-4==h?(f.dragtype="MoveI",f.noCursorSuffix=!1):2==h?(f.dragtype="MoveC",f.noCursorSuffix=!0):4==h&&(f.dragtype="MoveIC",f.noCursorSuffix=!1);f.filltype=null;switch(f.dragtype){case "Fill":case "FillC":b.hasrange||
a.RangeAnchor();break;case "Move":case "MoveI":case "MoveC":case "MoveIC":b.hasrange||a.RangeAnchor();a.range2.top=a.range.top;a.range2.right=a.range.right;a.range2.bottom=a.range.bottom;a.range2.left=a.range.left;a.range2.hasrange=!0;a.RangeRemove();break;default:return}f.fillinghandle.style.left=l+"px";f.fillinghandle.style.top=g-17+"px";f.fillinghandle.innerHTML=c.s_CHindicatorOperationLookup[f.dragtype]+(c.s_CHindicatorDirectionLookup[a.cellhandles.filltype]||"");f.fillinghandle.style.display=
"block";f.ShowCellHandles(!0,!1);f.mouseDown=!0;e.editor=a;c=a.ecell.coord;f.startingcoord=c;f.startingX=l;f.startingY=g;e.mouselastcoord=c;SocialCalc.KeyboardSetFocus(a);document.addEventListener?(document.addEventListener("mousemove",SocialCalc.CellHandlesMouseMove,!0),document.addEventListener("mouseup",SocialCalc.CellHandlesMouseUp,!0)):f.draghandle.attachEvent&&(f.draghandle.setCapture(),f.draghandle.attachEvent("onmousemove",SocialCalc.CellHandlesMouseMove),f.draghandle.attachEvent("onmouseup",
SocialCalc.CellHandlesMouseUp),f.draghandle.attachEvent("onlosecapture",SocialCalc.CellHandlesMouseUp));d.stopPropagation?d.stopPropagation():d.cancelBubble=!0;d.preventDefault?d.preventDefault():d.returnValue=!1}}};
SocialCalc.CellHandlesMouseMove=function(a){var c=SocialCalc.Constants,b,d,e,f=a||window.event,g=SocialCalc.EditorMouseInfo;if(a=g.editor){var l=a.cellhandles;b=SocialCalc.GetElementPositionWithScroll(a.toplevel);var h=f.clientX-b.left,n=f.clientY-b.top;if(b=SocialCalc.GridMousePosition(a,h,n))if(b&&!b.coord)SocialCalc.SetDragAutoRepeat(a,b,SocialCalc.CellHandlesDragAutoRepeat);else if(SocialCalc.SetDragAutoRepeat(a,null),b.coord){d=SocialCalc.coordToCr(a.cellhandles.startingcoord);e=SocialCalc.coordToCr(b.coord);
l.movedmouse=!0;switch(l.dragtype){case "Fill":case "FillC":b.coord==l.startingcoord?(l.filltype=null,l.startingX=h,l.startingY=n):l.filltype?"Down"==l.filltype?(e.col=d.col,e.row<d.row&&(e.row=d.row)):(e.row=d.row,e.col<d.col&&(e.col=d.col)):(10<Math.abs(n-l.startingY)?l.filltype="Down":10<Math.abs(h-l.startingX)&&(l.filltype="Right"),e.col=d.col,e.row=d.row);b.coord=SocialCalc.crToCoord(e.col,e.row);b.coord!=g.mouselastcoord&&(a.MoveECell(b.coord),a.RangeExtend());break;case "Move":case "MoveC":b.coord!=
g.mouselastcoord&&(a.MoveECell(b.coord),d=a.range2.right-a.range2.left+b.col,e=a.range2.bottom-a.range2.top+b.row,a.RangeAnchor(SocialCalc.crToCoord(d,e)),a.RangeExtend());break;case "MoveI":case "MoveIC":b.coord==l.startingcoord?(l.filltype=null,l.startingX=h,l.startingY=n):l.filltype?"Vertical"==l.filltype?(e.col=a.range2.left,e.row>=a.range2.top&&e.row<=a.range2.bottom+1&&(e.row=a.range2.bottom+2)):(e.row=a.range2.top,e.col>=a.range2.left&&e.col<=a.range2.right+1&&(e.col=a.range2.right+2)):(10<
Math.abs(n-l.startingY)?l.filltype="Vertical":10<Math.abs(h-l.startingX)&&(l.filltype="Horizontal"),e.col=d.col,e.row=d.row),b.coord=SocialCalc.crToCoord(e.col,e.row),b.coord!=g.mouselastcoord&&(a.MoveECell(b.coord),l.filltype?(d=a.range2.right-a.range2.left+e.col,e=a.range2.bottom-a.range2.top+e.row,a.RangeAnchor(SocialCalc.crToCoord(d,e)),a.RangeExtend()):a.RangeRemove())}l.fillinghandle.style.left=h+"px";l.fillinghandle.style.top=n-17+"px";l.fillinghandle.innerHTML=c.s_CHindicatorOperationLookup[l.dragtype]+
(c.s_CHindicatorDirectionLookup[a.cellhandles.filltype]||"");l.fillinghandle.style.display="block";g.mouselastcoord=b.coord;f.stopPropagation?f.stopPropagation():f.cancelBubble=!0;f.preventDefault?f.preventDefault():f.returnValue=!1}}};
SocialCalc.CellHandlesDragAutoRepeat=function(a,c){var b=SocialCalc.EditorMouseInfo,d=b.editor;if(d){var e=d.cellhandles,f=SocialCalc.coordToCr(d.cellhandles.startingcoord),g=SocialCalc.coordToCr(a),l,h=0,n=0;"left"==c?n=-1:"right"==c?n=1:"up"==c?h=-1:"down"==c&&(h=1);d.ScrollRelativeBoth(h,n);switch(e.dragtype){case "Fill":case "FillC":e.filltype?"Down"==e.filltype?(g.col=f.col,g.row<f.row&&(g.row=f.row)):(g.row=f.row,g.col<f.col&&(g.col=f.col)):(g.col=f.col,g.row=f.row);l=SocialCalc.crToCoord(g.col,
g.row);l!=b.mouselastcoord&&(d.MoveECell(a),d.RangeExtend());break;case "Move":case "MoveC":a!=b.mouselastcoord&&(d.MoveECell(a),e=d.range2.right-d.range2.left+d.ecell.col,g=d.range2.bottom-d.range2.top+d.ecell.row,d.RangeAnchor(SocialCalc.crToCoord(e,g)),d.RangeExtend());break;case "MoveI":case "MoveIC":e.filltype?"Vertical"==e.filltype?(g.col=d.range2.left,g.row>=d.range2.top&&g.row<=d.range2.bottom+1&&(g.row=d.range2.bottom+2)):(g.row=d.range2.top,g.col>=d.range2.left&&g.col<=d.range2.right+1&&
(g.col=d.range2.right+2)):(g.col=f.col,g.row=f.row),l=SocialCalc.crToCoord(g.col,g.row),l!=b.mouselastcoord&&(d.MoveECell(l),e=d.range2.right-d.range2.left+g.col,g=d.range2.bottom-d.range2.top+g.row,d.RangeAnchor(SocialCalc.crToCoord(e,g)),d.RangeExtend())}b.mouselastcoord=l}};
SocialCalc.CellHandlesMouseUp=function(a){var c,b,d,e,f,g=a||window.event,l=SocialCalc.EditorMouseInfo;if(a=l.editor){var h=a.cellhandles;l.ignore=!1;c=SocialCalc.GetElementPositionWithScroll(a.toplevel);c=SocialCalc.GridMousePosition(a,g.clientX-c.left,g.clientY-c.top);SocialCalc.SetDragAutoRepeat(a,null);h.mouseDown=!1;h.noCursorSuffix=!1;h.fillinghandle.style.display="none";c||(c={});c.coord||(c.coord=a.ecell.coord);switch(h.dragtype){case "Fill":case "Move":case "MoveI":b=" all";break;case "FillC":case "MoveC":case "MoveIC":b=
" formulas"}h.movedmouse||(h.dragtype="Nothing");switch(h.dragtype){case "Nothing":a.Range2Remove();a.RangeRemove();break;case "Fill":case "FillC":d=SocialCalc.coordToCr(h.startingcoord);e=SocialCalc.coordToCr(c.coord);h.filltype&&("Down"==h.filltype?e.col=d.col:e.row=d.row);c.coord=SocialCalc.crToCoord(e.col,e.row);a.MoveECell(c.coord);a.RangeExtend();c="Right"==a.cellhandles.filltype?"right":"down";b="fill"+c+" "+SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,
a.range.bottom)+b;a.EditorScheduleSheetCommands(b,!0,!1);break;case "Move":case "MoveC":a.context.cursorsuffix="";b="movepaste "+SocialCalc.crToCoord(a.range2.left,a.range2.top)+":"+SocialCalc.crToCoord(a.range2.right,a.range2.bottom)+" "+a.ecell.coord+b;a.EditorScheduleSheetCommands(b,!0,!1);a.Range2Remove();break;case "MoveI":case "MoveIC":a.context.cursorsuffix="",c=a.range2.right-a.range2.left,d=a.range2.bottom-a.range2.top,e=a.ecell.col-a.range2.left,f=a.ecell.row-a.range2.top,b="moveinsert "+
SocialCalc.crToCoord(a.range2.left,a.range2.top)+":"+SocialCalc.crToCoord(a.range2.right,a.range2.bottom)+" "+a.ecell.coord+b,a.EditorScheduleSheetCommands(b,!0,!1),a.Range2Remove(),a.RangeRemove()," Horizontal"==a.cellhandles.filltype&&0<e?a.MoveECell(SocialCalc.crToCoord(a.ecell.col-c-1,a.ecell.row)):" Vertical"==a.cellhandles.filltype&&0<f&&a.MoveECell(SocialCalc.crToCoord(a.ecell.col,a.ecell.row-d-1)),a.RangeAnchor(SocialCalc.crToCoord(a.ecell.col+c,a.ecell.row+d)),a.RangeExtend()}g.stopPropagation?
g.stopPropagation():g.cancelBubble=!0;g.preventDefault?g.preventDefault():g.returnValue=!1;document.removeEventListener?(document.removeEventListener("mousemove",SocialCalc.CellHandlesMouseMove,!0),document.removeEventListener("mouseup",SocialCalc.CellHandlesMouseUp,!0)):h.draghandle.detachEvent&&(h.draghandle.detachEvent("onlosecapture",SocialCalc.CellHandlesMouseUp),h.draghandle.detachEvent("onmouseup",SocialCalc.CellHandlesMouseUp),h.draghandle.detachEvent("onmousemove",SocialCalc.CellHandlesMouseMove),
h.draghandle.releaseCapture());l.editor=null;return!1}};
SocialCalc.TableControl=function(a,c,b){var d=SocialCalc.Constants;this.editor=a;this.vertical=c;this.size=b;this.thumbpos=this.scrollareasize=this.scrollareaend=this.scrollareastart=this.morebuttonstart=this.lessbuttonstart=this.panesliderstart=this.endcapstart=this.controlborder=this.thumb=this.scrollarea=this.morebutton=this.lessbutton=this.paneslider=this.endcap=this.main=null;this.controlthickness=d.defaultTableControlThickness;this.sliderthickness=d.defaultTCSliderThickness;this.buttonthickness=
d.defaultTCButtonThickness;this.thumbthickness=d.defaultTCThumbThickness;this.minscrollingpanesize=this.buttonthickness+this.buttonthickness+this.thumbthickness+20};SocialCalc.TableControl.prototype.CreateTableControl=function(){return SocialCalc.CreateTableControl(this)};SocialCalc.TableControl.prototype.PositionTableControlElements=function(){SocialCalc.PositionTableControlElements(this)};SocialCalc.TableControl.prototype.ComputeTableControlPositions=function(){SocialCalc.ComputeTableControlPositions(this)};
SocialCalc.CreateTableControl=function(a){var c,b,d=SocialCalc.AssignID,e=SocialCalc.setStyles,f=SocialCalc.Constants,g=a.editor.imageprefix,l=a.vertical?"v":"h";a.main=document.createElement("div");c=a.main.style;c.height=(a.vertical?a.size:a.controlthickness)+"px";c.width=(a.vertical?a.controlthickness:a.size)+"px";c.zIndex=0;e(a.main,f.TCmainStyle);c.backgroundImage="url("+g+"main-"+l+".gif)";f.TCmainClass&&(a.main.className=f.TCmainClass);a.main.style.display="none";a.endcap=document.createElement("div");
c=a.endcap.style;c.height=a.controlthickness+"px";c.width=a.controlthickness+"px";c.zIndex=1;c.overflow="hidden";c.position="absolute";e(a.endcap,f.TCendcapStyle);c.backgroundImage="url("+g+"endcap-"+l+".gif)";f.TCendcapClass&&(a.endcap.className=f.TCendcapClass);d(a.editor,a.endcap,"endcap"+l);a.main.appendChild(a.endcap);a.paneslider=document.createElement("div");c=a.paneslider.style;c.height=(a.vertical?a.sliderthickness:a.controlthickness)+"px";c.overflow="hidden";c.width=(a.vertical?a.controlthickness:
a.sliderthickness)+"px";c.position="absolute";c[a.vertical?"top":"left"]="4px";c.zIndex=3;e(a.paneslider,f.TCpanesliderStyle);c.backgroundImage="url("+g+"paneslider-"+l+".gif)";f.TCpanesliderClass&&(a.paneslider.className=f.TCpanesliderClass);d(a.editor,a.paneslider,"paneslider"+l);(function(c,b,d){f["s_"+b+"Tooltip"+d]&&SocialCalc.TooltipRegister(c,f["s_"+b+"Tooltip"+d],null,a.editor.toplevel)})(a.paneslider,"paneslider",l);c={MouseDown:SocialCalc.TCPSDragFunctionStart,MouseMove:SocialCalc.TCPSDragFunctionMove,
MouseUp:SocialCalc.TCPSDragFunctionStop,Disabled:function(){return a.editor.busy}};c.control=a;SocialCalc.DragRegister(a.paneslider,a.vertical,!a.vertical,c,a.editor.toplevel);a.main.appendChild(a.paneslider);a.lessbutton=document.createElement("div");c=a.lessbutton.style;c.height=(a.vertical?a.buttonthickness:a.controlthickness)+"px";c.width=(a.vertical?a.controlthickness:a.buttonthickness)+"px";c.zIndex=2;c.overflow="hidden";c.position="absolute";e(a.lessbutton,f.TClessbuttonStyle);c.backgroundImage=
"url("+g+"less-"+l+"n.gif)";f.TClessbuttonClass&&(a.lessbutton.className=f.TClessbuttonClass);d(a.editor,a.lessbutton,"lessbutton"+l);b={repeatwait:f.TClessbuttonRepeatWait,repeatinterval:f.TClessbuttonRepeatInterval,normalstyle:"backgroundImage:url("+g+"less-"+l+"n.gif);",downstyle:"backgroundImage:url("+g+"less-"+l+"d.gif);",hoverstyle:"backgroundImage:url("+g+"less-"+l+"h.gif);"};c={MouseDown:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,-1)},Repeat:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,
-1)},Disabled:function(){return a.editor.busy}};SocialCalc.ButtonRegister(a.editor,a.lessbutton,b,c);a.main.appendChild(a.lessbutton);a.morebutton=document.createElement("div");c=a.morebutton.style;c.height=(a.vertical?a.buttonthickness:a.controlthickness)+"px";c.width=(a.vertical?a.controlthickness:a.buttonthickness)+"px";c.zIndex=2;c.overflow="hidden";c.position="absolute";e(a.morebutton,f.TCmorebuttonStyle);c.backgroundImage="url("+g+"more-"+l+"n.gif)";f.TCmorebuttonClass&&(a.morebutton.className=
f.TCmorebuttonClass);d(a.editor,a.morebutton,"morebutton"+l);b={repeatwait:f.TCmorebuttonRepeatWait,repeatinterval:f.TCmorebuttonRepeatInterval,normalstyle:"backgroundImage:url("+g+"more-"+l+"n.gif);",downstyle:"backgroundImage:url("+g+"more-"+l+"d.gif);",hoverstyle:"backgroundImage:url("+g+"more-"+l+"h.gif);"};c={MouseDown:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,1)},Repeat:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,1)},Disabled:function(){return a.editor.busy}};
SocialCalc.ButtonRegister(a.editor,a.morebutton,b,c);a.main.appendChild(a.morebutton);a.scrollarea=document.createElement("div");c=a.scrollarea.style;c.height=a.controlthickness+"px";c.width=a.controlthickness+"px";c.zIndex=1;c.overflow="hidden";c.position="absolute";e(a.scrollarea,f.TCscrollareaStyle);c.backgroundImage="url("+g+"scrollarea-"+l+".gif)";f.TCscrollareaClass&&(a.scrollarea.className=f.TCscrollareaClass);d(a.editor,a.scrollarea,"scrollarea"+l);b={repeatwait:f.TCscrollareaRepeatWait,repeatinterval:f.TCscrollareaRepeatWait};
c={MouseDown:SocialCalc.ScrollAreaClick,Repeat:SocialCalc.ScrollAreaClick,Disabled:function(){return a.editor.busy}};c.control=a;SocialCalc.ButtonRegister(a.editor,a.scrollarea,b,c);a.main.appendChild(a.scrollarea);a.thumb=document.createElement("div");c=a.thumb.style;c.height=(a.vertical?a.thumbthickness:a.controlthickness)+"px";c.width=(a.vertical?a.controlthickness:a.thumbthickness)+"px";c.zIndex=2;c.overflow="hidden";c.position="absolute";e(a.thumb,f.TCthumbStyle);a.thumb.style.backgroundImage=
"url("+g+"thumb-"+l+"n.gif)";f.TCthumbClass&&(a.thumb.className=f.TCthumbClass);d(a.editor,a.thumb,"thumb"+l);c={MouseDown:SocialCalc.TCTDragFunctionStart,MouseMove:SocialCalc.TCTDragFunctionMove,MouseUp:SocialCalc.TCTDragFunctionStop,Disabled:function(){return a.editor.busy}};c.control=a;SocialCalc.DragRegister(a.thumb,a.vertical,!a.vertical,c,a.editor.toplevel);b={normalstyle:"backgroundImage:url("+g+"thumb-"+l+"n.gif)",name:"Thumb",downstyle:"backgroundImage:url("+g+"thumb-"+l+"d.gif)",hoverstyle:"backgroundImage:url("+
g+"thumb-"+l+"h.gif)"};SocialCalc.ButtonRegister(a.editor,a.thumb,b,null);a.main.appendChild(a.thumb);return a.main};SocialCalc.ScrollAreaClick=function(a,c,b){a=b.functionobj.control;b=SocialCalc.GetElementPositionWithScroll(a.editor.toplevel);c=a.vertical?c.clientY-b.top:c.clientX-b.left;a.editor.busy||a.editor.PageRelative(a.vertical,c>a.thumbpos?1:-1)};
SocialCalc.PositionTableControlElements=function(a){var c,b,d=a.editor;a.vertical?(c=a.controlborder+"px",a.endcap.style.top=a.endcapstart+"px",a.endcap.style.left=c,a.paneslider.style.top=a.panesliderstart+"px",a.paneslider.style.left=c,a.lessbutton.style.top=a.lessbuttonstart+"px",a.lessbutton.style.left=c,a.morebutton.style.top=a.morebuttonstart+"px",a.morebutton.style.left=c,a.scrollarea.style.top=a.scrollareastart+"px",a.scrollarea.style.left=c,a.scrollarea.style.height=a.scrollareasize+"px",
b=Math.max(d.context.sheetobj.attribs.lastrow,d.firstscrollingrow+1),b=(d.firstscrollingrow-(d.lastnonscrollingrow+1))*(a.scrollareasize-3*a.thumbthickness)/(b-(d.lastnonscrollingrow+1))+a.scrollareastart-1,b=Math.floor(b),a.thumb.style.top=b+"px",a.thumb.style.left=c):(c=a.controlborder+"px",a.endcap.style.left=a.endcapstart+"px",a.endcap.style.top=c,a.paneslider.style.left=a.panesliderstart+"px",a.paneslider.style.top=c,a.lessbutton.style.left=a.lessbuttonstart+"px",a.lessbutton.style.top=c,a.morebutton.style.left=
a.morebuttonstart+"px",a.morebutton.style.top=c,a.scrollarea.style.left=a.scrollareastart+"px",a.scrollarea.style.top=c,a.scrollarea.style.width=a.scrollareasize+"px",b=Math.max(d.context.sheetobj.attribs.lastcol,d.firstscrollingcol+1),b=(d.firstscrollingcol-(d.lastnonscrollingcol+1))*(a.scrollareasize-a.thumbthickness)/(b-d.lastnonscrollingcol)+a.scrollareastart-1,b=Math.floor(b),a.thumb.style.left=b+"px",a.thumb.style.top=c);a.thumbpos=b;a.main.style.display="block"};
SocialCalc.ComputeTableControlPositions=function(a){var c=a.editor;if(!c.gridposition||!c.headposition)throw"Can't compute table control positions before editor positions";a.vertical?(a.controlborder=c.gridposition.left+c.tablewidth,a.endcapstart=c.gridposition.top,a.panesliderstart=c.firstscrollingrowtop-a.sliderthickness,a.lessbuttonstart=c.firstscrollingrowtop-1,a.morebuttonstart=c.gridposition.top+c.tableheight-a.buttonthickness,a.scrollareastart=c.firstscrollingrowtop-1+a.buttonthickness):(a.controlborder=
c.gridposition.top+c.tableheight,a.endcapstart=c.gridposition.left,a.panesliderstart=c.firstscrollingcolleft-a.sliderthickness,a.lessbuttonstart=c.firstscrollingcolleft-1,a.morebuttonstart=c.gridposition.left+c.tablewidth-a.buttonthickness,a.scrollareastart=c.firstscrollingcolleft-1+a.buttonthickness);a.scrollareaend=a.morebuttonstart-1;a.scrollareasize=a.scrollareaend-a.scrollareastart+1};
SocialCalc.TCPSDragFunctionStart=function(a,c,b){var d=b.functionobj.control.editor,e=SocialCalc.Constants;SocialCalc.DragFunctionStart(a,c,b);c.trackingline=document.createElement("div");c.trackingline.style.height=b.vertical?e.TCPStrackinglineThickness:d.tableheight-(d.headposition.top-d.gridposition.top)+"px";c.trackingline.style.width=b.vertical?d.tablewidth-(d.headposition.left-d.gridposition.left)+"px":e.TCPStrackinglineThickness;c.trackingline.style.backgroundImage="url("+d.imageprefix+"trackingline-"+
(b.vertical?"v":"h")+".gif)";e.TCPStrackinglineClass&&(c.trackingline.className=e.TCPStrackinglineClass);SocialCalc.setStyles(c.trackingline,e.TCPStrackinglineStyle);b.vertical?(row=SocialCalc.Lookup(c.clientY+b.functionobj.control.sliderthickness,d.rowpositions),c.trackingline.style.top=(d.rowpositions[row]||d.headposition.top)+"px",c.trackingline.style.left=d.headposition.left+"px",d.context.rowpanes.length-1&&(d.context.SetRowPaneFirstLast(1,d.context.rowpanes[0].last+1,d.context.rowpanes[0].last+
1),d.FitToEditTable(),d.ScheduleRender())):(col=SocialCalc.Lookup(c.clientX+b.functionobj.control.sliderthickness,d.colpositions),c.trackingline.style.top=d.headposition.top+"px",c.trackingline.style.left=(d.colpositions[col]||d.headposition.left)+"px",d.context.colpanes.length-1&&(d.context.SetColPaneFirstLast(1,d.context.colpanes[0].last+1,d.context.colpanes[0].last+1),d.FitToEditTable(),d.ScheduleRender()));d.griddiv.appendChild(c.trackingline)};
SocialCalc.TCPSDragFunctionMove=function(a,c,b){var d,e;e=b.functionobj.control;d=e.sliderthickness;var f=e.editor;if(b.vertical){e=e.morebuttonstart-e.minscrollingpanesize-c.offsetY;c.clientY>e&&(c.clientY=e);e=f.headposition.top-d-c.offsetY;c.clientY<e&&(c.clientY=e);for(d=SocialCalc.Lookup(c.clientY+d,f.rowpositions);"yes"==f.context.sheetobj.rowattribs.hide[d];)d++;c.trackingline.style.top=(f.rowpositions[d]||f.headposition.top)+"px"}else{e=e.morebuttonstart-e.minscrollingpanesize-c.offsetX;c.clientX>
e&&(c.clientX=e);e=f.headposition.left-d-c.offsetX;c.clientX<e&&(c.clientX=e);for(d=SocialCalc.Lookup(c.clientX+d,f.colpositions);"yes"==f.context.sheetobj.colattribs.hide[SocialCalc.rcColname(d)];)d++;c.trackingline.style.left=(f.colpositions[d]||f.headposition.left)+"px"}SocialCalc.DragFunctionPosition(a,c,b)};
SocialCalc.TCPSDragFunctionStop=function(a,c,b){var d,e=b.functionobj.control;d=e.sliderthickness;a=e.editor;if(b.vertical){b=e.morebuttonstart-e.minscrollingpanesize-c.offsetY;c.clientY>b&&(c.clientY=b);b=a.headposition.top-d-c.offsetY;c.clientY<b&&(c.clientY=b);d=SocialCalc.Lookup(c.clientY+d,a.rowpositions);d>a.context.sheetobj.attribs.lastrow&&(d=a.context.sheetobj.attribs.lastrow);for(;"yes"==a.context.sheetobj.rowattribs.hide[d];)d++;!d||d<=a.context.rowpanes[0].first?1<a.context.rowpanes.length&&
(a.context.rowpanes.length=1):a.context.rowpanes.length-1?a.timeout||(a.context.SetRowPaneFirstLast(0,a.context.rowpanes[0].first,d-1),a.context.SetRowPaneFirstLast(1,d,d)):(a.context.SetRowPaneFirstLast(0,a.context.rowpanes[0].first,d-1),a.context.SetRowPaneFirstLast(1,d,d))}else{b=e.morebuttonstart-e.minscrollingpanesize-c.offsetX;c.clientX>b&&(c.clientX=b);b=a.headposition.left-d-c.offsetX;c.clientX<b&&(c.clientX=b);d=SocialCalc.Lookup(c.clientX+d,a.colpositions);d>a.context.sheetobj.attribs.lastcol&&
(d=a.context.sheetobj.attribs.lastcol);for(;"yes"==a.context.sheetobj.colattribs.hide[SocialCalc.rcColname(d)];)d++;!d||d<=a.context.colpanes[0].first?1<a.context.colpanes.length&&(a.context.colpanes.length=1):a.context.colpanes.length-1?a.timeout||(a.context.SetColPaneFirstLast(0,a.context.colpanes[0].first,d-1),a.context.SetColPaneFirstLast(1,d,d)):(a.context.SetColPaneFirstLast(0,a.context.colpanes[0].first,d-1),a.context.SetColPaneFirstLast(1,d,d))}a.FitToEditTable();a.griddiv.removeChild(c.trackingline);
a.ScheduleRender()};
SocialCalc.TCTDragFunctionStart=function(a,c,b){var d=b.functionobj.control,e=d.editor,f=SocialCalc.Constants;SocialCalc.DragFunctionStart(a,c,b);c.thumbstatus&&(c.thumbstatus.rowmsgele&&(c.thumbstatus.rowmsgele=null),c.thumbstatus.rowpreviewele&&(c.thumbstatus.rowpreviewele=null),e.toplevel.removeChild(c.thumbstatus),c.thumbstatus=null);c.thumbstatus=document.createElement("div");b.vertical?(f.TCTDFSthumbstatusvClass&&(c.thumbstatus.className=f.TCTDFSthumbstatusvClass),SocialCalc.setStyles(c.thumbstatus,f.TCTDFSthumbstatusvStyle),
c.thumbstatus.style.top=c.clientY+f.TCTDFStopOffsetv+"px",c.thumbstatus.style.left=d.controlborder-10-e.tablewidth/2+"px",c.thumbstatus.style.width=e.tablewidth/2+"px",c.thumbcontext=new SocialCalc.RenderContext(e.context.sheetobj),c.thumbcontext.showGrid=!0,c.thumbcontext.rowpanes=[{first:1,last:1}],a=e.context.colpanes[e.context.colpanes.length-1],c.thumbcontext.colpanes=[{first:a.first,last:a.last}],c.thumbstatus.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td valign="top" style="'+f.TCTDFSthumbstatusrownumStyle+
'" class="'+f.TCTDFSthumbstatusrownumClass+'"><div>msg</div></td><td valign="top"><div style="overflow:hidden;">preview</div></td></tr></table>',c.thumbstatus.rowmsgele=c.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild,c.thumbstatus.rowpreviewele=c.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild,e.toplevel.appendChild(c.thumbstatus),SocialCalc.TCTDragFunctionRowSetStatus(c,e,e.firstscrollingrow||1)):(f.TCTDFSthumbstatushClass&&(c.thumbstatus.className=f.TCTDFSthumbstatushClass),
SocialCalc.setStyles(c.thumbstatus,f.TCTDFSthumbstatushStyle),c.thumbstatus.style.top=d.controlborder+f.TCTDFStopOffseth+"px",c.thumbstatus.style.left=c.clientX+f.TCTDFSleftOffseth+"px",e.toplevel.appendChild(c.thumbstatus),c.thumbstatus.innerHTML=f.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(e.firstscrollingcol))};
SocialCalc.TCTDragFunctionRowSetStatus=function(a,c,b){a.thumbstatus.rowmsgele.innerHTML=SocialCalc.Constants.s_TCTDFthumbstatusPrefixv+b+" ";a.thumbcontext.rowpanes=[{first:b,last:b}];a.thumbrowshown=b;a.thumbcontext.RenderSheet(a.thumbstatus.rowpreviewele.firstChild,{type:"html"})};
SocialCalc.TCTDragFunctionMove=function(a,c,b){var d,e;d=b.functionobj.control;e=d.editor;var f=SocialCalc.Constants;b.vertical?(c.clientY>d.scrollareaend-c.offsetY-d.thumbthickness+2&&(c.clientY=d.scrollareaend-c.offsetY-d.thumbthickness+2),c.clientY<d.scrollareastart-c.offsetY-1&&(c.clientY=d.scrollareastart-c.offsetY-1),c.thumbstatus.style.top=c.clientY+"px",d=(c.clientY+c.offsetY-d.scrollareastart+1)/(d.scrollareasize-d.thumbthickness)*(e.context.sheetobj.attribs.lastrow-e.lastnonscrollingrow)+
e.lastnonscrollingrow+1,d=Math.floor(d),d<=e.lastnonscrollingrow&&(d=e.lastnonscrollingrow+1),d>e.context.sheetobj.attribs.lastrow&&(d=e.context.sheetobj.attribs.lastrow),d!=c.thumbrowshown&&SocialCalc.TCTDragFunctionRowSetStatus(c,e,d)):(c.clientX>d.scrollareaend-c.offsetX-d.thumbthickness+2&&(c.clientX=d.scrollareaend-c.offsetX-d.thumbthickness+2),c.clientX<d.scrollareastart-c.offsetX-1&&(c.clientX=d.scrollareastart-c.offsetX-1),c.thumbstatus.style.left=c.clientX+"px",d=(c.clientX+c.offsetX-d.scrollareastart+
1)/(d.scrollareasize-d.thumbthickness)*(e.context.sheetobj.attribs.lastcol-e.lastnonscrollingcol)+e.lastnonscrollingcol+1,d=Math.floor(d),d<=e.lastnonscrollingcol&&(d=e.lastnonscrollingcol+1),d>e.context.sheetobj.attribs.lastcol&&(d=e.context.sheetobj.attribs.lastcol),e=f.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(d),c.thumbstatus.innerHTML=e);SocialCalc.DragFunctionPosition(a,c,b)};
SocialCalc.TCTDragFunctionStop=function(a,c,b){var d=b.functionobj.control;a=d.editor;b.vertical?(b=(c.clientY+c.offsetY-d.scrollareastart+1)/(d.scrollareasize-d.thumbthickness)*(a.context.sheetobj.attribs.lastrow-a.lastnonscrollingrow)+a.lastnonscrollingrow+1,b=Math.floor(b),b<=a.lastnonscrollingrow&&(b=a.lastnonscrollingrow+1),b>a.context.sheetobj.attribs.lastrow&&(b=a.context.sheetobj.attribs.lastrow),a.context.SetRowPaneFirstLast(a.context.rowpanes.length-1,b,b+1)):(b=(c.clientX+c.offsetX-d.scrollareastart+
1)/(d.scrollareasize-d.thumbthickness)*(a.context.sheetobj.attribs.lastcol-a.lastnonscrollingcol)+a.lastnonscrollingcol+1,b=Math.floor(b),b<=a.lastnonscrollingcol&&(b=a.lastnonscrollingcol+1),b>a.context.sheetobj.attribs.lastcol&&(b=a.context.sheetobj.attribs.lastcol),a.context.SetColPaneFirstLast(a.context.colpanes.length-1,b,b+1));a.FitToEditTable();c.thumbstatus.rowmsgele&&(c.thumbstatus.rowmsgele=null);c.thumbstatus.rowpreviewele&&(c.thumbstatus.rowpreviewele=null);a.toplevel.removeChild(c.thumbstatus);
c.thumbstatus=null;a.ScheduleRender()};SocialCalc.DragInfo={registeredElements:[],draggingElement:null,startX:0,startY:0,startZ:0,clientX:0,clientY:0,offsetX:0,offsetY:0,relativeOffset:{left:0,top:0}};
SocialCalc.DragRegister=function(a,c,b,d,e){var f=SocialCalc.DragInfo;d||(d={MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null});f.registeredElements.push({element:a,vertical:c,horizontal:b,functionobj:d,parent:e});if(a.addEventListener)a.addEventListener("mousedown",SocialCalc.DragMouseDown,!1);else if(a.attachEvent)a.attachEvent("onmousedown",SocialCalc.DragMouseDown);else throw SocialCalc.Constants.s_BrowserNotSupported;
};SocialCalc.DragUnregister=function(a){var c=SocialCalc.DragInfo,b;if(a)for(b=0;b<c.registeredElements.length;b++)if(c.registeredElements[b].element==a){c.registeredElements.splice(b,1);a.removeEventListener?a.removeEventListener("mousedown",SocialCalc.DragMouseDown,!1):a.detachEvent("onmousedown",SocialCalc.DragMouseDown);break}};
SocialCalc.DragMouseDown=function(a){a=a||window.event;var c=SocialCalc.DragInfo,b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);if(b&&!(b&&(b.functionobj&&b.functionobj.Disabled)&&b.functionobj.Disabled(a,c,b)))return c.draggingElement=b,b.parent&&(c.relativeOffset=SocialCalc.GetElementPositionWithScroll(b.parent)),c.clientX=a.clientX-c.relativeOffset.left,c.clientY=a.clientY-c.relativeOffset.top,c.startX=c.clientX,c.startY=c.clientY,c.startZ=b.element.style.zIndex,c.offsetX=
0,c.offsetY=0,b.element.style.zIndex="100",document.addEventListener?(document.addEventListener("mousemove",SocialCalc.DragMouseMove,!0),document.addEventListener("mouseup",SocialCalc.DragMouseUp,!0)):b.element.attachEvent&&(b.element.setCapture(),b.element.attachEvent("onmousemove",SocialCalc.DragMouseMove),b.element.attachEvent("onmouseup",SocialCalc.DragMouseUp),b.element.attachEvent("onlosecapture",SocialCalc.DragMouseUp)),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?
a.preventDefault():a.returnValue=!1,b&&(b.functionobj&&b.functionobj.MouseDown)&&b.functionobj.MouseDown(a,c,b),!1};SocialCalc.DragMouseMove=function(a){a=a||window.event;var c=SocialCalc.DragInfo,b=c.draggingElement;c.clientX=a.clientX-c.relativeOffset.left;c.clientY=a.clientY-c.relativeOffset.top;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;b&&(b.functionobj&&b.functionobj.MouseMove)&&b.functionobj.MouseMove(a,c,b);return!1};
SocialCalc.DragMouseUp=function(a){a=a||window.event;var c=SocialCalc.DragInfo,b=c.draggingElement;c.clientX=a.clientX-c.relativeOffset.left;c.clientY=a.clientY-c.relativeOffset.top;b.element.style.zIndex=c.startZ;b&&(b.functionobj&&b.functionobj.MouseUp)&&b.functionobj.MouseUp(a,c,b);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;document.removeEventListener?(document.removeEventListener("mousemove",SocialCalc.DragMouseMove,!0),document.removeEventListener("mouseup",SocialCalc.DragMouseUp,
!0)):b.element.detachEvent&&(b.element.detachEvent("onlosecapture",SocialCalc.DragMouseUp),b.element.detachEvent("onmouseup",SocialCalc.DragMouseUp),b.element.detachEvent("onmousemove",SocialCalc.DragMouseMove),b.element.releaseCapture());c.draggingElement=null;return!1};SocialCalc.DragFunctionStart=function(a,c,b){a=b.functionobj.positionobj||b.element;c.offsetY=parseInt(a.style.top)-c.clientY;c.offsetX=parseInt(a.style.left)-c.clientX};
SocialCalc.DragFunctionPosition=function(a,c,b){a=b.functionobj.positionobj||b.element;b.vertical&&(a.style.top=c.clientY+c.offsetY+"px");b.horizontal&&(a.style.left=c.clientX+c.offsetX+"px")};SocialCalc.TooltipInfo={registeredElements:[],registered:!1,tooltipElement:null,timer:null,popupElement:null,clientX:0,clientY:0,offsetX:SocialCalc.Constants.TooltipOffsetX,offsetY:SocialCalc.Constants.TooltipOffsetY};
SocialCalc.TooltipRegister=function(a,c,b,d){var e=SocialCalc.TooltipInfo;e.registeredElements.push({element:a,tiptext:c,functionobj:b,parent:d});if(!e.registered){if(document.addEventListener)document.addEventListener("mousemove",SocialCalc.TooltipMouseMove,!1);else if(document.attachEvent)document.attachEvent("onmousemove",SocialCalc.TooltipMouseMove);else throw SocialCalc.Constants.s_BrowserNotSupported;e.registered=!0}};
SocialCalc.TooltipMouseMove=function(a){var c=a||window.event;a=SocialCalc.TooltipInfo;a.clientX=c.clientX;a.clientY=c.clientY;c=SocialCalc.LookupElement(c.target||c.srcElement,a.registeredElements);a.timer&&(window.clearTimeout(a.timer),a.timer=null);a.popupElement&&SocialCalc.TooltipHide();a.tooltipElement=c||null;c&&!SocialCalc.ButtonInfo.buttonDown&&(a.timer=window.setTimeout(SocialCalc.TooltipWaitDone,700),a.tooltipElement.element.addEventListener?a.tooltipElement.element.addEventListener("mousedown",
SocialCalc.TooltipMouseDown,!1):a.tooltipElement.element.attachEvent&&a.tooltipElement.element.attachEvent("onmousedown",SocialCalc.TooltipMouseDown))};
SocialCalc.TooltipMouseDown=function(a){a=SocialCalc.TooltipInfo;a.timer&&(window.clearTimeout(a.timer),a.timer=null);a.popupElement&&SocialCalc.TooltipHide();a.tooltipElement&&(a.tooltipElement.element.removeEventListener?a.tooltipElement.element.removeEventListener("mousedown",SocialCalc.TooltipMouseDown,!1):a.tooltipElement.element.attachEvent&&a.tooltipElement.element.detachEvent("onmousedown",SocialCalc.TooltipMouseDown),a.tooltipElement=null)};
SocialCalc.TooltipDisplay=function(a){var c=SocialCalc.TooltipInfo,b=SocialCalc.Constants,d=a.functionobj&&"number"==typeof a.functionobj.offsetx?a.functionobj.offsetx:c.offsetX,e=a.functionobj&&"number"==typeof a.functionobj.offsety?a.functionobj.offsety:c.offsetY,f=SocialCalc.GetViewportInfo(),g=SocialCalc.GetElementPositionWithScroll(a.parent);c.popupElement=document.createElement("div");b.TDpopupElementClass&&(c.popupElement.className=b.TDpopupElementClass);SocialCalc.setStyles(c.popupElement,
b.TDpopupElementStyle);c.popupElement.innerHTML=a.tiptext;c.clientX>f.width/2?(c.popupElement.style.bottom=g.height-c.clientY+e+g.top+"px",c.popupElement.style.right=g.width-c.clientX+d+g.left+"px"):(c.popupElement.style.bottom=g.height-c.clientY+e+g.top+"px",c.popupElement.style.left=c.clientX+d-g.left+"px");50>c.clientY&&(c.popupElement.style.bottom=g.height-c.clientY+e-50+g.top+"px");a.parent.appendChild(c.popupElement)};
SocialCalc.TooltipHide=function(){var a=SocialCalc.TooltipInfo;a.popupElement&&(a.popupElement.parentNode.removeChild(a.popupElement),a.popupElement=null)};SocialCalc.TooltipWaitDone=function(){var a=SocialCalc.TooltipInfo;a.timer=null;SocialCalc.TooltipDisplay(a.tooltipElement)};SocialCalc.ButtonInfo={registeredElements:[],buttonElement:null,doingHover:!1,buttonDown:!1,timer:null,relativeOffset:null,clientX:0,clientY:0};
SocialCalc.ButtonRegister=function(a,c,b,d){var e=SocialCalc.ButtonInfo;b||(b={});e.registeredElements.push({name:b.name,element:c,editor:a,normalstyle:b.normalstyle,hoverstyle:b.hoverstyle,downstyle:b.downstyle,repeatwait:b.repeatwait,repeatinterval:b.repeatinterval,functionobj:d});if(c.addEventListener)c.addEventListener("mousedown",SocialCalc.ButtonMouseDown,!1),c.addEventListener("mouseover",SocialCalc.ButtonMouseOver,!1),c.addEventListener("mouseout",SocialCalc.ButtonMouseOut,!1);else if(c.attachEvent)c.attachEvent("onmousedown",
SocialCalc.ButtonMouseDown),c.attachEvent("onmouseover",SocialCalc.ButtonMouseOver),c.attachEvent("onmouseout",SocialCalc.ButtonMouseOut);else throw SocialCalc.Constants.s_BrowserNotSupported;};
SocialCalc.ButtonMouseOver=function(a){a=a||window.event;var c=SocialCalc.ButtonInfo,b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);b&&(c.buttonDown?c.buttonElement==b&&(c.doingHover=!0):(c.buttonElement&&(c.buttonElement!=b&&c.doingHover)&&SocialCalc.setStyles(c.buttonElement.element,c.buttonElement.normalstyle),c.buttonElement=b,c.doingHover=!0,SocialCalc.setStyles(b.element,b.hoverstyle),b&&(b.functionobj&&b.functionobj.MouseOver)&&b.functionobj.MouseOver(a,c,b)))};
SocialCalc.ButtonMouseOut=function(a){a=a||window.event;var c=SocialCalc.ButtonInfo;if(c.buttonDown)c.doingHover=!1;else{var b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);c.doingHover&&(c.buttonElement&&SocialCalc.setStyles(c.buttonElement.element,c.buttonElement.normalstyle),c.buttonElement=null,c.doingHover=!1);b&&(b.functionobj&&b.functionobj.MouseOut)&&b.functionobj.MouseOut(a,c,b)}};
SocialCalc.ButtonMouseDown=function(a){a=a||window.event;var c=SocialCalc.ButtonInfo;SocialCalc.GetViewportInfo();var b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);!b||b&&(b.functionobj&&b.functionobj.Disabled)&&b.functionobj.Disabled(a,c,b)||(c.buttonElement=b,c.buttonDown=!0,SocialCalc.setStyles(b.element,c.buttonElement.downstyle),document.addEventListener?document.addEventListener("mouseup",SocialCalc.ButtonMouseUp,!0):b.element.attachEvent&&(b.element.setCapture(),b.element.attachEvent("onmouseup",
SocialCalc.ButtonMouseUp),b.element.attachEvent("onlosecapture",SocialCalc.ButtonMouseUp)),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,c.relativeOffset=SocialCalc.GetElementPositionWithScroll(b.editor.toplevel),c.clientX=a.clientX-c.relativeOffset.left,c.clientY=a.clientY-c.relativeOffset.top,b&&(b.functionobj&&b.functionobj.MouseDown)&&b.functionobj.MouseDown(a,c,b),b.repeatwait&&(c.timer=window.setTimeout(SocialCalc.ButtonRepeat,b.repeatwait)))};
SocialCalc.ButtonMouseUp=function(a){a=a||window.event;var c=SocialCalc.ButtonInfo,b=c.buttonElement;c.timer&&(window.clearTimeout(c.timer),c.timer=null);c.buttonDown&&(a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,document.removeEventListener?document.removeEventListener("mouseup",SocialCalc.ButtonMouseUp,!0):document.detachEvent&&(b.element.detachEvent("onlosecapture",SocialCalc.ButtonMouseUp),b.element.detachEvent("onmouseup",SocialCalc.ButtonMouseUp),
b.element.releaseCapture()),c.buttonElement.downstyle&&(c.doingHover?SocialCalc.setStyles(b.element,c.buttonElement.hoverstyle):SocialCalc.setStyles(b.element,c.buttonElement.normalstyle)),c.buttonDown=!1,b&&(b.functionobj&&b.functionobj.MouseUp)&&b.functionobj.MouseUp(a,c,b))};
SocialCalc.ButtonRepeat=function(){var a=SocialCalc.ButtonInfo,c=a.buttonElement;c&&(c&&(c.functionobj&&c.functionobj.Repeat)&&c.functionobj.Repeat(null,a,c),a.timer=window.setTimeout(SocialCalc.ButtonRepeat,c.repeatinterval||100))};SocialCalc.MouseWheelInfo={registeredElements:[]};
SocialCalc.MouseWheelRegister=function(a,c){SocialCalc.MouseWheelInfo.registeredElements.push({element:a,functionobj:c});if(a.addEventListener)a.addEventListener("DOMMouseScroll",SocialCalc.ProcessMouseWheel,!1),a.addEventListener("mousewheel",SocialCalc.ProcessMouseWheel,!1);else if(a.attachEvent)a.attachEvent("onmousewheel",SocialCalc.ProcessMouseWheel);else throw SocialCalc.Constants.s_BrowserNotSupported;};
SocialCalc.ProcessMouseWheel=function(a){a=a||window.event;var c;if(!SocialCalc.Keyboard.passThru){var b=SocialCalc.MouseWheelInfo;c=a.target||a.srcElement;var d;for(d=null;!d&&c;c=c.parentNode)d=SocialCalc.LookupElement(c,b.registeredElements);d&&((c=a.wheelDelta?a.wheelDelta/120:-a.detail/3)||(c=0),d.functionobj&&d.functionobj.WheelMove&&d.functionobj.WheelMove(a,c,b,d),a.preventDefault&&a.preventDefault(),a.returnValue=!1)}};
SocialCalc.keyboardTables={specialKeysCommon:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},specialKeysIE:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysIE:{67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",
88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysOpera:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysOpera:{67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysSafari:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",63232:"[aup]",63233:"[adown]",63234:"[aleft]",63235:"[aright]",63272:"[del]",63273:"[home]",
63275:"[end]",63276:"[pgup]",63277:"[pgdn]",63237:"[f2]"},controlKeysSafari:{99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysSafari:{63236:"[f1]",63238:"[f3]",63239:"[f4]",63240:"[f5]",63241:"[f6]",63242:"[f7]",63243:"[f8]",63244:"[f9]",63245:"[f10]",63246:"[f11]",63247:"[f12]",63289:"[numlock]"},specialKeysFirefox:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",
40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysFirefox:{99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysFirefox:{16:"[shift]",17:"[ctrl]",18:"[alt]",20:"[capslock]",19:"[pause]",44:"[printscreen]",91:"[windows]",92:"[windows]",112:"[f1]",114:"[f3]",115:"[f4]",116:"[f5]",117:"[f6]",118:"[f7]",119:"[f8]",120:"[f9]",121:"[f10]",122:"[f11]",123:"[f12]",144:"[numlock]",145:"[scrolllock]",224:"[cmd]"}};
SocialCalc.Keyboard={areListener:!1,focusTable:null,passThru:null,didProcessKey:!1,statusFromProcessKey:!1,repeatingKeyPress:!1,chForProcessKey:""};
SocialCalc.KeyboardSetFocus=function(a){SocialCalc.Keyboard.focusTable=a;SocialCalc.Keyboard.areListener||(document.onkeydown=SocialCalc.ProcessKeyDown,document.onkeypress=SocialCalc.ProcessKeyPress,SocialCalc.Keyboard.areListener=!0);SocialCalc.Keyboard.passThru&&(SocialCalc.Keyboard.passThru.blur&&SocialCalc.Keyboard.passThru.blur(),SocialCalc.Keyboard.passThru=null);window.focus()};SocialCalc.KeyboardFocus=function(){SocialCalc.Keyboard.passThru=null;window.focus()};
SocialCalc.ProcessKeyDown=function(a){var c=SocialCalc.keyboardTables;c.didProcessKey=!1;c.statusFromProcessKey=!1;c.repeatingKeyPress=!1;var b="",d=!0;if(!SocialCalc.Keyboard.passThru){a=a||window.event;if(void 0==a.which){b=c.specialKeysCommon[a.keyCode];if(!b&&(a.ctrlKey&&(b=c.controlKeysIE[a.keyCode]),!b))return!0;d=SocialCalc.ProcessKey(b,a);d||(a.preventDefault&&a.preventDefault(),a.returnValue=!1)}else{b=c.specialKeysCommon[a.keyCode];if(!b){if(a.ctrlKey||a.metaKey)b=c.controlKeysIE[a.keyCode];
if(!b)return!0}d=SocialCalc.ProcessKey(b,a);c.didProcessKey=!0;c.statusFromProcessKey=d;c.chForProcessKey=b}return d}};
SocialCalc.ProcessKeyPress=function(a){var c=SocialCalc.keyboardTables,b="";a=a||window.event;if(!SocialCalc.Keyboard.passThru){if(c.didProcessKey){if(c.repeatingKeyPress)return SocialCalc.ProcessKey(c.chForProcessKey,a);c.repeatingKeyPress=!0;return c.statusFromProcessKey}if(void 0==a.which)b=String.fromCharCode(a.keyCode);else{if(!a.which)return!1;if(void 0==a.charCode)if(0!=a.which)if(32>a.which||144==a.which){if(b=c.specialKeysOpera[a.which])return!0}else b=a.ctrlKey?c.controlKeysOpera[a.keyCode]:
String.fromCharCode(a.which);else return!0;else{if(0==a.keyCode&&0==a.charCode)return;if(a.keyCode==a.charCode){if(b=c.specialKeysSafari[a.keyCode],!b){if(c.ignoreKeysSafari[a.keyCode])return!0;b=a.metaKey?c.controlKeysSafari[a.keyCode]:String.fromCharCode(a.which)}}else{if(c.specialKeysFirefox[a.keyCode])return!0;b=String.fromCharCode(a.which);if(a.ctrlKey||a.metaKey)b=c.controlKeysFirefox[a.which]}}}c=SocialCalc.ProcessKey(b,a);c||(a.preventDefault&&a.preventDefault(),a.returnValue=!1);return c}};
SocialCalc.ProcessKey=function(a,c){var b=SocialCalc.Keyboard.focusTable;return b?b.EditorProcessKey(a,c):!0};SocialCalc||(SocialCalc={});SocialCalc.FormatNumber={};SocialCalc.FormatNumber.format_definitions={};SocialCalc.FormatNumber.separatorchar=",";SocialCalc.FormatNumber.decimalchar=".";SocialCalc.FormatNumber.daynames="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");SocialCalc.FormatNumber.daynames3="Sun Mon Tue Wed Thu Fri Sat".split(" ");SocialCalc.FormatNumber.monthnames3="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");SocialCalc.FormatNumber.monthnames="January February March April May June July August September October November December".split(" ");
SocialCalc.FormatNumber.allowedcolors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"};SocialCalc.FormatNumber.alloweddates={H:"h]",M:"m]",MM:"mm]",S:"s]",SS:"ss]"};SocialCalc.FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12};
SocialCalc.FormatNumber.datevalues={julian_offset:2415019,seconds_in_a_day:86400,seconds_in_an_hour:3600};
SocialCalc.FormatNumber.formatNumberWithFormat=function(a,c,b){b=SocialCalc.Constants;var d=SocialCalc.FormatNumber,e,f,g,l,h,n,p,r,t,q,s,u="",v,w,x,y,z,A,C,F,I,O,G;if("string"==typeof a&&!a.length)return"";G=a-0;if(!isFinite(G))return"string"==typeof a?d.formatTextWithFormat(a,c):"NaN";a=G;var N=0>G?1:0;N&&(G=-G);x=0==G?1:0;d.parse_format_string(d.format_definitions,c);c=d.format_definitions[c];if(!c)throw"Format not parsed error!";v=c.sectioninfo.length-1;if(c.hascomparison)for(x=s=v=0;;x++){e=
c.operators[x];f=c.operands[x];if(!e){s&&(c="General",d.parse_format_string(d.format_definitions,c),c=d.format_definitions[c],v=0);break}if(e==d.commands.section){if(!s)break;s=0;v++}else if(e==d.commands.comparison){s=f.indexOf(":");w=f.substring(0,s);f=f.substring(s+1)-0;if("<"==w&&a<f||"<="==w&&a<=f||"="==w&&a==f||"<>"==w&&a!=f||">="==w&&a>=f||">"==w&&a>f)break;s=1}}else if(0<v)if(1==v)N?(N=0,v=1):v=0;else if(2==v||3==v)N?(N=0,v=1):v=x?2:0;v=c.sectioninfo[v];if(0<v.commas)for(s=0;s<v.commas;s++)G/=
1E3;if(0<v.percent)for(s=0;s<v.percent;s++)G*=100;f=1;for(s=0;s<v.fractiondigits;s++)f*=10;x=Math.floor(G*f+0.5);x/=f;if("number"!=typeof x||!isFinite(x))return"NaN";f=x+"";0==x&&(v.fractiondigits||v.integerdigits)&&(N=0);if(0<=f.indexOf("e"))return a+"";f=f.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/);if(!f)return"NaN";(x=f[1])&&"0"!=x||(x="");(w=f[2])||(w="");if(v.hasdate){if(0>a)return"??-???-??&nbsp;??:??:??";g=(a-Math.floor(a))*d.datevalues.seconds_in_a_day;l=a*d.datevalues.seconds_in_a_day;h=Math.floor(g/
d.datevalues.seconds_in_an_hour);p=Math.floor(l/d.datevalues.seconds_in_an_hour);g-=h*d.datevalues.seconds_in_an_hour;n=Math.floor(g/60);r=Math.floor(l/60);f=1;for(s=0;s<v.fractiondigits;s++)f*=10;g=Math.floor((g-60*n)*f+0.5);g/=f;l=Math.floor(l*f+0.5);l/=f;60<=g&&(g=0,n++,r++,60<=n&&(n=0,h++,p++,24<=h&&(h=0,a++)));w=g-Math.floor(g)+"";w=w.substring(2);q=SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(a+d.datevalues.julian_offset));s=0;for(mspos=v.sectionstart;;mspos++){e=c.operators[mspos];
f=c.operands[mspos];if(!e)break;if(e==d.commands.section)break;e==d.commands.date?("am/pm"!=f.toLowerCase()&&"a/p"!=f.toLowerCase()||t||(12<=h?(h-=12,t="a/p"==f.toLowerCase()?b.s_FormatNumber_pm1:b.s_FormatNumber_pm):t="a/p"==f.toLowerCase()?b.s_FormatNumber_am1:b.s_FormatNumber_am,0>f.indexOf(t)&&(t=t.toLowerCase())),!s||"m"!=f&&"mm"!=f||(c.operands[mspos]+="in"),s="h"==f.charAt(0)?1:0):e!=d.commands.copy&&(s=0)}s=0;for(--mspos;;mspos--){e=c.operators[mspos];f=c.operands[mspos];if(!e)break;if(e==
d.commands.section)break;e==d.commands.date?(!s||"m"!=f&&"mm"!=f||(c.operands[mspos]+="in"),s="ss"==f?1:0):e!=d.commands.copy&&(s=0)}}A=z=y=0;F=C="";I=b.FormatNumber_separatorchar;0<=I.indexOf(" ")&&(I=I.replace(/ /g,"&nbsp;"));O=b.FormatNumber_decimalchar;0<=O.indexOf(" ")&&(O=O.replace(/ /g,"&nbsp;"));for(s=v.sectionstart;e=c.operators[s];)if(f=c.operands[s++],e==d.commands.copy)u+=f;else if(e==d.commands.color)C=f;else if(e==d.commands.style)F=f;else if(e==d.commands.integer_placeholder){N&&(u+=
"-",N=0);y++;if(1==y&&x.length>v.integerdigits)for(;z<x.length-v.integerdigits;z++)u+=x.charAt(z),v.thousandssep&&(e=x.length-z-1,2<e&&0==e%3&&(u+=I));if(x.length<v.integerdigits&&y<=v.integerdigits-x.length){if("0"==f||"?"==f)u+="0"==f?"0":"&nbsp;",v.thousandssep&&(e=v.integerdigits-y,2<e&&0==e%3&&(u+=I))}else u+=x.charAt(z),v.thousandssep&&(e=x.length-z-1,2<e&&0==e%3&&(u+=I)),z++}else if(e==d.commands.fraction_placeholder){if(A>=w.length){if("0"==f||"?"==f)u+="0"==f?"0":"&nbsp;"}else u+=w.charAt(A);
A++}else if(e==d.commands.decimal)N&&(u+="-",N=0),u+=O;else if(e==d.commands.currency)N&&(u+="-",N=0),u+=f;else if(e==d.commands.general){if(0!=G&&(f=Math.floor(Math.LOG10E*Math.log(G)),f=Math.pow(10,13-f),G=Math.floor(f*G+0.5)/f,!isFinite(G)))return"NaN";N&&(u+="-");f=G+"";if(0<=f.indexOf("e"))u+=f;else{f=f.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/);(x=f[1])&&"0"!=x||(x="");(w=f[2])||(w="");A=z=0;if(x.length)for(;z<x.length;z++)u+=x.charAt(z),v.thousandssep&&(e=x.length-z-1,2<e&&0==e%3&&(u+=I));else u+=
"0";if(w.length)for(u+=O;A<w.length;A++)u+=w.charAt(A)}}else if(e==d.commands.date)f=f.toLowerCase(),"y"==f||"yy"==f?u+=(q.year+"").substring(2):"yyyy"==f?u+=q.year+"":"d"==f?u+=q.day+"":"dd"==f?(f=1E3+q.day,u+=(f+"").substr(2)):"ddd"==f?(f=Math.floor(a+6)%7,u+=b.s_FormatNumber_daynames3[f]):"dddd"==f?(f=Math.floor(a+6)%7,u+=b.s_FormatNumber_daynames[f]):"m"==f?u+=q.month+"":"mm"==f?(f=1E3+q.month,u+=(f+"").substr(2)):"mmm"==f?u+=b.s_FormatNumber_monthnames3[q.month-1]:"mmmm"==f?u+=b.s_FormatNumber_monthnames[q.month-
1]:"mmmmm"==f?u+=b.s_FormatNumber_monthnames[q.month-1].charAt(0):"h"==f?u+=h+"":"h]"==f?u+=p+"":"mmin"==f?(f=1E3+n+"",u+=f.substr(2)):"mm]"==f?100>r?(f=1E3+r+"",u+=f.substr(2)):u+=r+"":"min"==f?u+=n+"":"m]"==f?u+=r+"":"hh"==f?(f=1E3+h+"",u+=f.substr(2)):"s"==f?(f=Math.floor(g),u+=f+""):"ss"==f?(f=1E3+Math.floor(g)+"",u+=f.substr(2)):"am/pm"==f||"a/p"==f?u+=t:"ss]"==f&&(100>l?(f=1E3+Math.floor(l)+"",u+=f.substr(2)):(f=Math.floor(l),u+=f+""));else if(e==d.commands.section)break;else e!=d.commands.comparison&&
(u+="!! Parse error !!");C&&(u='<span style="color:'+C+';">'+u+"</span>");F&&(u='<span style="'+F+';">'+u+"</span>");return u};
SocialCalc.FormatNumber.formatTextWithFormat=function(a,c){var b=SocialCalc.FormatNumber,d=a+"",e="",f,g,l="",h="";b.parse_format_string(b.format_definitions,c);thisformat=b.format_definitions[c];if(!thisformat)throw"Format not parsed error!";f=thisformat.sectioninfo.length-1;if(0==f)f=0;else if(3==f)f=3;else return d;for(f=thisformat.sectioninfo[f].sectionstart;op=thisformat.operators[f];)g=thisformat.operands[f++],op==b.commands.copy?e="@"==g?e+d:e+g.replace(/ /g,"&nbsp;"):op==b.commands.color?
l=g:op==b.commands.style&&(h=g);l&&(e='<span style="color:'+l+';">'+e+"</span>");h&&(e='<span style="'+h+';">'+e+"</span>");return e};
SocialCalc.FormatNumber.parse_format_string=function(a,c){var b=SocialCalc.FormatNumber,d,e,f=1,g,l,h,n,p,r,t,q,s,u,v,w,x;if(!a[c]){d={operators:[],operands:[],sectioninfo:[{}]};a[c]=d;e=0;sectioninfo=d.sectioninfo[e];sectioninfo.sectionstart=0;sectioninfo.integerdigits=0;sectioninfo.fractiondigits=0;sectioninfo.commas=0;for(x=sectioninfo.percent=0;x<c.length;x++)if(s=c.charAt(x),p)'"'==s?(p=0,d.operators.push(b.commands.copy),d.operands.push(r)):r+=s;else if(t)"]"==s?(t=0,s=SocialCalc.FormatNumber.parse_format_bracket(q),
s.operator==b.commands.separator?sectioninfo.thousandssep=1:(s.operator==b.commands.date&&(sectioninfo.hasdate=1),s.operator==b.commands.comparison&&(d.hascomparison=1),d.operators.push(s.operator),d.operands.push(s.operand))):q+=s;else if(l)d.operators.push(b.commands.copy),d.operands.push(s),l=!1;else if(h)d.operators.push(b.commands.copy),d.operands.push(s+s+s+s+s),h=!1;else if(n)d.operators.push(b.commands.copy),d.operands.push("&nbsp;"),n=!1;else{if(u){if("general".charAt(u)==s.toLowerCase()){u++;
7==u&&(d.operators.push(b.commands.general),d.operands.push(s),u=0);continue}u=0}if(w){if(w.charAt(0)==s){w+=s;continue}d.operators.push(b.commands.date);d.operands.push(w);sectioninfo.hasdate=1;w=""}if(v)if(v+=s,s=v.toLowerCase(),s!="am/pm".substring(0,s.length)&&s!="a/p".substring(0,s.length))ampstr="";else{if("am/pm"==s||"a/p"==s)d.operators.push(b.commands.date),d.operands.push(v),v=""}else"#"==s||"0"==s||"?"==s?(f?(sectioninfo.integerdigits++,sectioninfo.commas&&(sectioninfo.thousandssep=1,sectioninfo.commas=
0),g=1,d.operators.push(b.commands.integer_placeholder)):(sectioninfo.fractiondigits++,g=1,d.operators.push(b.commands.fraction_placeholder)),d.operands.push(s)):"."==s?(g=0,d.operators.push(b.commands.decimal),d.operands.push(s),f=0):"$"==s?(g=0,d.operators.push(b.commands.currency),d.operands.push(s)):","==s?g?sectioninfo.commas++:(d.operators.push(b.commands.copy),d.operands.push(s)):"%"==s?(g=0,sectioninfo.percent++,d.operators.push(b.commands.copy),d.operands.push(s)):'"'==s?(g=0,p=1,r=""):"["==
s?(g=0,t=1,q=""):"\\"==s?(l=1,g=0):"*"==s?(h=1,g=0):"_"==s?(n=1,g=0):";"==s?(e++,d.sectioninfo[e]={},sectioninfo=d.sectioninfo[e],sectioninfo.sectionstart=1+d.operators.length,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,f=1,g=0,d.operators.push(b.commands.section),d.operands.push(s)):"g"==s.toLowerCase()?(u=1,g=0):"a"==s.toLowerCase()?(v=s,g=0):0<="dmyhHs".indexOf(s)?w=s:(g=0,d.operators.push(b.commands.copy),d.operands.push(s))}w&&(d.operators.push(b.commands.date),
d.operands.push(w),sectioninfo.hasdate=1)}};
SocialCalc.FormatNumber.parse_format_bracket=function(a){var c=SocialCalc.FormatNumber,b=SocialCalc.Constants,d={},e;"$"==a.charAt(0)?(d.operator=c.commands.currency,e=a.match(/^\$(.+?)(\-.+?){0,1}$/),d.operand=e?e[1]||b.FormatNumber_defaultCurrency||"$":a.substring(1)||b.FormatNumber_defaultCurrency||"$"):"?$"==a?(d.operator=c.commands.currency,d.operand="[?$]"):c.allowedcolors[a.toUpperCase()]?(d.operator=c.commands.color,d.operand=c.allowedcolors[a.toUpperCase()]):(e=a.match(/^style=([^"]*)$/))?
(d.operator=c.commands.style,d.operand=e[1]):","==a?(d.operator=c.commands.separator,d.operand=a):c.alloweddates[a.toUpperCase()]?(d.operator=c.commands.date,d.operand=c.alloweddates[a.toUpperCase()]):a.match(/^[<>=]/)?(e=a.match(/^([<>=]+)(.+)$/),d.operator=c.commands.comparison,d.operand=e[1]+":"+e[2]):(d.operator=c.commands.copy,d.operand="["+a+"]");return d};
SocialCalc.FormatNumber.convert_date_gregorian_to_julian=function(a,c,b){b=b-32075+SocialCalc.intFunc(1461*(a+4800+SocialCalc.intFunc((c-14)/12))/4);b+=SocialCalc.intFunc(367*(c-2-12*SocialCalc.intFunc((c-14)/12))/12);return b-=SocialCalc.intFunc(3*SocialCalc.intFunc((a+4900+SocialCalc.intFunc((c-14)/12))/100)/4)};
SocialCalc.FormatNumber.convert_date_julian_to_gregorian=function(a){var c,b,d,e;a+=68569;c=Math.floor(4*a/146097);a-=Math.floor((146097*c+3)/4);b=Math.floor(4E3*(a+1)/1461001);a=a-Math.floor(1461*b/4)+31;d=Math.floor(80*a/2447);e=a-Math.floor(2447*d/80);a=Math.floor(d/11);return{year:100*(c-49)+b+a,month:d+2-12*a,day:e}};SocialCalc.intFunc=function(a){return 0>a?-Math.floor(-a):Math.floor(a)};SocialCalc||(SocialCalc={});SocialCalc.Formula={};SocialCalc.Formula.ParseState={num:1,alpha:2,coord:3,string:4,stringquote:5,numexp1:6,numexp2:7,alphanumeric:8,specialvalue:9};SocialCalc.Formula.TokenType={num:1,coord:2,op:3,name:4,error:5,string:6,space:7};SocialCalc.Formula.CharClass={num:1,numstart:2,op:3,eof:4,alpha:5,incoord:6,error:7,quote:8,space:9,specialstart:10};
SocialCalc.Formula.CharClassTable={" ":9,"!":3,'"':8,"'":8,"#":10,$:6,"%":3,"&":3,"(":3,")":3,"*":3,"+":3,",":3,"-":3,".":2,"/":3,0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,":":3,"<":3,"=":3,">":3,A:5,B:5,C:5,D:5,E:5,F:5,G:5,H:5,I:5,J:5,K:5,L:5,M:5,N:5,O:5,P:5,Q:5,R:5,S:5,T:5,U:5,V:5,W:5,X:5,Y:5,Z:5,"^":3,_:5,a:5,b:5,c:5,d:5,e:5,f:5,g:5,h:5,i:5,j:5,k:5,l:5,m:5,n:5,o:5,p:5,q:5,r:5,s:5,t:5,u:5,v:5,w:5,x:5,y:5,z:5};
SocialCalc.Formula.UpperCaseTable={a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z"};SocialCalc.Formula.SpecialConstants={"#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"};
SocialCalc.Formula.TokenPrecedence={"!":1,":":2,",":2,M:-3,P:-3,"%":4,"^":5,"*":6,"/":6,"+":7,"-":7,"&":8,"<":9,">":9,G:9,L:9,N:9};SocialCalc.Formula.TokenOpExpansion={G:">=",L:"<=",M:"-",N:"<>",P:"+"};
SocialCalc.Formula.TypeLookupTable={unaryminus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unaryplus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unarypercent:{"n*":"|n:n%|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},plus:{"n%":"|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",nd:"|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|",nt:"|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|",ndt:"|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|",
n$:"|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|",nl:"|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",n:"|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",b:"|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|","t*":"|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|","e*":"|e*:1|n*:1|t*:1|b:1|"},concat:{t:"|t:t|th:th|tw:tw|tl:t|tr:tr|t*:2|e*:2|",th:"|t:th|th:th|tw:t|tl:th|tr:t|t*:t|e*:2|",tw:"|t:tw|th:t|tw:tw|tl:tw|tr:tw|t*:t|e*:2|",tl:"|t:tl|th:th|tw:tw|tl:tl|tr:tr|t*:t|e*:2|",
"t*":"|t*:t|e*:2|","e*":"|e*:1|n*:1|t*:1|"},oneargnumeric:{"n*":"|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},twoargnumeric:{"n*":"|n*:n|t*:e#VALUE!|e*:2|","e*":"|e*:1|n*:1|t*:1|","t*":"|t*:e#VALUE!|n*:e#VALUE!|e*:2|"},propagateerror:{"n*":"|n*:2|e*:2|","e*":"|e*:2|","t*":"|t*:2|e*:2|",b:"|b:2|e*:2|"}};
SocialCalc.Formula.ParseFormulaIntoTokens=function(a){var c,b,d,e,f,g;c=SocialCalc.Formula;var l=SocialCalc.Constants,h=c.ParseState,n=c.TokenType,p=c.CharClass,r=c.CharClassTable,t=c.UpperCaseTable,q=c.ParsePushToken,s=/^\$?[A-Z]{1,2}\$?[1-9]\d*$/i,u=[],v="";f=0;e=!1;for(c=0;c<=a.length;c++)c<a.length?(b=a.charAt(c),d=r[b]):(b="",d=p.eof),f==h.num&&(d==p.num?v+=b:d!=p.numstart||e?"E"==b||"e"==b?(v+=b,e=!1,f=h.numexp1):(q(u,v,n.num,0),e=!1,f=0):(e=!0,v+=b)),f==h.numexp1&&(d==h.num?f=h.numexp2:"+"!=
b&&"-"!=b||"E"!=t[v.charAt(v.length-1)]?"E"!=b&&"e"!=b&&(q(u,l.s_parseerrexponent,n.error,0),f=0):v+=b),f==h.numexp2&&(d==p.num?v+=b:(q(u,v,n.num,0),f=0)),f==h.alpha&&(d==p.num?f=h.coord:d==p.alpha||"."==b?v+=b:d==p.incoord?f=h.coord:(d==p.op||d==p.numstart||d==p.space||d==p.eof?q(u,v.toUpperCase(),n.name,0):q(u,l.s_parseerrchar,n.error,0),f=0)),f==h.coord&&(d==p.num?v+=b:d==p.incoord?v+=b:d==p.alpha?f=h.alphanumeric:(d==p.op||d==p.numstart||d==p.eof||d==p.space?(f=s.test(v)?n.coord:n.name,q(u,v.toUpperCase(),
f,0)):q(u,l.s_parseerrchar,n.error,0),f=0)),f==h.alphanumeric&&(d==p.num||d==p.alpha?v+=b:(d==p.op||d==p.numstart||d==p.space||d==p.eof?q(u,v.toUpperCase(),n.name,0):q(u,l.s_parseerrchar,n.error,0),f=0)),f==h.string?d==p.quote?f=h.stringquote:d==p.eof?(q(u,l.s_parseerrstring,n.error,0),f=0):v+=b:f==h.stringquote?d==p.quote?(v+=b,f=h.string):(q(u,v,n.string,0),f=0):f==h.specialvalue&&("!"==v.charAt(v.length-1)?(q(u,v,n.name,0),f=0):d==p.eof?(q(u,l.s_parseerrspecialvalue,n.error,0),f=0):v+=b),0==f&&
(d==p.num?(v=b,f=h.num):d==p.numstart?(v=b,e=!0,f=h.num):d==p.alpha||d==p.incoord?(v=b,f=h.alpha):d==p.specialstart?(v=b,f=h.specialvalue):d==p.op?(v=b,0<u.length?(f=u[u.length-1],d=f.type,g=f.text,d!=p.op||"<"!=g&&">"!=g||(v=g+v,u.pop(),0<u.length?(f=u[u.length-1],d=f.type,g=f.text):(d=p.eof,g="EOF"))):(d=p.eof,g="EOF"),f=n.op,0==u.length||d==p.op&&")"!=g&&"%"!=g?"-"==v?b=v="M":"+"==v?b=v="P":")"==v&&"("==g||"("==v||(f=n.error,v=l.s_parseerrtwoops):1<v.length&&(">="==v?b=v="G":"<="==v?b=v="L":"<>"==
v?b=v="N":(f=n.error,v=l.s_parseerrtwoops)),q(u,v,f,b),f=0):d==p.quote?(v="",f=h.string):d!=p.space&&d!=p.eof&&q(u,l.s_parseerrchar,n.error,0));return u};SocialCalc.Formula.ParsePushToken=function(a,c,b,d){a.push({text:c,type:b,opcode:d})};SocialCalc.Formula.evaluate_parsed_formula=function(a,c,b){var d=SocialCalc.Formula,e;e=d.ConvertInfixToPolish(a);return d.EvaluatePolish(a,e,c,b)};
SocialCalc.Formula.ConvertInfixToPolish=function(a){var c=SocialCalc.Formula,b=SocialCalc.Constants,d=c.TokenType,c=c.TokenPrecedence,e=[],f=[],g="",l,h,n,p;for(l=0;l<a.length;l++)if(h=a[l],n=h.type,p=h.text,n==d.num||n==d.coord||n==d.string)e.push(l);else if(n==d.name)f.push(l),e.push(-1);else if(n!=d.space)if(","==p){for(;f.length&&"("!=a[f[f.length-1]].text;)e.push(f.pop());if(0==f.length){g=b.s_parseerrmissingopenparen;break}}else if("("==p)f.push(l);else if(")"==p){for(;f.length&&"("!=a[f[f.length-
1]].text;)e.push(f.pop());if(0==f.length){g=b.s_parseerrcloseparennoopen;break}f.pop();f.length&&a[f[f.length-1]].type==d.name&&e.push(f.pop())}else if(n==d.op){for(f.length&&a[f[f.length-1]].type==d.name&&e.push(f.pop());f.length&&a[f[f.length-1]].type==d.op&&"("!=a[f[f.length-1]].text;){n=c[h.opcode];p=c[a[f[f.length-1]].opcode];if(0<=n&&n<p)break;else if(0>n&&(n=-n,0>p&&(p=-p),n<=p))break;e.push(f.pop())}f.push(l)}else{g=n==d.error?p:"Internal error while processing parsed formula. ";break}for(;0<
f.length;){if("("==a[f[f.length-1]].text){g=b.s_parseerrmissingcloseparen;break}e.push(f.pop())}return g?g:e};
SocialCalc.Formula.EvaluatePolish=function(a,c,b,d){var e=SocialCalc.Formula,f=SocialCalc.Constants,g=e.TokenType,l=e.LookupResultType,h=e.TypeLookupTable,n=e.OperandAsNumber,p=e.OperandAsText,r=e.OperandValueAndType,t=e.OperandsAsCoordOnSheet,q=SocialCalc.format_number_for_display||function(a,c,b){return a+""},s="",u={value:"",type:"e#VALUE!",error:f.s_parseerrmissingoperand},v=[],w=function(a,c){v.push({type:a,value:c})},x,y,z,A,C,F;if(!(a.length&&c instanceof Array))return{value:"",type:"e#VALUE!",
error:"string"==typeof c?c:""};for(x=0;x<c.length;x++)if(y=c[x],-1==y)w("start",0);else if(y=a[y],z=y.type,y=y.text,z==g.num)w("n",y-0);else if(z==g.coord)w("coord",y);else if(z==g.string)w("t",y);else if(z==g.op){if(0>=v.length)return u;if("M"==y)z=n(b,v),y=l(z.type,z.type,h.unaryminus),w(y,-z.value);else if("P"==y)z=n(b,v),y=l(z.type,z.type,h.unaryplus),w(y,z.value);else if("%"==y)z=n(b,v),y=l(z.type,z.type,h.unarypercent),w(y,0.01*z.value);else if("&"==y){if(1>=v.length)return u;A=p(b,v);z=p(b,
v);y=l(z.type,z.type,h.concat);w(y,z.value+A.value)}else if(":"==y){if(1>=v.length)return u;z=e.OperandsAsRangeOnSheet(b,v);z.error&&(s=s||z.error);w(z.type,z.value)}else if("!"==y){if(1>=v.length)return u;z=t(b,v);z.error&&(s=s||z.error);w(z.type,z.value)}else if("<"==y||"L"==y||"="==y||"G"==y||">"==y||"N"==y){if(1>=v.length){s=f.s_parseerrmissingoperand;break}A=r(b,v);z=r(b,v);"n"==z.type.charAt(0)&&"n"==A.type.charAt(0)?(C=0,"<"==y?C=z.value<A.value?1:0:"L"==y?C=z.value<=A.value?1:0:"="==y?C=z.value==
A.value?1:0:"G"==y?C=z.value>=A.value?1:0:">"==y?C=z.value>A.value?1:0:"N"==y&&(C=z.value!=A.value?1:0),w("nl",C)):"e"==z.type.charAt(0)?w(z.type,0):"e"==A.type.charAt(0)?w(A.type,0):(C=z.type.charAt(0),F=A.type.charAt(0),"n"==C?z.value=q(z.value,"n",""):"b"==C&&(z.value=""),"n"==F?A.value=q(A.value,"n",""):"b"==F&&(A.value=""),C=0,z.value=z.value.toLowerCase(),A.value=A.value.toLowerCase(),"<"==y?C=z.value<A.value?1:0:"L"==y?C=z.value<=A.value?1:0:"="==y?C=z.value==A.value?1:0:"G"==y?C=z.value>=
A.value?1:0:">"==y?C=z.value>A.value?1:0:"N"==y&&(C=z.value!=A.value?1:0),w("nl",C))}else{if(1>=v.length){s=f.s_parseerrmissingoperand;break}A=n(b,v);z=n(b,v);"+"==y?(y=l(z.type,A.type,h.plus),w(y,z.value+A.value)):"-"==y?(y=l(z.type,A.type,h.plus),w(y,z.value-A.value)):"*"==y?(y=l(z.type,A.type,h.plus),w(y,z.value*A.value)):"/"==y?0!=A.value?w("n",z.value/A.value):w("e#DIV/0!",0):"^"==y&&(z.value=Math.pow(z.value,A.value),z.type="n",isNaN(z.value)&&(z.value=0,z.type="e#NUM!"),w(z.type,z.value))}}else if(z==
g.name){if(s=e.CalculateFunction(y,v,b))break}else{s=f.s_InternalError+"Unknown token "+z+" ("+y+"). ";break}value=v[0]?v[0].value:"";C=v[0]?v[0].type:"";"name"==C&&(z=SocialCalc.Formula.LookupName(b,value),value=z.value,C=z.type,s=s||z.error);"coord"==C&&(z=r(b,v),value=z.value,C=z.type,"b"==C&&(C="n",value=0));1<v.length&&!s&&(s+=f.s_parseerrerrorinformula);a=C;"e"==C.charAt(0)?s=s||C.substring(1)||f.s_calcerrerrorvalueinformula:"range"==C&&(c=value.match(/^(.*)\|(.*)\|/),b=c[1].indexOf("!"),c[1]=
0<=b?c[1].substring(b+1)+"!"+c[1].substring(0,b).toUpperCase():c[1].toUpperCase(),value=c[1]+":"+c[2].toUpperCase(),d||(s=f.s_formularangeresult+" "+value));s&&"e"!=a.charAt(0)&&(value=s,a="e");"n"!=a.charAt(0)||!isNaN(value)&&isFinite(value)||(value=0,a="e#NUM!",s=isNaN(value)?f.s_calcerrnumericnan:f.s_calcerrnumericoverflow);return{value:value,type:a,error:s}};
SocialCalc.Formula.LookupResultType=function(a,c,b){var d,e;e=b[a];if(!e&&(e=b[a.charAt(0)+"*"],!e))return"e#VALUE! (internal error, missing LookupResultType "+a.charAt(0)+"*)";b=e.indexOf("|"+c+":");if(0<=b){d=e.indexOf("|",b+1);if(0>d)return"e#VALUE! (internal error, incorrect LookupResultType "+e+")";e=e.substring(b+c.length+2,d);return"1"==e?a:"2"==e?c:e}b=e.indexOf("|"+c.charAt(0)+"*:");if(0<=b){d=e.indexOf("|",b+1);if(0>d)return"e#VALUE! (internal error, incorrect LookupResultType "+e+")";e=
e.substring(b+4,d);return"1"==e?a:"2"==e?c:e}return"e#VALUE!"};SocialCalc.Formula.TopOfStackValueAndType=function(a,c){var b=SocialCalc.Formula,d={type:"",value:""},e=c.length;if(!e)return d.error=SocialCalc.Constants.s_InternalError+"no operand on stack",d;d.value=c[e-1].value;d.type=c[e-1].type;c.pop();"name"==d.type&&(d=b.LookupName(a,d.value));return d};
SocialCalc.Formula.OperandAsNumber=function(a,c){var b,d=SocialCalc.Formula.OperandValueAndType(a,c);b=d.type.charAt(0);"n"==b?d.value-=0:"b"==b?(d.type="n",d.value=0):"e"==b?d.value=0:(b=SocialCalc.DetermineValueType?SocialCalc.DetermineValueType(d.value):{value:d.value-0,type:"n"},"n"==b.type.charAt(0)?d.value=b.value-0:d.value=0,d.type=b.type);return d};
SocialCalc.Formula.OperandAsText=function(a,c){var b,d=SocialCalc.Formula.OperandValueAndType(a,c);b=d.type.charAt(0);"t"!=b&&("n"==b?(d.value=SocialCalc.format_number_for_display?SocialCalc.format_number_for_display(d.value,d.type,""):d.value+="",d.type="t"):"b"==b?(d.value="",d.type="t"):"e"==b?d.value="":(c.value=d.value+"",c.type="t"));return d};
SocialCalc.Formula.OperandValueAndType=function(a,c){var b,d,e;b=SocialCalc.Formula;var f={type:"",value:""};d=c.length;if(!d)return f.error=SocialCalc.Constants.s_InternalError+"no operand on stack",f;f.value=c[d-1].value;f.type=c[d-1].type;c.pop();"name"==f.type&&(f=b.LookupName(a,f.value));"range"==f.type&&(f=b.StepThroughRangeDown(c,f.value));if("coord"==f.type){e=a;d=f.value.indexOf("!");if(-1!=d){e=b.FindInSheetCache(f.value.substring(d+1));if(null==e)return f.type="e#REF!",f.error=SocialCalc.Constants.s_sheetunavailable+
" "+f.value.substring(d+1),f.value=0,f;f.value=f.value.substring(0,d)}e?(d=e.cells[SocialCalc.Formula.PlainCoord(f.value)])?(b=d.valuetype,f.value=d.datavalue):b="b":(b="e#N/A",f.value=0);f.type=b||"b";"b"==f.type&&(f.value=0)}return f};
SocialCalc.Formula.OperandAsCoord=function(a,c){var b={type:"",value:""},d=c.length;b.value=c[d-1].value;b.type=c[d-1].type;c.pop();"name"==b.type&&(b=SocialCalc.Formula.LookupName(a,b.value));"coord"!=b.type&&(b.value=SocialCalc.Constants.s_calcerrcellrefmissing,b.type="e#REF!");return b};
SocialCalc.Formula.OperandsAsCoordOnSheet=function(a,c){var b,d,e,f={},g={};e=SocialCalc.Formula;b=c.length;f.value=c[b-1].value;f.type=c[b-1].type;c.pop();b=e.OperandAsSheetName(a,c);d=e.FindInSheetCache(b.value);if(null==d)return g.type="e#REF!",g.value=0,g.error=SocialCalc.Constants.s_sheetunavailable+" "+b.value,g;"name"==f.type&&(f=e.LookupName(d,f.value));g.type=f.type;"coord"==f.type?g.value=f.value+"!"+b.value:"range"==f.type?(e=f.value.indexOf("|"),d=f.value.indexOf("|",e+1),g.value=f.value.substring(0,
e)+"!"+b.value+"|"+f.value.substring(e+1,d)+"|"):"e"==f.type.charAt(0)?g.value=f.value:(g.error=SocialCalc.Constants.s_calcerrcellrefmissing,g.type="e#REF!",g.value=0);return g};
SocialCalc.Formula.OperandsAsRangeOnSheet=function(a,c){var b,d,e,f,g={},l=SocialCalc.Formula,h=SocialCalc.Constants;b=c.length;g.value=c[b-1].value;g.type=c[b-1].type;c.pop();b=l.OperandAsCoord(a,c);if("coord"!=b.type)return{value:0,type:"e#REF!"};d=a;e=b.value.indexOf("!");if(-1!=e&&(f=b.value.indexOf("|",e+1),0>f&&(f=b.value.length),d=l.FindInSheetCache(b.value.substring(e+1,f)),null==d))return{value:0,type:"e#REF!",errortext:h.s_sheetunavailable+" "+b.value.substring(e+1,f)};"name"==g.type&&(g=
l.LookupName(d,g.value));return"coord"==g.type?{value:b.value+"|"+g.value+"|",type:"range"}:{value:h.s_calcerrcellrefmissing,type:"e#REF!"}};
SocialCalc.Formula.OperandAsSheetName=function(a,c){var b,d={type:"",value:""};b=c.length;d.value=c[b-1].value;d.type=c[b-1].type;c.pop();if("name"==d.type){b=SocialCalc.Formula.LookupName(a,d.value);if(!b.value)return d;d.value=b.value;d.type=b.type}"coord"==d.type&&((b=a.cells[SocialCalc.Formula.PlainCoord(d.value)])?(d.value=b.datavalue,d.type=b.valuetype):(d.value="",d.type="b"));"t"!=d.type.charAt(0)&&(d.value="",d.error=SocialCalc.Constants.s_calcerrsheetnamemissing);return d};
SocialCalc.Formula.LookupName=function(a,c){var b,d,e;d=a.names;e={};b=!1;if(d[c.toUpperCase()]){e.value=d[c.toUpperCase()].definition;if("="==e.value.charAt(0)){if(!a.checknamecirc)a.checknamecirc={},b=!0;else if(a.checknamecirc[c])return e.type="e#NAME?",e.error=SocialCalc.Constants.s_circularnameref+' "'+c+'".',e;a.checknamecirc[c]=!0;e=SocialCalc.Formula.ParseFormulaIntoTokens(e.value.substring(1));e=SocialCalc.Formula.evaluate_parsed_formula(e,a,1);delete a.checknamecirc[c];b&&delete a.checknamecirc;
if("range"!=e.type)return e}b=e.value.indexOf(":");-1!=b?(e.type="range",e.value=e.value.substring(0,b)+"|"+e.value.substring(b+1)+"|"):e.type="coord";e.value=e.value.toUpperCase()}else(d=SocialCalc.Formula.SpecialConstants[c.toUpperCase()])?(b=d.indexOf(","),e.value=d.substring(0,b)-0,e.type=d.substring(b+1)):(e.value="",e.type="e#NAME?",e.error=SocialCalc.Constants.s_calcerrunknownname+' "'+c+'"');return e};
SocialCalc.Formula.StepThroughRangeDown=function(a,c){var b,d,e,f,g,l,h,n,p=SocialCalc.Formula;f=c.indexOf("|");e=c.indexOf("|",f+1);b=c.substring(0,f);d=c.substring(f+1,e);e=c.substring(e+1)-0;f=b.indexOf("!");-1!=f?(g=b.substring(f),b=b.substring(0,f)):g="";f=d.indexOf("!");-1!=f&&(d=d.substring(0,f));f=p.OrderRangeParts(b,d);n=0;for(h=f.r1;h<=f.r2;h++)for(l=f.c1;l<=f.c2;l++)if(n++,n>e)return h==f.r2&&l==f.c2||p.PushOperand(a,"range",b+g+"|"+d+"|"+n),{value:SocialCalc.crToCoord(l,h)+g,type:"coord"}};
SocialCalc.Formula.RangeToString=function(a){var c,b,d,e,f=SocialCalc.Formula,g=[];d=a.indexOf("|");e=a.indexOf("|",d+1);c=a.substring(0,d);b=a.substring(d+1,e);a.substring(e+1);d=c.indexOf("!");-1!=d&&(c.substring(d),c=c.substring(0,d));d=b.indexOf("!");-1!=d&&(b=b.substring(0,d));a=f.OrderRangeParts(c,b);console.log(JSON.stringify(a));d=0;for(b=a.r1;b<=a.r2;b++)for(c=a.c1;c<=a.c2;c++)d++,g.push(SocialCalc.CurrentSpreadsheetControlObject.sheet.cells[SocialCalc.letters[c-1]+b+""].datavalue);return g.join(",")};
SocialCalc.Formula.RangeTo2D=function(a){var c,b,d,e,f=SocialCalc.Formula,g=[];d=a.indexOf(":");e=a.length+1;c=a.substring(0,d);b=a.substring(d+1,e);a.substring(e+1);d=c.indexOf("!");-1!=d&&(c.substring(d),c=c.substring(0,d));d=b.indexOf("!");-1!=d&&(b=b.substring(0,d));a=f.OrderRangeParts(c,b);isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};d=0;for(b=a.r1;b<=a.r2;b++){e=[];for(c=a.c1;c<=a.c2;c++)d++,f=SocialCalc.CurrentSpreadsheetControlObject.sheet.cells[SocialCalc.letters[c-1]+b+
""],void 0!=f&&(isNumber(f.datavalue)?e.push(+f.datavalue):e.push(f.datavalue));g.push(e)}return g};
SocialCalc.Formula.DecodeRangeParts=function(a,c){var b,d,e,f,g=SocialCalc.Formula;e=c.indexOf("|");f=c.indexOf("|",e+1);b=c.substring(0,e);d=c.substring(e+1,f);e=b.indexOf("!");-1!=e?(f=b.substring(e+1),b=b.substring(0,e)):f="";e=d.indexOf("!");-1!=e&&(d=d.substring(0,e));e=a;if(f&&(e=g.FindInSheetCache(f),null==e))return null;b=g.OrderRangeParts(b,d);return{sheetdata:e,sheetname:f,col1num:b.c1,ncols:b.c2-b.c1+1,row1num:b.r1,nrows:b.r2-b.r1+1}};
SocialCalc.Formula.FunctionList||(SocialCalc.Formula.FunctionList={});SocialCalc.Formula.FunctionClasses=null;SocialCalc.Formula.FunctionArgDefs={};window.DAJE=function(a,c,b,d){console.log("daje");return 121+a+c+b+d};
SocialCalc.Formula.CalculateFunction=function(a,c,b){console.log("operand:");console.log(c);console.log("fname:");console.log(a);console.log("type:");console.log(typeof window[a]);var d,e,f,g=SocialCalc.Formula,l="";if(d=g.FunctionList[a]){e=[];f=d[0];d=d[1];g.CopyFunctionArgs(c,e);if(100!=d)if(0>d){if(e.length<-d)return l=g.FunctionArgsError(a,c)}else if(e.length!=d)return l=g.FunctionArgsError(a,c);l=f(a,c,e,b)}else if(c.length&&"start"==c[c.length-1].type)c.pop(),g.PushOperand(c,"name",a);else if("function"===
typeof window[a])try{e=[];var h=c.length;for(b=0;b<h;b++)f=c.pop(),"start"!=f.type&&e.push(f.value);console.log("args:");console.log(e);var n=window[a].apply(window,e.reverse());console.log("res:"+n);g.PushOperand(c,"t",n)}catch(p){l=JSON.stringify(p)}else l=SocialCalc.Constants.s_sheetfuncunknownfunction+" "+a+". ";return l};SocialCalc.Formula.PushOperand=function(a,c,b){a.push({type:c,value:b})};
SocialCalc.Formula.CopyFunctionArgs=function(a,c){for(;0<a.length&&"start"!=a[a.length-1].type;)c.push(a.pop());a.pop()};SocialCalc.Formula.FunctionArgsError=function(a,c){var b=SocialCalc.Constants.s_calcerrincorrectargstofunction+" "+a+". ";SocialCalc.Formula.PushOperand(c,"e#VALUE!",b);return b};SocialCalc.Formula.FunctionSpecificError=function(a,c,b,d){SocialCalc.Formula.PushOperand(c,b,d);return d};
SocialCalc.Formula.CheckForErrorValue=function(a,c){return"e"==c.type.charAt(0)?(a.push(c),!0):!1};
SocialCalc.Formula.FillFunctionInfo=function(){var a=SocialCalc.Formula,c=SocialCalc.Constants,b,d,e;if(!a.FunctionClasses){for(b in a.FunctionList)d=a.FunctionList[b],d[2]&&(a.FunctionArgDefs[d[2]]=c["s_farg_"+d[2]]||""),d[3]||c["s_fdef_"+b]&&(a.FunctionList[b][3]=c["s_fdef_"+b]);a.FunctionClasses={};for(d=0;d<c.function_classlist.length;d++)e=c.function_classlist[d],a.FunctionClasses[e]={name:c["s_fclass_"+e],items:[]};for(b in a.FunctionList)for(d=a.FunctionList[b],c=d[4]?d[4].split(","):[],c.push("all"),
d=0;d<c.length;d++)e=c[d],a.FunctionClasses[e].items.push(b);for(e in a.FunctionClasses)a.FunctionClasses[e].items.sort()}};SocialCalc.Formula.FunctionArgString=function(a){var c=SocialCalc.Formula;a=c.FunctionList[a];var b;b=a[2];if(!b)if(a=a[1],0==a)b=" ";else{if(0<a){b="v1";for(c=2;c<=a;c++)b+=", v"+c;return b}if(0>a){b="v1";for(c=2;c<-a;c++)b+=", v"+c;return b+", ..."}return"nargs: "+a}return b=c.FunctionArgDefs[b]||b};
SocialCalc.Formula.SeriesFunctions=function(a,c,b,d){var e,f;e=SocialCalc.Formula;for(var g=e.OperandValueAndType,l=e.LookupResultType,h=e.TypeLookupTable.plus,n=function(a,b){c.push({type:a,value:b})},p=0,r="",t=0,q=0,s=0,u=1,v,w,x,y,z,A;0<b.length;)e=g(d,b),f=e.type.charAt(0),"n"==f&&(t+=1),"b"!=f&&(q+=1),"b"==f&&(s+=1),"n"==f?(f=e.value-0,p+=f,u*=f,v=void 0!=v?f>v?f:v:f,w=void 0!=w?f<w?f:w:f,1==t?(z=f,A=0):(x=z+(f-z)/t,A=y=A+(f-z)*(f-x),z=x),r=l(e.type,r||e.type,h)):"e"==f&&"e"!=r.charAt(0)&&(r=
e.type);r=r||"n";switch(a){case "SUM":n(r,p);break;case "PRODUCT":n(r,u);break;case "MIN":n(r,w||0);break;case "MAX":n(r,v||0);break;case "COUNT":n("n",t);break;case "COUNTA":n("n",q);break;case "COUNTBLANK":n("n",s);break;case "AVERAGE":0<t?n(r,p/t):n("e#DIV/0!",0);break;case "STDEV":1<t?n(r,Math.sqrt(y/(t-1))):n("e#DIV/0!",0);break;case "STDEVP":1<t?n(r,Math.sqrt(y/t)):n("e#DIV/0!",0);break;case "VAR":1<t?n(r,y/(t-1)):n("e#DIV/0!",0);break;case "VARP":1<t?n(r,y/t):n("e#DIV/0!",0)}return null};
SocialCalc.Formula.FunctionList.AVERAGE=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.COUNT=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.COUNTA=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.COUNTBLANK=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.MAX=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];
SocialCalc.Formula.FunctionList.MIN=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.PRODUCT=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.STDEV=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.STDEVP=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.SUM=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];
SocialCalc.Formula.FunctionList.VAR=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];SocialCalc.Formula.FunctionList.VARP=[SocialCalc.Formula.SeriesFunctions,-1,"vn",null,"stat"];
SocialCalc.Formula.SumProductFunction=function(a,c,b,d){for(var e=[],f=0,g=SocialCalc.Formula,l=0,h=0,n=function(a,b){c.push({type:a,value:b})};0<b.length;){a=g.TopOfStackValueAndType(d,b);if("range"!=a.type){n("e#VALUE!",0);return}rangeinfo=g.DecodeRangeParts(d,a.value);if(!l)l=rangeinfo.ncols;else if(l!=rangeinfo.ncols){n("e#VALUE!",0);return}if(!h)h=rangeinfo.nrows;else if(h!=rangeinfo.nrows){n("e#VALUE!",0);return}for(i=0;i<rangeinfo.ncols;i++)for(j=0;j<rangeinfo.nrows;j++)k=i*rangeinfo.nrows+
j,cellcr=SocialCalc.crToCoord(rangeinfo.col1num+i,rangeinfo.row1num+j),cell=rangeinfo.sheetdata.GetAssuredCell(cellcr),value="n"==cell.valuetype?cell.datavalue:0,e[k]=(e[k]||1)*value}for(i=0;i<e.length;i++)f+=e[i];n("n",f)};SocialCalc.Formula.FunctionList.SUMPRODUCT=[SocialCalc.Formula.SumProductFunction,-1,"rangen","","stat"];
SocialCalc.Formula.CorrelFunction=function(a,c,b,d){var e,f=SocialCalc.Formula,g=0,l=0,h=[],n=[],p,r;for(a=function(a,b){c.push({type:a,value:b})};0<b.length;){n=[];e=f.TopOfStackValueAndType(d,b);if("range"!=e.type){a("e#VALUE!",0);return}rangeinfo=f.DecodeRangeParts(d,e.value);if(!g)g=rangeinfo.ncols;else if(g!=rangeinfo.ncols){a("e#VALUE!",0);return}if(!l)l=rangeinfo.nrows;else if(l!=rangeinfo.nrows){a("e#VALUE!",0);return}if(1<g&&1<l){a("e#VALUE!",0);return}for(i=0;i<rangeinfo.ncols;i++)for(j=
0;j<rangeinfo.nrows;j++)k=i*rangeinfo.nrows+j,cellcr=SocialCalc.crToCoord(rangeinfo.col1num+i,rangeinfo.row1num+j),cell=rangeinfo.sheetdata.GetAssuredCell(cellcr),value="n"==cell.valuetype?cell.datavalue:0,n.push(value);h.push(n)}if(h[0].length!=h[1].length)a("e#VALUE!",0);else{b=d=f=0;g=h[0][0];n=h[1][0];for(e=1;e<h[0].length;e++)r=(e-1)/e,l=h[0][e]-g,p=h[1][e]-n,f+=l*l*r,d+=p*p*r,b+=l*p*r,g+=l/e,n+=p/e;e=Math.sqrt(f/h[0].length);d=Math.sqrt(d/h[0].length);h=b/h[0].length;a("n",h/(e*d))}};
SocialCalc.Formula.FunctionList.CORREL=[SocialCalc.Formula.CorrelFunction,2,"rangen","","stat"];
SocialCalc.Formula.DSeriesFunctions=function(a,c,b,d){var e,f,g,l,h,n,p,r,t=SocialCalc.Formula,q=t.LookupResultType,s=t.TypeLookupTable.plus,u=function(a,b){c.push({type:a,value:b})};f=e=void 0;var v=0,w="",x=0,y=0,z=1,A,C,F,I,O;g=t.TopOfStackValueAndType(d,b);l=t.OperandValueAndType(d,b);h=t.TopOfStackValueAndType(d,b);if("range"!=g.type||"range"!=h.type)return t.FunctionArgsError(a,c);b=t.DecodeRangeParts(d,g.value);d=t.DecodeRangeParts(d,h.value);l=t.FieldToColnum(b.sheetdata,b.col1num,b.ncols,
b.row1num,l.value,l.type);if(0>=l)u("e#VALUE!",0);else{l=b.col1num+l-1;h=[];for(g=0;g<d.ncols;g++){n=d.sheetdata.GetAssuredCell(SocialCalc.crToCoord(d.col1num+g,d.row1num));criterianum=t.FieldToColnum(b.sheetdata,b.col1num,b.ncols,b.row1num,n.datavalue,n.valuetype);if(0>=criterianum){u("e#VALUE!",0);return}h.push(b.col1num+criterianum-1)}for(g=1;g<b.nrows;g++){p=!1;e=1;a:for(;e<d.nrows;e++){for(f=0;f<d.ncols;f++)if(r=SocialCalc.crToCoord(d.col1num+f,d.row1num+e),n=d.sheetdata.GetAssuredCell(r),r=
n.datavalue,"string"!=typeof r||0!=r.length)if(n=h[f],n=SocialCalc.crToCoord(n,b.row1num+g),n=d.sheetdata.GetAssuredCell(n),!t.TestCriteria(n.datavalue,n.valuetype||"b",r))continue a;p=!0;break a}p&&(e=SocialCalc.crToCoord(l,b.row1num+g),n=b.sheetdata.GetAssuredCell(e),e=n.datavalue,f=n.valuetype,p=f.charAt(0),"n"==p&&(x+=1),"b"!=p&&(y+=1),"n"==p?(v1=e-0,v+=v1,z*=v1,A=void 0!=A?v1>A?v1:A:v1,C=void 0!=C?v1<C?v1:C:v1,1==x?(I=v1,O=0):(e=I+(v1-I)/x,O=F=O+(v1-I)*(v1-e),I=e),w=q(f,w||f,s)):"e"==p&&"e"!=
w.charAt(0)&&(w=f))}w=w||"n";switch(a){case "DSUM":u(w,v);break;case "DPRODUCT":u(w,z);break;case "DMIN":u(w,C||0);break;case "DMAX":u(w,A||0);break;case "DCOUNT":u("n",x);break;case "DCOUNTA":u("n",y);break;case "DAVERAGE":0<x?u(w,v/x):u("e#DIV/0!",0);break;case "DSTDEV":1<x?u(w,Math.sqrt(F/(x-1))):u("e#DIV/0!",0);break;case "DSTDEVP":1<x?u(w,Math.sqrt(F/x)):u("e#DIV/0!",0);break;case "DVAR":1<x?u(w,F/(x-1)):u("e#DIV/0!",0);break;case "DVARP":1<x?u(w,F/x):u("e#DIV/0!",0);break;case "DGET":1==x?u(w,
v):0==x?u("e#VALUE!",0):u("e#NUM!",0)}}};SocialCalc.Formula.FunctionList.DAVERAGE=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DCOUNT=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DCOUNTA=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DGET=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];
SocialCalc.Formula.FunctionList.DMAX=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DMIN=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DPRODUCT=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DSTDEV=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DSTDEVP=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];
SocialCalc.Formula.FunctionList.DSUM=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DVAR=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];SocialCalc.Formula.FunctionList.DVARP=[SocialCalc.Formula.DSeriesFunctions,3,"dfunc","","stat"];
SocialCalc.Formula.FieldToColnum=function(a,c,b,d,e,f){var g;if("n"==f.charAt(0))return f=e-0,0>=f||f>b?0:Math.floor(f);if("t"!=f.charAt(0))return 0;e=e?e.toLowerCase():"";for(f=0;f<b;f++)if(g=a.GetAssuredCell(SocialCalc.crToCoord(c+f,d)),g=g.datavalue,g=(g+"").toLowerCase(),g==e)return f+1;return 0};
SocialCalc.Formula.LookupFunctions=function(a,c,b,d){var e,f,g,l,h,n,p,r,t,q,s;s=SocialCalc.Formula;e=s.OperandValueAndType;var u=function(a,b){c.push({type:a,value:b})};e=e(d,b);"string"==typeof e.value&&(e.value=e.value.toLowerCase());f=s.TopOfStackValueAndType(d,b);g=1;if("MATCH"==a){if(b.length){g=s.OperandAsNumber(d,b);if("n"!=g.type.charAt(0)){u("e#VALUE!",0);return}if(b.length)return s.FunctionArgsError(a,c),0;g=g.value-0}}else{l=s.OperandAsNumber(d,b);if("n"!=l.type.charAt(0)){u("e#VALUE!",
0);return}l=Math.floor(l.value);if(b.length){g=s.OperandAsNumber(d,b);if("n"!=g.type.charAt(0)){u("e#VALUE!",0);return}if(b.length)return s.FunctionArgsError(a,c),0;g=g.value?1:0}}e.type=e.type.charAt(0);"n"==e.type&&(e.value-=0);if("range"!=f.type)return s.FunctionArgsError(a,c),0;if(b=s.DecodeRangeParts(d,f.value,f.type)){n=h=f=d=0;if("HLOOKUP"==a){if(h=1,l>b.nrows){u("e#REF!",0);return}}else if("VLOOKUP"==a){if(n=1,l>b.ncols){u("e#REF!",0);return}}else if("MATCH"==a)if(1<b.ncols){if(1<b.nrows){u("e#N/A",
0);return}h=1}else n=1;else return s.FunctionArgsError(a,c),0;if(1>l&&"MATCH"!=a)return u("e#VALUE!",0),0;for(p;;){s=SocialCalc.crToCoord(b.col1num+d,b.row1num+f);q=b.sheetdata.GetAssuredCell(s);s=q.datavalue;q=q.valuetype?q.valuetype.charAt(0):"b";"n"==q&&(s-=0);if(g)if("n"==e.type&&"n"==q){if(e.value==s)break;if(0<g&&e.value>s||0>g&&e.value<s)p=1,r=d,t=f;else if(p){p=2;break}}else{if("t"==e.type&&"t"==q){s="string"==typeof s?s.toLowerCase():"";if(e.value==s)break;if(0<g&&e.value>s||0>g&&e.value<
s)p=1,r=d,t=f;else if(p){p=2;break}}}else if("n"==e.type&&"n"==q){if(e.value==s)break}else if("t"==e.type&&"t"==q&&(s="string"==typeof s?s.toLowerCase():"",e.value==s))break;f+=n;d+=h;if(f>=b.nrows||d>=b.ncols){if(p){p=2;break}u("e#N/A",0);return}}2==p&&(f=t,d=r);"MATCH"==a?(s=d+f+1,q="n"):(s=SocialCalc.crToCoord(b.col1num+d+("VLOOKUP"==a?l-1:0),b.row1num+f+("HLOOKUP"==a?l-1:0)),q=b.sheetdata.GetAssuredCell(s),s=q.datavalue,q=q.valuetype);u(q,s)}else u("e#REF!",0)};
SocialCalc.Formula.FunctionList.HLOOKUP=[SocialCalc.Formula.LookupFunctions,-3,"hlookup","","lookup"];SocialCalc.Formula.FunctionList.MATCH=[SocialCalc.Formula.LookupFunctions,-2,"match","","lookup"];SocialCalc.Formula.FunctionList.VLOOKUP=[SocialCalc.Formula.LookupFunctions,-3,"vlookup","","lookup"];
SocialCalc.Formula.IndexFunction=function(a,c,b,d){var e,f,g,l,h=SocialCalc.Formula,n=function(a,b){c.push({type:a,value:b})};e=h.TopOfStackValueAndType(d,b);if("range"!=e.type)return h.FunctionArgsError(a,c),0;f=h.DecodeRangeParts(d,e.value,e.type);e=f.sheetname?"!"+f.sheetname:"";g={value:0};l={value:0};if(b.length){g=h.OperandAsNumber(d,b);if("n"!=g.type.charAt(0)||0>g.value){n("e#VALUE!",0);return}if(b.length){l=h.OperandAsNumber(d,b);if("n"!=l.type.charAt(0)||0>l.value){n("e#VALUE!",0);return}if(b.length)return h.FunctionArgsError(a,
c),0}else 1==f.nrows&&(l.value=g.value,g.value=0)}g.value>f.nrows||l.value>f.ncols?n("e#REF!",0):(0==g.value?0==l.value?1==f.nrows&&1==f.ncols?(a=SocialCalc.crToCoord(f.col1num,f.row1num)+e,b="coord"):(a=SocialCalc.crToCoord(f.col1num,f.row1num)+e+"|"+SocialCalc.crToCoord(f.col1num+f.ncols-1,f.row1num+f.nrows-1)+"|",b="range"):1==f.nrows?(a=SocialCalc.crToCoord(f.col1num+l.value-1,f.row1num)+e,b="coord"):(a=SocialCalc.crToCoord(f.col1num+l.value-1,f.row1num)+e+"|"+SocialCalc.crToCoord(f.col1num+l.value-
1,f.row1num+f.nrows-1)+"|",b="range"):0==l.value?1==f.ncols?(a=SocialCalc.crToCoord(f.col1num,f.row1num+g.value-1)+e,b="coord"):(a=SocialCalc.crToCoord(f.col1num,f.row1num+g.value-1)+e+"|"+SocialCalc.crToCoord(f.col1num+f.ncols-1,f.row1num+g.value-1)+"|",b="range"):(a=SocialCalc.crToCoord(f.col1num+l.value-1,f.row1num+g.value-1)+e,b="coord"),n(b,a))};SocialCalc.Formula.FunctionList.INDEX=[SocialCalc.Formula.IndexFunction,-1,"index","","lookup"];
SocialCalc.Formula.CountifSumifFunctions=function(a,c,b,d){var e,f,g,l,h=0,n="",p=0,r=SocialCalc.Formula,t=r.OperandValueAndType,q=r.LookupResultType,s=r.TypeLookupTable.plus;e=r.TopOfStackValueAndType(d,b);f=r.OperandAsText(d,b);if("SUMIF"==a)if(1==b.length)g=r.TopOfStackValueAndType(d,b);else if(0==b.length)g={value:e.value,type:e.type};else return r.FunctionArgsError(a,c),0;else g={value:e.value,type:e.type};"n"==f.type.charAt(0)?f.value+="":"e"==f.type.charAt(0)?f.value=null:"b"==f.type.charAt(0)&&
(f.value=null);if("coord"!=e.type&&"range"!=e.type||"SUMIF"==a&&"coord"!=g.type&&"range"!=g.type)return r.FunctionArgsError(a,c),0;b.push(e);e=[];for(e.push(g);b.length;)g=t(d,b),l=t(d,e),r.TestCriteria(g.value,g.type,f.value)&&(p+=1,"n"==l.type.charAt(0)?(h+=l.value-0,n=q(l.type,n||l.type,s)):"e"==l.type.charAt(0)&&"e"!=n.charAt(0)&&(n=l.type));"SUMIF"==a?c.push({type:n||"n",value:h}):"COUNTIF"==a&&c.push({type:"n",value:p})};
SocialCalc.Formula.FunctionList.COUNTIF=[SocialCalc.Formula.CountifSumifFunctions,2,"rangec","","stat"];SocialCalc.Formula.FunctionList.SUMIF=[SocialCalc.Formula.CountifSumifFunctions,-2,"sumif","","stat"];
SocialCalc.Formula.IfFunction=function(a,c,b,d){var e;d=SocialCalc.Formula.OperandValueAndType(d,b);e=d.type.charAt(0);if("n"!=e&&"b"!=e)c.push({type:"e#VALUE!",value:0});else{e=b.pop();if(1==b.length)a=b.pop();else if(0==b.length)a={type:"n",value:0};else{scf.FunctionArgsError(a,c);return}c.push(d.value?e:a)}};SocialCalc.Formula.FunctionList.IF=[SocialCalc.Formula.IfFunction,-2,"iffunc","","test"];
SocialCalc.Formula.DateFunction=function(a,c,b,d){a=SocialCalc.Formula;var e=0,f=a.OperandAsNumber(d,b),g=a.OperandAsNumber(d,b);b=a.OperandAsNumber(d,b);d=a.LookupResultType(f.type,g.type,a.TypeLookupTable.twoargnumeric);d=a.LookupResultType(d,b.type,a.TypeLookupTable.twoargnumeric);"n"==d.charAt(0)&&(e=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(Math.floor(f.value),Math.floor(g.value),Math.floor(b.value))-SocialCalc.FormatNumber.datevalues.julian_offset,d="nd");a.PushOperand(c,d,e)};
SocialCalc.Formula.FunctionList.DATE=[SocialCalc.Formula.DateFunction,3,"date","","datetime"];SocialCalc.Formula.TimeFunction=function(a,c,b,d){a=SocialCalc.Formula;var e=0,f=a.OperandAsNumber(d,b),g=a.OperandAsNumber(d,b);b=a.OperandAsNumber(d,b);d=a.LookupResultType(f.type,g.type,a.TypeLookupTable.twoargnumeric);d=a.LookupResultType(d,b.type,a.TypeLookupTable.twoargnumeric);"n"==d.charAt(0)&&(e=(3600*f.value+60*g.value+b.value)/86400,d="nt");a.PushOperand(c,d,e)};
SocialCalc.Formula.FunctionList.TIME=[SocialCalc.Formula.TimeFunction,3,"hms","","datetime"];
SocialCalc.Formula.DMYFunctions=function(a,c,b,d){var e,f=SocialCalc.Formula,g=0,l=f.OperandAsNumber(d,b),h=f.LookupResultType(l.type,l.type,f.TypeLookupTable.oneargnumeric);if("n"==h.charAt(0))switch(e=SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(l.value+SocialCalc.FormatNumber.datevalues.julian_offset)),a){case "DAY":g=e.day;break;case "MONTH":g=e.month;break;case "YEAR":g=e.year;break;case "WEEKDAY":e={value:1};if(b.length){e=f.OperandAsNumber(d,b);if("n"!=e.type.charAt(0)||
1>e.value||3<e.value){f.PushOperand(c,"e#VALUE!",0);return}if(b.length){f.FunctionArgsError(a,c);return}}a=6;1<e.value&&(a-=1);g=Math.floor(l.value+a)%7+(3>e.value?1:0)}f.PushOperand(c,h,g)};SocialCalc.Formula.FunctionList.DAY=[SocialCalc.Formula.DMYFunctions,1,"v","","datetime"];SocialCalc.Formula.FunctionList.MONTH=[SocialCalc.Formula.DMYFunctions,1,"v","","datetime"];SocialCalc.Formula.FunctionList.YEAR=[SocialCalc.Formula.DMYFunctions,1,"v","","datetime"];
SocialCalc.Formula.FunctionList.WEEKDAY=[SocialCalc.Formula.DMYFunctions,-1,"weekday","","datetime"];
SocialCalc.Formula.HMSFunctions=function(a,c,b,d){var e,f=SocialCalc.Formula,g=0,l=f.OperandAsNumber(d,b),h=f.LookupResultType(l.type,l.type,f.TypeLookupTable.oneargnumeric);if("n"==h.charAt(0)){if(0>l.value){f.PushOperand(c,"e#NUM!",0);return}e=l.value-Math.floor(l.value);e*=24;b=Math.floor(e);e-=Math.floor(e);e*=60;d=Math.floor(e);e-=Math.floor(e);e=Math.floor(60*e+(0<=l.value?0.5:-0.5));"HOUR"==a?g=b:"MINUTE"==a?g=d:"SECOND"==a&&(g=e)}f.PushOperand(c,h,g)};
SocialCalc.Formula.FunctionList.HOUR=[SocialCalc.Formula.HMSFunctions,1,"v","","datetime"];SocialCalc.Formula.FunctionList.MINUTE=[SocialCalc.Formula.HMSFunctions,1,"v","","datetime"];SocialCalc.Formula.FunctionList.SECOND=[SocialCalc.Formula.HMSFunctions,1,"v","","datetime"];
SocialCalc.Formula.ExactFunction=function(a,c,b,d){a=SocialCalc.Formula;var e=0,f="nl",g=a.OperandValueAndType(d,b),l=g.type.charAt(0);b=a.OperandValueAndType(d,b);d=b.type.charAt(0);"t"==l?"t"==d?e=g.value==b.value?1:0:"b"==d?e=g.value.length?0:1:"n"==d?e=g.value==b.value+""?1:0:"e"==d?(e=b.value,f=b.type):e=0:"n"==l?"n"==d?e=g.value-0==b.value-0?1:0:"b"==d?e=0:"t"==d?e=g.value+""==b.value?1:0:"e"==d?(e=b.value,f=b.type):e=0:"b"==l?"t"==d?e=b.value.length?0:1:"b"==d?e=1:"n"==d?e=0:"e"==d?(e=b.value,
f=b.type):e=0:"e"==l&&(e=g.value,f=g.type);a.PushOperand(c,f,e)};SocialCalc.Formula.FunctionList.EXACT=[SocialCalc.Formula.ExactFunction,2,"","","text"];
SocialCalc.Formula.ArgList={FIND:[1,1,0],LEFT:[1,0],LEN:[1],LOWER:[1],MID:[1,0,0],PROPER:[1],REPLACE:[1,0,0,1],REPT:[1,0],RIGHT:[1,0],SUBSTITUTE:[1,1,1,0],TRIM:[1],JGET:[1],WGET:[1,0,1],EVAL:[1],OGET:[1,0,1,1],QUOTE:[1],LAST:[1],BUTTON:[1,1],IFRAME:[1,1],BOX:[1,1],EMAIL:[1,1],TWEET:[1,1],DM:[1,1],JXTRACT:[1,1],UPPER:[1],ABAR:[0,0],ABSBAR:[1,0],RBAR:[0,0],STORE:[1,-1,-1]};
SocialCalc.Formula.StringFunctions=function(a,c,b,d){var e,f,g,l=SocialCalc.Formula;g=0;var h="e#VALUE!",n=b.length,p=l.ArgList[a],r=[],t=[];for(e=1;e<=n;e++){if(e>p.length){l.FunctionArgsError(a,c);return}0==p[e-1]?f=l.OperandAsNumber(d,b):1==p[e-1]?f=l.OperandAsText(d,b):-1==p[e-1]&&(f=l.OperandValueAndType(d,b));r[e]=f.value;t[e]=f.type;if("e"==f.type.charAt(0)){l.PushOperand(c,f.type,g);return}}switch(a){case "FIND":g=t[3]?r[3]-1:0;0>g?g="Start is before string":(g=r[2].indexOf(r[1],g),0<=g?(g+=
1,h="n"):g="Not found");break;case "LEFT":g=t[2]?r[2]-0:1;0>g?g="Negative length":(g=r[1].substring(0,g),h="t");break;case "LEN":g=r[1].length;h="n";break;case "LOWER":g=r[1].toLowerCase();h="t";break;case "MID":a=r[2]-0;g=r[3]-0;1>g||1>a?g="Bad arguments":(g=r[1].substring(a-1,a+g-1),h="t");break;case "PROPER":g=r[1].replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});h="t";break;case "REPLACE":a=r[2]-0;g=r[3]-0;0>g||1>a?g="Bad arguments":(g=r[1].substring(0,a-1)+
r[4]+r[1].substring(a-1+g),h="t");break;case "REPT":a=r[2]-0;if(0>a)g="Negative count";else{for(g="";0<a;a--)g+=r[1];h="t"}break;case "RIGHT":g=t[2]?r[2]-0:1;0>g?g="Negative length":(g=r[1].slice(-g),h="t");break;case "SUBSTITUTE":fulltext=r[1];oldtext=r[2];newtext=r[3];if(null!=r[4]){if(which=r[4]-0,0>=which){g="Non-positive instance number";break}}else which=0;oldpos=a=0;for(g="";;)if(pos=fulltext.indexOf(oldtext,oldpos),0<=pos){a++;g+=fulltext.substring(oldpos,pos);if(0==which)g+=newtext;else if(which==
a){g+=newtext+fulltext.substring(pos+oldtext.length);break}else g+=oldtext;oldpos=pos+oldtext.length}else{g+=fulltext.substring(oldpos);break}h="t";break;case "TRIM":g=r[1];g=g.replace(/^ */,"");g=g.replace(/ *$/,"");g=g.replace(/ +/g," ");h="t";break;case "UPPER":g=r[1].toUpperCase();h="t";break;case "EVAL":try{g=eval(r[1])}catch(q){g=JSON.stringify(q)}g+="";h="t";break;case "TWEET":if("undefined"!=typeof this.navigator){var s=new XMLHttpRequest;s.open("GET","http://"+_CONFIG.serviceserver+":"+_CONFIG.serviceport+
"/TWEET/"+r[1]+"/"+r[2]+"",!1);s.send(null);g=s.responseText}else try{var u=http_sync.request({host:_CONFIG.serviceserver,port:_CONFIG.serviceport,path:"/TWEET/"+r[1]+"/"+r[2]}),v=u.end();g=v.body.toString()}catch(w){console.log("HTTP ERR:"),console.log(w),g="HTTP ERROR"}h="t";break;case "DM":g=httpget(_CONFIG.serviceserver,_CONFIG.serviceport+"/DM/"+r[1]+"/"+r[2]+"");h="t";break;case "EMAIL":try{"undefined"!=typeof this.navigator?(s=new XMLHttpRequest,s.open("GET","http://"+_CONFIG.serviceserver+
":"+_CONFIG.serviceport+"/EMAIL/"+r[1]+"/"+r[2]+"",!1),s.send(null),g=s.responseText):(u=http_sync.request({host:_CONFIG.serviceserver,port:_CONFIG.serviceport,path:"/EMAIL/"+r[1]+"/"+r[2]}),v=u.end(),g=v.body.toString())}catch(x){g="Network Error"}h="t";break;case "JGET":"undefined"!=typeof this.navigator?(s=new XMLHttpRequest,s.open("GET","http://"+_CONFIG.Wserver+":"+_CONFIG.Wport+"/HGET/"+r[1]+".txt",!1),s.send(null),g=s.responseText):(u=http_sync.request({host:_CONFIG.Wserver,port:_CONFIG.Wport,
path:"/HGET/"+r[1]+".txt"}),v=u.end(),g=v.body.toString());h="t";break;case "WGET":g=httpget(r[1],r[2],r[3]);h="t";break;case "BUTTON":g="<button onclick='"+r[2]+"'>"+r[1]+"</button>";d.cells[_GCR_].textvalueformat=d.valueformathash["text-html"];h="t";break;case "IFRAME":""==r[2]&&(r[2]="width:100%;height:100%;border:none");g="<iframe src='"+r[1]+"'  style='"+r[2]+"' id='iframe_"+_GCR_+"'></iframe>";d.cells[_GCR_].textvalueformat=d.valueformathash["text-html"];h="t";break;case "ABSBAR":d.cells[_GCR_].textvalueformat=
d.valueformathash["text-html"];g='<svg style="height:20px;position:relative">   <rect x="0%" width="'+r[1]+'px" height="100%" style="fill:rgb('+r[2]+')" /> </svg>';h="t";break;case "ABAR":d.cells[_GCR_].textvalueformat=d.valueformathash["text-html"];g=0<r[2]?'<svg style="height:20px;position:relative">   <rect x="50%" width="'+r[2]+'%" height="100%" style="fill:rgb(0,211,0)" /> </svg>':'<svg style="height:20px;position:relative">   <rect x="'+(50+r[2])+'%" width="'+Math.abs(r[2])+'%" height="100%" style="fill:rgb(211,0,0)" /> </svg>';
h="t";break;case "RBAR":g='<svg style="height:20px;">   <rect width="50%" height="100%" style="fill:rgb(0,'+Math.round(255*Math.random())+","+Math.round(255*Math.random())+')" /> </svg>';h="t";d.cells[_GCR_].textvalueformat=d.valueformathash["text-html"];break;case "BOX":g='<svg style="height:16px;">   <rect width="100%" height="100%" style="fill:rgb('+r[1]+')">  </rect> <text style="fill:rgb(0,0,0);stroke:rgb(255,255,255)" stroke="white" stroke-width:"1" font-size="15" text-anchor="middle" x="50%" y="80%">'+
r[2]+"</text>  </svg>";h="t";d.cells[_GCR_].textvalueformat=d.valueformathash["text-html"];break;case "STORE":h="undefined"!=typeof this.navigator?btoa(r[3]):(new Buffer(r[3])).toString("base64");g=httpput(_CONFIG.HBRserver,_CONFIG.HBRport,"/"+r[1]+"/"+r[2]+"/value",'{"Row": { "@key":"'+r[2]+'", "Cell": { "@column":"value", "$":"'+h+'" } } }');h="t";break;case "OGET":try{var y=JSON.parse(httpget(r[1],r[2],r[3])),z=r[4].split("."),A=0;for(g=y;A<z.length;)g=g[z[A]],A++}catch(C){g=JSON.stringify(C)}g+=
"";h="t";break;case "JXTRACT":try{for(y=JSON.parse(r[1]),z=r[2].split("."),A=0,g=y;A<z.length;)g=g[z[A]],A++}catch(F){g=JSON.stringify(F)}g+="";h="t";break;case "LAST":try{y=JSON.parse(httpget(_CONFIG.corsproxyserver,_CONFIG.corsproxyport,"/www.batstrading.com/json/bzx/book/"+r[1].toUpperCase())),g=y.data.trades[0][2]}catch(I){g=JSON.stringify(I)}g+="";h="t";break;case "QUOTE":"undefined"!=typeof this.navigator?(s=new XMLHttpRequest,s.open("GET","http://"+_CONFIG.Wserver+":"+_CONFIG.Wport+"/HGET/quotes/"+
r[1]+".txt",!1),s.send(null),g=s.responseText):(u=http_sync.request({host:_CONFIG.Wserver,port:_CONFIG.Wport,path:"/HGET/quotes/"+r[1]+".txt"}),v=u.end(),g=v.body.toString()),h="t"}l.PushOperand(c,h,g)};SocialCalc.Formula.FunctionList.FIND=[SocialCalc.Formula.StringFunctions,-2,"find","","text"];SocialCalc.Formula.FunctionList.LEFT=[SocialCalc.Formula.StringFunctions,-2,"tc","","text"];SocialCalc.Formula.FunctionList.LEN=[SocialCalc.Formula.StringFunctions,1,"txt","","text"];
SocialCalc.Formula.FunctionList.LOWER=[SocialCalc.Formula.StringFunctions,1,"txt","","text"];SocialCalc.Formula.FunctionList.MID=[SocialCalc.Formula.StringFunctions,3,"mid","","text"];SocialCalc.Formula.FunctionList.PROPER=[SocialCalc.Formula.StringFunctions,1,"v","","text"];SocialCalc.Formula.FunctionList.REPLACE=[SocialCalc.Formula.StringFunctions,4,"replace","","text"];SocialCalc.Formula.FunctionList.REPT=[SocialCalc.Formula.StringFunctions,2,"tc","","text"];
SocialCalc.Formula.FunctionList.RIGHT=[SocialCalc.Formula.StringFunctions,-1,"tc","","text"];SocialCalc.Formula.FunctionList.SUBSTITUTE=[SocialCalc.Formula.StringFunctions,-3,"subs","","text"];SocialCalc.Formula.FunctionList.TRIM=[SocialCalc.Formula.StringFunctions,1,"v","","text"];SocialCalc.Formula.FunctionList.UPPER=[SocialCalc.Formula.StringFunctions,1,"v","","text"];SocialCalc.Formula.FunctionList.EMAIL=[SocialCalc.Formula.StringFunctions,2,"v","","text"];
SocialCalc.Formula.FunctionList.EVAL=[SocialCalc.Formula.StringFunctions,1,"v","","text"];SocialCalc.Formula.FunctionList.TWEET=[SocialCalc.Formula.StringFunctions,2,"v","","text"];SocialCalc.Formula.FunctionList.BUTTON=[SocialCalc.Formula.StringFunctions,2,"v","","text"];SocialCalc.Formula.FunctionList.IFRAME=[SocialCalc.Formula.StringFunctions,2,"v","","text"];SocialCalc.Formula.FunctionList.BOX=[SocialCalc.Formula.StringFunctions,2,"v","","text"];
SocialCalc.Formula.FunctionList.DM=[SocialCalc.Formula.StringFunctions,2,"v","","text"];SocialCalc.Formula.FunctionList.JGET=[SocialCalc.Formula.StringFunctions,1,"v","","text"];SocialCalc.Formula.FunctionList.WGET=[SocialCalc.Formula.StringFunctions,3,"v","","text"];SocialCalc.Formula.FunctionList.ABAR=[SocialCalc.Formula.StringFunctions,2,"v","","text"];SocialCalc.Formula.FunctionList.ABSBAR=[SocialCalc.Formula.StringFunctions,2,"v","","text"];
SocialCalc.Formula.FunctionList.RBAR=[SocialCalc.Formula.StringFunctions,2,"v","","text"];SocialCalc.Formula.FunctionList.STORE=[SocialCalc.Formula.StringFunctions,3,"v","","text"];SocialCalc.Formula.FunctionList.OGET=[SocialCalc.Formula.StringFunctions,4,"v","","text"];SocialCalc.Formula.FunctionList.JXTRACT=[SocialCalc.Formula.StringFunctions,2,"v","","text"];SocialCalc.Formula.FunctionList.QUOTE=[SocialCalc.Formula.StringFunctions,1,"v","","text"];
SocialCalc.Formula.FunctionList.LAST=[SocialCalc.Formula.StringFunctions,1,"v","","text"];
SocialCalc.Formula.IsFunctions=function(a,c,b,d){var e=SocialCalc.Formula,f=0;b=e.OperandValueAndType(d,b);d=b.type.charAt(0);switch(a){case "ISBLANK":f="b"==b.type?1:0;break;case "ISERR":f="e"==d?"e#N/A"==b.type?0:1:0;break;case "ISERROR":f="e"==d?1:0;break;case "ISLOGICAL":f="nl"==b.type?1:0;break;case "ISNA":f="e#N/A"==b.type?1:0;break;case "ISNONTEXT":f="t"==d?0:1;break;case "ISNUMBER":f="n"==d?1:0;break;case "ISTEXT":f="t"==d?1:0}e.PushOperand(c,"nl",f)};
SocialCalc.Formula.FunctionList.ISBLANK=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISERR=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISERROR=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISLOGICAL=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISNA=[SocialCalc.Formula.IsFunctions,1,"v","","test"];
SocialCalc.Formula.FunctionList.ISNONTEXT=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISNUMBER=[SocialCalc.Formula.IsFunctions,1,"v","","test"];SocialCalc.Formula.FunctionList.ISTEXT=[SocialCalc.Formula.IsFunctions,1,"v","","test"];
SocialCalc.Formula.NTVFunctions=function(a,c,b,d){var e=SocialCalc.Formula,f=0,g="e#VALUE!";b=e.OperandValueAndType(d,b);d=b.type.charAt(0);switch(a){case "N":f="n"==d?b.value-0:0;g="n";break;case "T":f="t"==d?b.value+"":"";g="t";break;case "VALUE":"n"==d||"b"==d?(f=b.value||0,g="n"):"t"==d&&(b=SocialCalc.DetermineValueType(b.value),"n"!=b.type.charAt(0)?(f=0,g="e#VALUE!"):(f=b.value-0,g="n"))}"e"==d&&(g=b.type);e.PushOperand(c,g,f)};
SocialCalc.Formula.FunctionList.N=[SocialCalc.Formula.NTVFunctions,1,"v","","math"];SocialCalc.Formula.FunctionList.T=[SocialCalc.Formula.NTVFunctions,1,"v","","text"];SocialCalc.Formula.FunctionList.VALUE=[SocialCalc.Formula.NTVFunctions,1,"v","","text"];
SocialCalc.Formula.Math1Functions=function(a,c,b,d){var e={},f=SocialCalc.Formula;d=f.OperandAsNumber(d,b);b=d.value;e.type=f.LookupResultType(d.type,d.type,f.TypeLookupTable.oneargnumeric);if("n"==e.type)switch(a){case "ABS":b=Math.abs(b);break;case "ACOS":-1<=b&&1>=b?b=Math.acos(b):e.type="e#NUM!";break;case "ASIN":-1<=b&&1>=b?b=Math.asin(b):e.type="e#NUM!";break;case "ATAN":b=Math.atan(b);break;case "COS":b=Math.cos(b);break;case "DEGREES":b=180*b/Math.PI;break;case "EVEN":b=0>b?-b:b;b=b!=Math.floor(b)?
Math.floor(b+1)+Math.floor(b+1)%2:b+b%2;0>d.value&&(b=-b);break;case "EXP":b=Math.exp(b);break;case "FACT":a=1;for(b=Math.floor(b);0<b;b--)a*=b;b=a;break;case "INT":b=Math.floor(b);break;case "LN":0>=b&&(e.type="e#NUM!",e.error=SocialCalc.Constants.s_sheetfunclnarg);b=Math.log(b);break;case "LOG10":0>=b&&(e.type="e#NUM!",e.error=SocialCalc.Constants.s_sheetfunclog10arg);b=Math.log(b)/Math.log(10);break;case "ODD":b=0>b?-b:b;b=b!=Math.floor(b)?Math.floor(b+1)+(1-Math.floor(b+1)%2):b+(1-b%2);0>d.value&&
(b=-b);break;case "RADIANS":b=b*Math.PI/180;break;case "SIN":b=Math.sin(b);break;case "SQRT":0<=b?b=Math.sqrt(b):e.type="e#NUM!";break;case "TAN":0!=Math.cos(b)?b=Math.tan(b):e.type="e#NUM!"}e.value=b;c.push(e);return null};SocialCalc.Formula.FunctionList.ABS=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.ACOS=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.ASIN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];
SocialCalc.Formula.FunctionList.ATAN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.COS=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.DEGREES=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.EVEN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.EXP=[SocialCalc.Formula.Math1Functions,1,"v","","math"];
SocialCalc.Formula.FunctionList.FACT=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.INT=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.LN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.LOG10=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.ODD=[SocialCalc.Formula.Math1Functions,1,"v","","math"];
SocialCalc.Formula.FunctionList.RADIANS=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.SIN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.SQRT=[SocialCalc.Formula.Math1Functions,1,"v","","math"];SocialCalc.Formula.FunctionList.TAN=[SocialCalc.Formula.Math1Functions,1,"v","","math"];
SocialCalc.Formula.Math2Functions=function(a,c,b,d){var e,f,g={};f=SocialCalc.Formula;e=f.OperandAsNumber(d,b);b=f.OperandAsNumber(d,b);g.type=f.LookupResultType(e.type,b.type,f.TypeLookupTable.twoargnumeric);if("n"==g.type)switch(a){case "ATAN2":0==e.value&&0==b.value?g.type="e#DIV/0!":g.value=Math.atan2(b.value,e.value);break;case "POWER":g.value=Math.pow(e.value,b.value);isNaN(g.value)&&(g.value=0,g.type="e#NUM!");break;case "MOD":0==b.value?g.type="e#DIV/0!":(a=e.value/b.value,a=Math.floor(a),
g.value=e.value-a*b.value);break;case "TRUNC":a=1;if(0<=b.value){b.value=Math.floor(b.value);for(f=0;f<b.value;f++)a*=10;g.value=Math.floor(Math.abs(e.value)*a)/a}else if(0>b.value){b.value=Math.floor(-b.value);for(f=0;f<b.value;f++)a*=10;g.value=Math.floor(Math.abs(e.value)/a)*a}0>e.value&&(g.value=-g.value)}c.push(g);return null};SocialCalc.Formula.FunctionList.ATAN2=[SocialCalc.Formula.Math2Functions,2,"xy","","math"];
SocialCalc.Formula.FunctionList.MOD=[SocialCalc.Formula.Math2Functions,2,"","","math"];SocialCalc.Formula.FunctionList.POWER=[SocialCalc.Formula.Math2Functions,2,"","","math"];SocialCalc.Formula.FunctionList.TRUNC=[SocialCalc.Formula.Math2Functions,2,"valpre","","math"];
SocialCalc.Formula.LogFunction=function(a,c,b,d){var e,f={},g=SocialCalc.Formula;f.value=0;e=g.OperandAsNumber(d,b);f.type=g.LookupResultType(e.type,e.type,g.TypeLookupTable.oneargnumeric);if(1==b.length){if(b=g.OperandAsNumber(d,b),"n"!=b.type.charAt(0)||0>=b.value)return g.FunctionSpecificError(a,c,"e#NUM!",SocialCalc.Constants.s_sheetfunclogsecondarg),0}else{if(0!=b.length)return g.FunctionArgsError(a,c),0;b={value:Math.E,type:"n"}}if("n"==f.type){if(0>=e.value)return g.FunctionSpecificError(a,
c,"e#NUM!",SocialCalc.Constants.s_sheetfunclogfirstarg),0;f.value=Math.log(e.value)/Math.log(b.value)}c.push(f)};SocialCalc.Formula.FunctionList.LOG=[SocialCalc.Formula.LogFunction,-1,"log","","math"];
SocialCalc.Formula.RoundFunction=function(a,c,b,d){var e,f,g=SocialCalc.Formula;f=0;var l="e#VALUE!";e=g.OperandValueAndType(d,b);l=g.LookupResultType(e.type,e.type,g.TypeLookupTable.oneargnumeric);if(1==b.length){if(b=g.OperandValueAndType(d,b),"n"!=b.type.charAt(0))return g.FunctionSpecificError(a,c,"e#NUM!",SocialCalc.Constants.s_sheetfuncroundsecondarg),0}else{if(0!=b.length)return g.FunctionArgsError(a,c),0;b={value:0,type:"n"}}if("n"==l)if(b.value-=0,0==b.value)f=Math.round(e.value);else if(0<
b.value){a=1;b.value=Math.floor(b.value);for(f=0;f<b.value;f++)a*=10;e=Math.round(e.value*a);f=e/a}else if(0>b.value){a=1;b.value=Math.floor(-b.value);for(f=0;f<b.value;f++)a*=10;e=Math.round(e.value/a);f=e*a}g.PushOperand(c,l,f)};SocialCalc.Formula.FunctionList.ROUND=[SocialCalc.Formula.RoundFunction,-1,"vp","","math"];
SocialCalc.Formula.CeilingFloorFunctions=function(a,c,b,d){var e=SocialCalc.Formula,f,g,l=function(a,b){c.push({type:a,value:b})};f=e.OperandValueAndType(d,b);g=f.type.charAt(0);if("n"!=g)l("e#VALUE!",0);else if(0==f.value)l("n",0);else{if(1==b.length){if(b=e.OperandValueAndType(d,b),g=f.type.charAt(0),"n"!=g){l("e#VALUE!",0);return}}else if(0==b.length)b={type:"n",value:0<f.value?1:-1};else{l("e#VALUE!",0);return}if(0==b.value)l("n",0);else if(0>b.value*f.value)l("e#NUM!",0);else switch(a){case "CEILING":l("n",
Math.ceil(f.value/b.value)*b.value);break;case "FLOOR":l("n",Math.floor(f.value/b.value)*b.value)}}};SocialCalc.Formula.FunctionList.CEILING=[SocialCalc.Formula.CeilingFloorFunctions,-1,"vsig","","math"];SocialCalc.Formula.FunctionList.FLOOR=[SocialCalc.Formula.CeilingFloorFunctions,-1,"vsig","","math"];
SocialCalc.Formula.AndOrFunctions=function(a,c,b,d){var e,f,g=SocialCalc.Formula,l="";for("AND"==a?f=1:"OR"==a&&(f=0);b.length;)e=g.OperandValueAndType(d,b),"n"==e.type.charAt(0)?(e.value-=0,"AND"==a?f=0!=e.value?f:0:"OR"==a&&(f=0!=e.value?1:f),l=g.LookupResultType(e.type,l||"nl",g.TypeLookupTable.propagateerror)):"e"==e.type.charAt(0)&&"e"!=l.charAt(0)&&(l=e.type);1>l.length&&(l="e#VALUE!",f=0);g.PushOperand(c,l,f)};
SocialCalc.Formula.FunctionList.AND=[SocialCalc.Formula.AndOrFunctions,-1,"vn","","test"];SocialCalc.Formula.FunctionList.OR=[SocialCalc.Formula.AndOrFunctions,-1,"vn","","test"];SocialCalc.Formula.NotFunction=function(a,c,b,d){a=0;var e=SocialCalc.Formula;b=e.OperandValueAndType(d,b);d=e.LookupResultType(b.type,b.type,e.TypeLookupTable.propagateerror);"n"==b.type.charAt(0)||"b"==b.type?(a=0!=b.value-0?0:1,d="nl"):"t"==b.type.charAt(0)&&(d="e#VALUE!");e.PushOperand(c,d,a)};
SocialCalc.Formula.FunctionList.NOT=[SocialCalc.Formula.NotFunction,1,"v","","test"];SocialCalc.Formula.ChooseFunction=function(a,c,b,d){var e,f,g=0,l=SocialCalc.Formula,h=l.OperandAsNumber(d,b);"n"!=h.type.charAt(0)&&(h.value=0);h.value=Math.floor(h.value);for(a=0;b.length;)if(f=l.TopOfStackValueAndType(d,b),a+=1,h.value==a){g=f.value;e=f.type;break}e?l.PushOperand(c,e,g):l.PushOperand(c,"e#VALUE!",0)};SocialCalc.Formula.FunctionList.CHOOSE=[SocialCalc.Formula.ChooseFunction,-2,"choose","","lookup"];
SocialCalc.Formula.ColumnsRowsFunctions=function(a,c,b,d){var e=0,f=SocialCalc.Formula;b=f.TopOfStackValueAndType(d,b);"coord"==b.type?(e=1,a="n"):"range"==b.type?(d=f.DecodeRangeParts(d,b.value),"COLUMNS"==a?e=d.ncols:"ROWS"==a&&(e=d.nrows),a="n"):(e=0,a="e#VALUE!");f.PushOperand(c,a,e)};SocialCalc.Formula.FunctionList.COLUMNS=[SocialCalc.Formula.ColumnsRowsFunctions,1,"range","","lookup"];SocialCalc.Formula.FunctionList.ROWS=[SocialCalc.Formula.ColumnsRowsFunctions,1,"range","","lookup"];
SocialCalc.Formula.ZeroArgFunctions=function(a,c,b,d){b={value:0};switch(a){case "FALSE":b.type="nl";b.value=0;break;case "NA":b.type="e#N/A";break;case "NOW":a=new Date;d=a.getTimezoneOffset();a=a.getTime()/1E3;b.value=25569+a/86400-d/1440;b.type="ndt";SocialCalc.Formula.FreshnessInfo.volatile.NOW=!0;break;case "EPOCH":a=new Date;a.getTimezoneOffset();a.getTime();a=Math.round((new Date).getTime()/1E3);b.value=a;b.type="n";SocialCalc.Formula.FreshnessInfo.volatile.NOW=!0;break;case "PI":b.type="n";
b.value=Math.PI;break;case "TODAY":a=new Date;d=a.getTimezoneOffset();a=a.getTime()/1E3;b.value=Math.floor(25569+a/86400-d/1440);b.type="nd";SocialCalc.Formula.FreshnessInfo.volatile.TODAY=!0;break;case "TRUE":b.type="nl",b.value=1}c.push(b);return null};SocialCalc.Formula.FunctionList.FALSE=[SocialCalc.Formula.ZeroArgFunctions,0,"","","test"];SocialCalc.Formula.FunctionList.NA=[SocialCalc.Formula.ZeroArgFunctions,0,"","","test"];
SocialCalc.Formula.FunctionList.NOW=[SocialCalc.Formula.ZeroArgFunctions,0,"","","datetime"];SocialCalc.Formula.FunctionList.EPOCH=[SocialCalc.Formula.ZeroArgFunctions,0,"","","math"];SocialCalc.Formula.FunctionList.PI=[SocialCalc.Formula.ZeroArgFunctions,0,"","","math"];SocialCalc.Formula.FunctionList.TODAY=[SocialCalc.Formula.ZeroArgFunctions,0,"","","datetime"];SocialCalc.Formula.FunctionList.TRUE=[SocialCalc.Formula.ZeroArgFunctions,0,"","","test"];
SocialCalc.Formula.DDBFunction=function(a,c,b,d){var e,f=SocialCalc.Formula,g=f.OperandAsNumber(d,b),l=f.OperandAsNumber(d,b),h=f.OperandAsNumber(d,b),n=f.OperandAsNumber(d,b);if(!(f.CheckForErrorValue(c,g)||f.CheckForErrorValue(c,l)||f.CheckForErrorValue(c,h)||f.CheckForErrorValue(c,n))){if(1>h.value)return f.FunctionSpecificError(a,c,"e#NUM!",SocialCalc.Constants.s_sheetfuncddblife),0;e={value:2,type:"n"};0<b.length&&(e=f.OperandAsNumber(d,b));if(0!=b.length)return f.FunctionArgsError(a,c),0;if(!f.CheckForErrorValue(c,
e)){b=a=0;for(d=1;d<=n.value-0&&d<=h.value;d++)a=(g.value-b)*(e.value/h.value),g.value-b-a<l.value&&(a=g.value-b-l.value),b+=a;f.PushOperand(c,"n$",a)}}};SocialCalc.Formula.FunctionList.DDB=[SocialCalc.Formula.DDBFunction,-4,"ddb","","financial"];
SocialCalc.Formula.SLNFunction=function(a,c,b,d){var e=SocialCalc.Formula,f=e.OperandAsNumber(d,b),g=e.OperandAsNumber(d,b);b=e.OperandAsNumber(d,b);if(!e.CheckForErrorValue(c,f)&&!e.CheckForErrorValue(c,g)&&!e.CheckForErrorValue(c,b)){if(1>b.value)return e.FunctionSpecificError(a,c,"e#NUM!",SocialCalc.Constants.s_sheetfuncslnlife),0;a=(f.value-g.value)/b.value;e.PushOperand(c,"n$",a)}};SocialCalc.Formula.FunctionList.SLN=[SocialCalc.Formula.SLNFunction,3,"csl","","financial"];
SocialCalc.Formula.SYDFunction=function(a,c,b,d){var e;a=SocialCalc.Formula;e=a.OperandAsNumber(d,b);var f=a.OperandAsNumber(d,b),g=a.OperandAsNumber(d,b);d=a.OperandAsNumber(d,b);if(!(a.CheckForErrorValue(c,e)||a.CheckForErrorValue(c,f)||a.CheckForErrorValue(c,g)||a.CheckForErrorValue(c,d))){if(1>g.value||0>=d.value)return a.PushOperand(c,"e#NUM!",0),0;b=(g.value+1)*g.value/2;e=(e.value-f.value)*(g.value-d.value+1)/b;a.PushOperand(c,"n$",e)}};
SocialCalc.Formula.FunctionList.SYD=[SocialCalc.Formula.SYDFunction,4,"cslp","","financial"];
SocialCalc.Formula.InterestFunctions=function(a,c,b,d){var e,f,g,l,h,n,p,r,t,q=SocialCalc.Formula,s=q.OperandAsNumber(d,b);p=q.OperandAsNumber(d,b);n=q.OperandAsNumber(d,b);e=q.LookupResultType(s.type,p.type,q.TypeLookupTable.twoargnumeric);e=q.LookupResultType(e,n.type,q.TypeLookupTable.twoargnumeric);if(b.length&&(g=q.OperandAsNumber(d,b),e=q.LookupResultType(e,g.type,q.TypeLookupTable.twoargnumeric),b.length&&(l=q.OperandAsNumber(d,b),e=q.LookupResultType(e,l.type,q.TypeLookupTable.twoargnumeric),
b.length))){if("RATE"!=a)return q.FunctionArgsError(a,c),0;h=q.OperandAsNumber(d,b);e=q.LookupResultType(e,h.type,q.TypeLookupTable.twoargnumeric)}if("n"==e)switch(a){case "FV":h=s.value;a=p.value;p=n.value;n=null!=g?g.value:0;l=null!=l?l.value?1:0:0;f=g=0==h?-n-p*a:-(n*Math.pow(1+h,a)+p*(1+h*l)*(Math.pow(1+h,a)-1)/h);e="n$";break;case "NPER":h=s.value;p=p.value;n=n.value;g=null!=g?g.value:0;l=null!=l?l.value?1:0:0;if(0==h){if(0==p){q.PushOperand(c,"e#NUM!",0);return}a=(n+g)/-p}else{r=p*(1+h*l)/h;
t=n+r;if(0==t||-1>=h){q.PushOperand(c,"e#NUM!",0);return}r=(r-g)/t;if(0>=r){q.PushOperand(c,"e#NUM!",0);return}r=Math.log(r);t=Math.log(1+h);a=r/t}f=a;e="n";break;case "PMT":h=s.value;a=p.value;n=n.value;g=null!=g?g.value:0;l=null!=l?l.value?1:0:0;if(0==a){q.PushOperand(c,"e#NUM!",0);return}f=p=0==h?(g-n)/a:(0-g-n*Math.pow(1+h,a))/((1+h*l)*(Math.pow(1+h,a)-1)/h);e="n$";break;case "PV":h=s.value;a=p.value;p=n.value;g=null!=g?g.value:0;l=null!=l?l.value?1:0:0;if(-1==h){q.PushOperand(c,"e#DIV/0!",0);
return}f=n=0==h?-g-p*a:(-g-p*(1+h*l)*(Math.pow(1+h,a)-1)/h)/Math.pow(1+h,a);e="n$";break;case "RATE":a=s.value;p=p.value;n=n.value;g=null!=g?g.value:0;l=null!=l?l.value?1:0:0;h=null!=h?h.value:0.1;b=0;delta=1;epsilon=1E-7;for(h=h||1E-8;(0<=delta?delta:-delta)>epsilon&&h!=r;)if(delta=g+n*Math.pow(1+h,a)+p*(1+h*l)*(Math.pow(1+h,a)-1)/h,null!=t?(t=(delta-t)/(h-r)||0.001,r=h,h-=delta/t):(r=h,h*=1.1),t=delta,b++,100<=b){q.PushOperand(c,"e#NUM!",0);return}f=h;e="n%"}q.PushOperand(c,e,f)};
SocialCalc.Formula.FunctionList.FV=[SocialCalc.Formula.InterestFunctions,-3,"fv","","financial"];SocialCalc.Formula.FunctionList.NPER=[SocialCalc.Formula.InterestFunctions,-3,"nper","","financial"];SocialCalc.Formula.FunctionList.PMT=[SocialCalc.Formula.InterestFunctions,-3,"pmt","","financial"];SocialCalc.Formula.FunctionList.PV=[SocialCalc.Formula.InterestFunctions,-3,"pv","","financial"];SocialCalc.Formula.FunctionList.RATE=[SocialCalc.Formula.InterestFunctions,-3,"rate","","financial"];
SocialCalc.Formula.NPVFunction=function(a,c,b,d){var e,f,g,l,h=SocialCalc.Formula;e=h.OperandAsNumber(d,b);if(!h.CheckForErrorValue(c,e)){f=0;a="n";for(g=1;b.length;)if(l=h.OperandValueAndType(d,b),"n"==l.type.charAt(0)){g*=1+e.value;if(0==g){h.PushOperand(c,"e#DIV/0!",0);return}f+=l.value/g;a=h.LookupResultType(l.type,a||l.type,h.TypeLookupTable.plus)}else if("e"==l.type.charAt(0)&&"e"!=a.charAt(0)){a=l.type;break}"n"==a.charAt(0)&&(a="n$");h.PushOperand(c,a,f)}};
SocialCalc.Formula.FunctionList.NPV=[SocialCalc.Formula.NPVFunction,-2,"npv","","financial"];
SocialCalc.Formula.IRRFunction=function(a,c,b,d){var e,f,g,l;l=[];var h=[],n=SocialCalc.Formula;for(l.push(b.pop());l.length;)if(e=n.OperandValueAndType(d,l),"n"==e.type.charAt(0))h.push(e.value);else if("e"==e.type.charAt(0)){n.PushOperand(c,"e#VALUE!",0);return}if(h.length){e={value:0};if(b.length){e=n.OperandAsNumber(d,b);if("n"!=e.type.charAt(0)&&"b"!=e.type.charAt(0)){n.PushOperand(c,"e#VALUE!",0);return}if(b.length){n.FunctionArgsError(a,c);return}}e.value=e.value||0.1;a=0;b=e.value;for(d=1;1E-7<
(0<=d?d:-d)&&b!=g;){d=0;e=1;for(l=0;l<h.length;l++){e*=1+b;if(0==e){n.PushOperand(c,"e#DIV/0!",0);return}d+=h[l]/e}null!=f?(f=(d-f)/(b-g),g=b,b-=d/f):(g=b,b*=1.1);f=d;a++;if(20<=a){n.PushOperand(c,"e#NUM!",0);return}}n.PushOperand(c,"n%",b)}else n.PushOperand(c,"e#NUM!",0)};SocialCalc.Formula.FunctionList.IRR=[SocialCalc.Formula.IRRFunction,-1,"irr","","financial"];SocialCalc.Formula.SheetCache={sheets:{},waitingForLoading:null,constants:{asloaded:0,recalcing:1,recalcdone:2},loadsheet:null};
SocialCalc.Formula.FindInSheetCache=function(a){var c=SocialCalc.Formula.SheetCache;a=SocialCalc.Formula.NormalizeSheetName(a);if(c.sheets[a])return c.sheets[a].sheet;if(c.waitingForLoading)return null;if(c.loadsheet)return alert("Using SocialCalc.Formula.SheetCache.loadsheet - deprecated"),SocialCalc.Formula.AddSheetToCache(a,c.loadsheet(a));c.waitingForLoading=a;return null};
SocialCalc.Formula.AddSheetToCache=function(a,c,b){var d=null,e=SocialCalc.Formula.SheetCache,f=e.constants;a=SocialCalc.Formula.NormalizeSheetName(a);c&&(d=new SocialCalc.Sheet,d.ParseSheetSave(c));e.sheets[a]={sheet:d,recalcstate:f.asloaded,name:a};SocialCalc.Formula.FreshnessInfo.sheets[a]="undefined"==typeof b||!1===b;return d};SocialCalc.Formula.NormalizeSheetName=function(a){return SocialCalc.Callbacks.NormalizeSheetName?SocialCalc.Callbacks.NormalizeSheetName(a):a.toLowerCase()};
SocialCalc.Formula.RemoteFunctionInfo={waitingForServer:null};SocialCalc.Formula.FreshnessInfo={sheets:{},volatile:{},recalc_completed:!1};SocialCalc.Formula.FreshnessInfoReset=function(){var a=SocialCalc.Formula.FreshnessInfo,c=SocialCalc.Formula.SheetCache,b;for(b in a.sheets)!1===a.sheets[b]&&delete c.sheets[b];a.sheets={};a.volatile={};a.recalc_completed=!1};SocialCalc.Formula.PlainCoord=function(a){return-1==a.indexOf("$")?a:a.replace(/\$/g,"")};
SocialCalc.Formula.OrderRangeParts=function(a,c){var b,d,e={};b=SocialCalc.coordToCr(a);d=SocialCalc.coordToCr(c);b.col>d.col?(e.c1=d.col,e.c2=b.col):(e.c1=b.col,e.c2=d.col);b.row>d.row?(e.r1=d.row,e.r2=b.row):(e.r1=b.row,e.r2=d.row);return e};
SocialCalc.Formula.TestCriteria=function(a,c,b){var d,e,f;if(null==b)return!1;b+="";d=b.charAt(0);"="==d||"<"==d||">"==d?b=b.substring(1):(d=b.substring(0,2),"<="==d||"<>"==d||">="==d?b=b.substring(2):d="none");b=SocialCalc.DetermineValueType(b);if(!b.type){if("none"==d)return!1;if("b"==c.charAt(0)){if("="==d)return!0}else if("<>"==d)return!0;return!1}e=!1;"n"==b.type.charAt(0)&&"t"==c.charAt(0)&&(f=SocialCalc.DetermineValueType(a),"n"==f.type.charAt(0)&&(a=f.value,c=f.type));if("n"==c.charAt(0)&&
"n"==b.type.charAt(0))switch(a-=0,b.value-=0,d){case "<":e=a<b.value;break;case "<=":e=a<=b.value;break;case "=":case "none":e=a==b.value;break;case ">=":e=a>=b.value;break;case ">":e=a>b.value;break;case "<>":e=a!=b.value}else if("e"==c.charAt(0))e=!1;else if("e"==b.type.charAt(0))e=!1;else{"n"==c.charAt(0)&&(a=SocialCalc.format_number_for_display(a,"n",""));if("n"==b.type.charAt(0))return!1;a=a?a.toLowerCase():"";b.value=b.value?b.value.toLowerCase():"";switch(d){case "<":e=a<b.value;break;case "<=":e=
a<=b.value;break;case "=":e=a==b.value;break;case "none":e=a.substring(0,b.value.length)==b.value;break;case ">=":e=a>=b.value;break;case ">":e=a>b.value;break;case "<>":e=a!=b.value}}return e};_GCR_="";cl=console.log;R2D=SocialCalc.Formula.RangeTo2D;function _c(a){return SocialCalc.GetSpreadsheetControlObject().sheet.cells[a]?SocialCalc.GetSpreadsheetControlObject().sheet.cells[a].datavalue:""}ixDP=function(a,c){return[{name:a,columns:["value"],points:[[c]]}]};ixPost=function(a,c,b,d){b=void 0==b?_CONFIG.IDBuser:b;d=void 0==d?_CONFIG.IDBpw:d;httppost_A(_CONFIG.IDBserver,_CONFIG.IDBport,"/db/"+c+"/series?u="+b+"&p="+d,JSON.stringify(a))};
Transpose=function(a){if(0==a.length||0==a[0].length)return null;for(var c=[],b=0;b<a[0].length;++b)c.push([]);for(b=0;b<a.length;++b)for(var d=0;d<a[b].length;++d)c[d][b]=a[b][d];return c};
function httpget(a,c,b,d){d=d?"https://":"http://";console.log("GET "+a+" "+c+" "+b);"undefined"===typeof c&&(c=80);"undefined"===typeof b&&(b="/");var e="";try{if("undefined"!=typeof this.navigator){var f=new XMLHttpRequest;f.open("GET",d+a+":"+c+b,!1);f.send(null);e=f.responseText}else e=http_sync.request({host:a,port:c,path:b}).end().body.toString()}catch(g){e="Exception, check your params and connectivity. Use proxy on port 8012 to get around Cross origin issues. Exception: "+JSON.stringify(g)}return e}
function httpput(a,c,b,d){console.log("PUT "+a+" "+c+" "+b);"undefined"===typeof c&&(c=80);"undefined"===typeof b&&(b="/");var e="";try{if("undefined"!=typeof this.navigator){var f=new XMLHttpRequest;f.open("PUT","http://"+a+":"+c+b,!1);f.setRequestHeader("Content-Type","application/json");f.setRequestHeader("Accept","application/json");f.send(d);e=f.responseText}else e=http_sync.request({method:"PUT",host:a,port:c,path:b,body:d}).end().body.toString()}catch(g){e="Exception, check your params and connectivity. Use proxy on port 8012 to get around Cross origin issues. Exception: "+
JSON.stringify(g)}return e}
function httppost(a,c,b,d){console.log("POST "+a+" "+c+" "+b);"undefined"===typeof c&&(c=80);"undefined"===typeof b&&(b="/");var e="";try{if("undefined"!=typeof this.navigator){var f=new XMLHttpRequest;f.open("POST","http://"+a+":"+c+b,!1);f.setRequestHeader("Content-Type","application/x-www-form-urlencoded");f.setRequestHeader("Accept","application/json");f.send(d);e=f.responseText}else{var g=http_sync.request({method:"POST",host:a,port:c,path:b,body:d}).end();console.log(g);e="TODOFIX"}}catch(l){e=
"Exception, check your params and connectivity. Use proxy on port 8012 to get around Cross origin issues. Exception: "+JSON.stringify(l)}console.log("httppost returning"+e);return e}
function httppost_A(a,c,b,d){if("undefined"!=typeof this.navigator)return httppost(a,c,b,d);console.log("POST async 2 "+a+" "+c+" "+b+" body:"+d);"undefined"===typeof c&&(c=80);"undefined"===typeof b&&(b="/");var e="";try{var f=http.request({method:"POST",host:a,port:c,path:b,body:d,headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":Buffer.byteLength(d)}});f.write(d);f.on("error",function(a){console.log(a)});f.end();e="sent."}catch(g){e="Exception, check your params and connectivity. Use proxy on port 8012 to get around Cross origin issues. Exception: "+
JSON.stringify(g)}console.log("httppost returning"+e);return e}
SocialCalc.Formula.CovarFunction=function(a,c,b,d){var e,f=SocialCalc.Formula,g=0,l=0,h=[],n=[],p,r;for(a=function(a,b){c.push({type:a,value:b})};0<b.length;){n=[];e=f.TopOfStackValueAndType(d,b);if("range"!=e.type){a("e#VALUE!",0);return}rangeinfo=f.DecodeRangeParts(d,e.value);if(!g)g=rangeinfo.ncols;else if(g!=rangeinfo.ncols){a("e#VALUE!",0);return}if(!l)l=rangeinfo.nrows;else if(l!=rangeinfo.nrows){a("e#VALUE!",0);return}if(1<g&&1<l){a("e#VALUE!",0);return}for(i=0;i<rangeinfo.ncols;i++)for(j=
0;j<rangeinfo.nrows;j++)k=i*rangeinfo.nrows+j,cellcr=SocialCalc.crToCoord(rangeinfo.col1num+i,rangeinfo.row1num+j),cell=rangeinfo.sheetdata.GetAssuredCell(cellcr),value="n"==cell.valuetype?cell.datavalue:0,n.push(value);h.push(n)}if(h[0].length!=h[1].length)a("e#VALUE!",0);else{r=g=d=0;e=h[0][0];l=h[1][0];for(b=1;b<h[0].length;b++)p=(b-1)/b,f=h[0][b]-e,n=h[1][b]-l,d+=f*f*p,g+=n*n*p,r+=f*n*p,e+=f/b,l+=n/b;Math.sqrt(d/h[0].length);Math.sqrt(g/h[0].length);h=r/h[0].length;a("n",h)}};
SocialCalc.Formula.FunctionList.COVAR=[SocialCalc.Formula.CovarFunction,2,"rangen","","stat"];SocialCalc.Formula.ADFFunction=function(a,c,b,d){console.log("ADF");d=SocialCalc.Formula;console.log("fname:"+a);console.log("operand:"+JSON.stringify(c));console.log("foperand:"+JSON.stringify(b));console.log("prePOST "+_CONFIG.RapServer+" "+_CONFIG.RapPort+" /ADF "+d.RangeToString(b[0].value));a=httppost(_CONFIG.RapServer,_CONFIG.RapPort,"/ADF","param="+d.RangeToString(b[0].value));c.push({type:"t",value:a})};
SocialCalc.Formula.FunctionList.ADF=[SocialCalc.Formula.ADFFunction,1,"rangen","","stat"];SocialCalc.Formula.KPSSFunction=function(a,c,b,d){console.log("ADF");a=httppost(_CONFIG.RapServer,_CONFIG.RapPort,"/KPSS","param="+SocialCalc.Formula.RangeToString(b[0].value));c.push({type:"t",value:a})};SocialCalc.Formula.FunctionList.KPSS=[SocialCalc.Formula.KPSSFunction,1,"rangen","","stat"];
SocialCalc.Formula.REvalFunction=function(a,c,b,d){a=httppost(_CONFIG.RapServer,_CONFIG.RapPort,_CONFIG.RapPath,"param="+encodeURIComponent(b[0].value));c.push({type:"t",value:a})};SocialCalc.Formula.FunctionList.REVAL=[SocialCalc.Formula.REvalFunction,1,"rangen","","stat"];
function EpochToGMT(a){"L"==a.charAt(a.length-1)&&(a=a.slice(0,-1));a*=1;var c="";1E14<=a?(Math.round(a/1E6),a=Math.round(a/1E3)):1E11<=a?Math.round(a/1E3):a*=1E3;a=new Date(a);var b=a.toLocaleString(),d=b.search(/GMT/i);0<d&&b.substring(0,d);return c+=""+a.toGMTString()}
SocialCalc.Formula.EmailIfFunction=function(a,c,b,d){var e;d=SocialCalc.Formula.OperandValueAndType(d,b);e=d.type.charAt(0);if("n"!=e&&"b"!=e)c.push({type:"e#VALUE!",value:0});else{e=b.pop();if(1==b.length)a=b.pop();else if(0==b.length)a={type:"n",value:0};else{scf.FunctionArgsError(a,c);return}d.value?c.push({type:"t",value:httpget(_CONFIG.serviceserver,_CONFIG.serviceport,"/EMAIL/"+e.value+"/"+a.value)}):c.push({type:"n",value:0})}};
SocialCalc.Formula.FunctionList.EMAILIF=[SocialCalc.Formula.EmailIfFunction,3,"emailiffunc","","test"];
SocialCalc.Formula.StoreIfFunction=function(a,c,b,d){a=SocialCalc.Formula.OperandValueAndType(d,b);d=a.type.charAt(0);if("n"!=d&&"b"!=d)c.push({type:"e#VALUE!",value:0});else{var e;d=b.pop();e=b.pop();op3=b.pop();b="undefined"!=typeof this.navigator?btoa(op3.value):(new Buffer(op3.value)).toString("base64");a.value?c.push({type:"t",value:httpput(_CONFIG.HBRserver,_CONFIG.HBRport,"/"+d.value+"/"+e.value+"/value",'{"Row": { "@key":"'+e.value+'", "Cell": { "@column":"value", "$":"'+b+'" } } }')}):c.push({type:"n",
value:0})}};SocialCalc.Formula.FunctionList.STOREIF=[SocialCalc.Formula.StoreIfFunction,4,"emailiffunc","","test"];
SocialCalc.Formula.DMIfFunction=function(a,c,b,d){var e;d=SocialCalc.Formula.OperandValueAndType(d,b);e=d.type.charAt(0);if("n"!=e&&"b"!=e)c.push({type:"e#VALUE!",value:0});else{e=b.pop();if(1==b.length)a=b.pop();else if(0==b.length)a={type:"n",value:0};else{scf.FunctionArgsError(a,c);return}d.value?c.push({type:"t",value:httpget(_CONFIG.serviceserver,_CONFIG.serviceport,"/DM/"+e.value+"/"+a.value)}):c.push({type:"n",value:0})}};
SocialCalc.Formula.FunctionList.DMIF=[SocialCalc.Formula.DMIfFunction,3,"dmiffunc","","test"];
SocialCalc.Formula.TweetIfFunction=function(a,c,b,d){var e;d=SocialCalc.Formula.OperandValueAndType(d,b);e=d.type.charAt(0);if("n"!=e&&"b"!=e)c.push({type:"e#VALUE!",value:0});else{e=b.pop();if(1==b.length)a=b.pop();else if(0==b.length)a={type:"n",value:0};else{scf.FunctionArgsError(a,c);return}d.value?c.push({type:"t",value:httpget(_CONFIG.serviceserver,_CONFIG.serviceport,"/TWEET/"+e.value+"/"+a.value)}):c.push({type:"n",value:0})}};
SocialCalc.Formula.FunctionList.TWEETIF=[SocialCalc.Formula.TweetIfFunction,3,"tweetiffunc","","test"];
SocialCalc.Formula.SeFunction=function(a,c,b,d){var e;console.log("FNAME:");console.log(a);console.log("operand:");console.log(c);console.log("foperand:");console.log(b);d=SocialCalc.Formula.OperandValueAndType(d,b);e=d.type.charAt(0);if("n"!=e&&"b"!=e)c.push({type:"e#VALUE!",value:0});else{e=b.pop();if(1==b.length)a=b.pop();else if(0==b.length)a={type:"n",value:0};else{scf.FunctionArgsError(a,c);return}var f;d.value?f=SocialCalc.Formula.evaluate_parsed_formula(SocialCalc.Formula.ParseFormulaIntoTokens(e.value)):
SocialCalc.Formula.evaluate_parsed_formula(SocialCalc.Formula.ParseFormulaIntoTokens(a.value));console.log("res");console.log(f);c.push({value:f.value,type:f.type})}};SocialCalc.Formula.FunctionList.SE=[SocialCalc.Formula.SeFunction,-2,"sefunc","","test"];var __EC_HBASE_SERVER="url.com ";_CONFIG={IOloglevel:2,serviceserver:"serv.recal.cc",serviceport:80,corsproxyserver:"www.corsproxy.com",corproxyport:80,urlpath:"http://static.recal.cc",HBRserver:"h.recal.cc",HBRport:80,Wserver:"smsm.4irc.com",Wport:8042,Wprefix:"/HGET/",XLLserver:"fe",XLLport:"8047",XLLurl:"Rserver.r",RapServer:"r.at.recal.cc",RapPort:80,RapPath:"/E",ProxyServer:"recal.cc",ProxyPort:8012};SocialCalc||(SocialCalc={});SocialCalc.Popup={};SocialCalc.Popup.Types={};SocialCalc.Popup.Controls={};SocialCalc.Popup.Current={};SocialCalc.Popup.LocalizeString=function(a){return a};SocialCalc.Popup.Create=function(a,c,b){var d=SocialCalc.Popup.Types[a];d&&d.Create&&d.Create(a,c,b);SocialCalc.Popup.imagePrefix=SocialCalc.Constants.defaultImagePrefix};
SocialCalc.Popup.SetValue=function(a,c){var b=SocialCalc.Popup,d=b.Types,e=b.Controls;e[a]?(b=e[a].type,d=d[b],e=e[a].data,d&&d.Create&&(d.SetValue(b,a,c),e.attribs&&e.attribs.changedcallback&&e.attribs.changedcallback(e.attribs,a,c))):alert("Unknown control "+a)};
SocialCalc.Popup.SetDisabled=function(a,c){var b=SocialCalc.Popup,d=b.Types,e=b.Controls;e[a]?(e=e[a].type,(d=d[e])&&d.Create&&(b.Current.id&&a==b.Current.id&&(d.Hide(e,b.Current.id),b.Current.id=null),d.SetDisabled(e,a,c))):alert("Unknown control "+a)};SocialCalc.Popup.GetValue=function(a){var c=SocialCalc.Popup,b=c.Types,c=c.Controls;if(c[a])return c=c[a].type,(b=b[c])&&b.Create?b.GetValue(c,a):null;alert("Unknown control "+a)};
SocialCalc.Popup.Initialize=function(a,c){var b=SocialCalc.Popup,d=b.Types,b=b.Controls;b[a]?(b=b[a].type,(d=d[b])&&d.Initialize&&d.Initialize(b,a,c)):alert("Unknown control "+a)};SocialCalc.Popup.Reset=function(a){var c=SocialCalc.Popup.Types;c[a].Reset&&c[a].Reset(a)};
SocialCalc.Popup.CClick=function(a){var c=SocialCalc.Popup,b=c.Types,d=c.Controls;if(!d[a])alert("Unknown control "+a);else if(!d[a].data||!d[a].data.disabled){var e=d[a].type,f=b[e];if(c.Current.id&&(b[d[c.Current.id].type].Hide(e,c.Current.id),a==c.Current.id)){c.Current.id=null;return}f&&f.Show&&f.Show(e,a);c.Current.id=a}};SocialCalc.Popup.Close=function(){var a=SocialCalc.Popup;a.Current.id&&a.CClick(a.Current.id)};
SocialCalc.Popup.Cancel=function(){var a=SocialCalc.Popup,c=a.Types,b=a.Controls;a.Current.id&&(b=b[a.Current.id].type,c[b].Cancel(b,a.Current.id),a.Current.id=null)};
SocialCalc.Popup.CreatePopupDiv=function(a,c){var b,d=SocialCalc.Popup.Controls[a].data,e=document.createElement("div");e.style.position="absolute";b=SocialCalc.GetElementPosition(d.mainele);e.style.top=b.top+d.mainele.offsetHeight+"px";e.style.left=b.left+"px";e.style.zIndex=100;e.style.backgroundColor="#FFF";e.style.border="1px solid black";c.width&&(e.style.width=c.width);d.mainele.appendChild(e);c.title&&(e.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+
c.title+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.Popup.Cancel();">&nbsp;X&nbsp;</td></tr></table>',c.moveable&&(d.dragregistered=e.firstChild.firstChild.firstChild.firstChild,SocialCalc.DragRegister(d.dragregistered,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:e},d.mainele)));return e};
SocialCalc.Popup.EnsurePosition=function(a,c){function b(a){var b=SocialCalc.GetElementPosition(a);b.height=a.offsetHeight;b.width=a.offsetWidth;b.bottom=b.top+b.height;b.right=b.left+b.width;return b}var d=SocialCalc.Popup.Controls[a].data,e=d.mainele.firstChild;if(e){var d=d.popupele,f=b(d),g=b(c),e=b(e);e.bottom+f.height<g.bottom&&e.left+f.width<g.right?(d.style.top=e.bottom+"px",d.style.left=e.left+"px"):e.top-f.height>g.top&&e.left+f.width<g.right?(d.style.top=e.top-f.height+"px",d.style.left=
e.left+"px"):e.bottom+f.height<g.bottom&&e.right-f.width>g.left?(d.style.top=e.bottom+"px",d.style.left=e.right-f.width+"px"):e.top-f.height>g.top&&e.right-f.width>g.left?(d.style.top=e.top-f.height+"px",d.style.left=e.right-f.width+"px"):e.bottom+f.height<g.bottom&&f.width<g.width?(d.style.top=e.bottom+"px",d.style.left=g.left+Math.floor((g.width-f.width)/2)+"px"):e.top-f.height>g.top&&f.width<g.width?(d.style.top=e.top-f.height+"px",d.style.left=g.left+Math.floor((g.width-f.width)/2)+"px"):f.height<
g.height&&e.right+f.width<g.right?(d.style.top=g.top+Math.floor((g.height-f.height)/2)+"px",d.style.left=e.right+"px"):f.height<g.height&&e.left-f.width>g.left&&(d.style.top=g.top+Math.floor((g.height-f.height)/2)+"px",d.style.left=e.left-f.width+"px")}else alert("No main popup element firstChild.")};SocialCalc.Popup.DestroyPopupDiv=function(a,c){a&&(a.innerHTML="",SocialCalc.DragUnregister(c),a.parentNode&&a.parentNode.removeChild(a))};
SocialCalc.Popup.RGBToHex=function(a){var c=SocialCalc.Popup;return""==a?"000000":(a=a.match(/(\d+)\D+(\d+)\D+(\d+)/))?c.ToHex(a[1])+c.ToHex(a[2])+c.ToHex(a[3]):"000000"};SocialCalc.Popup.HexDigits="0123456789ABCDEF";SocialCalc.Popup.ToHex=function(a){var c=SocialCalc.Popup,b=a%16;return c.HexDigits.charAt(Math.floor(a/16))+c.HexDigits.charAt(b)};
SocialCalc.Popup.FromHex=function(a){var c=SocialCalc.Popup,b=c.HexDigits.indexOf(a.charAt(0).toUpperCase());a=c.HexDigits.indexOf(a.charAt(1).toUpperCase());return 16*(0<=b?b:0)+(0<=a?a:0)};SocialCalc.Popup.HexToRGB=function(a){var c=SocialCalc.Popup;return"rgb("+c.FromHex(a.substring(1,3))+","+c.FromHex(a.substring(3,5))+","+c.FromHex(a.substring(5,7))+")"};SocialCalc.Popup.makeRGB=function(a,c,b){return"rgb("+(0<a?a:0)+","+(0<c?c:0)+","+(0<b?b:0)+")"};
SocialCalc.Popup.splitRGB=function(a){return(a=a.match(/(\d+)\D+(\d+)\D+(\d+)\D/))?{r:a[1]-0,g:a[2]-0,b:a[3]-0}:{r:0,g:0,b:0}};SocialCalc.Popup.Types.List={};
SocialCalc.Popup.Types.List.Create=function(a,c,b){a={type:a,value:"",display:"",data:{}};SocialCalc.Popup.Controls[c]=a;a=a.data;a.attribs=b||{};(b=document.getElementById(c))?(a.mainele=b,b.innerHTML='<input style="cursor:pointer;width:100px;font-size:smaller;" onfocus="this.blur();" onclick="SocialCalc.Popup.CClick(\''+c+'\');" value="">',a.options=[]):alert("Missing element "+c)};
SocialCalc.Popup.Types.List.SetValue=function(a,c,b){a=SocialCalc.Popup.Controls[c].data;a.value=b;a.custom=!1;for(b=0;b<a.options.length;b++)if(o=a.options[b],!(o.a&&(o.a.skip||o.a.custom||o.a.cancel)||o.v!=a.value)){a.display=o.o;break}b==a.options.length&&(a.display="Custom",a.custom=!0);a.mainele&&a.mainele.firstChild&&(a.mainele.firstChild.value=a.display)};
SocialCalc.Popup.Types.List.SetDisabled=function(a,c,b){a=SocialCalc.Popup.Controls[c].data;a.disabled=b;a.mainele&&a.mainele.firstChild&&(a.mainele.firstChild.disabled=b)};SocialCalc.Popup.Types.List.GetValue=function(a,c){return SocialCalc.Popup.Controls[c].data.value};SocialCalc.Popup.Types.List.Initialize=function(a,c,b){var d;a=SocialCalc.Popup;var e=a.Controls[c].data;for(d in b.attribs)e.attribs[d]=b.attribs[d];e.options=b?b.options:[];b.value&&a.SetValue(c,b.value)};
SocialCalc.Popup.Types.List.Reset=function(a){var c=SocialCalc.Popup,b=c.Types,d=c.Controls;c.Current.id&&d[c.Current.id].type==a&&(b[a].Hide(a,c.Current.id),c.Current.id=null)};
SocialCalc.Popup.Types.List.Show=function(a,c){var b;b=SocialCalc.Popup;var d=b.Controls[c].data,e="";d.popupele=b.CreatePopupDiv(c,d.attribs);d.custom?(e=SocialCalc.Popup.Types.List.MakeCustom(a,c),b=document.createElement("div"),b.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+e+"</div>",d.customele=b.firstChild.firstChild.childNodes[1],d.listdiv=null):(e=SocialCalc.Popup.Types.List.MakeList(a,c),b=document.createElement("div"),b.innerHTML='<div style="cursor:default;padding:4px;">'+
e+"</div>",d.customele=null,d.listdiv=b.firstChild);d.contentele=b;d.mainele&&d.mainele.firstChild&&(d.mainele.firstChild.disabled=!0);d.popupele.appendChild(b);d.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(c,d.attribs.ensureWithin)};
SocialCalc.Popup.Types.List.MakeList=function(a,c){var b,d,e,f=SocialCalc.Popup.Controls[c].data,g;g='<table cellspacing="0" cellpadding="0"><tr><td style="vertical-align:top;">';f.ncols=1;for(b=0;b<f.options.length;b++){d=f.options[b];if(d.a){if(d.a.newcol){g+='</td><td style="vertical-align:top;">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align:top;">';f.ncols+=1;continue}if(d.a.skip){g+='<div style="font-size:x-small;white-space:nowrap;">'+d.o+"</div>";continue}}e=d.v!=f.value||d.a&&(d.a.custom||
d.a.cancel)?"":"background-color:#DDF;";g+='<div style="font-size:x-small;white-space:nowrap;'+e+'" onclick="SocialCalc.Popup.Types.List.ItemClicked(\''+c+"','"+b+"');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove('"+c+"',this);\">"+d.o+"</div>"}return g+"</td></tr></table>"};
SocialCalc.Popup.Types.List.MakeCustom=function(a,c){var b=SocialCalc.Popup.LocalizeString,d="",d=SocialCalc.Popup.Controls[c].data.value,d=SocialCalc.special_chars(d);return d='<div style="white-space:nowrap;"><br><input id="customvalue" value="'+d+'"><br><br><input style="font-size:smaller;" type="button" value="'+b("OK")+'" onclick="SocialCalc.Popup.Types.List.CustomOK(\''+c+'\');return false;"><input style="font-size:smaller;" type="button" value="'+b("List")+'" onclick="SocialCalc.Popup.Types.List.CustomToList(\''+
c+'\');"><input style="font-size:smaller;" type="button" value="'+b("Cancel")+'" onclick="SocialCalc.Popup.Close();"><br></div>'};
SocialCalc.Popup.Types.List.ItemClicked=function(a,c){var b,d,e,f=SocialCalc.Popup.Controls[a].data;(b=f.options[c].a)&&b.custom?(b=f.contentele,d=SocialCalc.Popup.Types.List.MakeCustom("List",a),e=document.createElement("div"),e.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+d+"</div>",f.customele=e.firstChild.firstChild.childNodes[1],f.listdiv=null,f.contentele=e,f.popupele.replaceChild(e,b),f.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(a,f.attribs.ensureWithin)):
(b&&b.cancel||SocialCalc.Popup.SetValue(a,f.options[c].v),SocialCalc.Popup.Close())};SocialCalc.Popup.Types.List.CustomToList=function(a){var c,b,d,e=SocialCalc.Popup.Controls[a].data;c=e.contentele;b=SocialCalc.Popup.Types.List.MakeList("List",a);d=document.createElement("div");d.innerHTML='<div style="cursor:default;padding:4px;">'+b+"</div>";e.customele=null;e.listdiv=d.firstChild;e.contentele=d;e.popupele.replaceChild(d,c);e.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(a,e.attribs.ensureWithin)};
SocialCalc.Popup.Types.List.CustomOK=function(a){SocialCalc.Popup.SetValue(a,SocialCalc.Popup.Controls[a].data.customele.value);SocialCalc.Popup.Close()};SocialCalc.Popup.Types.List.MouseMove=function(a,c){var b,d,e=SocialCalc.Popup.Controls[a].data;if(b=e.listdiv){var f=b.firstChild.firstChild.firstChild;for(b=0;b<e.ncols;b++)for(d=0;d<f.childNodes[2*b].childNodes.length;d++)f.childNodes[2*b].childNodes[d].style.backgroundColor="#FFF";c.style.backgroundColor="#DDF"}};
SocialCalc.Popup.Types.List.Hide=function(a,c){var b=SocialCalc.Popup,d=b.Controls[c].data;b.DestroyPopupDiv(d.popupele,d.dragregistered);d.popupele=null;d.mainele&&d.mainele.firstChild&&(d.mainele.firstChild.disabled=!1)};SocialCalc.Popup.Types.List.Cancel=function(a,c){SocialCalc.Popup.Types.List.Hide(a,c)};SocialCalc.Popup.Types.ColorChooser={};
SocialCalc.Popup.Types.ColorChooser.Create=function(a,c,b){a={type:a,value:"",display:"",data:{}};SocialCalc.Popup.Controls[c]=a;a=a.data;a.attribs=b||{};b=a.attribs;a.value="";var d=document.getElementById(c);d?(a.mainele=d,d.innerHTML='<div style="cursor:pointer;border:1px solid black;vertical-align:top;width:'+(b.sampleWidth||"15px")+";height:"+(b.sampleHeight||"15px")+';" onclick="SocialCalc.Popup.Types.ColorChooser.ControlClicked(\''+c+"');\">&nbsp;</div>"):alert("Missing element "+c)};
SocialCalc.Popup.Types.ColorChooser.SetValue=function(a,c,b){a=SocialCalc.Popup;c=a.Controls[c].data;var d=c.attribs;c.value=b;c.custom=!1;c.mainele&&c.mainele.firstChild&&(c.value?(c.mainele.firstChild.style.backgroundColor=c.value,b=d.backgroundImage?"url("+a.imagePrefix+d.backgroundImage+")":"",a="center center"):(c.mainele.firstChild.style.backgroundColor="#FFF",d.backgroundImageDefault?(b="url("+a.imagePrefix+d.backgroundImageDefault+")",a="center center"):(b="url("+a.imagePrefix+"defaultcolor.gif)",
a="left top")),c.mainele.firstChild.style.backgroundPosition=a,c.mainele.firstChild.style.backgroundImage=b)};
SocialCalc.Popup.Types.ColorChooser.SetDisabled=function(a,c,b){a=SocialCalc.Popup;var d=a.Controls[c].data,e=d.attribs;d.disabled=b;d.mainele&&d.mainele.firstChild&&(b?(d.mainele.firstChild.style.backgroundColor="#DDD",e.backgroundImageDisabled?(img="url("+a.imagePrefix+e.backgroundImageDisabled+")",pos="center center"):(img="url("+a.imagePrefix+"defaultcolor.gif)",pos="left top"),d.mainele.firstChild.style.backgroundPosition=pos,d.mainele.firstChild.style.backgroundImage=img):a.SetValue(c,d.value))};
SocialCalc.Popup.Types.ColorChooser.GetValue=function(a,c){return SocialCalc.Popup.Controls[c].data.value};SocialCalc.Popup.Types.ColorChooser.Initialize=function(a,c,b){var d;a=SocialCalc.Popup;var e=a.Controls[c].data;for(d in b.attribs)e.attribs[d]=b.attribs[d];b.value&&a.SetValue(c,b.value)};SocialCalc.Popup.Types.ColorChooser.Reset=function(a){var c=SocialCalc.Popup,b=c.Types,d=c.Controls;c.Current.id&&d[c.Current.id].type==a&&(b[a].Hide(a,c.Current.id),c.Current.id=null)};
SocialCalc.Popup.Types.ColorChooser.Show=function(a,c){var b,d;b=SocialCalc.Popup;var e=b.Controls[c].data;d="";e.oldvalue=e.value;e.popupele=b.CreatePopupDiv(c,e.attribs);e.custom?(d=SocialCalc.Popup.Types.ColorChooser.MakeCustom(a,c),b=document.createElement("div"),b.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+d+"</div>",e.customele=b.firstChild.firstChild.childNodes[2]):(d=SocialCalc.Popup.Types.ColorChooser.CreateGrid(a,c),b=document.createElement("div"),b.style.padding=
"3px",b.style.backgroundColor="#CCC",b.appendChild(d),e.customele=null);e.contentele=b;e.popupele.appendChild(b);e.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(c,e.attribs.ensureWithin)};
SocialCalc.Popup.Types.ColorChooser.MakeCustom=function(a,c){var b=SocialCalc.Popup,d=b.LocalizeString,e="";return e='<div style="white-space:nowrap;"><br>#<input id="customvalue" style="width:75px;" value="'+b.Controls[c].data.value+'"><br><br><input style="font-size:smaller;" type="button" value="'+d("OK")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomOK(\''+c+'\');return false;"><input style="font-size:smaller;" type="button" value="'+d("Grid")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\''+
c+"');\"><br></div>"};SocialCalc.Popup.Types.ColorChooser.ItemClicked=function(a,c){SocialCalc.Popup.Close()};SocialCalc.Popup.Types.ColorChooser.CustomToList=function(a){};SocialCalc.Popup.Types.ColorChooser.CustomOK=function(a){var c=SocialCalc.Popup;c.SetValue(a,c.Controls[a].data.customele.value);c.Close()};SocialCalc.Popup.Types.ColorChooser.Hide=function(a,c){var b=SocialCalc.Popup,d=b.Controls[c].data;b.DestroyPopupDiv(d.popupele,d.dragregistered);d.popupele=null};
SocialCalc.Popup.Types.ColorChooser.Cancel=function(a,c){var b=SocialCalc.Popup;b.SetValue(c,b.Controls[c].data.oldvalue);SocialCalc.Popup.Types.ColorChooser.Hide(a,c)};
SocialCalc.Popup.Types.ColorChooser.CreateGrid=function(a,c){var b,d,e,f,g,l=SocialCalc.Popup,h=l.Types,n=l.LocalizeString;b=l.Controls[c].data;b.grid={};var p=b.grid,r=document.createElement("div");b=document.createElement("table");b.cellSpacing=0;b.cellPadding=0;b.style.width="100px";p.table=b;b=document.createElement("tbody");p.table.appendChild(b);p.tbody=b;for(d=0;16>d;d++){e=document.createElement("tr");for(f=0;5>f;f++)g={},p[d+","+f]=g,b=document.createElement("td"),b.style.fontSize="1px",
b.innerHTML="&nbsp;",b.style.height="10px",1>=f?(b.style.width="17px",b.style.borderRight="3px solid white"):(b.style.width="20px",b.style.backgroundRepeat="no-repeat"),e.appendChild(b),g.ele=b;p.tbody.appendChild(e)}r.appendChild(p.table);b=document.createElement("div");b.style.marginTop="3px";b.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td style="width:17px;background-color:#FFF;background-image:url('+l.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;" title="'+
n("Default")+'">&nbsp;</td><td style="width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;" title="'+n("Custom")+'">#</td><td style="width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;">'+n("OK")+"</td></tr></table>";p.defaultbox=b.firstChild.firstChild.firstChild.childNodes[0];p.defaultbox.onclick=h.ColorChooser.DefaultClicked;p.custom=b.firstChild.firstChild.firstChild.childNodes[1];p.custom.onclick=h.ColorChooser.CustomClicked;p.msg=b.firstChild.firstChild.firstChild.childNodes[2];
p.msg.onclick=h.ColorChooser.CloseOK;r.appendChild(b);p.table.onmousedown=h.ColorChooser.GridMouseDown;h.ColorChooser.DetermineColors(c);h.ColorChooser.SetColors(c);return r};SocialCalc.Popup.Types.ColorChooser.gridToG=function(a,c,b){return a[c+","+b]};
SocialCalc.Popup.Types.ColorChooser.DetermineColors=function(a){var c=SocialCalc.Popup,b=c.Types.ColorChooser,d=c.Controls[a].data;a=d.grid;var e,f=c.splitRGB(d.value),d=2;e=16-Math.floor((f.r+16)/16);a["selectedrow"+d]=e;for(e=0;16>e;e++)b.gridToG(a,e,d).rgb=c.makeRGB(17*(15-e),0,0);d=3;e=16-Math.floor((f.g+16)/16);a["selectedrow"+d]=e;for(e=0;16>e;e++)b.gridToG(a,e,d).rgb=c.makeRGB(0,17*(15-e),0);d=4;e=16-Math.floor((f.b+16)/16);a["selectedrow"+d]=e;for(e=0;16>e;e++)b.gridToG(a,e,d).rgb=c.makeRGB(0,
0,17*(15-e));d=1;for(e=0;16>e;e++)b.gridToG(a,e,d).rgb=c.makeRGB(17*(15-e),17*(15-e),17*(15-e));var d=0,c=[0,68,153,204,255],f="400 310 420 440 442 340 040 042 032 044 024 004 204 314 402 414".split(" "),g;for(e=0;16>e;e++)g=f[e],b.gridToG(a,e,d).rgb="rgb("+c[g.charAt(0)-0]+","+c[g.charAt(1)-0]+","+c[g.charAt(2)-0]+")"};
SocialCalc.Popup.Types.ColorChooser.SetColors=function(a){var c,b,d,e=SocialCalc.Popup,f=e.Types.ColorChooser,g=e.Controls[a].data,l=g.grid;for(c=0;16>c;c++)for(b=0;5>b;b++)d=f.gridToG(l,c,b),d.ele.style.backgroundColor=d.rgb,d.ele.title=e.RGBToHex(d.rgb),d.ele.style.backgroundImage=l["selectedrow"+b]==c?"url("+e.imagePrefix+"chooserarrow.gif)":"";e.SetValue(a,g.value);l.msg.style.backgroundColor=g.value;a=e.splitRGB(g.value||"rgb(255,255,255)");l.msg.style.color=220>a.r+a.g+a.b?"#FFF":"#000";g.value?
(l.msg.style.backgroundImage="",l.msg.title=e.RGBToHex(g.value)):(l.msg.style.backgroundColor="#FFF",l.msg.style.backgroundImage="url("+e.imagePrefix+"defaultcolor.gif)",l.msg.title="Default")};
SocialCalc.Popup.Types.ColorChooser.GridMouseDown=function(a){var c=a||window.event;a=SocialCalc.Popup;var b=a.Types.ColorChooser,d=a.Controls,e=a.Current.id;if(e){var d=d[e].data,f=d.grid;switch(c.type){case "mousedown":f.mousedown=!0;break;case "mouseup":f.mousedown=!1;break;case "mousemove":if(!f.mousedown)return}var g=SocialCalc.GetElementPositionWithScroll(d.mainele),l=c.clientX-g.left,h=c.clientY-g.top,c=SocialCalc.GetElementPositionWithScroll(f.table);c.left-=g.left;c.top-=g.top;g=Math.floor((h-
c.top-2)/10);g=0>g?0:g;l=Math.floor((l-c.left)/20);l=0>l?0:4<l?4:l;f=b.gridToG(f,0>g?0:15<g?15:g,l).ele.style.backgroundColor;g=a.splitRGB(f);c=a.splitRGB(d.value);switch(l){case 2:d.value=a.makeRGB(g.r,c.g,c.b);break;case 3:d.value=a.makeRGB(c.r,g.g,c.b);break;case 4:d.value=a.makeRGB(c.r,c.g,g.b);break;case 0:case 1:d.value=f}b.DetermineColors(e);b.SetColors(e)}};
SocialCalc.Popup.Types.ColorChooser.ControlClicked=function(a){var c=SocialCalc.Popup,b=c.Types.ColorChooser,d=c.Current.id;d&&a==d?b.CloseOK():c.CClick(a)};SocialCalc.Popup.Types.ColorChooser.DefaultClicked=function(a){var c=SocialCalc.Popup;a=c.Controls;if(c=c.Current.id)a=a[c].data,a.value="",SocialCalc.Popup.SetValue(c,a.value),SocialCalc.Popup.Close()};
SocialCalc.Popup.Types.ColorChooser.CustomClicked=function(a){a=SocialCalc.Popup;var c=a.Controls,b=a.Current.id;if(b){var c=c[b].data,d,e,f;d=c.contentele;e=SocialCalc.Popup.Types.ColorChooser.MakeCustom("ColorChooser",b);f=document.createElement("div");f.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+e+"</div>";c.customele=f.firstChild.firstChild.childNodes[2];c.contentele=f;c.popupele.replaceChild(f,d);c.customele.value=a.RGBToHex(c.value);c.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(b,
c.attribs.ensureWithin)}};
SocialCalc.Popup.Types.ColorChooser.CustomToGrid=function(a){var c,b;c=SocialCalc.Popup;var d=c.Controls[a].data;SocialCalc.Popup.SetValue(a,c.HexToRGB("#"+d.customele.value));var e;c=d.contentele;e=SocialCalc.Popup.Types.ColorChooser.CreateGrid("ColorChooser",a);b=document.createElement("div");b.style.padding="3px";b.style.backgroundColor="#CCC";b.appendChild(e);d.customele=null;d.contentele=b;d.popupele.replaceChild(b,c);d.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(a,d.attribs.ensureWithin)};
SocialCalc.Popup.Types.ColorChooser.CustomOK=function(a){var c=SocialCalc.Popup;SocialCalc.Popup.SetValue(a,c.HexToRGB("#"+c.Controls[a].data.customele.value));SocialCalc.Popup.Close()};SocialCalc.Popup.Types.ColorChooser.CloseOK=function(a){var c=SocialCalc.Popup;a=c.Controls;if(c=c.Current.id)SocialCalc.Popup.SetValue(c,a[c].data.value),SocialCalc.Popup.Close()};SocialCalc||(alert("Main SocialCalc code module needed"),SocialCalc={});SocialCalc.TableEditor||alert("SocialCalc TableEditor code module needed");SocialCalc.CurrentSpreadsheetControlObject=null;
SocialCalc.SpreadsheetControl=function(a){var c=SocialCalc.Constants;this.spreadsheetDiv=this.parentNode=null;this.viewheight=this.width=this.height=this.requestedSpaceBelow=this.requestedWidth=this.requestedHeight=0;this.tabs=[];this.tabnums={};this.tabreplacements={};this.currentTab=-1;this.views={};this.editorDiv=this.spreadsheetDiv=this.editor=this.context=this.sheet=null;this.moverange=this.sortrange="";this.idPrefix=a||"SocialCalc-";this.multipartBoundary="SocialCalcSpreadsheetControlSave";
this.imagePrefix=c.defaultImagePrefix;this.toolbarbackground=c.SCToolbarbackground;this.tabbackground=c.SCTabbackground;this.tabselectedCSS=c.SCTabselectedCSS;this.tabplainCSS=c.SCTabplainCSS;this.toolbartext=c.SCToolbartext;this.formulabarheight=c.SCFormulabarheight;this.statuslineheight=c.SCStatuslineheight;this.statuslineCSS=c.SCStatuslineCSS;this.ExportCallback=null;this.sheet=new SocialCalc.Sheet;this.context=new SocialCalc.RenderContext(this.sheet);this.context.showGrid=!0;this.context.showRCHeaders=
!0;this.editor=new SocialCalc.TableEditor(this.context);this.editor.StatusCallback.statusline={func:SocialCalc.SpreadsheetControlStatuslineCallback,params:{statuslineid:this.idPrefix+"statusline",recalcid1:this.idPrefix+"divider_recalc",recalcid2:this.idPrefix+"button_recalc"}};SocialCalc.CurrentSpreadsheetControlObject=this;this.editor.MoveECellCallback.movefrom=function(a){var c=SocialCalc.GetSpreadsheetControlObject();c.context.cursorsuffix="";a.range2.hasrange&&!a.cellhandles.noCursorSuffix&&
(a.ecell.row==a.range2.top&&(a.ecell.col<a.range2.left||a.ecell.col>a.range2.right+1)&&(c.context.cursorsuffix="insertleft"),a.ecell.col==a.range2.left&&(a.ecell.row<a.range2.top||a.ecell.row>a.range2.bottom+1)&&(c.context.cursorsuffix="insertup"))};this.formulabuttons={formulafunctions:{image:"formuladialog.gif",tooltip:"Functions",command:SocialCalc.SpreadsheetControl.DoFunctionList},multilineinput:{image:"multilinedialog.gif",tooltip:"Multi-line Input Box",command:SocialCalc.SpreadsheetControl.DoMultiline},
link:{image:"linkdialog.gif",tooltip:"Link Input Box",command:SocialCalc.SpreadsheetControl.DoLink},sum:{image:"sumdialog.gif",tooltip:"Auto Sum",command:SocialCalc.SpreadsheetControl.DoSum}};this.tabnums.edit=this.tabs.length;this.tabs.push({name:"edit",text:"Edit",html:' <div id="%id.edittools" style="padding:0px 0px 0px 0px;">&nbsp;<img id="%id.button_undo" src="%img.undo.gif" style="vertical-align:bottom;"> <img id="%id.button_redo" src="%img.redo.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_copy" src="%img.copy.gif" style="vertical-align:bottom;"> <img id="%id.button_cut" src="%img.cut.gif" style="vertical-align:bottom;"> <img id="%id.button_paste" src="%img.paste.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_delete" src="%img.delete.gif" style="vertical-align:bottom;"> <img id="%id.button_pasteformats" src="%img.pasteformats.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp;  <span id="%id.locktools"><img id="%id.button_lock" src="%img.lock.gif" style="vertical-align:bottom;"> <img id="%id.button_unlock" src="%img.unlock.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp;</span> <img id="%id.button_filldown" src="%img.filldown.gif" style="vertical-align:bottom;"> <img id="%id.button_fillright" src="%img.fillright.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_movefrom" src="%img.movefromoff.gif" style="vertical-align:bottom;"> <img id="%id.button_movepaste" src="%img.movepasteoff.gif" style="vertical-align:bottom;"> <img id="%id.button_moveinsert" src="%img.moveinsertoff.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_alignleft" src="%img.alignleft.gif" style="vertical-align:bottom;"> <img id="%id.button_aligncenter" src="%img.aligncenter.gif" style="vertical-align:bottom;"> <img id="%id.button_alignright" src="%img.alignright.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_borderon" src="%img.borderson.gif" style="vertical-align:bottom;">  <img id="%id.button_borderoff" src="%img.bordersoff.gif" style="vertical-align:bottom;">  <img id="%id.button_swapcolors" src="%img.swapcolors.gif" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_merge" src="%img.merge.gif" style="vertical-align:bottom;">  <img id="%id.button_unmerge" src="%img.unmerge.gif" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_insertrow" src="%img.insertrow.gif" style="vertical-align:bottom;">  <img id="%id.button_insertcol" src="%img.insertcol.gif" style="vertical-align:bottom;"> &nbsp; <img id="%id.button_deleterow" src="%img.deleterow.gif" style="vertical-align:bottom;">  <img id="%id.button_deletecol" src="%img.deletecol.gif" style="vertical-align:bottom;"> &nbsp; <img id="%id.button_hiderow" src="%img.hiderow.gif" style="vertical-align:bottom;">  <img id="%id.button_hidecol" src="%img.hidecol.gif" style="vertical-align:bottom;">  &nbsp;<img id="%id.divider_recalc" src="%img.divider1.gif" style="vertical-align:bottom;">&nbsp; <img id="%id.button_recalc" src="%img.recalc.gif" style="vertical-align:bottom;">  </div>',
oncreate:null,onclick:null});this.tabnums.settings=this.tabs.length;this.tabs.push({name:"settings",text:"Format",html:'<div id="%id.settingstools" style="display:none;"> <div id="%id.sheetsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!SHEET SETTINGS!:</div>   </td></tr><tr><td>   <input id="%id.settings-savesheet" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'sheet\');">   <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">   <input type="button" value="%loc!Show Cell Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'cell\');return false;">   </td></tr></table> </div> <div id="%id.cellsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!CELL SETTINGS!: <span id="%id.settingsecell">&nbsp;</span></div>   </td></tr><tr><td>  <input id="%id.settings-savecell" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'cell\');">  <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">  <input type="button" value="%loc!Show Sheet Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'sheet\');return false;">  </td></tr></table> </div></div>',
view:"settings",onclick:function(a,c){SocialCalc.SettingsControls.idPrefix=a.idPrefix;SocialCalc.SettingControlReset();var e=a.sheet.EncodeSheetAttributes(),f=a.sheet.EncodeCellAttributes(a.editor.ecell.coord);SocialCalc.SettingsControlLoadPanel(a.views.settings.values.sheetspanel,e);SocialCalc.SettingsControlLoadPanel(a.views.settings.values.cellspanel,f);document.getElementById(a.idPrefix+"settingsecell").innerHTML=a.editor.ecell.coord;SocialCalc.SpreadsheetControlSettingsSwitch("cell");a.views.settings.element.style.height=
a.viewheight+"px";a.views.settings.element.firstChild.style.height=a.viewheight+"px";e=a.editor.range.hasrange?SocialCalc.crToCoord(a.editor.range.left,a.editor.range.top)+":"+SocialCalc.crToCoord(a.editor.range.right,a.editor.range.bottom):a.editor.ecell.coord;document.getElementById(a.idPrefix+"settings-savecell").value=SocialCalc.LocalizeString("Save to")+": "+e},onclickFocus:!0});this.views.settings={name:"settings",values:{},oncreate:function(a,c){var e=SocialCalc.Constants;c.values.sheetspanel=
{colorchooser:{id:a.idPrefix+"scolorchooser"},formatnumber:{setting:"numberformat",type:"PopupList",id:a.idPrefix+"formatnumber",initialdata:e.SCFormatNumberFormats},formattext:{setting:"textformat",type:"PopupList",id:a.idPrefix+"formattext",initialdata:e.SCFormatTextFormats},fontfamily:{setting:"fontfamily",type:"PopupList",id:a.idPrefix+"fontfamily",initialdata:e.SCFormatFontfamilies},fontlook:{setting:"fontlook",type:"PopupList",id:a.idPrefix+"fontlook",initialdata:e.SCFormatFontlook},fontsize:{setting:"fontsize",
type:"PopupList",id:a.idPrefix+"fontsize",initialdata:e.SCFormatFontsizes},textalignhoriz:{setting:"textalignhoriz",type:"PopupList",id:a.idPrefix+"textalignhoriz",initialdata:e.SCFormatTextAlignhoriz},numberalignhoriz:{setting:"numberalignhoriz",type:"PopupList",id:a.idPrefix+"numberalignhoriz",initialdata:e.SCFormatNumberAlignhoriz},alignvert:{setting:"alignvert",type:"PopupList",id:a.idPrefix+"alignvert",initialdata:e.SCFormatAlignVertical},textcolor:{setting:"textcolor",type:"ColorChooser",id:a.idPrefix+
"textcolor"},bgcolor:{setting:"bgcolor",type:"ColorChooser",id:a.idPrefix+"bgcolor"},padtop:{setting:"padtop",type:"PopupList",id:a.idPrefix+"padtop",initialdata:e.SCFormatPadsizes},padright:{setting:"padright",type:"PopupList",id:a.idPrefix+"padright",initialdata:e.SCFormatPadsizes},padbottom:{setting:"padbottom",type:"PopupList",id:a.idPrefix+"padbottom",initialdata:e.SCFormatPadsizes},padleft:{setting:"padleft",type:"PopupList",id:a.idPrefix+"padleft",initialdata:e.SCFormatPadsizes},colwidth:{setting:"colwidth",
type:"PopupList",id:a.idPrefix+"colwidth",initialdata:e.SCFormatColwidth},recalc:{setting:"recalc",type:"PopupList",id:a.idPrefix+"recalc",initialdata:e.SCFormatRecalc},usermaxcol:{setting:"usermaxcol",type:"PopupList",id:a.idPrefix+"usermaxcol",initialdata:e.SCFormatUserMaxCol},usermaxrow:{setting:"usermaxrow",type:"PopupList",id:a.idPrefix+"usermaxrow",initialdata:e.SCFormatUserMaxRow}};c.values.cellspanel={name:"cell",colorchooser:{id:a.idPrefix+"scolorchooser"},cformatnumber:{setting:"numberformat",
type:"PopupList",id:a.idPrefix+"cformatnumber",initialdata:e.SCFormatNumberFormats},cformattext:{setting:"textformat",type:"PopupList",id:a.idPrefix+"cformattext",initialdata:e.SCFormatTextFormats},cfontfamily:{setting:"fontfamily",type:"PopupList",id:a.idPrefix+"cfontfamily",initialdata:e.SCFormatFontfamilies},cfontlook:{setting:"fontlook",type:"PopupList",id:a.idPrefix+"cfontlook",initialdata:e.SCFormatFontlook},cfontsize:{setting:"fontsize",type:"PopupList",id:a.idPrefix+"cfontsize",initialdata:e.SCFormatFontsizes},
calignhoriz:{setting:"alignhoriz",type:"PopupList",id:a.idPrefix+"calignhoriz",initialdata:e.SCFormatTextAlignhoriz},calignvert:{setting:"alignvert",type:"PopupList",id:a.idPrefix+"calignvert",initialdata:e.SCFormatAlignVertical},ctextcolor:{setting:"textcolor",type:"ColorChooser",id:a.idPrefix+"ctextcolor"},cbgcolor:{setting:"bgcolor",type:"ColorChooser",id:a.idPrefix+"cbgcolor"},cbt:{setting:"bt",type:"BorderSide",id:a.idPrefix+"cbt"},cbr:{setting:"br",type:"BorderSide",id:a.idPrefix+"cbr"},cbb:{setting:"bb",
type:"BorderSide",id:a.idPrefix+"cbb"},cbl:{setting:"bl",type:"BorderSide",id:a.idPrefix+"cbl"},cpadtop:{setting:"padtop",type:"PopupList",id:a.idPrefix+"cpadtop",initialdata:e.SCFormatPadsizes},cpadright:{setting:"padright",type:"PopupList",id:a.idPrefix+"cpadright",initialdata:e.SCFormatPadsizes},cpadbottom:{setting:"padbottom",type:"PopupList",id:a.idPrefix+"cpadbottom",initialdata:e.SCFormatPadsizes},cpadleft:{setting:"padleft",type:"PopupList",id:a.idPrefix+"cpadleft",initialdata:e.SCFormatPadsizes}};
SocialCalc.SettingsControlInitializePanel(c.values.sheetspanel);SocialCalc.SettingsControlInitializePanel(c.values.cellspanel)},replacements:{itemtitle:{regex:/\%itemtitle\./g,replacement:'style="padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;"'},sectiontitle:{regex:/\%sectiontitle\./g,replacement:'style="padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;"'},parttitle:{regex:/\%parttitle\./g,replacement:'style="font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;"'},
itembody:{regex:/\%itembody\./g,replacement:'style="padding:12px 0px 0px 0px;vertical-align:top;font-size:small;"'},bodypart:{regex:/\%bodypart\./g,replacement:'style="padding:0px 10px 0px 0px;font-size:small;vertical-align:top;"'}},divStyle:"border:1px solid black;overflow:auto;",html:'<div id="%id.scolorchooser" style="display:none;position:absolute;z-index:20;"></div><table cellspacing="0" cellpadding="0"> <tr><td style="vertical-align:top;"><table id="%id.sheetsettingstable" style="display:none;" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Default Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.formatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.formattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Text Horizontal!</div>     <span id="%id.textalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Number Horizontal!</div>     <span id="%id.numberalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.alignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.fontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.fontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.fontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.textcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.bgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.padtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.padright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.padbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.padleft"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Column Width!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.colwidth"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Recalculation!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.recalc"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Dimensions!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Columns!</div>     <span id="%id.usermaxcol"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Rows!</div>     <span id="%id.usermaxrow"></span>    </td>   </tr></table> </td></tr></table><table id="%id.cellsettingstable" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.cformatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.cformattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Horizontal!</div>     <span id="%id.calignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.calignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.cfontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.cfontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.cfontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.ctextcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.cbgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Borders!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0">    <tr><td %bodypart. colspan="3"><div %parttitle.>%loc!Top Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Right Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Bottom Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Left Border!</div></td>    </tr><tr>    <td %bodypart.>     <input id="%id.cbt-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbt-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbr-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbr-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbb-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbb-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbl-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbl-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.cpadtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.cpadright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.cpadbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.cpadleft"></span>    </td>   </tr></table> </td></tr></table> </td><td style="vertical-align:top;padding:12px 0px 0px 12px;">  <div style="width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;">   <table cellspacing="0" cellpadding="0"><tr>    <td id="sample-text" style="height:100px;width:100px;"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>   </tr></table>  </div> </td></tr></table><br>'};
this.tabnums.sort=this.tabs.length;this.tabs.push({name:"sort",text:"Sort",html:' <div id="%id.sorttools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:4px;width:160px;">    <div style="%tbt.">%loc!Set Cells To Sort!</div>    <select id="%id.sortlist" size="1" onfocus="%s.CmdGotFocus(this);"><option selected>[select range]</option></select>    <input type="button" value="%loc!OK!" onclick="%s.DoCmd(this, \'ok-setsort\');" style="font-size:x-small;">   </td>   <td style="vertical-align:middle;padding-right:16px;width:100px;text-align:right;">    <div style="%tbt.">&nbsp;</div>    <input type="button" id="%id.sortbutton" value="%loc!Sort Cells! A1:A1" onclick="%s.DoCmd(this, \'dosort\');" style="visibility:hidden;">   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Major Sort!</div>      <select id="%id.majorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="majorsort" id="%id.majorsortup" value="up" checked><span style="font-size:x-small;color:#FFF;">%loc!Up!</span><br>      <input type="radio" name="majorsort" id="%id.majorsortdown" value="down"><span style="font-size:x-small;color:#FFF;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Minor Sort!</div>      <select id="%id.minorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="minorsort" id="%id.minorsortup" value="up" checked><span style="font-size:x-small;color:#FFF;">%loc!Up!</span><br>      <input type="radio" name="minorsort" id="%id.minorsortdown" value="down"><span style="font-size:x-small;color:#FFF;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Last Sort!</div>      <select id="%id.lastsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="lastsort" id="%id.lastsortup" value="up" checked><span style="font-size:x-small;color:#FFF;">%loc!Up!</span><br>      <input type="radio" name="lastsort" id="%id.lastsortdown" value="down"><span style="font-size:x-small;color:#FFF;">%loc!Down!</span>     </td>    </tr></table>   </td>  </tr></table> </div>',
onclick:SocialCalc.SpreadsheetControlSortOnclick});this.editor.SettingsCallbacks.sort={save:SocialCalc.SpreadsheetControlSortSave,load:SocialCalc.SpreadsheetControlSortLoad};this.tabnums.audit=this.tabs.length;this.tabs.push({name:"audit",text:"Audit",html:'<div id="%id.audittools" style="display:none;"> <div style="%tbt.">&nbsp;</div></div>',view:"audit",onclick:function(a,c){var e=SocialCalc.LocalizeString,f,g,l='<table cellspacing="0" cellpadding="0" style="margin-bottom:10px;"><tr><td style="font-size:small;padding:6px;"><b>'+
e("Audit Trail This Session")+":</b><br><br>",h=a.sheet.changes.stack,n=a.sheet.changes.tos;for(f=0;f<h.length;f++)for(f==n+1&&(l+='<br></td></tr><tr><td style="font-size:small;background-color:#EEE;padding:6px;">'+e("UNDONE STEPS")+":<br>"),g=0;g<h[f].command.length;g++)l+=SocialCalc.special_chars(h[f].command[g])+"<br>";a.views.audit.element.innerHTML=l+"</td></tr></table>";SocialCalc.CmdGotFocus(!0)},onclickFocus:!0});this.views.audit={name:"audit",divStyle:"border:1px solid black;overflow:auto;",
html:"Audit Trail"};this.tabnums.comment=this.tabs.length;this.tabs.push({name:"comment",text:"Comment",html:'<div id="%id.commenttools" style="display:none;"><table cellspacing="0" cellpadding="0"><tr><td><textarea id="%id.commenttext" style="font-size:small;height:32px;width:600px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea></td><td style="vertical-align:top;">&nbsp;<input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlCommentSet();" style="font-size:x-small;"></td></tr></table></div>',
view:"sheet",onclick:SocialCalc.SpreadsheetControlCommentOnclick,onunclick:SocialCalc.SpreadsheetControlCommentOnunclick});this.tabnums.names=this.tabs.length;this.tabs.push({name:"names",text:"Names",html:'<div id="%id.namestools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">%loc!Existing Names!</div>    <select id="%id.nameslist" size="1" onchange="%s.SpreadsheetControlNamesChangedName();" onfocus="%s.CmdGotFocus(this);"><option selected>[New]</option></select>   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Name!</div>    <input type="text" id="%id.namesname" style="font-size:x-small;width:75px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Description!</div>    <input type="text" id="%id.namesdesc" style="font-size:x-small;width:150px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Value!</div>    <input type="text" id="%id.namesvalue" width="16" style="font-size:x-small;width:100px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:12px;width:100px;">    <div style="%tbt.">%loc!Set Value To!</div>    <input type="button" id="%id.namesrangeproposal" value="A1" onclick="%s.SpreadsheetControlNamesSetValue();" style="font-size:x-small;">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">&nbsp;</div>    <input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlNamesSave();" style="font-size:x-small;">    <input type="button" value="%loc!Delete!" onclick="%s.SpreadsheetControlNamesDelete()" style="font-size:x-small;">   </td>  </tr></table></div>',
view:"sheet",onclick:SocialCalc.SpreadsheetControlNamesOnclick,onunclick:SocialCalc.SpreadsheetControlNamesOnunclick});this.tabnums.clipboard=this.tabs.length;this.tabs.push({name:"clipboard",text:"Clipboard",html:'<div id="%id.clipboardtools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">     &nbsp;    </div>   </td>  </tr></table></div>',view:"clipboard",onclick:SocialCalc.SpreadsheetControlClipboardOnclick,
onclickFocus:"clipboardtext"});this.views.clipboard={name:"clipboard",divStyle:"overflow:auto;",html:' <div style="font-size:x-small;padding:5px 0px 10px 0px;">  <b>%loc!Display Clipboard in!:</b>  <input type="radio" id="%id.clipboardformat-tab" name="%id.clipboardformat" checked onclick="%s.SpreadsheetControlClipboardFormat(\'tab\');"> %loc!Tab-delimited format! &nbsp;  <input type="radio" id="%id.clipboardformat-csv" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'csv\');"> %loc!CSV format! &nbsp;  <input type="radio" id="%id.clipboardformat-scsave" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'scsave\');"> %loc!SocialCalc-save format! </div> <input type="button" value="%loc!Load SocialCalc Clipboard With This!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardLoad();">&nbsp;  <input type="button" value="%loc!Clear SocialCalc Clipboard!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardClear();">&nbsp;  <br> <textarea id="%id.clipboardtext" style="font-size:small;height:350px;width:800px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea>'}};
SocialCalc.SpreadsheetControl.prototype.InitializeSpreadsheetControl=function(a,c,b,d){return SocialCalc.InitializeSpreadsheetControl(this,a,c,b,d)};SocialCalc.SpreadsheetControl.prototype.DoOnResize=function(){return SocialCalc.DoOnResize(this)};SocialCalc.SpreadsheetControl.prototype.SizeSSDiv=function(){return SocialCalc.SizeSSDiv(this)};SocialCalc.SpreadsheetControl.prototype.ExecuteCommand=function(a,c){return SocialCalc.SpreadsheetControlExecuteCommand(this,a,c)};
SocialCalc.SpreadsheetControl.prototype.CreateSheetHTML=function(){return SocialCalc.SpreadsheetControlCreateSheetHTML(this)};SocialCalc.SpreadsheetControl.prototype.CreateSpreadsheetSave=function(a){return SocialCalc.SpreadsheetControlCreateSpreadsheetSave(this,a)};SocialCalc.SpreadsheetControl.prototype.DecodeSpreadsheetSave=function(a){return SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(this,a)};
SocialCalc.SpreadsheetControl.prototype.CreateCellHTML=function(a){return SocialCalc.SpreadsheetControlCreateCellHTML(this,a)};SocialCalc.SpreadsheetControl.prototype.CreateCellHTMLSave=function(a){return SocialCalc.SpreadsheetControlCreateCellHTMLSave(this,a)};SocialCalc.SpreadsheetControl.prototype.ParseSheetSave=function(a){return this.sheet.ParseSheetSave(a)};SocialCalc.SpreadsheetControl.prototype.CreateSheetSave=function(){return this.sheet.CreateSheetSave()};
SocialCalc.SpreadsheetControl.prototype.Upsert=function(a,c,b,d){return this.sheet.Upsert(a,c,b,d)};
SocialCalc.InitializeSpreadsheetControl=function(a,c,b,d,e){var f=SocialCalc.Constants,g=SocialCalc.LocalizeString,l=SocialCalc.LocalizeSubstrings,h,n,p,r=a.tabs,t=a.views;a.requestedHeight=b;a.requestedWidth=d;a.requestedSpaceBelow=e;"string"==typeof c&&(c=document.getElementById(c));null==c&&alert("SocialCalc.SpreadsheetControl not given parent node.");a.parentNode=c;a.spreadsheetDiv=document.createElement("div");a.SizeSSDiv();for(b=c.firstChild;null!=b;b=c.firstChild)c.removeChild(b);b='<div><div id="_SC_top" style="'+
a.toolbarbackground+'padding:8px 6px 6px 6px;height:40px;-webkit-filter: invert(100%) brightness(215%);display:block;">';for(d=0;d<r.length;d++)b+=r[d].html;b+='</div><div id="_SC_mid" style="'+a.tabbackground+'padding-bottom:4px;margin:0px 0px 8px 0px;display:none"><table cellpadding="0" cellspacing="0"><tr>';for(d=0;d<r.length;d++)b+='  <td id="%id.'+r[d].name+'tab" style="'+(0==d?a.tabselectedCSS:a.tabplainCSS)+'" onclick="%s.SetTab(this);">'+g(r[d].text)+"</td>";b+=" </tr></table></div></div>";
a.currentTab=0;for(n in a.tabreplacements)b=b.replace(a.tabreplacements[n].regex,a.tabreplacements[n].replacement);b=b.replace(/\%s\./g,"SocialCalc.");b=b.replace(/\%id\./g,a.idPrefix);b=b.replace(/\%tbt\./g,a.toolbartext);b=b.replace(/\%img\./g,a.imagePrefix);b=l(b);a.spreadsheetDiv.innerHTML=b;c.appendChild(a.spreadsheetDiv);a.Buttons={button_undo:{tooltip:"Undo",command:"undo"},button_redo:{tooltip:"Redo",command:"redo"},button_copy:{tooltip:"Copy",command:"copy"},button_cut:{tooltip:"Cut",command:"cut"},
button_paste:{tooltip:"Paste",command:"paste"},button_pasteformats:{tooltip:"Paste Formats",command:"pasteformats"},button_lock:{tooltip:"Lock",command:"lock"},button_unlock:{tooltip:"Unlock",command:"unlock"},button_delete:{tooltip:"Delete Contents",command:"delete"},button_filldown:{tooltip:"Fill Down",command:"filldown"},button_fillright:{tooltip:"Fill Right",command:"fillright"},button_movefrom:{tooltip:"Set/Clear Move From",command:"movefrom"},button_movepaste:{tooltip:"Move Paste",command:"movepaste"},
button_moveinsert:{tooltip:"Move Insert",command:"moveinsert"},button_alignleft:{tooltip:"Align Left",command:"align-left"},button_aligncenter:{tooltip:"Align Center",command:"align-center"},button_alignright:{tooltip:"Align Right",command:"align-right"},button_borderon:{tooltip:"Borders On",command:"borderon"},button_borderoff:{tooltip:"Borders Off",command:"borderoff"},button_swapcolors:{tooltip:"Swap Colors",command:"swapcolors"},button_merge:{tooltip:"Merge Cells",command:"merge"},button_unmerge:{tooltip:"Unmerge Cells",
command:"unmerge"},button_insertrow:{tooltip:"Insert Row",command:"insertrow"},button_insertcol:{tooltip:"Insert Column",command:"insertcol"},button_deleterow:{tooltip:"Delete Row",command:"deleterow"},button_deletecol:{tooltip:"Delete Column",command:"deletecol"},button_hiderow:{tooltip:"Hide Row",command:"hiderow"},button_hidecol:{tooltip:"Hide Column",command:"hidecol"},button_recalc:{tooltip:"Recalc",command:"recalc"}};for(p in a.Buttons)(c=document.getElementById(a.idPrefix+p))?(c.style.border=
"1px solid "+f.ISCButtonBorderNormal,SocialCalc.TooltipRegister(c,g(a.Buttons[p].tooltip),{},a.spreadsheetDiv),SocialCalc.ButtonRegister(a.editor,c,{normalstyle:"border:1px solid "+f.ISCButtonBorderNormal+";backgroundColor:"+f.ISCButtonBorderNormal+";",hoverstyle:"border:1px solid "+f.ISCButtonBorderHover+";backgroundColor:"+f.ISCButtonBorderNormal+";",downstyle:"border:1px solid "+f.ISCButtonBorderDown+";backgroundColor:"+f.ISCButtonDownBackground+";"},{MouseDown:SocialCalc.DoButtonCmd,command:a.Buttons[p].command})):
alert("Button "+(a.idPrefix+p)+" missing");a.formulabarDiv=document.createElement("div");_SC_formula=a.formulabarDiv;a.formulabarDiv.style.height=a.formulabarheight+"px";a.formulabarDiv.innerHTML='<input type="text" size="100" style="font-size:15px" value="" id="formulabox" style="border:solid 1px #CCC">&nbsp;';a.spreadsheetDiv.appendChild(a.formulabarDiv);new SocialCalc.InputBox(a.formulabarDiv.firstChild,a.editor);for(p in a.formulabuttons)c=document.createElement("img"),c.id=a.idPrefix+p,c.src=
(a.formulabuttons[p].skipImagePrefix?"":a.imagePrefix)+a.formulabuttons[p].image,c.style.verticalAlign="middle",c.style.border="1px solid #FFF",c.style.marginLeft="4px",SocialCalc.TooltipRegister(c,g(a.formulabuttons[p].tooltip),{},a.spreadsheetDiv),SocialCalc.ButtonRegister(a.editor,c,{normalstyle:"border:1px solid #FFF;backgroundColor:#FFF;",hoverstyle:"border:1px solid #CCC;backgroundColor:#FFF;",downstyle:"border:1px solid #000;backgroundColor:#FFF;"},{MouseDown:a.formulabuttons[p].command,Disabled:function(){return a.editor.ECellReadonly()}}),
a.formulabarDiv.appendChild(c);for(d=0;d<r.length;d++)if(r[d].oncreate)r[d].oncreate(a,r[d].name);a.nonviewheight=a.statuslineheight+a.spreadsheetDiv.firstChild.offsetHeight+a.spreadsheetDiv.lastChild.offsetHeight;a.viewheight=a.height-a.nonviewheight;a.editorDiv=a.editor.CreateTableEditor(a.width,a.viewheight);a.spreadsheetDiv.appendChild(a.editorDiv);for(h in t){b=t[h].html;for(n in t[h].replacements)b=b.replace(t[h].replacements[n].regex,t[h].replacements[n].replacement);b=b.replace(/\%s\./g,"SocialCalc.");
b=b.replace(/\%id\./g,a.idPrefix);b=b.replace(/\%tbt\./g,a.toolbartext);b=b.replace(/\%img\./g,a.imagePrefix);f=document.createElement("div");SocialCalc.setStyles(f,t[h].divStyle);f.style.display="none";f.style.width=a.width+"px";f.style.height=a.viewheight+"px";f.id=a.idPrefix+t[h].name+"view";b=l(b);f.innerHTML=b;a.spreadsheetDiv.appendChild(f);t[h].element=f;if(t[h].oncreate)t[h].oncreate(a,t[h])}t.sheet={name:"sheet",element:a.editorDiv};a.statuslineDiv=document.createElement("div");a.statuslineDiv.style.cssText=
a.statuslineCSS;a.statuslineDiv.style.height=a.statuslineheight-(a.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(a.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+"px";a.statuslineDiv.id=a.idPrefix+"statusline";a.spreadsheetDiv.appendChild(a.statuslineDiv);if(a.spreadsheetDiv.addEventListener)a.spreadsheetDiv.addEventListener("mousedown",function(){SocialCalc.SetSpreadsheetControlObject(a)},!1),a.spreadsheetDiv.addEventListener("mouseover",function(){SocialCalc.SetSpreadsheetControlObject(a)},!1);
else if(a.spreadsheetDiv.attachEvent)a.spreadsheetDiv.attachEvent("onmousedown",function(){SocialCalc.SetSpreadsheetControlObject(a)}),a.spreadsheetDiv.attachEvent("onmouseover",function(){SocialCalc.SetSpreadsheetControlObject(a)});else throw SocialCalc.Constants.s_BrowserNotSupported;};SocialCalc.LocalizeString=function(a){var c=SocialCalc.LocalizeStringList[a];c||(c=SocialCalc.Constants["s_loc_"+a.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||a,SocialCalc.LocalizeStringList[a]=c);return c};
SocialCalc.LocalizeStringList={};SocialCalc.LocalizeSubstrings=function(a){var c=SocialCalc.LocalizeString;return a.replace(/%(loc|ssc)!(.*?)!/g,function(a,d,e){return"ssc"==d?SocialCalc.Constants[e]||alert("Missing constant: "+e):c(e)})};SocialCalc.GetSpreadsheetControlObject=function(){var a=SocialCalc.CurrentSpreadsheetControlObject;if(a)return a};
SocialCalc.SetSpreadsheetControlObject=function(a){SocialCalc.CurrentSpreadsheetControlObject=a;SocialCalc.Keyboard.focusTable&&a&&(SocialCalc.Keyboard.focusTable=a.editor)};SocialCalc.DoOnResize=function(a){var c,b=a.views;if(a.SizeSSDiv()){for(vname in b)c=b[vname].element,c.style.width=a.width+"px",c.style.height=a.height-a.nonviewheight+"px";a.editor.ResizeTableEditor(a.width,a.height-a.nonviewheight)}};
SocialCalc.SizeSSDiv=function(a){var c,b,d,e;d=!1;c=SocialCalc.GetViewportInfo();b=SocialCalc.GetElementPosition(a.parentNode);b.bottom=0;b.right=0;e=a.parentNode.style;e.marginTop&&(b.top+=e.marginTop.slice(0,-2)-0);e.marginBottom&&(b.bottom+=e.marginBottom.slice(0,-2)-0);e.marginLeft&&(b.left+=e.marginLeft.slice(0,-2)-0);e.marginRight&&(b.right+=e.marginRight.slice(0,-2)-0);e=a.requestedHeight||c.height-(b.top+b.bottom+10)-(a.requestedSpaceBelow||0);a.height!=e&&(a.height=e,a.spreadsheetDiv.style.height=
e+"px",d=!0);e=a.requestedWidth||c.width-(b.left+b.right+10)||700;a.width!=e&&(a.width=e,a.spreadsheetDiv.style.width=e+"px",d=!0);a.spreadsheetDiv.style.position="relative";return d};
SocialCalc.SetTab=function(a){var c,b,d,e,f,g={},l={},h=SocialCalc.GetSpreadsheetControlObject(),n=h.tabs,p=h.views;a="string"==typeof a?a:a.id.slice(h.idPrefix.length,-3);if(h.editor.busy&&(!n[h.currentTab].view||"sheet"==n[h.currentTab].view))for(e=0;e<n.length;e++)if(n[e].name==a&&n[e].view&&"sheet"!=n[e].view)return;if(h.tabs[h.currentTab].onunclick)h.tabs[h.currentTab].onunclick(h,h.tabs[h.currentTab].name);for(e=0;e<n.length;e++)c=n[e].name,g[c]=document.getElementById(h.idPrefix+c+"tab"),l[c]=
document.getElementById(h.idPrefix+c+"tools"),c==a?(b=e,l[c].style.display="block",g[c].style.cssText=h.tabselectedCSS):(l[c].style.display="none",g[c].style.cssText=h.tabplainCSS);h.currentTab=b;if(n[b].onclick)n[b].onclick(h,a);for(f in p)!n[b].view&&"sheet"==f||n[b].view==f?(p[f].element.style.display="block",d=f):p[f].element.style.display="none";n[b].onclickFocus?(b=n[b].onclickFocus,"string"==typeof b&&(b=document.getElementById(h.idPrefix+b),b.focus()),SocialCalc.CmdGotFocus(b)):SocialCalc.KeyboardFocus();
p[d].needsresize&&p[d].onresize&&(p[d].needsresize=!1,p[d].onresize(h,p[d]));"sheet"==d?(h.statuslineDiv.style.display="block",h.editor.ScheduleRender()):h.statuslineDiv.style.display="none"};
SocialCalc.SpreadsheetControlStatuslineCallback=function(a,c,b,d){var e=document.getElementById(d.statuslineid);e&&(e.innerHTML=a.GetStatuslineString(c,b,d));switch(c){case "cmdendnorender":case "calcfinished":case "doneposcalc":c=document.getElementById(d.recalcid1);d=document.getElementById(d.recalcid2);if(!c||!d)break;"yes"==a.context.sheetobj.attribs.needsrecalc?(c.style.display="inline",d.style.display="inline"):(c.style.display="none",d.style.display="none")}};
SocialCalc.UpdateSortRangeProposal=function(a){document.getElementById(SocialCalc.GetSpreadsheetControlObject().idPrefix+"sortlist").options[0].text=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom):SocialCalc.LocalizeString("[select range]")};
SocialCalc.LoadColumnChoosers=function(a){var c=SocialCalc.LocalizeString,b,d,e,f;a.sortrange&&-1==a.sortrange.indexOf(":")?(b=SocialCalc.Formula.LookupName(a.sheet,a.sortrange||""),"range"==b.type?(b=b.value.match(/^(.*)\|(.*)\|$/),b=b[1]+":"+b[2]):b="A1:A1"):b=a.sortrange;var g=SocialCalc.ParseRange(b);e=document.getElementById(a.idPrefix+"majorsort");f=e.selectedIndex;e.options.length=0;e.options[e.options.length]=new Option(c("[None]"),"");for(b=g.cr1.col;b<=g.cr2.col;b++)d=SocialCalc.rcColname(b),
e.options[e.options.length]=new Option(c("Column ")+d,d);e.selectedIndex=1<f&&f<=g.cr2.col-g.cr1.col+1?f:1;e=document.getElementById(a.idPrefix+"minorsort");f=e.selectedIndex;e.options.length=0;e.options[e.options.length]=new Option(c("[None]"),"");for(b=g.cr1.col;b<=g.cr2.col;b++)d=SocialCalc.rcColname(b),e.options[e.options.length]=new Option(d,d);e.selectedIndex=0<f&&f<=g.cr2.col-g.cr1.col+1?f:0;e=document.getElementById(a.idPrefix+"lastsort");f=e.selectedIndex;e.options.length=0;e.options[e.options.length]=
new Option(c("[None]"),"");for(b=g.cr1.col;b<=g.cr2.col;b++)d=SocialCalc.rcColname(b),e.options[e.options.length]=new Option(d,d);e.selectedIndex=0<f&&f<=g.cr2.col-g.cr1.col+1?f:0};SocialCalc.CmdGotFocus=function(a){SocialCalc.Keyboard.passThru=a};SocialCalc.DoButtonCmd=function(a,c,b){SocialCalc.DoCmd(b.element,b.functionobj.command)};
SocialCalc.DoCmd=function(a,c){var b,d,e,f,g,l;f=SocialCalc.GetSpreadsheetControlObject();e=f.editor;switch(c){case "undo":f.ExecuteCommand("undo","");break;case "redo":f.ExecuteCommand("redo","");break;case "fill-rowcolstuff":case "fill-text":e=c.substring(5);d=document.getElementById(f.idPrefix+e+"list");for(b=d.length=0;b<SocialCalc.SpreadsheetCmdTable[e].length;b++)d.options[b]=new Option(SocialCalc.SpreadsheetCmdTable[e][b].t);c="changed-"+e;case "changed-rowcolstuff":case "changed-text":e=c.substring(8);
d=document.getElementById(f.idPrefix+e+"list");d=SocialCalc.SpreadsheetCmdTable.slists[SocialCalc.SpreadsheetCmdTable[e][d.selectedIndex].s];f=document.getElementById(f.idPrefix+e+"slist");for(b=f.length=0;b<(d.length||0);b++)f.options[b]=new Option(d[b].t,d[b].s);return;case "ok-rowcolstuff":case "ok-text":e=c.substring(3);d=document.getElementById(f.idPrefix+e+"list");f=document.getElementById(f.idPrefix+e+"slist");b=SocialCalc.SpreadsheetCmdTable[e][d.selectedIndex].c;d=f[f.selectedIndex].value;
SocialCalc.SpreadsheetControlExecuteCommand(a,b,d);break;case "ok-setsort":b=document.getElementById(f.idPrefix+"sortlist");f.sortrange=0==b.selectedIndex?e.range.hasrange?SocialCalc.crToCoord(e.range.left,e.range.top)+":"+SocialCalc.crToCoord(e.range.right,e.range.bottom):e.ecell.coord+":"+e.ecell.coord:b.options[b.selectedIndex].value;d=document.getElementById(f.idPrefix+"sortbutton");d.value=SocialCalc.LocalizeString("Sort ")+f.sortrange;d.style.visibility="visible";SocialCalc.LoadColumnChoosers(f);
a&&a.blur&&a.blur();SocialCalc.KeyboardFocus();return;case "dosort":if(f.sortrange&&-1==f.sortrange.indexOf(":")){e=SocialCalc.Formula.LookupName(f.sheet,f.sortrange||"");if("range"!=e.type)return;e=e.value.match(/^(.*)\|(.*)\|$/);e=e[1]+":"+e[2]}else e=f.sortrange;if("A1:A1"==e)return;b="sort "+e+" ";e=document.getElementById(f.idPrefix+"majorsort");d=document.getElementById(f.idPrefix+"majorsortup");b+=e.options[e.selectedIndex].value+(d.checked?" up":" down");e=document.getElementById(f.idPrefix+
"minorsort");0<e.selectedIndex&&(d=document.getElementById(f.idPrefix+"minorsortup"),b+=" "+e.options[e.selectedIndex].value+(d.checked?" up":" down"));e=document.getElementById(f.idPrefix+"lastsort");0<e.selectedIndex&&(d=document.getElementById(f.idPrefix+"lastsortup"),b+=" "+e.options[e.selectedIndex].value+(d.checked?" up":" down"));f.ExecuteCommand(b,"");break;case "merge":b=SocialCalc.SpreadsheetCmdLookup[c]||"";d=SocialCalc.SpreadsheetCmdSLookup[c]||"";f.ExecuteCommand(b,d);e.range.hasrange&&
(e.MoveECell(SocialCalc.crToCoord(e.range.left,e.range.top)),e.RangeRemove());break;case "movefrom":e.range2.hasrange?(f.context.cursorsuffix="",e.Range2Remove(),f.ExecuteCommand("redisplay","")):e.range.hasrange?(e.range2.top=e.range.top,e.range2.right=e.range.right,e.range2.bottom=e.range.bottom,e.range2.left=e.range.left,e.range2.hasrange=!0,e.MoveECell(SocialCalc.crToCoord(e.range.left,e.range.top))):(e.range2.top=e.ecell.row,e.range2.right=e.ecell.col,e.range2.bottom=e.ecell.row,e.range2.left=
e.ecell.col,e.range2.hasrange=!0);b=e.range2.hasrange?"":"off";d=document.getElementById(f.idPrefix+"button_movefrom");d.src=f.imagePrefix+"movefrom"+b+".gif";d=document.getElementById(f.idPrefix+"button_movepaste");d.src=f.imagePrefix+"movepaste"+b+".gif";d=document.getElementById(f.idPrefix+"button_moveinsert");d.src=f.imagePrefix+"moveinsert"+b+".gif";e.range2.hasrange&&e.RangeRemove();break;case "movepaste":case "moveinsert":e.range2.hasrange&&(f.context.cursorsuffix="",b=c+" "+SocialCalc.crToCoord(e.range2.left,
e.range2.top)+":"+SocialCalc.crToCoord(e.range2.right,e.range2.bottom)+" "+e.ecell.coord,f.ExecuteCommand(b,""),e.Range2Remove(),d=document.getElementById(f.idPrefix+"button_movefrom"),d.src=f.imagePrefix+"movefromoff.gif",d=document.getElementById(f.idPrefix+"button_movepaste"),d.src=f.imagePrefix+"movepasteoff.gif",d=document.getElementById(f.idPrefix+"button_moveinsert"),d.src=f.imagePrefix+"moveinsertoff.gif");break;case "swapcolors":b=f.sheet;g=b.GetAssuredCell(e.ecell.coord);d=b.attribs.defaultcolor?
b.colors[b.attribs.defaultcolor]:"rgb(0,0,0)";l=b.attribs.defaultbgcolor?b.colors[b.attribs.defaultbgcolor]:"rgb(255,255,255)";e=g.color?b.colors[g.color]:d;e==l&&(e="");b=g.bgcolor?b.colors[g.bgcolor]:l;b==d&&(b="");f.ExecuteCommand("set %C color "+b+"%Nset %C bgcolor "+e,"");break;default:b=SocialCalc.SpreadsheetCmdLookup[c]||"",d=SocialCalc.SpreadsheetCmdSLookup[c]||"",f.ExecuteCommand(b,d)}a&&a.blur&&a.blur();SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetCmdLookup={copy:"copy %C all",cut:"cut %C all",paste:"paste %C all",pasteformats:"paste %C formats",lock:"set %C readonly yes",unlock:"set %C readonly no","delete":"erase %C formulas",filldown:"filldown %C all",fillright:"fillright %C all",erase:"erase %C all",borderon:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",borderoff:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",merge:"merge %C",unmerge:"unmerge %C","align-left":"set %C cellformat left","align-center":"set %C cellformat center",
"align-right":"set %C cellformat right","align-default":"set %C cellformat",insertrow:"insertrow %C",insertcol:"insertcol %C",deleterow:"deleterow %C",deletecol:"deletecol %C",hiderow:"set %H hide yes",hidecol:"set %W hide yes",undo:"undo",redo:"redo",recalc:"recalc"};SocialCalc.SpreadsheetCmdSLookup={borderon:"1px solid rgb(0,0,0)",borderoff:""};
SocialCalc.SpreadsheetControlExecuteCommand=function(a,c,b){a=SocialCalc.GetSpreadsheetControlObject().editor;var d,e,f,g;a.range.hasrange?(e=d=SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom),f=SocialCalc.rcColname(a.range.left)+":"+SocialCalc.rcColname(a.range.right),g=a.range.top+":"+a.range.bottom):(e=a.ecell.coord,d=a.ecell.coord+":"+a.ecell.coord,f=SocialCalc.rcColname(SocialCalc.coordToCr(a.ecell.coord).col),g=SocialCalc.coordToCr(a.ecell.coord).row);
c=c.replace(/%C/g,e);c=c.replace(/%R/g,d);c=c.replace(/%N/g,"\n");c=c.replace(/%S/g,b);c=c.replace(/%W/g,f);c=c.replace(/%H/g,g);c=c.replace(/%P/g,"%");a.EditorScheduleSheetCommands(c,!0,!1)};SocialCalc.SpreadsheetControlCreateSheetHTML=function(a){var c,b;c="";c=new SocialCalc.RenderContext(a.sheet);a=document.createElement("div");b=c.RenderSheet(null,{type:"html"});a.appendChild(b);delete c;c=a.innerHTML;delete b;delete a;return c};
SocialCalc.SpreadsheetControlCreateCellHTML=function(a,c,b){var d="",d=a.sheet.cells[c];if(!d)return"";d=void 0==d.displaystring?SocialCalc.FormatValueForDisplay(a.sheet,d.datavalue,c,b||a.context.defaultHTMLlinkstyle):d.displaystring;"&nbsp;"==d&&(d="");return d};
SocialCalc.SpreadsheetControlCreateCellHTMLSave=function(a,c,b){var d,e,f,g,l,h=[];d=c?SocialCalc.ParseRange(c):{cr1:{row:1,col:1},cr2:{row:a.sheet.attribs.lastrow,col:a.sheet.attribs.lastcol}};c=d.cr1;d=d.cr2;h.push("version:1.0");for(e=c.row;e<=d.row;e++)for(f=c.col;f<=d.col;f++)if(g=SocialCalc.crToCoord(f,e),l=a.sheet.cells[g])l=void 0==l.displaystring?SocialCalc.FormatValueForDisplay(a.sheet,l.datavalue,g,b||a.context.defaultHTMLlinkstyle):l.displaystring,"&nbsp;"!=l&&h.push(g+":"+SocialCalc.encodeForSave(l));
h.push("");return h.join("\n")};
SocialCalc.SpreadsheetControl.DoFunctionList=function(){var a,c,b=SocialCalc.Formula,d=SocialCalc.Constants.function_classlist,e=SocialCalc.GetSpreadsheetControlObject(),f=e.idPrefix+"function";c=document.getElementById(f+"dialog");if(!c){b.FillFunctionInfo();c='<table><tr><td><span style="font-size:x-small;font-weight:bold">%loc!Category!</span><br><select id="'+f+'class" size="'+d.length+'" style="width:120px;" onchange="SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);">';for(a=
0;a<d.length;a++)c+='<option value="'+d[a]+'"'+(0==a?" selected>":">")+SocialCalc.special_chars(b.FunctionClasses[d[a]].name)+"</option>";c+='</select></td><td>&nbsp;&nbsp;</td><td id="'+f+'list"><span style="font-size:x-small;font-weight:bold">%loc!Functions!</span><br><select id="'+f+'name" size="'+d.length+'" style="width:240px;" onchange="SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);" ondblclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">';c+=SocialCalc.SpreadsheetControl.GetFunctionNamesStr("all");
c+='</td></tr><tr><td colspan="3"><div id="'+f+'desc" style="width:380px;height:80px;overflow:auto;font-size:x-small;">'+SocialCalc.SpreadsheetControl.GetFunctionInfoStr(b.FunctionClasses[d[0]].items[0])+'</div><div style="width:380px;text-align:right;padding-top:6px;font-size:small;"><input type="button" value="%loc!Paste!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();"></div></td></tr></table>';
b=document.createElement("div");b.id=f+"dialog";b.style.position="absolute";d=SocialCalc.GetViewportInfo();a=SocialCalc.GetElementPositionWithScroll(e.spreadsheetDiv);b.style.top=d.height/3-a.top+"px";b.style.left=d.width/3-a.left+"px";b.style.zIndex=100;b.style.backgroundColor="#FFF";b.style.border="1px solid black";b.style.width="400px";c=SocialCalc.LocalizeSubstrings('<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;%loc!Function List!</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+
c+"</div>");b.innerHTML=c;SocialCalc.DragRegister(b.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:b},e.spreadsheetDiv);e.spreadsheetDiv.appendChild(b);c=document.getElementById(f+"name");c.focus();SocialCalc.CmdGotFocus(c)}};
SocialCalc.SpreadsheetControl.GetFunctionNamesStr=function(a){var c,b="";c=SocialCalc.Formula.FunctionClasses[a];for(a=0;a<c.items.length;a++)b+='<option value="'+c.items[a]+'"'+(0==a?" selected>":">")+c.items[a]+"</option>";return b};SocialCalc.SpreadsheetControl.FillFunctionNames=function(a,c){var b,d;b=SocialCalc.Formula;c.length=0;d=b.FunctionClasses[a];for(b=0;b<d.items.length;b++)c.options[b]=new Option(d.items[b],d.items[b]),0==b&&(c.options[b].selected=!0)};
SocialCalc.SpreadsheetControl.GetFunctionInfoStr=function(a){var c=SocialCalc.Formula,b=c.FunctionList[a],d=SocialCalc.special_chars;a="<b>"+a+"("+d(c.FunctionArgString(a))+")</b><br>";return a+=d(b[3])};SocialCalc.SpreadsheetControl.FunctionClassChosen=function(a){var c=SocialCalc.GetSpreadsheetControlObject().idPrefix+"function",b=SocialCalc.Formula;SocialCalc.SpreadsheetControl.FillFunctionNames(a,document.getElementById(c+"name"));SocialCalc.SpreadsheetControl.FunctionChosen(b.FunctionClasses[a].items[0])};
SocialCalc.SpreadsheetControl.FunctionChosen=function(a){var c=SocialCalc.GetSpreadsheetControlObject().idPrefix+"function";document.getElementById(c+"desc").innerHTML=SocialCalc.SpreadsheetControl.GetFunctionInfoStr(a)};SocialCalc.SpreadsheetControl.HideFunctions=function(){var a=SocialCalc.GetSpreadsheetControlObject(),a=document.getElementById(a.idPrefix+"functiondialog");a.innerHTML="";SocialCalc.DragUnregister(a);SocialCalc.KeyboardFocus();a.parentNode&&a.parentNode.removeChild(a)};
SocialCalc.SpreadsheetControl.DoFunctionPaste=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,b=document.getElementById(a.idPrefix+"functionname"),a=document.getElementById(a.idPrefix+"multilinetextarea"),b=b.value+"(";SocialCalc.SpreadsheetControl.HideFunctions();a?(a.value+=b,a.focus(),SocialCalc.CmdGotFocus(a)):c.EditorAddToInput(b,"=")};
SocialCalc.SpreadsheetControl.DoMultiline=function(){var a=SocialCalc.LocalizeSubstrings,c,b,d=SocialCalc.GetSpreadsheetControlObject(),e=d.editor,f=e.workingvalues,d=SocialCalc.GetSpreadsheetControlObject(),g=d.idPrefix+"multiline";c=document.getElementById(g+"dialog");if(!c){switch(e.state){case "start":f.ecoord=e.ecell.coord;f.erow=e.ecell.row;f.ecol=e.ecell.col;e.RangeRemove();b=SocialCalc.GetCellContents(e.context.sheetobj,f.ecoord);break;case "input":case "inputboxdirect":b=e.inputBox.GetText()}e.inputBox.element.disabled=
!0;b=SocialCalc.special_chars(b);c='<textarea id="'+g+'textarea" style="width:380px;height:120px;margin:10px 0px 0px 6px;">'+b+'</textarea><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;">'+a('<input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilinePaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilineClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();"></div></div>');
b=document.createElement("div");b.id=g+"dialog";b.style.position="absolute";e=SocialCalc.GetViewportInfo();f=SocialCalc.GetElementPositionWithScroll(d.spreadsheetDiv);b.style.top=e.height/3-f.top+"px";b.style.left=e.width/3-f.left+"px";b.style.zIndex=100;b.style.backgroundColor="#FFF";b.style.border="1px solid black";b.style.width="400px";b.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+
a("&nbsp;%loc!Multi-line Input Box!")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+c+"</div>";SocialCalc.DragRegister(b.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:b},d.spreadsheetDiv);d.spreadsheetDiv.appendChild(b);
c=document.getElementById(g+"textarea");c.focus();SocialCalc.CmdGotFocus(c)}};SocialCalc.SpreadsheetControl.HideMultiline=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,a=document.getElementById(a.idPrefix+"multilinedialog");a.innerHTML="";SocialCalc.DragUnregister(a);SocialCalc.KeyboardFocus();a.parentNode&&a.parentNode.removeChild(a);switch(c.state){case "start":c.inputBox.DisplayCellContents(null);break;case "input":case "inputboxdirect":c.inputBox.element.disabled=!1,c.inputBox.Focus()}};
SocialCalc.SpreadsheetControl.DoMultilineClear=function(){var a=SocialCalc.GetSpreadsheetControlObject(),a=document.getElementById(a.idPrefix+"multilinetextarea");a.value="";a.focus()};
SocialCalc.SpreadsheetControl.DoMultilinePaste=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,b=c.workingvalues,a=document.getElementById(a.idPrefix+"multilinetextarea").value;SocialCalc.SpreadsheetControl.HideMultiline();switch(c.state){case "start":b.partialexpr="";b.ecoord=c.ecell.coord;b.erow=c.ecell.row;b.ecol=c.ecell.col;break;case "input":case "inputboxdirect":c.inputBox.Blur(),c.inputBox.ShowInputBox(!1),c.state="start"}c.EditorSaveEdit(a)};
SocialCalc.SpreadsheetControl.DoLink=function(){var a=SocialCalc.LocalizeString,c,b,d,e,f=SocialCalc.GetSpreadsheetControlObject();d=f.editor;e=d.workingvalues;var f=SocialCalc.GetSpreadsheetControlObject(),g=f.idPrefix+"link";b=document.getElementById(g+"dialog");if(!b){switch(d.state){case "start":e.ecoord=d.ecell.coord;e.erow=d.ecell.row;e.ecol=d.ecell.col;d.RangeRemove();c=SocialCalc.GetCellContents(d.context.sheetobj,e.ecoord);break;case "input":case "inputboxdirect":c=d.inputBox.GetText()}d.inputBox.element.disabled=
!0;"'"==c.charAt(0)&&(c=c.slice(1));b=SocialCalc.ParseCellLinkText(c);SocialCalc.special_chars(c);d=(c=f.sheet.cells[d.ecell.coord])&&c.textvalueformat?"":" checked";e=b.newwin?" checked":"";c='<div style="padding:6px 0px 4px 6px;"><span style="font-size:smaller;">'+a("Description")+'</span><br><input type="text" id="'+g+'desc" style="width:380px;" value="'+SocialCalc.special_chars(b.desc)+'"><br><span style="font-size:smaller;">'+a("URL")+'</span><br><input type="text" id="'+g+'url" style="width:380px;" value="'+
SocialCalc.special_chars(b.url)+'"><br>';SocialCalc.Callbacks.MakePageLink&&(c+='<span style="font-size:smaller;">'+a("Page Name")+'</span><br><input type="text" id="'+g+'pagename" style="width:380px;" value="'+SocialCalc.special_chars(b.pagename)+'"><br><span style="font-size:smaller;">'+a("Workspace")+'</span><br><input type="text" id="'+g+'workspace" style="width:380px;" value="'+SocialCalc.special_chars(b.workspace)+'"><br>');c+=SocialCalc.LocalizeSubstrings('<input type="checkbox" id="'+g+'format"'+
d+'>&nbsp;<span style="font-size:smaller;">%loc!Set to Link format!</span><br><input type="checkbox" id="'+g+'popup"'+e+'>&nbsp;<span style="font-size:smaller;">%loc!Show in new browser window!</span></div><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;"><input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkPaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideLink();"></div></div>');
b=document.createElement("div");b.id=g+"dialog";b.style.position="absolute";d=SocialCalc.GetViewportInfo();e=SocialCalc.GetElementPositionWithScroll(f.spreadsheetDiv);b.style.top=d.height/3-e.top+"px";b.style.left=d.width/3-e.left+"px";b.style.zIndex=100;b.style.backgroundColor="#FFF";b.style.border="1px solid black";b.style.width="400px";b.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;'+
a("Link Input Box")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideLink();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+c+"</div>";SocialCalc.DragRegister(b.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:b},f.spreadsheetDiv);f.spreadsheetDiv.appendChild(b);b=document.getElementById(g+
"url");b.focus();SocialCalc.CmdGotFocus(b)}};SocialCalc.SpreadsheetControl.HideLink=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,a=document.getElementById(a.idPrefix+"linkdialog");a.innerHTML="";SocialCalc.DragUnregister(a);SocialCalc.KeyboardFocus();a.parentNode&&a.parentNode.removeChild(a);switch(c.state){case "start":c.inputBox.DisplayCellContents(null);break;case "input":case "inputboxdirect":c.inputBox.element.disabled=!1,c.inputBox.Focus()}};
SocialCalc.SpreadsheetControl.DoLinkClear=function(){var a=SocialCalc.GetSpreadsheetControlObject();document.getElementById(a.idPrefix+"linkdesc").value="";document.getElementById(a.idPrefix+"linkpagename").value="";document.getElementById(a.idPrefix+"linkworkspace").value="";a=document.getElementById(a.idPrefix+"linkurl");a.value="";a.focus()};
SocialCalc.SpreadsheetControl.DoLinkPaste=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,b=c.workingvalues,d=document.getElementById(a.idPrefix+"linkdesc"),e=document.getElementById(a.idPrefix+"linkurl"),f=document.getElementById(a.idPrefix+"linkpagename"),g=document.getElementById(a.idPrefix+"linkworkspace"),l=document.getElementById(a.idPrefix+"linkformat"),h="",n,p;document.getElementById(a.idPrefix+"linkpopup").checked?(a="<<",h=">>",n="[[",p="]]"):(a="<",h=">",n="[",p="]");
h=f&&f.value?g.value?d.value+"{"+g.value+n+f.value+p+"}":d.value+n+f.value+p:d.value+a+e.value+h;SocialCalc.SpreadsheetControl.HideLink();switch(c.state){case "start":b.partialexpr="";b.ecoord=c.ecell.coord;b.erow=c.ecell.row;b.ecol=c.ecell.col;break;case "input":case "inputboxdirect":c.inputBox.Blur(),c.inputBox.ShowInputBox(!1),c.state="start"}l.checked&&SocialCalc.SpreadsheetControlExecuteCommand(null,"set %C textvalueformat text-link","");c.EditorSaveEdit(h)};
SocialCalc.SpreadsheetControl.DoSum=function(){var a,c,b,d,e=SocialCalc.GetSpreadsheetControlObject().editor,f=e.context.sheetobj;if(e.range.hasrange)a=SocialCalc.crToCoord(e.range.left,e.range.top)+":"+SocialCalc.crToCoord(e.range.right,e.range.bottom),a="set "+SocialCalc.crToCoord(e.range.right,e.range.bottom+1)+" formula sum("+a+")";else if(a=e.ecell.row-1,b=e.ecell.col,1>=a)a="set "+e.ecell.coord+" constant e#REF! 0 #REF!";else{for(d=!1;0<a;){c=SocialCalc.crToCoord(b,a);c=f.GetAssuredCell(c);
if(c.datatype&&"t"!=c.datatype)d=!0;else if(d){a++;break}a--}a="set "+e.ecell.coord+" formula sum("+SocialCalc.crToCoord(b,a)+":"+SocialCalc.crToCoord(b,e.ecell.row-1)+")"}e.EditorScheduleSheetCommands(a,!0,!1)};
SocialCalc.SpreadsheetControlSortOnclick=function(a,c){var b,d,e=[],f=document.getElementById(a.idPrefix+"sortlist");SocialCalc.LoadColumnChoosers(a);a.editor.RangeChangeCallback.sort=SocialCalc.UpdateSortRangeProposal;for(b in a.sheet.names)e.push(b);e.sort();f.length=0;f.options[0]=new Option(SocialCalc.LocalizeString("[select range]"));for(d=0;d<e.length;d++)b=e[d],f.options[d+1]=new Option(b,b),b==a.sortrange&&(f.options[d+1].selected=!0);""==a.sortrange&&(f.options[0].selected=!0);SocialCalc.UpdateSortRangeProposal(a.editor);
SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetControlSortSave=function(a,c){var b=SocialCalc.GetSpreadsheetControlObject(),d,e,f;d="sort:"+SocialCalc.encodeForSave(b.sortrange)+":";e=document.getElementById(b.idPrefix+"majorsort");f=document.getElementById(b.idPrefix+"majorsortup");d+=e.selectedIndex+(f.checked?":up":":down");e=document.getElementById(b.idPrefix+"minorsort");0<e.selectedIndex?(f=document.getElementById(b.idPrefix+"minorsortup"),d+=":"+e.selectedIndex+(f.checked?":up":":down")):d+="::";e=document.getElementById(b.idPrefix+
"lastsort");0<e.selectedIndex?(f=document.getElementById(b.idPrefix+"lastsortup"),d+=":"+e.selectedIndex+(f.checked?":up":":down")):d+="::";return d+"\n"};
SocialCalc.SpreadsheetControlSortLoad=function(a,c,b,d){a=SocialCalc.GetSpreadsheetControlObject();b=b.split(":");a.sortrange=SocialCalc.decodeFromSave(b[1]);c=document.getElementById(a.idPrefix+"sortbutton");a.sortrange?(c.value=SocialCalc.LocalizeString("Sort ")+a.sortrange,c.style.visibility="visible"):c.style.visibility="hidden";SocialCalc.LoadColumnChoosers(a);sele=document.getElementById(a.idPrefix+"majorsort");sele.selectedIndex=b[2]-0;document.getElementById(a.idPrefix+"majorsort"+b[3]).checked=
!0;sele=document.getElementById(a.idPrefix+"minorsort");b[4]?(sele.selectedIndex=b[4]-0,document.getElementById(a.idPrefix+"minorsort"+b[5]).checked=!0):(sele.selectedIndex=0,document.getElementById(a.idPrefix+"minorsortup").checked=!0);sele=document.getElementById(a.idPrefix+"lastsort");b[6]?(sele.selectedIndex=b[6]-0,document.getElementById(a.idPrefix+"lastsort"+b[7]).checked=!0):(sele.selectedIndex=0,document.getElementById(a.idPrefix+"lastsortup").checked=!0);return!0};
SocialCalc.SpreadsheetControlCommentOnclick=function(a,c){a.editor.MoveECellCallback.comment=SocialCalc.SpreadsheetControlCommentMoveECell;SocialCalc.SpreadsheetControlCommentDisplay(a,c);SocialCalc.KeyboardFocus()};SocialCalc.SpreadsheetControlCommentDisplay=function(a,c){var b="";a.editor.ecell&&(a.editor.ecell.coord&&a.sheet.cells[a.editor.ecell.coord])&&(b=a.sheet.cells[a.editor.ecell.coord].comment||"");document.getElementById(a.idPrefix+"commenttext").value=b};
SocialCalc.SpreadsheetControlCommentMoveECell=function(a){SocialCalc.SpreadsheetControlCommentDisplay(SocialCalc.GetSpreadsheetControlObject(),"comment")};
SocialCalc.SpreadsheetControlCommentSet=function(){var a=SocialCalc.GetSpreadsheetControlObject();a.ExecuteCommand("set %C comment "+SocialCalc.encodeForSave(document.getElementById(a.idPrefix+"commenttext").value));var c=SocialCalc.GetEditorCellElement(a.editor,a.editor.ecell.row,a.editor.ecell.col);a.editor.ECellReadonly()||(c.element.title=document.getElementById(a.idPrefix+"commenttext").value,a.editor.UpdateCellCSS(c,a.editor.ecell.row,a.editor.ecell.col));SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetControlCommentOnunclick=function(a,c){delete a.editor.MoveECellCallback.comment};
SocialCalc.SpreadsheetControlNamesOnclick=function(a,c){document.getElementById(a.idPrefix+"namesname").value="";document.getElementById(a.idPrefix+"namesdesc").value="";document.getElementById(a.idPrefix+"namesvalue").value="";a.editor.RangeChangeCallback.names=SocialCalc.SpreadsheetControlNamesRangeChange;a.editor.MoveECellCallback.names=SocialCalc.SpreadsheetControlNamesRangeChange;SocialCalc.SpreadsheetControlNamesRangeChange(a.editor);SocialCalc.SpreadsheetControlNamesFillNameList();SocialCalc.SpreadsheetControlNamesChangedName()};
SocialCalc.SpreadsheetControlNamesFillNameList=function(){var a=SocialCalc.LocalizeString,c,b=[],d=SocialCalc.GetSpreadsheetControlObject(),e=document.getElementById(d.idPrefix+"nameslist"),f=document.getElementById(d.idPrefix+"namesname").value.toUpperCase().replace(/[^A-Z0-9_\.]/g,"");for(c in d.sheet.names)b.push(c);b.sort();e.length=0;e.options[0]=0<b.length?new Option(a("[New]")):new Option(a("[None]"));for(a=0;a<b.length;a++)c=b[a],e.options[a+1]=new Option(c,c),c==f&&(e.options[a+1].selected=
!0);""==f&&(e.options[0].selected=!0)};
SocialCalc.SpreadsheetControlNamesChangedName=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+"nameslist"),c=c.options[c.selectedIndex].value;a.sheet.names[c]?(document.getElementById(a.idPrefix+"namesname").value=c,document.getElementById(a.idPrefix+"namesdesc").value=a.sheet.names[c].desc||"",document.getElementById(a.idPrefix+"namesvalue").value=a.sheet.names[c].definition||""):(document.getElementById(a.idPrefix+"namesname").value="",document.getElementById(a.idPrefix+
"namesdesc").value="",document.getElementById(a.idPrefix+"namesvalue").value="")};SocialCalc.SpreadsheetControlNamesRangeChange=function(a){var c=SocialCalc.GetSpreadsheetControlObject();document.getElementById(c.idPrefix+"namesrangeproposal").value=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+":"+SocialCalc.crToCoord(a.range.right,a.range.bottom):a.ecell.coord};SocialCalc.SpreadsheetControlNamesOnunclick=function(a,c){delete a.editor.RangeChangeCallback.names;delete a.editor.MoveECellCallback.names};
SocialCalc.SpreadsheetControlNamesSetValue=function(){var a=SocialCalc.GetSpreadsheetControlObject();document.getElementById(a.idPrefix+"namesvalue").value=document.getElementById(a.idPrefix+"namesrangeproposal").value;SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetControlNamesSave=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+"namesname").value;SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus();""!=c&&a.ExecuteCommand("name define "+c+" "+document.getElementById(a.idPrefix+"namesvalue").value+"\nname desc "+c+" "+document.getElementById(a.idPrefix+"namesdesc").value)};
SocialCalc.SpreadsheetControlNamesDelete=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+"namesname").value;SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus();""!=c&&a.ExecuteCommand("name delete "+c);SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetControlClipboardOnclick=function(a,c){a=SocialCalc.GetSpreadsheetControlObject();clipele=document.getElementById(a.idPrefix+"clipboardtext");document.getElementById(a.idPrefix+"clipboardformat-tab").checked=!0;clipele.value=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,"tab")};
SocialCalc.SpreadsheetControlClipboardFormat=function(a){var c=SocialCalc.GetSpreadsheetControlObject();clipele=document.getElementById(c.idPrefix+"clipboardtext");clipele.value=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,a)};
SocialCalc.SpreadsheetControlClipboardLoad=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c="tab";SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus();document.getElementById(a.idPrefix+"clipboardformat-csv").checked?c="csv":document.getElementById(a.idPrefix+"clipboardformat-scsave").checked&&(c="scsave");a.editor.EditorScheduleSheetCommands("loadclipboard "+SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(document.getElementById(a.idPrefix+"clipboardtext").value,c)),
!0,!1)};SocialCalc.SpreadsheetControlClipboardClear=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+"clipboardtext");c.value="";a.editor.EditorScheduleSheetCommands("clearclipboard",!0,!1);c.focus()};SocialCalc.SpreadsheetControlClipboardExport=function(){var a=SocialCalc.GetSpreadsheetControlObject();a.ExportCallback&&a.ExportCallback(a);SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus()};
SocialCalc.SpreadsheetControlSettingsSwitch=function(a){SocialCalc.SettingControlReset();var c=SocialCalc.GetSpreadsheetControlObject(),b=document.getElementById(c.idPrefix+"sheetsettingstable"),d=document.getElementById(c.idPrefix+"cellsettingstable"),e=document.getElementById(c.idPrefix+"sheetsettingstoolbar"),f=document.getElementById(c.idPrefix+"cellsettingstoolbar");"sheet"==a?(b.style.display="block",d.style.display="none",e.style.display="block",f.style.display="none",SocialCalc.SettingsControlSetCurrentPanel(c.views.settings.values.sheetspanel)):
(b.style.display="none",d.style.display="block",e.style.display="none",f.style.display="block",SocialCalc.SettingsControlSetCurrentPanel(c.views.settings.values.cellspanel))};
SocialCalc.SettingsControlSave=function(a){var c,b,d=SocialCalc.GetSpreadsheetControlObject(),e=SocialCalc.SettingsControlUnloadPanel(SocialCalc.SettingsControls.CurrentPanel);SocialCalc.SetTab(d.tabs[0].name);SocialCalc.KeyboardFocus();"sheet"==a?b=d.sheet.DecodeSheetAttributes(e):"cell"==a&&(d.editor.range.hasrange&&(c=SocialCalc.crToCoord(d.editor.range.left,d.editor.range.top)+":"+SocialCalc.crToCoord(d.editor.range.right,d.editor.range.bottom)),b=d.sheet.DecodeCellAttributes(d.editor.ecell.coord,
e,c));b&&d.editor.EditorScheduleSheetCommands(b,!0,!1)};
SocialCalc.SpreadsheetControlCreateSpreadsheetSave=function(a,c){var b="",d="",e,f;if(c)for(e in c)f="\n"!=c[e].charAt(c[e]-1)?"\n":"",b+="--"+a.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+c[e]+f,d+="part:"+e+"\n";return"socialcalc:version:1.0\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary="+a.multipartBoundary+"\n--"+a.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n# SocialCalc Spreadsheet Control Save\nversion:1.0\npart:sheet\npart:edit\npart:audit\n"+d+
"--"+a.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+a.CreateSheetSave()+"--"+a.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+a.editor.SaveEditorSettings()+"--"+a.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+a.sheet.CreateAuditString()+b+"--"+a.multipartBoundary+"--\n"};
SocialCalc.SpreadsheetControlDecodeSpreadsheetSave=function(a,c){var b,d,e,f,g,l,h,n={},p=[];b=c.search(/^MIME-Version:\s1\.0/mi);if(0>b)return n;d=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/mig;d.lastIndex=b;e=d.exec(c);if(0>=d.lastIndex)return n;b=e[1];f=RegExp("^--"+b+"(?:\r\n|\n)","mg");f.lastIndex=d.lastIndex;f.exec(c);d=/(?:\r\n|\n)(?:\r\n|\n)/gm;d.lastIndex=f.lastIndex;e=d.exec(c);if(!e)return n;g=d.lastIndex;f.lastIndex=g;e=f.exec(c);if(!e)return n;e=e.index;g=c.substring(g,e).split(/\r\n|\n/);
for(l=0;l<g.length;l++)switch(line=g[l],h=line.split(":"),h[0]){case "part":p.push(h[1])}for(pnum=0;pnum<p.length;pnum++){d.lastIndex=e;e=d.exec(c);if(!e)break;g=d.lastIndex;pnum==p.length-1&&(f=RegExp("^--"+b+"--$","mg"));f.lastIndex=g;e=f.exec(c);if(!e)break;e=e.index;n[p[pnum]]={start:g,end:e}}return n};SocialCalc.SettingsControls={Controls:{},CurrentPanel:null};
SocialCalc.SettingsControlSetCurrentPanel=function(a){SocialCalc.SettingsControls.CurrentPanel=a;SocialCalc.SettingsControls.PopupChangeCallback({panelobj:a},"",null)};SocialCalc.SettingsControlInitializePanel=function(a){var c,b=SocialCalc.SettingsControls;for(c in a)"name"!=c&&(ctrl=b.Controls[a[c].type])&&ctrl.Initialize&&ctrl.Initialize(a,c)};
SocialCalc.SettingsControlLoadPanel=function(a,c){var b,d=SocialCalc.SettingsControls;for(b in a)"name"!=b&&(ctrl=d.Controls[a[b].type])&&ctrl.SetValue&&ctrl.SetValue(a,b,c[a[b].setting])};SocialCalc.SettingsControlUnloadPanel=function(a){var c,b=SocialCalc.SettingsControls,d={};for(c in a)"name"!=c&&(ctrl=b.Controls[a[c].type])&&ctrl.GetValue&&(d[a[c].setting]=ctrl.GetValue(a,c));return d};
SocialCalc.SettingsControls.PopupChangeCallback=function(a,c,b){var d=SocialCalc.Constants;if((c=document.getElementById("sample-text"))&&a&&a.panelobj){b=SocialCalc.CurrentSpreadsheetControlObject.idPrefix;var e="cell"==a.panelobj.name?"c":"",f,g;g=d.defaultCellLayout.match(/^padding.(\S+) (\S+) (\S+) (\S+).vertical.align.(\S+);$/)||[];g={color:["textcolor"],backgroundColor:["bgcolor","#FFF"],fontSize:["fontsize",d.defaultCellFontSize],fontFamily:["fontfamily"],paddingTop:["padtop",g[1]],paddingRight:["padright",
g[2]],paddingBottom:["padbottom",g[3]],paddingLeft:["padleft",g[4]],verticalAlign:["alignvert",g[5]]};for(f in g)d=SocialCalc.Popup.GetValue(b+e+g[f][0])||g[f][1]||"",c.style[f]=d;if("c"==e){g={borderTop:"cbt",borderRight:"cbr",borderBottom:"cbb",borderLeft:"cbl"};for(f in g)d=SocialCalc.SettingsControls.BorderSideGetValue(a.panelobj,g[f]),c.style[f]=d?d.val||"":"";d=SocialCalc.Popup.GetValue(b+"calignhoriz");c.style.textAlign=d||"left"}else c.style.border="",d=SocialCalc.Popup.GetValue(b+"textalignhoriz"),
c.style.textAlign=d||"left",d=SocialCalc.Popup.GetValue(b+"numberalignhoriz");c.childNodes[1].style.textAlign=d||"right";g=(d=SocialCalc.Popup.GetValue(b+e+"fontlook"))?d.match(/^(\S+) (\S+)$/)||[]:[];c.style.fontStyle=g[1]||"";c.style.fontWeight=g[2]||"";d=SocialCalc.Popup.GetValue(b+e+"formatnumber")||"General";a=SocialCalc.FormatNumber.formatNumberWithFormat(9.8765,d,"");f=SocialCalc.FormatNumber.formatNumberWithFormat(-1234.5,d,"");"??-???-??&nbsp;??:??:??"!=f&&(a+="<br>"+f);c.childNodes[1].innerHTML=
a}};SocialCalc.SettingsControls.PopupListSetValue=function(a,c,b){if(b){var d=SocialCalc.Popup;b.def?d.SetValue(a[c].id,""):d.SetValue(a[c].id,b.val)}else alert(c+" no value")};SocialCalc.SettingsControls.PopupListGetValue=function(a,c){var b=a[c];return b?(b=SocialCalc.Popup.GetValue(b.id))?{def:!1,val:b}:{def:!0,val:0}:null};
SocialCalc.SettingsControls.PopupListInitialize=function(a,c){var b,d,e,f;b=SocialCalc.SettingsControls;b=a[c].initialdata||b.Controls[a[c].type].InitialData||"";b=SocialCalc.LocalizeSubstrings(b);var g=b.split(/\|/),l=[];for(b=0;b<(g.length||0);b++)d=g[b],e=d.indexOf(":"),f=d.substring(0,e),-1!=f.indexOf("\\")&&(f=f.replace(/\\c/g,":"),f=f.replace(/\\b/g,"\\")),f=SocialCalc.special_chars(f),l[b]="[custom]"==f?{o:SocialCalc.Constants.s_PopupListCustom,v:d.substring(e+1),a:{custom:!0}}:"[cancel]"==
f?{o:SocialCalc.Constants.s_PopupListCancel,v:"",a:{cancel:!0}}:"[break]"==f?{o:"-----",v:"",a:{skip:!0}}:"[newcol]"==f?{o:"",v:"",a:{newcol:!0}}:{o:f,v:d.substring(e+1)};SocialCalc.Popup.Create("List",a[c].id,{});SocialCalc.Popup.Initialize(a[c].id,{options:l,attribs:{changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:a}})};SocialCalc.SettingsControls.PopupListReset=function(a){SocialCalc.Popup.Reset("List")};
SocialCalc.SettingsControls.Controls.PopupList={SetValue:SocialCalc.SettingsControls.PopupListSetValue,GetValue:SocialCalc.SettingsControls.PopupListGetValue,Initialize:SocialCalc.SettingsControls.PopupListInitialize,OnReset:SocialCalc.SettingsControls.PopupListReset,ChangedCallback:null};SocialCalc.SettingsControls.ColorChooserSetValue=function(a,c,b){if(b){var d=SocialCalc.Popup;b.def?d.SetValue(a[c].id,""):d.SetValue(a[c].id,b.val)}else alert(c+" no value")};
SocialCalc.SettingsControls.ColorChooserGetValue=function(a,c){var b=SocialCalc.Popup.GetValue(a[c].id);return b?{def:!1,val:b}:{def:!0,val:0}};SocialCalc.SettingsControls.ColorChooserInitialize=function(a,c){SocialCalc.Popup.Create("ColorChooser",a[c].id,{});SocialCalc.Popup.Initialize(a[c].id,{attribs:{title:"&nbsp;",moveable:!0,width:"106px",changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:a}})};SocialCalc.SettingsControls.ColorChooserReset=function(a){SocialCalc.Popup.Reset("ColorChooser")};
SocialCalc.SettingsControls.Controls.ColorChooser={SetValue:SocialCalc.SettingsControls.ColorChooserSetValue,GetValue:SocialCalc.SettingsControls.ColorChooserGetValue,Initialize:SocialCalc.SettingsControls.ColorChooserInitialize,OnReset:SocialCalc.SettingsControls.ColorChooserReset,ChangedCallback:null};
SocialCalc.SettingsControls.BorderSideSetValue=function(a,c,b){a=a[c].id;if(b){if(c=document.getElementById(a+"-onoff-bcb"))b.val?(c.checked=!0,c.value=b.val,b=b.val.match(/(\S+)\s+(\S+)\s+(\S.+)/),a+="-color",SocialCalc.Popup.SetValue(a,b[3]),SocialCalc.Popup.SetDisabled(a,!1)):(c.checked=!1,c.value=b.val,a+="-color",SocialCalc.Popup.SetValue(a,""),SocialCalc.Popup.SetDisabled(a,!0))}else alert(c+" no value")};
SocialCalc.SettingsControls.BorderSideGetValue=function(a,c){var b,d=a[c].id;if(b=document.getElementById(d+"-onoff-bcb"))return b.checked?(b=SocialCalc.Popup.GetValue(d+"-color"),{def:!1,val:"1px solid "+(b||"rgb(0,0,0)")}):{def:!1,val:""}};
SocialCalc.SettingsControls.BorderSideInitialize=function(a,c){var b=a[c].id;SocialCalc.Popup.Create("ColorChooser",b+"-color",{});SocialCalc.Popup.Initialize(b+"-color",{attribs:{title:"&nbsp;",width:"106px",moveable:!0,changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:a}})};
SocialCalc.SettingsControlOnchangeBorder=function(a){var c=SocialCalc.SettingsControls,b=c.CurrentPanel,d=a.id.match(/(^.*\-)(\w+)\-(\w+)\-(\w+)$/);if(d){var e=d[2],b=b[e].type;switch(d[4]){case "bcb":a.checked?c.Controls[b].SetValue(c.CurrentPanel,e,{def:!1,val:a.value||"1px solid rgb(0,0,0)"}):c.Controls[b].SetValue(c.CurrentPanel,e,{def:!1,val:""})}}};
SocialCalc.SettingsControls.Controls.BorderSide={SetValue:SocialCalc.SettingsControls.BorderSideSetValue,GetValue:SocialCalc.SettingsControls.BorderSideGetValue,OnClick:SocialCalc.SettingsControls.ColorComboOnClick,Initialize:SocialCalc.SettingsControls.BorderSideInitialize,InitialData:{thickness:"1 pixel:1px",style:"Solid:solid"},ChangedCallback:null};SocialCalc.SettingControlReset=function(){var a=SocialCalc.SettingsControls,c;for(c in a.Controls)a.Controls[c].OnReset&&a.Controls[c].OnReset(c)};
SocialCalc.OtherSaveParts={};
SocialCalc.CtrlSEditor=function(a){var c,b;if(0<a.length)c=SocialCalc.special_chars(SocialCalc.OtherSaveParts[a]||"");else for(b in c="Listing of Parts\n",SocialCalc.OtherSaveParts)c+=SocialCalc.special_chars("\nPart: "+b+"\n=====\n"+SocialCalc.OtherSaveParts[b]+"\n");b=document.createElement("div");b.style.cssText="position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;";b.id="socialcalc-editbox";b.innerHTML=a+'<br><br><textarea id="socialcalc-editbox-textarea" style="width:250px;height:200px;">'+
c+"</textarea><br><br><input type=button onclick=\"SocialCalc.CtrlSEditorDone ('socialcalc-editbox', '"+a+'\');" value="OK">';document.body.appendChild(b);a=document.getElementById("socialcalc-editbox-textarea");a.focus();SocialCalc.CmdGotFocus(a)};SocialCalc.CtrlSEditorDone=function(a,c){var b=document.getElementById(a+"-textarea").value;0<c.length&&(0<b.length?SocialCalc.OtherSaveParts[c]=b:delete SocialCalc.OtherSaveParts[c]);b=document.getElementById(a);SocialCalc.KeyboardFocus();b.parentNode.removeChild(b)};SocialCalc||(alert("Main SocialCalc code module needed"),SocialCalc={});SocialCalc.TableEditor||alert("SocialCalc TableEditor code module needed");SocialCalc.CurrentSpreadsheetViewerObject=null;
SocialCalc.SpreadsheetViewer=function(a){var c=SocialCalc.Constants;this.spreadsheetDiv=this.parentNode=null;this.viewheight=this.width=this.height=this.requestedSpaceBelow=this.requestedWidth=this.requestedHeight=0;this.editorDiv=this.spreadsheetDiv=this.editor=this.context=this.sheet=null;this.sortrange="";this.idPrefix=a||"SocialCalc-";this.imagePrefix=c.defaultImagePrefix;this.statuslineheight=c.SVStatuslineheight;this.statuslineCSS=c.SVStatuslineCSS;this.sheet=new SocialCalc.Sheet;this.context=
new SocialCalc.RenderContext(this.sheet);this.context.showGrid=!0;this.context.showRCHeaders=!0;this.editor=new SocialCalc.TableEditor(this.context);this.editor.noEdit=!0;this.editor.StatusCallback.statusline={func:SocialCalc.SpreadsheetViewerStatuslineCallback,params:{}};this.hasStatusLine=!0;this.statuslineHTML='<table cellspacing="0" cellpadding="0"><tr><td width="100%" style="overflow:hidden;">{status}</td><td>&nbsp;</td></tr></table>';this.noRecalc=this.statuslineFull=!0;this.repeatingMacroTimer=
null;this.repeatingMacroInterval=60;this.repeatingMacroCommands="";SocialCalc.CurrentSpreadsheetViewerObject=this};SocialCalc.SpreadsheetViewer.prototype.InitializeSpreadsheetViewer=function(a,c,b,d){return SocialCalc.InitializeSpreadsheetViewer(this,a,c,b,d)};SocialCalc.SpreadsheetViewer.prototype.LoadSave=function(a){return SocialCalc.SpreadsheetViewerLoadSave(this,a)};SocialCalc.SpreadsheetViewer.prototype.DoOnResize=function(){return SocialCalc.DoOnResize(this)};
SocialCalc.SpreadsheetViewer.prototype.SizeSSDiv=function(){return SocialCalc.SizeSSDiv(this)};SocialCalc.SpreadsheetViewer.prototype.DecodeSpreadsheetSave=function(a){return SocialCalc.SpreadsheetViewerDecodeSpreadsheetSave(this,a)};SocialCalc.SpreadsheetViewer.prototype.ParseSheetSave=function(a){return this.sheet.ParseSheetSave(a)};
SocialCalc.InitializeSpreadsheetViewer=function(a,c,b,d,e){a.requestedHeight=b;a.requestedWidth=d;a.requestedSpaceBelow=e;"string"==typeof c&&(c=document.getElementById(c));null==c&&alert("SocialCalc.SpreadsheetControl not given parent node.");a.parentNode=c;a.spreadsheetDiv=document.createElement("div");a.SizeSSDiv();for(b=c.firstChild;null!=b;b=c.firstChild)c.removeChild(b);c.appendChild(a.spreadsheetDiv);a.nonviewheight=a.hasStatusLine?a.statuslineheight:0;a.viewheight=a.height-a.nonviewheight;
a.editorDiv=a.editor.CreateTableEditor(a.width,a.viewheight);a.spreadsheetDiv.appendChild(a.editorDiv);a.hasStatusLine&&(a.statuslineDiv=document.createElement("div"),a.statuslineDiv.style.cssText=a.statuslineCSS,a.statuslineDiv.style.height=a.statuslineheight-(a.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(a.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+"px",a.statuslineDiv.id=a.idPrefix+"statusline",a.spreadsheetDiv.appendChild(a.statuslineDiv),a.editor.StatusCallback.statusline={func:SocialCalc.SpreadsheetViewerStatuslineCallback,
params:{spreadsheetobj:a}})};
SocialCalc.SpreadsheetViewerLoadSave=function(a,c){var b,d,e;if(b=a.DecodeSpreadsheetSave(c))b.sheet&&(a.sheet.ResetSheet(),a.sheet.ParseSheetSave(c.substring(b.sheet.start,b.sheet.end))),b.edit&&a.editor.LoadEditorSettings(c.substring(b.edit.start,b.edit.end)),b.startupmacro&&a.editor.EditorScheduleSheetCommands(c.substring(b.startupmacro.start,b.startupmacro.end),!1,!0),b.repeatingmacro&&(b=c.substring(b.repeatingmacro.start,b.repeatingmacro.end),b=b.replace("\r",""),d=b.indexOf("\n"),0<d&&(e=b.substring(0,
d)-0,a.repeatingMacroInterval=e,a.repeatingMacroCommands=b.substring(d+1),0<e&&(a.repeatingMacroTimer=window.setTimeout(SocialCalc.SpreadsheetViewerDoRepeatingMacro,1E3*a.repeatingMacroInterval))));"off"==a.editor.context.sheetobj.attribs.recalc||a.noRecalc?a.editor.ScheduleRender():a.editor.EditorScheduleSheetCommands("recalc")};
SocialCalc.SpreadsheetViewerDoRepeatingMacro=function(){var a=SocialCalc.GetSpreadsheetViewerObject(),c=a.editor;a.repeatingMacroTimer=null;SocialCalc.SheetCommandInfo.CmdExtensionCallbacks.repeatmacro={func:SocialCalc.SpreadsheetViewerRepeatMacroCommand,data:null};c.EditorScheduleSheetCommands(a.repeatingMacroCommands)};
SocialCalc.SpreadsheetViewerRepeatMacroCommand=function(a,c,b,d,e){a=SocialCalc.GetSpreadsheetViewerObject();d=d.RestOfString()-0;0<d||(d=a.repeatingMacroInterval);a.repeatingMacroInterval=d;a.repeatingMacroTimer=window.setTimeout(SocialCalc.SpreadsheetViewerDoRepeatingMacro,1E3*a.repeatingMacroInterval)};SocialCalc.SpreadsheetViewerStopRepeatingMacro=function(){var a=SocialCalc.GetSpreadsheetViewerObject();a.repeatingMacroTimer&&(window.clearTimeout(a.repeatingMacroTimer),a.repeatingMacroTimer=null)};
SocialCalc.SpreadsheetViewerDoButtonCmd=function(a,c,b){a=b.element;b=b.functionobj.command;c=SocialCalc.GetSpreadsheetViewerObject().editor;switch(b){case "recalc":c.EditorScheduleSheetCommands("recalc")}a&&a.blur&&a.blur();SocialCalc.KeyboardFocus()};SocialCalc.LocalizeString=function(a){var c=SocialCalc.LocalizeStringList[a];c||(c=SocialCalc.Constants["s_loc_"+a.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||a,SocialCalc.LocalizeStringList[a]=c);return c};SocialCalc.LocalizeStringList={};
SocialCalc.LocalizeSubstrings=function(a){var c=SocialCalc.LocalizeString;return a.replace(/%(loc|ssc)!(.*?)!/g,function(a,d,e){return"ssc"==d?SocialCalc.Constants[e]||alert("Missing constant: "+e):c(e)})};SocialCalc.GetSpreadsheetViewerObject=function(){var a=SocialCalc.CurrentSpreadsheetViewerObject;if(a)return a;throw"No current SpreadsheetViewer object.";};
SocialCalc.DoOnResize=function(a){var c,b=a.views;if(a.SizeSSDiv()){for(vname in b)c=b[vname].element,c.style.width=a.width+"px",c.style.height=a.height-a.nonviewheight+"px";a.editor.ResizeTableEditor(a.width,a.height-a.nonviewheight)}};
SocialCalc.SizeSSDiv=function(a){var c,b,d,e;d=!1;c=SocialCalc.GetViewportInfo();b=SocialCalc.GetElementPosition(a.parentNode);b.bottom=0;b.right=0;e=a.parentNode.style;e.marginTop&&(b.top+=e.marginTop.slice(0,-2)-0);e.marginBottom&&(b.bottom+=e.marginBottom.slice(0,-2)-0);e.marginLeft&&(b.left+=e.marginLeft.slice(0,-2)-0);e.marginRight&&(b.right+=e.marginRight.slice(0,-2)-0);e=a.requestedHeight||c.height-(b.top+b.bottom+10)-(a.requestedSpaceBelow||0);a.height!=e&&(a.height=e,a.spreadsheetDiv.style.height=
e+"px",d=!0);e=a.requestedWidth||c.width-(b.left+b.right+10)||700;a.width!=e&&(a.width=e,a.spreadsheetDiv.style.width=e+"px",d=!0);a.spreadsheetDiv.style.position="relative";return d};SocialCalc.SpreadsheetViewerStatuslineCallback=function(a,c,b,d){var e=d.spreadsheetobj,f="";e&&e.statuslineDiv&&(f=e.statuslineFull?a.GetStatuslineString(c,b,d):a.ecell.coord,f=e.statuslineHTML.replace(/\{status\}/,f),e.statuslineDiv.innerHTML=f)};SocialCalc.CmdGotFocus=function(a){SocialCalc.Keyboard.passThru=a};
SocialCalc.SpreadsheetViewerCreateSheetHTML=function(a){var c,b;c="";c=new SocialCalc.RenderContext(a.sheet);a=document.createElement("div");b=c.RenderSheet(null,{type:"html"});a.appendChild(b);delete c;c=a.innerHTML;delete b;delete a;return c};
SocialCalc.SpreadsheetViewerDecodeSpreadsheetSave=function(a,c){var b,d,e,f,g,l,h,n={},p=[];/[^\n]\r[^\n]/.test(c)&&(c=c.replace(/([^\n])\r([^\n])/g,"$1\r\n$2"));b=c.search(/^MIME-Version:\s1\.0/mi);if(0>b)return n;d=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/mig;d.lastIndex=b;e=d.exec(c);if(0>=d.lastIndex)return n;b=e[1];f=RegExp("^--"+b+"(?:\r\n|\n)","mg");f.lastIndex=d.lastIndex;f.exec(c);d=/(?:\r\n|\n)(?:\r\n|\n)/gm;d.lastIndex=f.lastIndex;e=d.exec(c);if(!e)return n;g=d.lastIndex;f.lastIndex=
g;e=f.exec(c);if(!e)return n;e=e.index;g=c.substring(g,e).split(/\r\n|\n/);for(l=0;l<g.length;l++)switch(line=g[l],h=line.split(":"),h[0]){case "part":p.push(h[1])}for(pnum=0;pnum<p.length;pnum++){d.lastIndex=e;e=d.exec(c);if(!e)break;g=d.lastIndex;pnum==p.length-1&&(f=RegExp("^--"+b+"--$","mg"));f.lastIndex=g;e=f.exec(c);if(!e)break;e=e.index;n[p[pnum]]={start:g,end:e}}return n};(function(){Class=function(a,c){if(!a)throw"Class requires a class definition string as its first argument";if(!c)throw"Class requires a class wrapper function as its second argument";if(!a.match(/^([\w\.]+)(?:\(\s*([\w\.]+)\s*\))?(?:\s+(.*?)\s*)?$/))throw"Can't parse Class Definition: '"+a+"'";var b=RegExp.$1,d=RegExp.$2||"",e=[];RegExp.$3&&(e=RegExp.$3.split(/\s+/));for(var f=[],g=!0,l=0,h=e.length;l<h;l++){var n=e[l];"-nostrict"==n&&(g=!1);n.match(/^-inc=(.+)$/)&&(f=RegExp.$1.split(","))}for(var e=
b.split("."),p=Class.global,l=0;l<e.length;l++)p[e[l]]||(p[e[l]]=function(){try{this.init()}catch(a){}}),p=p[e[l]];p.className=b;p.isa=function(a){if(p.baseClassName=a)p.prototype=eval("new "+a+"()"),p.prototype.superFunc=function(c){return eval(a).prototype[c]}};p.isa(d);p.global=Class.global;p.addGlobal=function(){this.newGlobals++;return Class.global};p.extend=function(a){if("object"!=typeof a)throw"extend requires an object of name:value pairs";for(var c in a)p.prototype[c]=a[c]};b=0;for(d=f.length;b<
d;b++)l=f[b],f[b]="proto"==l?p.prototype:"this"==l?p:Class.global[l];g?Class.eval_strict(c,p,f):c.apply(p,f);return p}})();Class.global=this;Class.eval_strict=function(a,c,b){var d=0,e;for(e in Class.global)d++;c.newGlobals=0;a.apply(c,b);a=0;for(e in Class.global)a++;if(d+c.newGlobals!=a)throw"Class '"+c.className+"' defines "+(a-d)+" new global JavaScript variables without using this.addGlobal()";delete c.newGlobals};Class("Document.Emitter",function(){var a=this.prototype;a.className="Document.Emitter";a.instantiate=function(){return eval("new "+this.className+"()")};a.init=function(){this.output=""};a.content=function(){return this.output};a.insert=function(a){this.output+=a.output}});Class("Document.Emitter.HTML(Document.Emitter)",function(){var a=this.prototype;a.className="Document.Emitter.HTML";a.begin_node=function(a){var b=a.type;switch(b){case "asis":case "line":break;case "br":case "hr":this.output+="<"+b+" />";break;case "html":this.output+='<span class="wafl">Raw HTML section. Edit in Wiki Text mode.</span>';break;case "waflparagraph":case "waflphrase":case "im":if(a._wafl.match(/^image:\s*(\S+)(?:\s+size=(\w+))?/)){a="if (typeof(ss) != 'undefined' && ss.editor) { var recalc = function () { try { ss.editor.DoPositionCalculations() } catch (e) { setTimeout(recalc, 500) } }; recalc() } if (!window.image_dimension_cache) window.image_dimension_cache = {};window.image_dimension_cache['/data/wafl/"+
a._label.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"\\'").replace(/\\/g,"\\\\")+"'] = [ this.offsetWidth, this.offsetHeight ]; this.style.width = this.offsetWidth + 'px'; this.style.height = this.offsetHeight + 'px'";var b=RegExp.$1,d=RegExp.$2;switch(d){case "small":d="100";break;case "medium":d="300";break;case "large":d="600"}d&&(d=' width="'+d+'"');this.output+='<img src="'+b.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,
"&gt;")+'" onload="'+a+'"'+d+" />";break}this.output+='<span class="wafl">'+a._label.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"\\'").replace(/\\/g,"\\\\")+"</span>";break;case "a":case "wikilink":this.output+='<a href="'+encodeURI(a._href)+'">';break;case "file":this.output+='<a title="(network resource)" href="'+encodeURI(a._href)+'">';break;case "ul":case "ol":case "table":case "tr":this.output+="<"+b+">\n";break;default:this.output+="<"+
b+">"}};a.end_node=function(a){a=a.type;switch(a){case "asis":case "br":case "hr":case "html":case "waflparagraph":case "waflphrase":case "im":break;case "line":this.output+="<br />";break;case "file":case "wikilink":this.output+="</a>";break;default:0==a.search(/^(?:p|ul|ol|li|h\d|table|tr|td)$/)?this.output+="</"+a+">\n":this.output+="</"+a+">"}};a.text_node=function(a){this.output+=a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}});Class("Document.Parser",function(){var a=this.prototype;a.className="Document.Parser";a.init=function(){};a.parse=function(a,b){this.input=-1==a.search(/\n$/)?a+"\n":a;b&&(this.receiver=b);this.receiver.init();this.grammar=this.create_grammar();this.parse_blocks("top");return this.receiver.content()};a.create_grammar=function(){throw"Please define create_grammar in a derived class of Document.Parser.";};a.parse_blocks=function(a){if(a=this.grammar[a].blocks)for(;this.input.length;){for(var b=this.input.length,
d=0;d<a.length;d++){var e=a[d],f=this.find_match("matched_block",e);if(f){this.input=this.input.substr(f.end);this.handle_match(e,f);break}}if(this.input.length>=b)throw this.classname+": Reduction error for:\n"+this.input+"\n"+JSON.stringify(this);}};a.handle_match=function(a,b){var d=this.grammar[a];this.subparse(d.blocks?"parse_blocks":"parse_phrases",b,a,d.filter)};a.find_match=function(a,b){var d=this.grammar[b].match;if(!d)throw"no regexp for type: "+b;if(d=this.input.match(d))return d=this[a].call(this,
d,this.grammar[b].lookbehind),d.type=this.grammar[b].type||b,d};a.parse_phrases=function(a){if(a=this.grammar[a].phrases)for(;this.input.length;){for(var b=null,d=0;d<a.length;d++){var e=this.find_match("matched_phrase",a[d]);if(e&&(!b||e.begin<b.begin)&&(b=e,0==b.begin))break}if(!b){this.receiver.text_node(this.input||"");break}0!=b.begin&&this.receiver.text_node(this.input.substr(0,b.begin)||"");this.input=this.input.substr(b.end);this.handle_match(b.type,b)}else this.receiver.text_node(this.input||
"")};a.subparse=function(a,b,d,e){b.type=this.grammar[d].type;null==b.type&&(b.type=d);e=e?e(b):null;b.type&&this.receiver.begin_node(b);var f=eval("new "+this.className+"()");f.input=null==e?b.text:e;f.grammar=this.grammar;f.receiver=this.receiver.instantiate();f[a].call(f,d);this.receiver.insert(f.receiver);b.type&&this.receiver.end_node(b)};a.matched_block=function(a){return{begin:a.index,text:a[1],end:a[0].length,1:a[2],2:a[3],3:a[4]}};a.matched_phrase=function(a,b){if(b){var d=a[2],e=this.input.indexOf(a[1]);
return{text:d,begin:e,end:e+a[1].length,1:RegExp.$2,2:RegExp.$3,3:RegExp.$4}}return{begin:a.index,text:a[1],end:a.index+a[0].length,1:a[2],2:a[3],3:a[4]}}});Class("Document.Parser.Wikitext(Document.Parser)",function(){var a=this.prototype;a.className="Document.Parser.Wikitext";a.init=function(){};a.create_grammar=function(){var a="pre html hr hx waflparagraph ul ol blockquote p empty else".split(" "),b="waflphrase asis wikilink wikilink2 a im mail file tt b i del a".split(" "),d=function(a,c){c="\\"+(c||a);a="\\"+a;return{match:RegExp("(?:^|[^"+a+"\\w])("+a+"(?=\\S)(?!"+c+")(.*?)"+c+"(?=[^"+c+"\\w]|$))"),phrases:"\\`"==a?null:b,lookbehind:!0}},e={yahoo:"yahoo",
ymsgr:"yahoo",callto:"callto",callme:"callto",skype:"callto",aim:"aim"},f={aim:"AIM: %1",yahoo:"Yahoo: %1",callto:"Skype: %1"},g="(\\b(",l;for(l in e)g+=l+"|";g=g.replace(/\|$/,")\\:([^\\s\\>\\)]+))");l=function(a,c){var b=RegExp("(^|\n)"+c+" *","g");return{match:RegExp("^("+a+"+ .*\n(?:[*-+#]+ .*\n)*)(?:s*\n)?"),blocks:["ul","ol","subl","li"],filter:function(a){return a.text.replace(b,"$1")}}};return{_all_blocks:a,_all_phrases:b,top:{blocks:a},ol:l("#","[*#]"),ul:l("[-+*]","[-+*#]"),blockquote:{match:/^((?:>[^\n]*\n)+)(?:\s*\n)?/,
blocks:["blockquote","line"],filter:function(a){return a.text.replace(/(^|\n)>\ ?/g,"$1")}},line:{match:/([^\n]*)\n/,phrases:b},subl:{type:"li",match:/^(([^\n]*)\n[*#]+\ [^\n]*\n(?:[*#]+\ [^\n]*\n)*)(?:\s*\n)?/,blocks:["ul","ol","li2"]},li:{match:/([^\n]*)\n/,phrases:b},li2:{type:"",match:/([^\n]*)\n/,phrases:b},html:{match:/^(\.html\ *\n(?:[^\n]*\n)*?\.html)\ *\n(?:\s*\n)?/,filter:function(a){a._html=a.text;return""}},pre:{match:/^\.pre\ *\n((?:[^\n]*\n)*?)\.pre\ *\n(?:\s*\n)?/},hr:{match:/^--+(?:\s*\n)?/},
hx:{match:/^((\^+) *([^\n]*?)(\s+=+)?\s*?\n+)/,phrases:b,filter:function(a){a.type="h"+a["1"].length;return a[2]}},p:{match:/^((?:(?!(?:(?:\^+|\#+|\*+|\-+) |\>|\.\w+\s*\n|\{[^\}]+\}\s*\n))[^\n]*\S[^\n]*\n)+(?:(?=^|\n)\s*\n)*)/,phrases:b,filter:function(a){return a.text.replace(/\n$/,"")}},empty:{match:/^(\s*\n)/,filter:function(a){a.type=""}},"else":{match:/^(([^\n]*)\n)/,phrases:[],filter:function(a){a.type="p"}},waflparagraph:{match:/^\{(.*)\}[\ \t]*\n(?:\s*\n)?/,filter:function(a){a._wafl=a._label=
a.text;return""}},waflphrase:{match:/(?:^|[\s\-])((?:"([^\n]+?)")?\{([\w-]+(?=[\:\ \}])(?:\s*:)?\s*[^\n]*?\s*)\}(?=[\W_]|$))/,filter:function(a){a._wafl=a[2];a._label=a[1]||a._wafl;return""},lookbehind:!0},asis:{match:/(\{\{([^\n]*?)\}\}(\}*))/,filter:function(a){a.type="";return a[1]+a[2]}},wikilink:{match:/(?:^|[_\W])(\[()(?=[^\s\[\]])(.*?)\](?=[_\W]|$))/,filter:function(a){a._href="?"+a[2];return a.text||a[2]},lookbehind:!0},wikilink2:{type:"wikilink",match:/(?:"([^"]*)"\s*)(\[(?=[^\s\[\]])(.*?)\](?=[_\W]|$))/,
filter:function(a){a._href="?"+a[2];return a[1]||a[2]}},a:{match:/((?:"([^"]*)"\s*)?<?((?:http|https|ftp|irc|file):(?:\/\/)?[\;\/\?\:\@\&\=\+\$\,\[\]\#A-Za-z0-9\-\_\.\!\~\*\'\(\)]+[A-Za-z0-9\/#])>?)/,filter:function(a){a._href=a[2];return a[1]||a[2]}},file:{match:/((?:"([^"]*)")?<(\\\\[^\s\>\)]+)>)/,filter:function(a){var c=a[2].replace(/^\\\\/,"");a._href="file://"+c.replace(/\\/g,"/");return a["1"]||c}},im:{match:RegExp(g),filter:function(a){a._wafl=a[1]+": "+a[2];a._label=(f[e[a[1]]]||"%1").replace(/%1/g,
a[2]);return""}},mail:{match:/([\w+%\-\.]+@(?:[\w\-]+\.)+[\w\-]+)/,filter:function(a){a.type="a";a._href="mailto:"+a.text.replace(/%/g,"%25")}},tt:d("`"),b:d("*"),i:d("_"),del:d("-")}}});(function(a,c){function b(a){var c=Ea[a]={};return m.each(a.split(Y),function(a,b){c[b]=!0}),c}function d(a,b,d){if(d===c&&1===a.nodeType)if(d="data-"+b.replace(mb,"-$1").toLowerCase(),d=a.getAttribute(d),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:nb.test(d)?m.parseJSON(d):d}catch(e){}m.data(a,b,d)}else d=c;return d}function e(a){for(var c in a)if(("data"!==c||!m.isEmptyObject(a[c]))&&"toJSON"!==c)return!1;return!0}function f(){return!1}function g(){return!0}
function l(a){return!a||!a.parentNode||11===a.parentNode.nodeType}function h(a,c){do a=a[c];while(a&&1!==a.nodeType);return a}function n(a,c,b){c=c||0;if(m.isFunction(c))return m.grep(a,function(a,d){return!!c.call(a,d,a)===b});if(c.nodeType)return m.grep(a,function(a,d){return a===c===b});if("string"==typeof c){var d=m.grep(a,function(a){return 1===a.nodeType});if(ob.test(c))return m.filter(c,d,!b);c=m.filter(c,d)}return m.grep(a,function(a,d){return 0<=m.inArray(a,c)===b})}function p(a){var c=Fa.split("|");
a=a.createDocumentFragment();if(a.createElement)for(;c.length;)a.createElement(c.pop());return a}function r(a,c){if(1===c.nodeType&&m.hasData(a)){var b,d,e;d=m._data(a);var f=m._data(c,d),g=d.events;if(g)for(b in delete f.handle,f.events={},g)for(d=0,e=g[b].length;d<e;d++)m.event.add(c,b,g[b][d]);f.data&&(f.data=m.extend({},f.data))}}function t(a,c){var b;1===c.nodeType&&(c.clearAttributes&&c.clearAttributes(),c.mergeAttributes&&c.mergeAttributes(a),b=c.nodeName.toLowerCase(),"object"===b?(c.parentNode&&
(c.outerHTML=a.outerHTML),m.support.html5Clone&&a.innerHTML&&!m.trim(c.innerHTML)&&(c.innerHTML=a.innerHTML)):"input"===b&&Ga.test(a.type)?(c.defaultChecked=c.checked=a.checked,c.value!==a.value&&(c.value=a.value)):"option"===b?c.selected=a.defaultSelected:"input"===b||"textarea"===b?c.defaultValue=a.defaultValue:"script"===b&&c.text!==a.text&&(c.text=a.text),c.removeAttribute(m.expando))}function q(a){return"undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName("*"):"undefined"!=typeof a.querySelectorAll?
a.querySelectorAll("*"):[]}function s(a){Ga.test(a.type)&&(a.defaultChecked=a.checked)}function u(a,c){if(c in a)return c;for(var b=c.charAt(0).toUpperCase()+c.slice(1),d=c,e=Ha.length;e--;)if(c=Ha[e]+b,c in a)return c;return d}function v(a,c){return a=c||a,"none"===m.css(a,"display")||!m.contains(a.ownerDocument,a)}function w(a,c){for(var b,d,e=[],f=0,g=a.length;f<g;f++)b=a[f],b.style&&(e[f]=m._data(b,"olddisplay"),c?(!e[f]&&"none"===b.style.display&&(b.style.display=""),""===b.style.display&&v(b)&&
(e[f]=m._data(b,"olddisplay",A(b.nodeName)))):(d=Q(b,"display"),!e[f]&&"none"!==d&&m._data(b,"olddisplay",d)));for(f=0;f<g;f++)b=a[f],!b.style||c&&"none"!==b.style.display&&""!==b.style.display||(b.style.display=c?e[f]||"":"none");return a}function x(a,c,b){return(a=pb.exec(c))?Math.max(0,a[1]-(b||0))+(a[2]||"px"):c}function y(a,c,b,d){c=b===(d?"border":"content")?4:"width"===c?1:0;for(var e=0;4>c;c+=2)"margin"===b&&(e+=m.css(a,b+Z[c],!0)),d?("content"===b&&(e-=parseFloat(Q(a,"padding"+Z[c]))||0),
"margin"!==b&&(e-=parseFloat(Q(a,"border"+Z[c]+"Width"))||0)):(e+=parseFloat(Q(a,"padding"+Z[c]))||0,"padding"!==b&&(e+=parseFloat(Q(a,"border"+Z[c]+"Width"))||0));return e}function z(a,c,b){var d="width"===c?a.offsetWidth:a.offsetHeight,e=!0,f=m.support.boxSizing&&"border-box"===m.css(a,"boxSizing");if(0>=d){d=Q(a,c);if(0>d||null==d)d=a.style[c];if(ja.test(d))return d;e=f&&(m.support.boxSizingReliable||d===a.style[c]);d=parseFloat(d)||0}return d+y(a,c,b||(f?"border":"content"),e)+"px"}function A(a){if(sa[a])return sa[a];
var c=m("<"+a+">").appendTo(E.body),b=c.css("display");c.remove();if("none"===b||""===b)ha=E.body.appendChild(ha||m.extend(E.createElement("iframe"),{frameBorder:0,width:0,height:0})),V&&ha.createElement||(V=(ha.contentWindow||ha.contentDocument).document,V.write("<!doctype html><html><body>"),V.close()),c=V.body.appendChild(V.createElement(a)),b=Q(c,"display"),E.body.removeChild(ha);return sa[a]=b,b}function C(a,c,b,d){var e;if(m.isArray(c))m.each(c,function(c,e){b||qb.test(a)?d(a,e):C(a+"["+("object"==
typeof e?c:"")+"]",e,b,d)});else if(b||"object"!==m.type(c))d(a,c);else for(e in c)C(a+"["+e+"]",c[e],b,d)}function F(a){return function(c,b){"string"!=typeof c&&(b=c,c="*");var d,e,f=c.toLowerCase().split(Y),g=0,h=f.length;if(m.isFunction(b))for(;g<h;g++)d=f[g],(e=/^\+/.test(d))&&(d=d.substr(1)||"*"),d=a[d]=a[d]||[],d[e?"unshift":"push"](b)}}function I(a,b,d,e,f,g){f=f||b.dataTypes[0];g=g||{};g[f]=!0;var h;f=a[f];for(var l=0,m=f?f.length:0,n=a===ta;l<m&&(n||!h);l++)h=f[l](b,d,e),"string"==typeof h&&
(!n||g[h]?h=c:(b.dataTypes.unshift(h),h=I(a,b,d,e,h,g)));return(n||!h)&&!g["*"]&&(h=I(a,b,d,e,"*",g)),h}function O(a,b){var d,e,f=m.ajaxSettings.flatOptions||{};for(d in b)b[d]!==c&&((f[d]?a:e||(e={}))[d]=b[d]);e&&m.extend(!0,a,e)}function G(){try{return new a.XMLHttpRequest}catch(c){}}function N(){return setTimeout(function(){la=c},0),la=m.now()}function D(a,c){m.each(c,function(c,b){for(var d=($[c]||[]).concat($["*"]),e=0,f=d.length;e<f&&!d[e].call(a,c,b);e++);})}function B(a,c,b){var d=0,e=ma.length,
f=m.Deferred().always(function(){delete g.elem}),g=function(){for(var c=la||N(),c=Math.max(0,h.startTime+h.duration-c),b=1-(c/h.duration||0),d=0,e=h.tweens.length;d<e;d++)h.tweens[d].run(b);return f.notifyWith(a,[h,b,c]),1>b&&e?c:(f.resolveWith(a,[h]),!1)},h=f.promise({elem:a,props:m.extend({},c),opts:m.extend(!0,{specialEasing:{}},b),originalProperties:c,originalOptions:b,startTime:la||N(),duration:b.duration,tweens:[],createTween:function(c,b,d){c=m.Tween(a,h.opts,c,b,h.opts.specialEasing[c]||h.opts.easing);
return h.tweens.push(c),c},stop:function(c){for(var b=0,d=c?h.tweens.length:0;b<d;b++)h.tweens[b].run(1);return c?f.resolveWith(a,[h,c]):f.rejectWith(a,[h,c]),this}});b=h.props;for(X(b,h.opts.specialEasing);d<e;d++)if(c=ma[d].call(h,a,b,h.opts))return c;return D(h,b),m.isFunction(h.opts.start)&&h.opts.start.call(a,h),m.fx.timer(m.extend(g,{anim:h,queue:h.opts.queue,elem:a})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function X(a,c){var b,
d,e,f,g;for(b in a)if(d=m.camelCase(b),e=c[d],f=a[b],m.isArray(f)&&(e=f[1],f=a[b]=f[0]),b!==d&&(a[d]=f,delete a[b]),(g=m.cssHooks[d])&&"expand"in g)for(b in f=g.expand(f),delete a[d],f)b in a||(a[b]=f[b],c[b]=e);else c[d]=e}function H(a,c,b,d,e){return new H.prototype.init(a,c,b,d,e)}function ga(a,c){for(var b,d={height:a},e=0;4>e;e+=2-c)b=Z[e],d["margin"+b]=d["padding"+b]=a;return c&&(d.opacity=d.width=a),d}function Ca(a){return m.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var Da,
ba,E=a.document,kb=a.location,lb=a.navigator,rb=a.jQuery,sb=a.$,Ia=Array.prototype.push,S=Array.prototype.slice,Ja=Array.prototype.indexOf,ub=Object.prototype.toString,ua=Object.prototype.hasOwnProperty,Ka=String.prototype.trim,m=function(a,c){return new m.fn.init(a,c,Da)},na=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,La=/\S/,Y=/\s+/,vb=La.test("\u00a0")?/^[\s\xA0]+|[\s\xA0]+$/g:/^\s+|\s+$/g,wb=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Ma=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,xb=/^[\],:{}\s]*$/,yb=/(?:^|:|,)(?:\s*\[)+/g,
zb=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Ab=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,Bb=/^-ms-/,Cb=/-([\da-z])/gi,Db=function(a,c){return(c+"").toUpperCase()},oa=function(){E.addEventListener?(E.removeEventListener("DOMContentLoaded",oa,!1),m.ready()):"complete"===E.readyState&&(E.detachEvent("onreadystatechange",oa),m.ready())},Na={};m.fn=m.prototype={constructor:m,init:function(a,b,d){var e,f;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,
this;if("string"==typeof a){"<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?e=[null,a,null]:e=wb.exec(a);if(e&&(e[1]||!b)){if(e[1])return b=b instanceof m?b[0]:b,f=b&&b.nodeType?b.ownerDocument||b:E,a=m.parseHTML(e[1],f,!0),Ma.test(e[1])&&m.isPlainObject(b)&&this.attr.call(a,b,!0),m.merge(this,a);if((b=E.getElementById(e[2]))&&b.parentNode){if(b.id!==e[2])return d.find(a);this.length=1;this[0]=b}return this.context=E,this.selector=a,this}return!b||b.jquery?(b||d).find(a):this.constructor(b).find(a)}return m.isFunction(a)?
d.ready(a):(a.selector!==c&&(this.selector=a.selector,this.context=a.context),m.makeArray(a,this))},selector:"",jquery:"1.8.0",length:0,size:function(){return this.length},toArray:function(){return S.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a,c,b){a=m.merge(this.constructor(),a);return a.prevObject=this,a.context=this.context,"find"===c?a.selector=this.selector+(this.selector?" ":"")+b:c&&(a.selector=this.selector+"."+c+"("+b+")"),
a},each:function(a,c){return m.each(this,a,c)},ready:function(a){return m.ready.promise().done(a),this},eq:function(a){return a=+a,-1===a?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(S.apply(this,arguments),"slice",S.call(arguments).join(","))},map:function(a){return this.pushStack(m.map(this,function(c,b){return a.call(c,b,c)}))},end:function(){return this.prevObject||this.constructor(null)},push:Ia,
sort:[].sort,splice:[].splice};m.fn.init.prototype=m.fn;m.extend=m.fn.extend=function(){var a,b,d,e,f,g,h=arguments[0]||{},l=1,n=arguments.length,p=!1;"boolean"==typeof h&&(p=h,h=arguments[1]||{},l=2);"object"!=typeof h&&!m.isFunction(h)&&(h={});for(n===l&&(h=this,--l);l<n;l++)if(null!=(a=arguments[l]))for(b in a)d=h[b],e=a[b],h!==e&&(p&&e&&(m.isPlainObject(e)||(f=m.isArray(e)))?(f?(f=!1,g=d&&m.isArray(d)?d:[]):g=d&&m.isPlainObject(d)?d:{},h[b]=m.extend(p,g,e)):e!==c&&(h[b]=e));return h};m.extend({noConflict:function(c){return a.$===
m&&(a.$=sb),c&&a.jQuery===m&&(a.jQuery=rb),m},isReady:!1,readyWait:1,holdReady:function(a){a?m.readyWait++:m.ready(!0)},ready:function(a){if(!0===a?!--m.readyWait:!m.isReady){if(!E.body)return setTimeout(m.ready,1);m.isReady=!0;!0!==a&&0<--m.readyWait||(ba.resolveWith(E,[m]),m.fn.trigger&&m(E).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===m.type(a)},isArray:Array.isArray||function(a){return"array"===m.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&
isFinite(a)},type:function(a){return null==a?String(a):Na[ub.call(a)]||"object"},isPlainObject:function(a){if(!a||"object"!==m.type(a)||a.nodeType||m.isWindow(a))return!1;try{if(a.constructor&&!ua.call(a,"constructor")&&!ua.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}for(var d in a);return d===c||ua.call(a,d)},isEmptyObject:function(a){for(var c in a)return!1;return!0},error:function(a){throw Error(a);},parseHTML:function(a,c,b){var d;return a&&"string"==typeof a?("boolean"==
typeof c&&(b=c,c=0),c=c||E,(d=Ma.exec(a))?[c.createElement(d[1])]:(d=m.buildFragment([a],c,b?null:[]),m.merge([],(d.cacheable?m.clone(d.fragment):d.fragment).childNodes))):null},parseJSON:function(c){if(!c||"string"!=typeof c)return null;c=m.trim(c);if(a.JSON&&a.JSON.parse)return a.JSON.parse(c);if(xb.test(c.replace(zb,"@").replace(Ab,"]").replace(yb,"")))return(new Function("return "+c))();m.error("Invalid JSON: "+c)},parseXML:function(b){var d,e;if(!b||"string"!=typeof b)return null;try{a.DOMParser?
(e=new DOMParser,d=e.parseFromString(b,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(b))}catch(f){d=c}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&m.error("Invalid XML: "+b),d},noop:function(){},globalEval:function(c){c&&La.test(c)&&(a.execScript||function(c){a.eval.call(a,c)})(c)},camelCase:function(a){return a.replace(Bb,"ms-").replace(Cb,Db)},nodeName:function(a,c){return a.nodeName&&a.nodeName.toUpperCase()===c.toUpperCase()},
each:function(a,b,d){var e,f=0,g=a.length,h=g===c||m.isFunction(a);if(d)if(h)for(e in a){if(!1===b.apply(a[e],d))break}else for(;f<g&&!1!==b.apply(a[f++],d););else if(h)for(e in a){if(!1===b.call(a[e],e,a[e]))break}else for(;f<g&&!1!==b.call(a[f],f,a[f++]););return a},trim:Ka?function(a){return null==a?"":Ka.call(a)}:function(a){return null==a?"":a.toString().replace(vb,"")},makeArray:function(a,c){var b,d=c||[];return null!=a&&(b=m.type(a),null==a.length||"string"===b||"function"===b||"regexp"===
b||m.isWindow(a)?Ia.call(d,a):m.merge(d,a)),d},inArray:function(a,c,b){var d;if(c){if(Ja)return Ja.call(c,a,b);d=c.length;for(b=b?0>b?Math.max(0,d+b):b:0;b<d;b++)if(b in c&&c[b]===a)return b}return-1},merge:function(a,b){var d=b.length,e=a.length,f=0;if("number"==typeof d)for(;f<d;f++)a[e++]=b[f];else for(;b[f]!==c;)a[e++]=b[f++];return a.length=e,a},grep:function(a,c,b){var d,e=[],f=0,g=a.length;for(b=!!b;f<g;f++)d=!!c(a[f],f),b!==d&&e.push(a[f]);return e},map:function(a,b,d){var e,f,g=[],h=0,l=
a.length;if(a instanceof m||l!==c&&"number"==typeof l&&(0<l&&a[0]&&a[l-1]||0===l||m.isArray(a)))for(;h<l;h++)e=b(a[h],h,d),null!=e&&(g[g.length]=e);else for(f in a)e=b(a[f],f,d),null!=e&&(g[g.length]=e);return g.concat.apply([],g)},guid:1,proxy:function(a,b){var d,e,f;return"string"==typeof b&&(d=a[b],b=a,a=d),m.isFunction(a)?(e=S.call(arguments,2),f=function(){return a.apply(b,e.concat(S.call(arguments)))},f.guid=a.guid=a.guid||f.guid||m.guid++,f):c},access:function(a,b,d,e,f,g,h){var l,n=null==
d,p=0,q=a.length;if(d&&"object"==typeof d){for(p in d)m.access(a,b,p,d[p],1,g,e);f=1}else if(e!==c){l=h===c&&m.isFunction(e);n&&(l?(l=b,b=function(a,c,b){return l.call(m(a),b)}):(b.call(a,e),b=null));if(b)for(;p<q;p++)b(a[p],d,l?e.call(a[p],p,b(a[p],d)):e,h);f=1}return f?a:n?b.call(a):q?b(a[0],d):g},now:function(){return(new Date).getTime()}});m.ready.promise=function(c){if(!ba)if(ba=m.Deferred(),"complete"===E.readyState||"loading"!==E.readyState&&E.addEventListener)setTimeout(m.ready,1);else if(E.addEventListener)E.addEventListener("DOMContentLoaded",
oa,!1),a.addEventListener("load",m.ready,!1);else{E.attachEvent("onreadystatechange",oa);a.attachEvent("onload",m.ready);var b=!1;try{b=null==a.frameElement&&E.documentElement}catch(d){}b&&b.doScroll&&function ra(){if(!m.isReady){try{b.doScroll("left")}catch(a){return setTimeout(ra,50)}m.ready()}}()}return ba.promise(c)};m.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,c){Na["[object "+c+"]"]=c.toLowerCase()});Da=m(E);var Ea={};m.Callbacks=function(a){a="string"==
typeof a?Ea[a]||b(a):m.extend({},a);var d,e,f,g,h,l,n=[],p=!a.once&&[],q=function(c){d=a.memory&&c;e=!0;l=g||0;g=0;h=n.length;for(f=!0;n&&l<h;l++)if(!1===n[l].apply(c[0],c[1])&&a.stopOnFalse){d=!1;break}f=!1;n&&(p?p.length&&q(p.shift()):d?n=[]:r.disable())},r={add:function(){if(n){var c=n.length;(function Eb(c){m.each(c,function(c,b){!m.isFunction(b)||a.unique&&r.has(b)?b&&b.length&&Eb(b):n.push(b)})})(arguments);f?h=n.length:d&&(g=c,q(d))}return this},remove:function(){return n&&m.each(arguments,
function(a,c){for(var b;-1<(b=m.inArray(c,n,b));)n.splice(b,1),f&&(b<=h&&h--,b<=l&&l--)}),this},has:function(a){return-1<m.inArray(a,n)},empty:function(){return n=[],this},disable:function(){return n=p=d=c,this},disabled:function(){return!n},lock:function(){return p=c,d||r.disable(),this},locked:function(){return!p},fireWith:function(a,c){return c=c||[],c=[a,c.slice?c.slice():c],n&&(!e||p)&&(f?p.push(c):q(c)),this},fire:function(){return r.fireWith(this,arguments),this},fired:function(){return!!e}};
return r};m.extend({Deferred:function(a){var c=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],b="pending",d={state:function(){return b},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return m.Deferred(function(b){m.each(c,function(c,d){var f=d[0],g=a[c];e[d[1]](m.isFunction(g)?function(){var a=g.apply(this,arguments);a&&m.isFunction(a.promise)?
a.promise().done(b.resolve).fail(b.reject).progress(b.notify):b[f+"With"](this===e?b:this,[a])}:b[f])});a=null}).promise()},promise:function(a){return"object"==typeof a?m.extend(a,d):d}},e={};return d.pipe=d.then,m.each(c,function(a,f){var g=f[2],K=f[3];d[f[1]]=g.add;K&&g.add(function(){b=K},c[a^1][2].disable,c[2][2].lock);e[f[0]]=g.fire;e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var c=0,b=S.call(arguments),d=b.length,e=1!==d||a&&m.isFunction(a.promise)?d:0,f=1===
e?a:m.Deferred(),g=function(a,c,b){return function(d){c[a]=this;b[a]=1<arguments.length?S.call(arguments):d;b===h?f.notifyWith(c,b):--e||f.resolveWith(c,b)}},h,l,n;if(1<d)for(h=Array(d),l=Array(d),n=Array(d);c<d;c++)b[c]&&m.isFunction(b[c].promise)?b[c].promise().done(g(c,n,b)).fail(f.reject).progress(g(c,l,h)):--e;return e||f.resolveWith(n,b),f.promise()}});m.support=function(){var c,b,d,e,f,g,h,l,n=E.createElement("div");n.setAttribute("className","t");n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
b=n.getElementsByTagName("*");d=n.getElementsByTagName("a")[0];d.style.cssText="top:1px;float:left;opacity:.5";if(!b||!b.length||!d)return{};e=E.createElement("select");f=e.appendChild(E.createElement("option"));b=n.getElementsByTagName("input")[0];c={leadingWhitespace:3===n.firstChild.nodeType,tbody:!n.getElementsByTagName("tbody").length,htmlSerialize:!!n.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:"/a"===d.getAttribute("href"),opacity:/^0.5/.test(d.style.opacity),
cssFloat:!!d.style.cssFloat,checkOn:"on"===b.value,optSelected:f.selected,getSetAttribute:"t"!==n.className,enctype:!!E.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==E.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===E.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1};b.checked=!0;c.noCloneChecked=b.cloneNode(!0).checked;
e.disabled=!0;c.optDisabled=!f.disabled;try{delete n.test}catch(p){c.deleteExpando=!1}!n.addEventListener&&n.attachEvent&&n.fireEvent&&(n.attachEvent("onclick",l=function(){c.noCloneEvent=!1}),n.cloneNode(!0).fireEvent("onclick"),n.detachEvent("onclick",l));b=E.createElement("input");b.value="t";b.setAttribute("type","radio");c.radioValue="t"===b.value;b.setAttribute("checked","checked");b.setAttribute("name","t");n.appendChild(b);d=E.createDocumentFragment();d.appendChild(n.lastChild);c.checkClone=
d.cloneNode(!0).cloneNode(!0).lastChild.checked;c.appendChecked=b.checked;d.removeChild(b);d.appendChild(n);if(n.attachEvent)for(g in{submit:!0,change:!0,focusin:!0})b="on"+g,(h=b in n)||(n.setAttribute(b,"return;"),h="function"==typeof n[b]),c[g+"Bubbles"]=h;return m(function(){var b,d,e,f,g=E.getElementsByTagName("body")[0];g&&(b=E.createElement("div"),b.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",g.insertBefore(b,g.firstChild),d=E.createElement("div"),
b.appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",e=d.getElementsByTagName("td"),e[0].style.cssText="padding:0;margin:0;border:0;display:none",h=0===e[0].offsetHeight,e[0].style.display="",e[1].style.display="none",c.reliableHiddenOffsets=h&&0===e[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",c.boxSizing=4===
d.offsetWidth,c.doesNotIncludeMarginInBodyOffset=1!==g.offsetTop,a.getComputedStyle&&(c.pixelPosition="1%"!==(a.getComputedStyle(d,null)||{}).top,c.boxSizingReliable="4px"===(a.getComputedStyle(d,null)||{width:"4px"}).width,f=E.createElement("div"),f.style.cssText=d.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;",f.style.marginRight=f.style.width="0",d.style.width="1px",d.appendChild(f),c.reliableMarginRight=!parseFloat((a.getComputedStyle(f,null)||{}).marginRight)),"undefined"!=
typeof d.style.zoom&&(d.innerHTML="",d.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;width:1px;padding:1px;display:inline;zoom:1",c.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.style.overflow="visible",d.innerHTML="<div></div>",d.firstChild.style.width="5px",c.shrinkWrapBlocks=3!==d.offsetWidth,b.style.zoom=1),g.removeChild(b))}),d.removeChild(n),b=d=e=f=b=d=n=null,c}();var nb=/^(?:\{.*\}|\[.*\])$/,mb=/([A-Z])/g;m.extend({cache:{},deletedIds:[],uuid:0,
expando:"jQuery"+(m.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?m.cache[a[m.expando]]:a[m.expando],!!a&&!e(a)},data:function(a,b,d,e){if(m.acceptData(a)){var f,g,h=m.expando,l="string"==typeof b,n=a.nodeType,p=n?m.cache:a,q=n?a[h]:a[h]&&h;if(q&&p[q]&&(e||p[q].data)||!l||d!==c){q||(n?a[h]=q=m.deletedIds.pop()||++m.uuid:q=h);p[q]||(p[q]={},n||(p[q].toJSON=m.noop));if("object"==typeof b||
"function"==typeof b)e?p[q]=m.extend(p[q],b):p[q].data=m.extend(p[q].data,b);return f=p[q],e||(f.data||(f.data={}),f=f.data),d!==c&&(f[m.camelCase(b)]=d),l?(g=f[b],null==g&&(g=f[m.camelCase(b)])):g=f,g}}},removeData:function(a,b,c){if(m.acceptData(a)){var d,f,g,h=a.nodeType,l=h?m.cache:a,n=h?a[m.expando]:m.expando;if(l[n]){if(b&&(d=c?l[n]:l[n].data)){m.isArray(b)||(b in d?b=[b]:(b=m.camelCase(b),b in d?b=[b]:b=b.split(" ")));f=0;for(g=b.length;f<g;f++)delete d[b[f]];if(!(c?e:m.isEmptyObject)(d))return}if(!c&&
(delete l[n].data,!e(l[n])))return;h?m.cleanData([a],!0):m.support.deleteExpando||l!=l.window?delete l[n]:l[n]=null}}},_data:function(a,b,c){return m.data(a,b,c,!0)},acceptData:function(a){var b=a.nodeName&&m.noData[a.nodeName.toLowerCase()];return!b||!0!==b&&a.getAttribute("classid")===b}});m.fn.extend({data:function(a,b){var e,f,g,h,l,n=this[0],p=0,q=null;if(a===c){if(this.length&&(q=m.data(n),1===n.nodeType&&!m._data(n,"parsedAttrs"))){g=n.attributes;for(l=g.length;p<l;p++)h=g[p].name,0===h.indexOf("data-")&&
(h=m.camelCase(h.substring(5)),d(n,h,q[h]));m._data(n,"parsedAttrs",!0)}return q}return"object"==typeof a?this.each(function(){m.data(this,a)}):(e=a.split(".",2),e[1]=e[1]?"."+e[1]:"",f=e[1]+"!",m.access(this,function(b){if(b===c)return q=this.triggerHandler("getData"+f,[e[0]]),q===c&&n&&(q=m.data(n,a),q=d(n,a,q)),q===c&&e[1]?this.data(e[0]):q;e[1]=b;this.each(function(){var c=m(this);c.triggerHandler("setData"+f,e);m.data(this,a,b);c.triggerHandler("changeData"+f,e)})},null,b,1<arguments.length,
null,!1))},removeData:function(a){return this.each(function(){m.removeData(this,a)})}});m.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=m._data(a,b),c&&(!d||m.isArray(c)?d=m._data(a,b,m.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=m.queue(a,b),d=c.shift(),e=m._queueHooks(a,b),f=function(){m.dequeue(a,b)};"inprogress"===d&&(d=c.shift());d&&("fx"===b&&c.unshift("inprogress"),delete e.stop,d.call(a,f,e));!c.length&&e&&e.empty.fire()},_queueHooks:function(a,
b){var c=b+"queueHooks";return m._data(a,c)||m._data(a,c,{empty:m.Callbacks("once memory").add(function(){m.removeData(a,b+"queue",!0);m.removeData(a,c,!0)})})}});m.fn.extend({queue:function(a,b){var d=2;return"string"!=typeof a&&(b=a,a="fx",d--),arguments.length<d?m.queue(this[0],a):b===c?this:this.each(function(){var c=m.queue(this,a,b);m._queueHooks(this,a);"fx"===a&&"inprogress"!==c[0]&&m.dequeue(this,a)})},dequeue:function(a){return this.each(function(){m.dequeue(this,a)})},delay:function(a,
b){return a=m.fx?m.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var d,e=1,f=m.Deferred(),g=this,h=this.length,l=function(){--e||f.resolveWith(g,[g])};"string"!=typeof a&&(b=a,a=c);for(a=a||"fx";h--;)(d=m._data(g[h],a+"queueHooks"))&&d.empty&&(e++,d.empty.add(l));return l(),f.promise(b)}});var T,Oa,Pa,Qa=/[\t\r\n]/g,Fb=/\r/g,Gb=/^(?:button|input)$/i,Hb=/^(?:button|input|object|select|textarea)$/i,
Ib=/^a(?:rea|)$/i,Ra=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Sa=m.support.getSetAttribute;m.fn.extend({attr:function(a,b){return m.access(this,m.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){m.removeAttr(this,a)})},prop:function(a,b){return m.access(this,m.prop,a,b,1<arguments.length)},removeProp:function(a){return a=m.propFix[a]||a,this.each(function(){try{this[a]=c,delete this[a]}catch(b){}})},
addClass:function(a){var b,c,d,e,f,g,h;if(m.isFunction(a))return this.each(function(b){m(this).addClass(a.call(this,b,this.className))});if(a&&"string"==typeof a)for(b=a.split(Y),c=0,d=this.length;c<d;c++)if(e=this[c],1===e.nodeType)if(e.className||1!==b.length){f=" "+e.className+" ";g=0;for(h=b.length;g<h;g++)~f.indexOf(" "+b[g]+" ")||(f+=b[g]+" ");e.className=m.trim(f)}else e.className=a;return this},removeClass:function(a){var b,d,e,f,g,h,l;if(m.isFunction(a))return this.each(function(b){m(this).removeClass(a.call(this,
b,this.className))});if(a&&"string"==typeof a||a===c)for(b=(a||"").split(Y),h=0,l=this.length;h<l;h++)if(e=this[h],1===e.nodeType&&e.className){d=(" "+e.className+" ").replace(Qa," ");f=0;for(g=b.length;f<g;f++)for(;-1<d.indexOf(" "+b[f]+" ");)d=d.replace(" "+b[f]+" "," ");e.className=a?m.trim(d):""}return this},toggleClass:function(a,b){var c=typeof a,d="boolean"==typeof b;return m.isFunction(a)?this.each(function(c){m(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===
c)for(var e,f=0,g=m(this),h=b,l=a.split(Y);e=l[f++];)h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e);else if("undefined"===c||"boolean"===c)this.className&&m._data(this,"__className__",this.className),this.className=this.className||!1===a?"":m._data(this,"__className__")||""})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;b<c;b++)if(1===this[b].nodeType&&-1<(" "+this[b].className+" ").replace(Qa," ").indexOf(a))return!0;return!1},val:function(a){var b,d,e,f=this[0];if(arguments.length)return e=
m.isFunction(a),this.each(function(d){var f,g=m(this);1===this.nodeType&&(e?f=a.call(this,d,g.val()):f=a,null==f?f="":"number"==typeof f?f+="":m.isArray(f)&&(f=m.map(f,function(a){return null==a?"":a+""})),b=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&b.set(this,f,"value")!==c||(this.value=f))});if(f)return b=m.valHooks[f.type]||m.valHooks[f.nodeName.toLowerCase()],b&&"get"in b&&(d=b.get(f,"value"))!==c?d:(d=f.value,"string"==typeof d?d.replace(Fb,""):null==d?"":d)}});
m.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d=a.selectedIndex,e=[],f=a.options,g="select-one"===a.type;if(0>d)return null;a=g?d:0;for(c=g?d+1:f.length;a<c;a++)if(b=f[a],b.selected&&!((m.support.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&m.nodeName(b.parentNode,"optgroup"))){b=m(b).val();if(g)return b;e.push(b)}return g&&!e.length&&f.length?m(f[d]).val():e},set:function(a,
b){var c=m.makeArray(b);return m(a).find("option").each(function(){this.selected=0<=m.inArray(m(this).val(),c)}),c.length||(a.selectedIndex=-1),c}}},attrFn:{},attr:function(a,b,d,e){var f,g,h=a.nodeType;if(a&&3!==h&&8!==h&&2!==h){if(e&&m.isFunction(m.fn[b]))return m(a)[b](d);if("undefined"==typeof a.getAttribute)return m.prop(a,b,d);(e=1!==h||!m.isXMLDoc(a))&&(b=b.toLowerCase(),g=m.attrHooks[b]||(Ra.test(b)?Oa:T));if(d!==c){if(null===d){m.removeAttr(a,b);return}return g&&"set"in g&&e&&(f=g.set(a,
d,b))!==c?f:(a.setAttribute(b,""+d),d)}return g&&"get"in g&&e&&null!==(f=g.get(a,b))?f:(f=a.getAttribute(b),null===f?c:f)}},removeAttr:function(a,b){var c,d,e,f,g=0;if(b&&1===a.nodeType)for(d=b.split(Y);g<d.length;g++)(e=d[g])&&(c=m.propFix[e]||e,f=Ra.test(e),f||m.attr(a,e,""),a.removeAttribute(Sa?e:c),f&&c in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(Gb.test(a.nodeName)&&a.parentNode)m.error("type property can't be changed");else if(!m.support.radioValue&&"radio"===b&&m.nodeName(a,"input")){var c=
a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}},value:{get:function(a,b){return T&&m.nodeName(a,"button")?T.get(a,b):b in a?a.value:null},set:function(a,b,c){if(T&&m.nodeName(a,"button"))return T.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},
prop:function(a,b,d){var e,f,g,h=a.nodeType;if(a&&3!==h&&8!==h&&2!==h)return g=1!==h||!m.isXMLDoc(a),g&&(b=m.propFix[b]||b,f=m.propHooks[b]),d!==c?f&&"set"in f&&(e=f.set(a,d,b))!==c?e:a[b]=d:f&&"get"in f&&null!==(e=f.get(a,b))?e:a[b]},propHooks:{tabIndex:{get:function(a){var b=a.getAttributeNode("tabindex");return b&&b.specified?parseInt(b.value,10):Hb.test(a.nodeName)||Ib.test(a.nodeName)&&a.href?0:c}}}});Oa={get:function(a,b){var d,e=m.prop(a,b);return!0===e||"boolean"!=typeof e&&(d=a.getAttributeNode(b))&&
!1!==d.nodeValue?b.toLowerCase():c},set:function(a,b,c){var d;return!1===b?m.removeAttr(a,c):(d=m.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}};Sa||(Pa={name:!0,id:!0,coords:!0},T=m.valHooks.button={get:function(a,b){var d;return d=a.getAttributeNode(b),d&&(Pa[b]?""!==d.value:d.specified)?d.value:c},set:function(a,b,c){var d=a.getAttributeNode(c);return d||(d=E.createAttribute(c),a.setAttributeNode(d)),d.value=b+""}},m.each(["width","height"],function(a,b){m.attrHooks[b]=
m.extend(m.attrHooks[b],{set:function(a,c){if(""===c)return a.setAttribute(b,"auto"),c}})}),m.attrHooks.contenteditable={get:T.get,set:function(a,b,c){""===b&&(b="false");T.set(a,b,c)}});m.support.hrefNormalized||m.each(["href","src","width","height"],function(a,b){m.attrHooks[b]=m.extend(m.attrHooks[b],{get:function(a){a=a.getAttribute(b,2);return null===a?c:a}})});m.support.style||(m.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||c},set:function(a,b){return a.style.cssText=
""+b}});m.support.optSelected||(m.propHooks.selected=m.extend(m.propHooks.selected,{get:function(a){a=a.parentNode;return a&&(a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex),null}}));m.support.enctype||(m.propFix.enctype="encoding");m.support.checkOn||m.each(["radio","checkbox"],function(){m.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}});m.each(["radio","checkbox"],function(){m.valHooks[this]=m.extend(m.valHooks[this],{set:function(a,b){if(m.isArray(b))return a.checked=
0<=m.inArray(m(a).val(),b)}})});var va=/^(?:textarea|input|select)$/i,Ta=/^([^\.]*|)(?:\.(.+)|)$/,Jb=/(?:^|\s)hover(\.\S+|)\b/,Kb=/^key/,Lb=/^(?:mouse|contextmenu)|click/,Ua=/^(?:focusinfocus|focusoutblur)$/,Va=function(a){return m.event.special.hover?a:a.replace(Jb,"mouseenter$1 mouseleave$1")};m.event={add:function(a,b,d,e,f){var g,h,l,n,p,q,r,s,t;if(3!==a.nodeType&&8!==a.nodeType&&b&&d&&(g=m._data(a))){d.handler&&(r=d,d=r.handler,f=r.selector);d.guid||(d.guid=m.guid++);(l=g.events)||(g.events=
l={});(h=g.handle)||(g.handle=h=function(a){return"undefined"==typeof m||a&&m.event.triggered===a.type?c:m.event.dispatch.apply(h.elem,arguments)},h.elem=a);b=m.trim(Va(b)).split(" ");for(g=0;g<b.length;g++)n=Ta.exec(b[g])||[],p=n[1],q=(n[2]||"").split(".").sort(),t=m.event.special[p]||{},p=(f?t.delegateType:t.bindType)||p,t=m.event.special[p]||{},n=m.extend({type:p,origType:n[1],data:e,handler:d,guid:d.guid,selector:f,namespace:q.join(".")},r),s=l[p],s||(s=l[p]=[],s.delegateCount=0,t.setup&&!1!==
t.setup.call(a,e,q,h)||(a.addEventListener?a.addEventListener(p,h,!1):a.attachEvent&&a.attachEvent("on"+p,h))),t.add&&(t.add.call(a,n),n.handler.guid||(n.handler.guid=d.guid)),f?s.splice(s.delegateCount++,0,n):s.push(n),m.event.global[p]=!0;a=null}},global:{},remove:function(a,b,c,d,e){var f,g,h,l,n,p,q,r,s,t,u=m.hasData(a)&&m._data(a);if(u&&(q=u.events)){b=m.trim(Va(b||"")).split(" ");for(f=0;f<b.length;f++)if(g=Ta.exec(b[f])||[],h=l=g[1],g=g[2],h){r=m.event.special[h]||{};h=(d?r.delegateType:r.bindType)||
h;s=q[h]||[];n=s.length;g=g?RegExp("(^|\\.)"+g.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(p=0;p<s.length;p++)t=s[p],!e&&l!==t.origType||c&&c.guid!==t.guid||g&&!g.test(t.namespace)||d&&!(d===t.selector||"**"===d&&t.selector)||(s.splice(p--,1),t.selector&&s.delegateCount--,!r.remove||r.remove.call(a,t));0===s.length&&n!==s.length&&((!r.teardown||!1===r.teardown.call(a,g,u.handle))&&m.removeEvent(a,h,u.handle),delete q[h])}else for(h in q)m.event.remove(a,h+b[f],c,d,!0);m.isEmptyObject(q)&&
(delete u.handle,m.removeData(a,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(b,d,e,f){if(!e||3!==e.nodeType&&8!==e.nodeType){var g,h,l,n,p,q,r,s=b.type||b;n=[];if(!Ua.test(s+m.event.triggered)&&(0<=s.indexOf("!")&&(s=s.slice(0,-1),g=!0),0<=s.indexOf(".")&&(n=s.split("."),s=n.shift(),n.sort()),e&&!m.event.customEvent[s]||m.event.global[s]))if(b="object"==typeof b?b[m.expando]?b:new m.Event(s,b):new m.Event(s),b.type=s,b.isTrigger=!0,b.exclusive=g,b.namespace=n.join("."),
b.namespace_re=b.namespace?RegExp("(^|\\.)"+n.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n=0>s.indexOf(":")?"on"+s:"",e){if(b.result=c,b.target||(b.target=e),d=null!=d?m.makeArray(d):[],d.unshift(b),p=m.event.special[s]||{},!p.trigger||!1!==p.trigger.apply(e,d)){r=[[e,p.bindType||s]];if(!f&&!p.noBubble&&!m.isWindow(e)){h=p.delegateType||s;g=Ua.test(h+s)?e:e.parentNode;for(l=e;g;g=g.parentNode)r.push([g,h]),l=g;l===(e.ownerDocument||E)&&r.push([l.defaultView||l.parentWindow||a,h])}for(h=0;h<r.length&&!b.isPropagationStopped();h++)g=
r[h][0],b.type=r[h][1],(q=(m._data(g,"events")||{})[b.type]&&m._data(g,"handle"))&&q.apply(g,d),(q=n&&g[n])&&m.acceptData(g)&&!1===q.apply(g,d)&&b.preventDefault();return b.type=s,!f&&!b.isDefaultPrevented()&&(!p._default||!1===p._default.apply(e.ownerDocument,d))&&("click"!==s||!m.nodeName(e,"a"))&&m.acceptData(e)&&n&&e[s]&&("focus"!==s&&"blur"!==s||0!==b.target.offsetWidth)&&!m.isWindow(e)&&(l=e[n],l&&(e[n]=null),m.event.triggered=s,e[s](),m.event.triggered=c,l&&(e[n]=l)),b.result}}else for(h in e=
m.cache,e)e[h].events&&e[h].events[s]&&m.event.trigger(b,d,e[h].handle.elem,!0)}},dispatch:function(b){b=m.event.fix(b||a.event);var d,e,f,g,h,l,n,p=(m._data(this,"events")||{})[b.type]||[],q=p.delegateCount,s=[].slice.call(arguments),r=!b.exclusive&&!b.namespace,t=m.event.special[b.type]||{},u=[];s[0]=b;b.delegateTarget=this;if(!t.preDispatch||!1!==t.preDispatch.call(this,b)){if(q&&(!b.button||"click"!==b.type))for(f=m(this),f.context=this,e=b.target;e!=this;e=e.parentNode||this)if(!0!==e.disabled||
"click"!==b.type){h={};l=[];f[0]=e;for(d=0;d<q;d++)g=p[d],n=g.selector,h[n]===c&&(h[n]=f.is(n)),h[n]&&l.push(g);l.length&&u.push({elem:e,matches:l})}p.length>q&&u.push({elem:this,matches:p.slice(q)});for(d=0;d<u.length&&!b.isPropagationStopped();d++)for(f=u[d],b.currentTarget=f.elem,e=0;e<f.matches.length&&!b.isImmediatePropagationStopped();e++)if(g=f.matches[e],r||!b.namespace&&!g.namespace||b.namespace_re&&b.namespace_re.test(g.namespace))b.data=g.data,b.handleObj=g,g=((m.event.special[g.origType]||
{}).handle||g.handler).apply(f.elem,s),g!==c&&(b.result=g,!1===g&&(b.preventDefault(),b.stopPropagation()));return t.postDispatch&&t.postDispatch.call(this,b),b.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),
a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var d,e,f,g=b.button,h=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||E,e=d.documentElement,f=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),!a.relatedTarget&&h&&(a.relatedTarget=
h===a.target?b.toElement:h),!a.which&&g!==c&&(a.which=g&1?1:g&2?3:g&4?2:0),a}},fix:function(a){if(a[m.expando])return a;var b,c,d=a,e=m.event.fixHooks[a.type]||{},f=e.props?this.props.concat(e.props):this.props;a=m.Event(d);for(b=f.length;b;)c=f[--b],a[c]=d[c];return a.target||(a.target=d.srcElement||E),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,e.filter?e.filter(a,d):a},special:{ready:{setup:m.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},
beforeunload:{setup:function(a,b,c){m.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){a=m.extend(new m.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?m.event.trigger(a,null,b):m.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};m.event.handle=m.event.dispatch;m.removeEvent=E.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,
c){b="on"+b;a.detachEvent&&("undefined"==typeof a[b]&&(a[b]=null),a.detachEvent(b,c))};m.Event=function(a,b){if(this instanceof m.Event)a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?g:f):this.type=a,b&&m.extend(this,b),this.timeStamp=a&&a.timeStamp||m.now(),this[m.expando]=!0;else return new m.Event(a,b)};m.Event.prototype={preventDefault:function(){this.isDefaultPrevented=g;var a=this.originalEvent;
a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=g;var a=this.originalEvent;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=g;this.stopPropagation()},isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f};m.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){m.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,
d=a.relatedTarget,e=a.handleObj;if(!d||d!==this&&!m.contains(this,d))a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b;return c}}});m.support.submitBubbles||(m.event.special.submit={setup:function(){if(m.nodeName(this,"form"))return!1;m.event.add(this,"click._submit keypress._submit",function(a){a=a.target;(a=m.nodeName(a,"input")||m.nodeName(a,"button")?a.form:c)&&!m._data(a,"_submit_attached")&&(m.event.add(a,"submit._submit",function(a){a._submit_bubble=!0}),m._data(a,"_submit_attached",
!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&m.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(m.nodeName(this,"form"))return!1;m.event.remove(this,"._submit")}});m.support.changeBubbles||(m.event.special.change={setup:function(){if(va.test(this.nodeName)){if("checkbox"===this.type||"radio"===this.type)m.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=
!0)}),m.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1);m.event.simulate("change",this,a,!0)});return!1}m.event.add(this,"beforeactivate._change",function(a){a=a.target;va.test(a.nodeName)&&!m._data(a,"_change_attached")&&(m.event.add(a,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&m.event.simulate("change",this.parentNode,a,!0)}),m._data(a,"_change_attached",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||
a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type)return a.handleObj.handler.apply(this,arguments)},teardown:function(){return m.event.remove(this,"._change"),va.test(this.nodeName)}});m.support.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){m.event.simulate(b,a.target,m.event.fix(a),!0)};m.event.special[b]={setup:function(){0===c++&&E.addEventListener(a,d,!0)},teardown:function(){0===--c&&E.removeEventListener(a,d,!0)}}});m.fn.extend({on:function(a,
b,d,e,g){var h,l;if("object"==typeof a){"string"!=typeof b&&(d=d||b,b=c);for(l in a)this.on(l,b,d,a[l],g);return this}null==d&&null==e?(e=b,d=b=c):null==e&&("string"==typeof b?(e=d,d=c):(e=d,d=b,b=c));if(!1===e)e=f;else if(!e)return this;return 1===g&&(h=e,e=function(a){return m().off(a),h.apply(this,arguments)},e.guid=h.guid||(h.guid=m.guid++)),this.each(function(){m.event.add(this,a,e,d,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,d){var e,g;if(a&&a.preventDefault&&a.handleObj)return e=
a.handleObj,m(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof a){for(g in a)this.off(g,b,a[g]);return this}if(!1===b||"function"==typeof b)d=b,b=c;return!1===d&&(d=f),this.each(function(){m.event.remove(this,a,d,b)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return m(this.context).on(a,this.selector,b,c),this},die:function(a,b){return m(this.context).off(a,
this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1==arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,b){return this.each(function(){m.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return m.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||m.guid++,d=0,e=function(c){var e=(m._data(this,"lastToggle"+a.guid)||0)%d;return m._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),
b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){m.fn[b]=function(a,c){return null==c&&(c=a,a=null),0<arguments.length?this.on(b,null,a,c):this.trigger(b)};Kb.test(b)&&
(m.event.fixHooks[b]=m.event.keyHooks);Lb.test(b)&&(m.event.fixHooks[b]=m.event.mouseHooks)});(function(a,b){function c(a,b,d,e){for(var f=0,g=b.length;f<g;f++)J(a,b[f],d,e)}function d(a,b,e,f,g,h){var l,m=L.setFilters[b.toLowerCase()];return m||J.error(b),(a||!(l=g))&&c(a||"*",f,l=[],g),0<l.length?m(l,e,h):[]}function e(a,f,g,h,l){for(var m,n,K,p,q,s,r,t=0,u=l.length,v=ca.POS,ra=RegExp("^"+v.source+"(?!"+A+")","i"),U=function(){for(var a=1,c=arguments.length-2;a<c;a++)arguments[a]===b&&(m[a]=b)};t<
u;t++){v.exec("");a=l[t];p=[];K=0;for(q=h;m=v.exec(a);)if(n=v.lastIndex=m.index+m[0].length,n>K){r=a.slice(K,m.index);K=n;s=[f];F.test(r)&&(q&&(s=q),q=h);if(n=Q.test(r))r=r.slice(0,-5).replace(F,"$&*");1<m.length&&m[0].replace(ra,U);q=d(r,m[1],m[2],s,q,n)}q?(p=p.concat(q),(r=a.slice(K))&&")"!==r?F.test(r)?c(r,p,g,h):J(r,f,g,h?h.concat(q):q):y.apply(g,p)):J(a,f,g,h)}return 1===u?g:J.uniqueSort(g)}function f(a,b,c){var d=b.dir,e=x++;return a||(a=function(a){return a===c}),b.first?function(b,c){for(;b=
b[d];)if(1===b.nodeType)return a(b,c)&&b}:function(b,c){for(var f,g=e+"."+n,h=g+"."+l;b=b[d];)if(1===b.nodeType){if((f=b[z])===h)return b.sizset;if("string"==typeof f&&0===f.indexOf(g)){if(b.sizset)return b}else{b[z]=h;if(a(b,c))return b.sizset=!0,b;b.sizset=!1}}}}function g(a,b){return a?function(c,d){var e=b(c,d);return e&&a(!0===e?c:e,d)}:b}function h(a){return function(b,c){for(var d,e=0;d=a[e];e++)if(d(b,c))return!0;return!1}}var l,n,p,q,s,r=a.document,t=r.documentElement,u=!1,v=!0,x=0,w=[].slice,
y=[].push,z=("sizcache"+Math.random()).replace(".",""),A="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("w","w#"),B="\\["+A+"*((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)"+A+"*(?:([*^$|!~]?=)"+A+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+B+")|)|)"+A+"*\\]",C=A+"*([\\x20\\t\\r\\n\\f>+~])"+A+"*",D="(?=[^\\x20\\t\\r\\n\\f])(?:\\\\.|"+B+"|"+":((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|((?:[^,]|\\\\,|(?:,(?=[^\\[]*\\]))|(?:,(?=[^\\(]*\\))))*))\\)|)".replace(2,7)+
"|[^\\\\(),])+",E=RegExp("^"+A+"+|((?:^|[^\\\\])(?:\\\\.)*)"+A+"+$","g"),F=RegExp("^"+C),H=RegExp(D+"?(?="+A+"*,|$)","g"),G=RegExp("^(?:(?!,)(?:(?:^|,)"+A+"*"+D+")*?|"+A+"*(.*?))(\\)|$)"),I=RegExp(D.slice(19,-6)+"\\x20\\t\\r\\n\\f>+~])+|"+C,"g"),N=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,O=/[\x20\t\r\n\f]*[+~]/,Q=/:not\($/,Mb=/h\d/i,Nb=/input|select|textarea|button/i,ia=/\\(?!\\)/g,ca={ID:/^#((?:\\.|[-\w]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[-\w]|[^\x00-\xa0])+)/,NAME:/^\[name=['"]?((?:\\.|[-\w]|[^\x00-\xa0])+)['"]?\]/,
TAG:RegExp("^("+"(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("[-","[-\\*")+")"),ATTR:RegExp("^"+B),PSEUDO:RegExp("^:((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|((?:[^,]|\\\\,|(?:,(?=[^\\[]*\\]))|(?:,(?=[^\\(]*\\))))*))\\)|)"),CHILD:RegExp("^:(only|nth|last|first)-child(?:\\("+A+"*(even|odd|(([+-]|)(\\d*)n|)"+A+"*(?:([+-]|)"+A+"*(\\d+)|))"+A+"*\\)|)","i"),POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\)|)(?=[^-]|$)/ig,needsContext:RegExp("^"+A+"*[>+~]|:(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\)|)(?=[^-]|$)",
"i")},R={},S=[],wa={},T=[],B=function(a){return a.sizzleFilter=!0,a},C=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}},D=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}},da=function(a){var b=!1,c=r.createElement("div");try{b=a(c)}catch(d){}return b},X=da(function(a){a.innerHTML="<select></select>";a=typeof a.lastChild.getAttribute("multiple");return"boolean"!==a&&"string"!==a}),Y=da(function(a){a.id=
z+0;a.innerHTML="<a name='"+z+"'></a><div name='"+z+"'></div>";t.insertBefore(a,t.firstChild);var b=r.getElementsByName&&r.getElementsByName(z).length===2+r.getElementsByName(z+0).length;return s=!r.getElementById(z),t.removeChild(a),b}),Z=da(function(a){return a.appendChild(r.createComment("")),0===a.getElementsByTagName("*").length}),aa=da(function(a){return a.innerHTML="<a href='#'></a>",a.firstChild&&"undefined"!==typeof a.firstChild.getAttribute&&"#"===a.firstChild.getAttribute("href")}),W=da(function(a){return a.innerHTML=
"<div class='hidden e'></div><div class='hidden'></div>",a.getElementsByClassName&&0!==a.getElementsByClassName("e").length?(a.lastChild.className="e",1!==a.getElementsByClassName("e").length):!1}),J=function(a,b,c,d){c=c||[];b=b||r;var e,f,g,h,l=b.nodeType;if(1!==l&&9!==l)return[];if(!a||"string"!=typeof a)return c;g=V(b);if(!g&&!d&&(e=N.exec(a)))if(h=e[1])if(9===l){f=b.getElementById(h);if(!f||!f.parentNode)return c;if(f.id===h)return c.push(f),c}else{if(b.ownerDocument&&(f=b.ownerDocument.getElementById(h))&&
fa(b,f)&&f.id===h)return c.push(f),c}else{if(e[2])return y.apply(c,w.call(b.getElementsByTagName(a),0)),c;if((h=e[3])&&W&&b.getElementsByClassName)return y.apply(c,w.call(b.getElementsByClassName(h),0)),c}return ba(a,b,c,d,g)},L=J.selectors={cacheLength:50,match:ca,order:["ID","TAG"],attrHandle:{},createPseudo:B,find:{ID:s?function(a,b,c){if("undefined"!==typeof b.getElementById&&!c)return(a=b.getElementById(a))&&a.parentNode?[a]:[]}:function(a,c,d){if("undefined"!==typeof c.getElementById&&!d)return(c=
c.getElementById(a))?c.id===a||"undefined"!==typeof c.getAttributeNode&&c.getAttributeNode("id").value===a?[c]:b:[]},TAG:Z?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a)}:function(a,b){var c=b.getElementsByTagName(a);if("*"===a){for(var d,e=[],f=0;d=c[f];f++)1===d.nodeType&&e.push(d);return e}return c}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=
a[1].replace(ia,""),a[3]=(a[4]||a[5]||"").replace(ia,""),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1]?(a[2]||J.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*("even"===a[2]||"odd"===a[2])),a[4]=+(a[6]+a[7]||"odd"===a[2])):a[2]&&J.error(a[0]),a},PSEUDO:function(a){var b,c=a[4];return ca.CHILD.test(a[0])?null:(c&&(b=G.exec(c))&&b.pop()&&(a[0]=a[0].slice(0,b[0].length-c.length-1),c=b[0].slice(0,-1)),a.splice(2,3,c||a[3]),a)}},filter:{ID:s?function(a){return a=
a.replace(ia,""),function(b){return b.getAttribute("id")===a}}:function(a){return a=a.replace(ia,""),function(b){return(b="undefined"!==typeof b.getAttributeNode&&b.getAttributeNode("id"))&&b.value===a}},TAG:function(a){return"*"===a?function(){return!0}:(a=a.replace(ia,"").toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=R[a];return b||(b=R[a]=RegExp("(^|"+A+")"+a+"("+A+"|$)"),S.push(a),S.length>L.cacheLength&&delete R[S.shift()]),function(a){return b.test(a.className||
"undefined"!==typeof a.getAttribute&&a.getAttribute("class")||"")}},ATTR:function(a,b,c){return b?function(d){d=J.attr(d,a);var e=d+"";if(null==d)return"!="===b;switch(b){case "=":return e===c;case "!=":return e!==c;case "^=":return c&&0===e.indexOf(c);case "*=":return c&&-1<e.indexOf(c);case "$=":return c&&e.substr(e.length-c.length)===c;case "~=":return-1<(" "+e+" ").indexOf(c);case "|=":return e===c||e.substr(0,c.length+1)===c+"-"}}:function(b){return null!=J.attr(b,a)}},CHILD:function(a,b,c,d){if("nth"===
a){var e=x++;return function(a){var b,f,g=0,h=a;if(1===c&&0===d)return!0;if((b=a.parentNode)&&(b[z]!==e||!a.sizset)){for(h=b.firstChild;h&&(1!==h.nodeType||(h.sizset=++g,h!==a));h=h.nextSibling);b[z]=e}return f=a.sizset-d,0===c?0===f:0===f%c&&0<=f/c}}return function(b){var c=b;switch(a){case "only":case "first":for(;c=c.previousSibling;)if(1===c.nodeType)return!1;if("first"===a)return!0;c=b;case "last":for(;c=c.nextSibling;)if(1===c.nodeType)return!1;return!0}}},PSEUDO:function(a,b,c,d){var e=L.pseudos[a]||
L.pseudos[a.toLowerCase()];return e||J.error("unsupported pseudo: "+a),e.sizzleFilter?e(b,c,d):e}},pseudos:{not:B(function(a,b,c){var d=ga(a.replace(E,"$1"),b,c);return function(a){return!d(a)}}),enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},parent:function(a){return!L.pseudos.empty(a)},
empty:function(a){var b;for(a=a.firstChild;a;){if("@"<a.nodeName||3===(b=a.nodeType)||4===b)return!1;a=a.nextSibling}return!0},contains:B(function(a){return function(b){return-1<(b.textContent||b.innerText||$(b)).indexOf(a)}}),has:B(function(a){return function(b){return 0<J(a,b).length}}),header:function(a){return Mb.test(a.nodeName)},text:function(a){var b,c;return"input"===a.nodeName.toLowerCase()&&"text"===(b=a.type)&&(null==(c=a.getAttribute("type"))||c.toLowerCase()===b)},radio:C("radio"),checkbox:C("checkbox"),
file:C("file"),password:C("password"),image:C("image"),submit:D("submit"),reset:D("reset"),button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return Nb.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||b.hasFocus())&&(!!a.type||!!a.href)},active:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b,c){return c?a.slice(1):[a[0]]},last:function(a,b,c){b=
a.pop();return c?a:[b]},even:function(a,b,c){b=[];c=c?1:0;for(var d=a.length;c<d;c+=2)b.push(a[c]);return b},odd:function(a,b,c){b=[];c=c?0:1;for(var d=a.length;c<d;c+=2)b.push(a[c]);return b},lt:function(a,b,c){return c?a.slice(+b):a.slice(0,+b)},gt:function(a,b,c){return c?a.slice(0,+b+1):a.slice(+b+1)},eq:function(a,b,c){b=a.splice(+b,1);return c?a:b}}};L.setFilters.nth=L.setFilters.eq;L.filters=L.pseudos;aa||(L.attrHandle={href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}});
Y&&(L.order.push("NAME"),L.find.NAME=function(a,b){if("undefined"!==typeof b.getElementsByName)return b.getElementsByName(a)});W&&(L.order.splice(1,0,"CLASS"),L.find.CLASS=function(a,b,c){if("undefined"!==typeof b.getElementsByClassName&&!c)return b.getElementsByClassName(a)});try{w.call(t.childNodes,0)[0].nodeType}catch(ha){w=function(a){for(var b,c=[];b=this[a];a++)c.push(b);return c}}var V=J.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1},fa=J.contains=
t.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:t.contains?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b.parentNode;return a===d||!!(d&&1===d.nodeType&&c.contains&&c.contains(d))}:function(a,b){for(;b=b.parentNode;)if(b===a)return!0;return!1},$=J.getText=function(a){var b,c="",d=0;if(b=a.nodeType)if(1===b||9===b||11===b){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=$(a)}else{if(3===b||4===b)return a.nodeValue}else for(;b=
a[d];d++)c+=$(b);return c};J.attr=function(a,b){var c,d=V(a);return d||(b=b.toLowerCase()),L.attrHandle[b]?L.attrHandle[b](a):X||d?a.getAttribute(b):(c=a.getAttributeNode(b),c?"boolean"==typeof a[b]?a[b]?b:null:c.specified?c.value:null:null)};J.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};[0,0].sort(function(){return v=0});t.compareDocumentPosition?p=function(a,b){return a===b?(u=!0,0):(a.compareDocumentPosition&&b.compareDocumentPosition?a.compareDocumentPosition(b)&
4:a.compareDocumentPosition)?-1:1}:(p=function(a,b){if(a===b)return u=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[];c=a.parentNode;d=b.parentNode;var g=c;if(c===d)return q(a,b);if(!c)return-1;if(!d)return 1;for(;g;)e.unshift(g),g=g.parentNode;for(g=d;g;)f.unshift(g),g=g.parentNode;c=e.length;d=f.length;for(g=0;g<c&&g<d;g++)if(e[g]!==f[g])return q(e[g],f[g]);return g===c?q(a,f[g],-1):q(e[g],b,1)},q=function(a,b,c){if(a===b)return c;for(a=a.nextSibling;a;){if(a===
b)return-1;a=a.nextSibling}return 1});J.uniqueSort=function(a){var b,c=1;if(p&&(u=v,a.sort(p),u))for(;b=a[c];c++)b===a[c-1]&&a.splice(c--,1);return a};var ga=J.compile=function(a,b,c){var d,e,l,m=wa[a];if(m&&m.context===b)return m;var n,K=[];d=0;for(var p=G.exec(a),q=!p.pop()&&!p.pop(),M=q&&a.match(H)||[""],s=L.preFilter,P=L.filter,t=!c&&b!==r;null!=(l=M[d])&&q;d++)for(K.push(e=[]),t&&(l=" "+l);l;){q=!1;if(p=F.exec(l))l=l.slice(p[0].length),q=e.push({part:p.pop().replace(E," "),captures:p});for(n in P)(p=
ca[n].exec(l))&&(!s[n]||(p=s[n](p,b,c)))&&(l=l.slice(p.shift().length),q=e.push({part:n,captures:p}));if(!q)break}e=(q||J.error(a),K);for(l=0;d=e[l];l++){n=e;K=l;p=b;q=c;s=M=void 0;for(P=0;M=d[P];P++)L.relative[M.part]?s=f(s,L.relative[M.part],p):(M.captures.push(p,q),s=g(s,L.filter[M.part].apply(null,M.captures)));n[K]=s}return m=wa[a]=h(e),m.context=b,m.runs=m.dirruns=0,T.push(a),T.length>L.cacheLength&&delete wa[T.shift()],m};J.matches=function(a,b){return J(a,null,null,b)};J.matchesSelector=function(a,
b){return 0<J(b,null,null,[a]).length};var ba=function(a,b,c,d,f){a=a.replace(E,"$1");var g,h,m,K,p,q,M=a.match(H);h=a.match(I);m=b.nodeType;if(ca.POS.test(a))return e(a,b,c,d,M);if(d)g=w.call(d,0);else if(M&&1===M.length){if(1<h.length&&9===m&&!f&&(M=ca.ID.exec(h[0]))){b=L.find.ID(M[1],b,f)[0];if(!b)return c;a=a.slice(h.shift().length)}d=(M=O.exec(h[0]))&&!M.index&&b.parentNode||b;q=h.pop();K=q.split(":not")[0];h=0;for(m=L.order.length;h<m;h++)if(p=L.order[h],M=ca[p].exec(K))if(g=L.find[p]((M[1]||
"").replace(ia,""),d,f),null!=g){K===q&&(a=a.slice(0,a.length-q.length)+K.replace(ca[p],""),a||y.apply(c,w.call(g,0)));break}}if(a)for(f=ga(a,b,f),n=f.dirruns++,null==g&&(g=L.find.TAG("*",O.test(a)&&b.parentNode||b)),h=0;a=g[h];h++)l=f.runs++,f(a,b)&&c.push(a);return c};r.querySelectorAll&&function(){var a,b=ba,c=/'|\\/g,d=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,e=[],f=[":active"],g=t.matchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||t.msMatchesSelector;da(function(a){a.innerHTML=
"<select><option selected></option></select>";a.querySelectorAll("[selected]").length||e.push("\\["+A+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)");a.querySelectorAll(":checked").length||e.push(":checked")});da(function(a){a.innerHTML="<p test=''></p>";a.querySelectorAll("[test^='']").length&&e.push("[*^$]="+A+"*(?:\"\"|'')");a.innerHTML="<input type='hidden'>";a.querySelectorAll(":enabled").length||e.push(":enabled",":disabled")});e=e.length&&RegExp(e.join("|"));ba=function(a,d,
f,g,h){if(!(g||h||e&&e.test(a)))if(9===d.nodeType)try{return y.apply(f,w.call(d.querySelectorAll(a),0)),f}catch(l){}else if(1===d.nodeType&&"object"!==d.nodeName.toLowerCase()){var m=d.getAttribute("id"),n=m||z,K=O.test(a)&&d.parentNode||d;m?n=n.replace(c,"\\$&"):d.setAttribute("id",n);try{return y.apply(f,w.call(K.querySelectorAll(a.replace(H,"[id='"+n+"'] $&")),0)),f}catch(p){}finally{m||d.removeAttribute("id")}}return b(a,d,f,g,h)};g&&(da(function(b){a=g.call(b,"div");try{g.call(b,"[test!='']:sizzle"),
f.push(L.match.PSEUDO)}catch(c){}}),f=RegExp(f.join("|")),J.matchesSelector=function(b,c){c=c.replace(d,"='$1']");if(!(V(b)||f.test(c)||e&&e.test(c)))try{var h=g.call(b,c);if(h||a||b.document&&11!==b.document.nodeType)return h}catch(l){}return 0<J(c,null,null,[b]).length})}();J.attr=m.attr;m.find=J;m.expr=J.selectors;m.expr[":"]=m.expr.pseudos;m.unique=J.uniqueSort;m.text=J.getText;m.isXMLDoc=J.isXML;m.contains=J.contains})(a);var Ob=/Until$/,Pb=/^(?:parents|prev(?:Until|All))/,ob=/^.[^:#\[\.,]*$/,
Wa=m.expr.match.needsContext,Qb={children:!0,contents:!0,next:!0,prev:!0};m.fn.extend({find:function(a){var b,c,d,e,f,g,h=this;if("string"!=typeof a)return m(a).filter(function(){b=0;for(c=h.length;b<c;b++)if(m.contains(h[b],this))return!0});g=this.pushStack("","find",a);b=0;for(c=this.length;b<c;b++)if(d=g.length,m.find(a,this[b],g),0<b)for(e=d;e<g.length;e++)for(f=0;f<d;f++)if(g[f]===g[e]){g.splice(e--,1);break}return g},has:function(a){var b,c=m(a,this),d=c.length;return this.filter(function(){for(b=
0;b<d;b++)if(m.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(n(this,a,!1),"not",a)},filter:function(a){return this.pushStack(n(this,a,!0),"filter",a)},is:function(a){return!!a&&("string"==typeof a?Wa.test(a)?0<=m(a,this.context).index(this[0]):0<m.filter(a,this).length:0<this.filter(a).length)},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=Wa.test(a)||"string"!=typeof a?m(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c.ownerDocument&&c!==b&&11!==c.nodeType;){if(g?
-1<g.index(c):m.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}return f=1<f.length?m.unique(f):f,this.pushStack(f,"closest",a)},index:function(a){return a?"string"==typeof a?m.inArray(this[0],m(a)):m.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c="string"==typeof a?m(a,b):m.makeArray(a&&a.nodeType?[a]:a),d=m.merge(this.get(),c);return this.pushStack(l(c[0])||l(d[0])?d:m.unique(d))},addBack:function(a){return this.add(null==a?
this.prevObject:this.prevObject.filter(a))}});m.fn.andSelf=m.fn.addBack;m.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return m.dir(a,"parentNode")},parentsUntil:function(a,b,c){return m.dir(a,"parentNode",c)},next:function(a){return h(a,"nextSibling")},prev:function(a){return h(a,"previousSibling")},nextAll:function(a){return m.dir(a,"nextSibling")},prevAll:function(a){return m.dir(a,"previousSibling")},nextUntil:function(a,b,c){return m.dir(a,"nextSibling",
c)},prevUntil:function(a,b,c){return m.dir(a,"previousSibling",c)},siblings:function(a){return m.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return m.sibling(a.firstChild)},contents:function(a){return m.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:m.merge([],a.childNodes)}},function(a,b){m.fn[a]=function(c,d){var e=m.map(this,b,c);return Ob.test(a)||(d=c),d&&"string"==typeof d&&(e=m.filter(d,e)),e=1<this.length&&!Qb[a]?m.unique(e):e,1<this.length&&Pb.test(a)&&
(e=e.reverse()),this.pushStack(e,a,S.call(arguments).join(","))}});m.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),1===b.length?m.find.matchesSelector(b[0],a)?[b[0]]:[]:m.find.matches(a,b)},dir:function(a,b,d){var e=[];for(a=a[b];a&&9!==a.nodeType&&(d===c||1!==a.nodeType||!m(a).is(d));)1===a.nodeType&&e.push(a),a=a[b];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Fa="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
Rb=/ jQuery\d+="(?:null|\d+)"/g,xa=/^\s+/,Xa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ya=/<([\w:]+)/,Sb=/<tbody/i,Tb=/<|&#?\w+;/,Ub=/<(?:script|style|link)/i,Vb=/<(?:script|object|embed|option|style)/i,ya=RegExp("<(?:"+Fa+")[\\s/>]","i"),Ga=/^(?:checkbox|radio)$/,Za=/checked\s*(?:[^=]|=\s*.checked.)/i,Wb=/\/(java|ecma)script/i,Xb=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,R={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],
thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},$a=p(E),za=$a.appendChild(E.createElement("div"));R.optgroup=R.option;R.tbody=R.tfoot=R.colgroup=R.caption=R.thead;R.th=R.td;m.support.htmlSerialize||(R._default=[1,"X<div>","</div>"]);m.fn.extend({text:function(a){return m.access(this,function(a){return a===c?m.text(this):
this.empty().append((this[0]&&this[0].ownerDocument||E).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(m.isFunction(a))return this.each(function(b){m(this).wrapAll(a.call(this,b))});if(this[0]){var b=m(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return m.isFunction(a)?this.each(function(b){m(this).wrapInner(a.call(this,
b))}):this.each(function(){var b=m(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=m.isFunction(a);return this.each(function(c){m(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){1!==this.nodeType&&11!==this.nodeType||this.appendChild(a)})},prepend:function(){return this.domManip(arguments,
!0,function(a){1!==this.nodeType&&11!==this.nodeType||this.insertBefore(a,this.firstChild)})},before:function(){if(!l(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=m.clean(arguments);return this.pushStack(m.merge(a,this),"before",this.selector)}},after:function(){if(!l(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=m.clean(arguments);return this.pushStack(m.merge(this,
a),"after",this.selector)}},remove:function(a,b){for(var c,d=0;null!=(c=this[d]);d++)if(!a||m.filter(a,[c]).length)!b&&1===c.nodeType&&(m.cleanData(c.getElementsByTagName("*")),m.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c);return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)for(1===a.nodeType&&m.cleanData(a.getElementsByTagName("*"));a.firstChild;)a.removeChild(a.firstChild);return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return m.clone(this,
a,b)})},html:function(a){return m.access(this,function(a){var b=this[0]||{},d=0,e=this.length;if(a===c)return 1===b.nodeType?b.innerHTML.replace(Rb,""):c;if("string"==typeof a&&!(Ub.test(a)||!m.support.htmlSerialize&&ya.test(a)||!m.support.leadingWhitespace&&xa.test(a)||R[(Ya.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(Xa,"<$1></$2>");try{for(;d<e;d++)b=this[d]||{},1===b.nodeType&&(m.cleanData(b.getElementsByTagName("*")),b.innerHTML=a);b=0}catch(f){}}b&&this.empty().append(a)},null,a,arguments.length)},
replaceWith:function(a){return l(this[0])?this.length?this.pushStack(m(m.isFunction(a)?a():a),"replaceWith",a):this:m.isFunction(a)?this.each(function(b){var c=m(this),d=c.html();c.replaceWith(a.call(this,b,d))}):("string"!=typeof a&&(a=m(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;m(this).remove();b?m(b).before(a):m(c).append(a)}))},detach:function(a){return this.remove(a,!0)},domManip:function(a,b,d){a=[].concat.apply([],a);var e,f,g,h=0,l=a[0],n=[],p=this.length;
if(!m.support.checkClone&&1<p&&"string"==typeof l&&Za.test(l))return this.each(function(){m(this).domManip(a,b,d)});if(m.isFunction(l))return this.each(function(e){var f=m(this);a[0]=l.call(this,e,b?f.html():c);f.domManip(a,b,d)});if(this[0]){e=m.buildFragment(a,this,n);g=e.fragment;f=g.firstChild;1===g.childNodes.length&&(g=f);if(f)for(b=b&&m.nodeName(f,"tr"),e=e.cacheable||p-1;h<p;h++)d.call(b&&m.nodeName(this[h],"table")?this[h].getElementsByTagName("tbody")[0]||this[h].appendChild(this[h].ownerDocument.createElement("tbody")):
this[h],h===e?g:m.clone(g,!0,!0));g=f=null;n.length&&m.each(n,function(a,b){b.src?m.ajax?m.ajax({url:b.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):m.error("no ajax"):m.globalEval((b.text||b.textContent||b.innerHTML||"").replace(Xb,""));b.parentNode&&b.parentNode.removeChild(b)})}return this}});m.buildFragment=function(a,b,d){var e,f,g,h=a[0];return b=b||E,b=(b[0]||b).ownerDocument||b[0]||b,"undefined"==typeof b.createDocumentFragment&&(b=E),1===a.length&&"string"==typeof h&&
512>h.length&&b===E&&"<"===h.charAt(0)&&!Vb.test(h)&&(m.support.checkClone||!Za.test(h))&&(m.support.html5Clone||!ya.test(h))&&(f=!0,e=m.fragments[h],g=e!==c),e||(e=b.createDocumentFragment(),m.clean(a,b,e,d),f&&(m.fragments[h]=g&&e)),{fragment:e,cacheable:f}};m.fragments={};m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){m.fn[a]=function(c){var d,e=0,f=[];c=m(c);var g=c.length;d=1===this.length&&this[0].parentNode;if((null==
d||d&&11===d.nodeType&&1===d.childNodes.length)&&1===g)return c[b](this[0]),this;for(;e<g;e++)d=(0<e?this.clone(!0):this).get(),m(c[e])[b](d),f=f.concat(d);return this.pushStack(f,a,c.selector)}});m.extend({clone:function(a,b,c){var d,e,f,g;m.support.html5Clone||m.isXMLDoc(a)||!ya.test("<"+a.nodeName+">")?g=a.cloneNode(!0):(za.innerHTML=a.outerHTML,za.removeChild(g=za.firstChild));if(!(m.support.noCloneEvent&&m.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||m.isXMLDoc(a)))for(t(a,g),d=q(a),
e=q(g),f=0;d[f];++f)e[f]&&t(d[f],e[f]);if(b&&(r(a,g),c))for(d=q(a),e=q(g),f=0;d[f];++f)r(d[f],e[f]);return g},clean:function(a,b,c,d){var e,f,g,h,l,n,q,r=0,t=[];b&&"undefined"!=typeof b.createDocumentFragment||(b=E);for(f=b===E&&$a;null!=(g=a[r]);r++)if("number"==typeof g&&(g+=""),g){if("string"==typeof g)if(Tb.test(g)){f=f||p(b);n=n||f.appendChild(b.createElement("div"));g=g.replace(Xa,"<$1></$2>");e=(Ya.exec(g)||["",""])[1].toLowerCase();h=R[e]||R._default;l=h[0];for(n.innerHTML=h[1]+g+h[2];l--;)n=
n.lastChild;if(!m.support.tbody)for(l=Sb.test(g),h="table"!==e||l?"<table>"!==h[1]||l?[]:n.childNodes:n.firstChild&&n.firstChild.childNodes,e=h.length-1;0<=e;--e)m.nodeName(h[e],"tbody")&&!h[e].childNodes.length&&h[e].parentNode.removeChild(h[e]);!m.support.leadingWhitespace&&xa.test(g)&&n.insertBefore(b.createTextNode(xa.exec(g)[0]),n.firstChild);g=n.childNodes;n=f.lastChild}else g=b.createTextNode(g);g.nodeType?t.push(g):t=m.merge(t,g)}n&&(f.removeChild(n),g=n=f=null);if(!m.support.appendChecked)for(r=
0;null!=(g=t[r]);r++)m.nodeName(g,"input")?s(g):"undefined"!=typeof g.getElementsByTagName&&m.grep(g.getElementsByTagName("input"),s);if(c)for(a=function(a){if(!a.type||Wb.test(a.type))return d?d.push(a.parentNode?a.parentNode.removeChild(a):a):c.appendChild(a)},r=0;null!=(g=t[r]);r++)m.nodeName(g,"script")&&a(g)||(c.appendChild(g),"undefined"!=typeof g.getElementsByTagName&&(q=m.grep(m.merge([],g.getElementsByTagName("script")),a),t.splice.apply(t,[r+1,0].concat(q)),r+=q.length));return t},cleanData:function(a,
b){for(var c,d,e,f,g=0,h=m.expando,l=m.cache,n=m.support.deleteExpando,p=m.event.special;null!=(e=a[g]);g++)if(b||m.acceptData(e))if(c=(d=e[h])&&l[d]){if(c.events)for(f in c.events)p[f]?m.event.remove(e,f):m.removeEvent(e,f,c.handle);l[d]&&(delete l[d],n?delete e[h]:e.removeAttribute?e.removeAttribute(h):e[h]=null,m.deletedIds.push(d))}}});(function(){var a,b;m.uaMatch=function(a){a=a.toLowerCase();a=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||
/(msie) ([\w.]+)/.exec(a)||0>a.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}};a=m.uaMatch(lb.userAgent);b={};a.browser&&(b[a.browser]=!0,b.version=a.version);b.webkit&&(b.safari=!0);m.browser=b;m.sub=function(){function a(b,c){return new a.fn.init(b,c)}m.extend(!0,a,this);a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(c,d){return d&&d instanceof m&&!(d instanceof a)&&(d=a(d)),m.fn.init.call(this,
c,d,b)};a.fn.init.prototype=a.fn;var b=a(E);return a}})();var Q,ha,V,Aa=/alpha\([^)]*\)/i,Yb=/opacity=([^)]*)/,Zb=/^(top|right|bottom|left)$/,ab=/^margin/,pb=RegExp("^("+na+")(.*)$","i"),ja=RegExp("^("+na+")(?!px)[a-z%]+$","i"),$b=RegExp("^([-+])=("+na+")","i"),sa={},ac={position:"absolute",visibility:"hidden",display:"block"},bb={letterSpacing:0,fontWeight:400,lineHeight:1},Z=["Top","Right","Bottom","Left"],Ha=["Webkit","O","Moz","ms"],bc=m.fn.toggle;m.fn.extend({css:function(a,b){return m.access(this,
function(a,b,d){return d!==c?m.style(a,b,d):m.css(a,b)},a,b,1<arguments.length)},show:function(){return w(this,!0)},hide:function(){return w(this)},toggle:function(a,b){var c="boolean"==typeof a;return m.isFunction(a)&&m.isFunction(b)?bc.apply(this,arguments):this.each(function(){(c?a:v(this))?m(this).show():m(this).hide()})}});m.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Q(a,"opacity");return""===c?"1":c}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,
widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":m.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,g,h,l=m.camelCase(b),n=a.style;b=m.cssProps[l]||(m.cssProps[l]=u(n,l));h=m.cssHooks[b]||m.cssHooks[l];if(d===c)return h&&"get"in h&&(f=h.get(a,!1,e))!==c?f:n[b];g=typeof d;"string"===g&&(f=$b.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(m.css(a,b)),g="number");if(!(null==d||"number"===g&&isNaN(d)||("number"===g&&!m.cssNumber[l]&&(d+="px"),
h&&"set"in h&&(d=h.set(a,d,e))===c)))try{n[b]=d}catch(p){}}},css:function(a,b,d,e){var f,g,h,l=m.camelCase(b);return b=m.cssProps[l]||(m.cssProps[l]=u(a.style,l)),h=m.cssHooks[b]||m.cssHooks[l],h&&"get"in h&&(f=h.get(a,!0,e)),f===c&&(f=Q(a,b)),"normal"===f&&b in bb&&(f=bb[b]),d||e!==c?(g=parseFloat(f),d||m.isNumeric(g)?g||0:f):f},swap:function(a,b,c){var d,e={};for(d in b)e[d]=a.style[d],a.style[d]=b[d];c=c.call(a);for(d in b)a.style[d]=e[d];return c}});a.getComputedStyle?Q=function(a,b){var c,d,
e,f,g=getComputedStyle(a,null),h=a.style;return g&&(c=g[b],""===c&&!m.contains(a.ownerDocument.documentElement,a)&&(c=m.style(a,b)),ja.test(c)&&ab.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=c,c=g.width,h.width=d,h.minWidth=e,h.maxWidth=f)),c}:E.documentElement.currentStyle&&(Q=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;return null==e&&f&&f[b]&&(e=f[b]),ja.test(e)&&!Zb.test(b)&&(c=f.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=
a.currentStyle.left),f.left="fontSize"===b?"1em":e,e=f.pixelLeft+"px",f.left=c,d&&(a.runtimeStyle.left=d)),""===e?"auto":e});m.each(["height","width"],function(a,b){m.cssHooks[b]={get:function(a,c,d){if(c)return 0!==a.offsetWidth||"none"!==Q(a,"display")?z(a,b,d):m.swap(a,ac,function(){return z(a,b,d)})},set:function(a,c,d){return x(a,c,d?y(a,b,d,m.support.boxSizing&&"border-box"===m.css(a,"boxSizing")):0)}}});m.support.opacity||(m.cssHooks.opacity={get:function(a,b){return Yb.test((b&&a.currentStyle?
a.currentStyle.filter:a.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=m.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if(1<=b&&(""===m.trim(f.replace(Aa,""))&&c.removeAttribute)&&(c.removeAttribute("filter"),d&&!d.filter))return;c.filter=Aa.test(f)?f.replace(Aa,e):f+" "+e}});m(function(){m.support.reliableMarginRight||(m.cssHooks.marginRight={get:function(a,b){return m.swap(a,{display:"inline-block"},
function(){if(b)return Q(a,"marginRight")})}});!m.support.pixelPosition&&m.fn.position&&m.each(["top","left"],function(a,b){m.cssHooks[b]={get:function(a,c){if(c){var d=Q(a,b);return ja.test(d)?m(a).position()[b]+"px":d}}}})});m.expr&&m.expr.filters&&(m.expr.filters.hidden=function(a){return 0===a.offsetWidth&&0===a.offsetHeight||!m.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||Q(a,"display"))},m.expr.filters.visible=function(a){return!m.expr.filters.hidden(a)});m.each({margin:"",
padding:"",border:"Width"},function(a,b){m.cssHooks[a+b]={expand:function(c){var d="string"==typeof c?c.split(" "):[c],e={};for(c=0;4>c;c++)e[a+Z[c]+b]=d[c]||d[c-2]||d[0];return e}};ab.test(a)||(m.cssHooks[a+b].set=x)});var cc=/%20/g,qb=/\[\]$/,cb=/\r?\n/g,dc=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,ec=/^(?:select|textarea)/i;m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?
m.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ec.test(this.nodeName)||dc.test(this.type))}).map(function(a,b){var c=m(this).val();return null==c?null:m.isArray(c)?m.map(c,function(a,c){return{name:b.name,value:a.replace(cb,"\r\n")}}):{name:b.name,value:c.replace(cb,"\r\n")}}).get()}});m.param=function(a,b){var d,e=[],f=function(a,b){b=m.isFunction(b)?b():null==b?"":b;e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};b===c&&(b=m.ajaxSettings&&
m.ajaxSettings.traditional);if(m.isArray(a)||a.jquery&&!m.isPlainObject(a))m.each(a,function(){f(this.name,this.value)});else for(d in a)C(d,a[d],b,f);return e.join("&").replace(cc,"+")};var aa,W,fc=/#.*$/,gc=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,hc=/^(?:GET|HEAD)$/,ic=/^\/\//,db=/\?/,jc=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,kc=/([?&])_=[^&]*/,eb=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,fb=m.fn.load,ta={},gb={},hb=["*/"]+["*"];try{aa=kb.href}catch(rc){aa=E.createElement("a"),aa.href=
"",aa=aa.href}W=eb.exec(aa.toLowerCase())||[];m.fn.load=function(a,b,d){if("string"!=typeof a&&fb)return fb.apply(this,arguments);if(!this.length)return this;var e,f,g,h=this,l=a.indexOf(" ");return 0<=l&&(e=a.slice(l,a.length),a=a.slice(0,l)),m.isFunction(b)?(d=b,b=c):"object"==typeof b&&(f="POST"),m.ajax({url:a,type:f,dataType:"html",data:b,complete:function(a,b){d&&h.each(d,g||[a.responseText,b,a])}}).done(function(a){g=arguments;h.html(e?m("<div>").append(a.replace(jc,"")).find(e):a)}),this};
m.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){m.fn[b]=function(a){return this.on(b,a)}});m.each(["get","post"],function(a,b){m[b]=function(a,d,e,f){return m.isFunction(d)&&(f=f||e,e=d,d=c),m.ajax({type:b,url:a,data:d,success:e,dataType:f})}});m.extend({getScript:function(a,b){return m.get(a,c,b,"script")},getJSON:function(a,b,c){return m.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?O(a,m.ajaxSettings):(b=a,a=m.ajaxSettings),O(a,b),a},ajaxSettings:{url:aa,
isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(W[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":hb},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},
flatOptions:{context:!0,url:!0}},ajaxPrefilter:F(ta),ajaxTransport:F(gb),ajax:function(a,b){function d(a,b,g,n){var q,K,w,M,y,A=b;if(2!==z){z=2;l&&clearTimeout(l);h=c;f=n||"";B.readyState=0<a?4:0;if(g){M=r;n=B;var P,C,U,D,E=M.contents,F=M.dataTypes,H=M.responseFields;for(C in H)C in g&&(n[H[C]]=g[C]);for(;"*"===F[0];)F.shift(),P===c&&(P=M.mimeType||n.getResponseHeader("content-type"));if(P)for(C in E)if(E[C]&&E[C].test(P)){F.unshift(C);break}if(F[0]in g)U=F[0];else{for(C in g){if(!F[0]||M.converters[C+
" "+F[0]]){U=C;break}D||(D=C)}U=U||D}g=U?(U!==F[0]&&F.unshift(U),g[U]):void 0;M=g}if(200<=a&&300>a||304===a)if(r.ifModified&&(y=B.getResponseHeader("Last-Modified"),y&&(m.lastModified[e]=y),y=B.getResponseHeader("Etag"),y&&(m.etag[e]=y)),304===a)A="notmodified",q=!0;else{var G;a:{q=r;K=M;var ka,A=q.dataTypes.slice();g=A[0];P={};C=0;q.dataFilter&&(K=q.dataFilter(K,q.dataType));if(A[1])for(G in q.converters)P[G.toLowerCase()]=q.converters[G];for(;w=A[++C];)if("*"!==w){if("*"!==g&&g!==w){G=P[g+" "+w]||
P["* "+w];if(!G)for(ka in P)if(y=ka.split(" "),y[1]===w&&(G=P[g+" "+y[0]]||P["* "+y[0]])){!0===G?G=P[ka]:!0!==P[ka]&&(w=y[0],A.splice(C--,0,w));break}if(!0!==G)if(G&&q["throws"])K=G(K);else try{K=G(K)}catch(I){G={state:"parsererror",error:G?I:"No conversion from "+g+" to "+w};break a}}g=w}G={state:"success",data:K}}q=G;A=q.state;K=q.data;w=q.error;q=!w}else if(w=A,!A||a)A="error",0>a&&(a=0);B.status=a;B.statusText=""+(b||A);q?u.resolveWith(s,[K,A,B]):u.rejectWith(s,[B,A,w]);B.statusCode(x);x=c;p&&
t.trigger("ajax"+(q?"Success":"Error"),[B,r,q?K:w]);v.fireWith(s,[B,A]);p&&(t.trigger("ajaxComplete",[B,r]),--m.active||m.event.trigger("ajaxStop"))}}"object"==typeof a&&(b=a,a=c);b=b||{};var e,f,g,h,l,n,p,q,r=m.ajaxSetup({},b),s=r.context||r,t=s!==r&&(s.nodeType||s instanceof m)?m(s):m.event,u=m.Deferred(),v=m.Callbacks("once memory"),x=r.statusCode||{},w={},y={},z=0,A="canceled",B={readyState:0,setRequestHeader:function(a,b){if(!z){var c=a.toLowerCase();a=y[c]=y[c]||a;w[a]=b}return this},getAllResponseHeaders:function(){return 2===
z?f:null},getResponseHeader:function(a){var b;if(2===z){if(!g)for(g={};b=gc.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return b===c?null:b},overrideMimeType:function(a){return z||(r.mimeType=a),this},abort:function(a){return a=a||A,h&&h.abort(a),d(0,a),this}};u.promise(B);B.success=B.done;B.error=B.fail;B.complete=v.add;B.statusCode=function(a){if(a){var b;if(2>z)for(b in a)x[b]=[x[b],a[b]];else b=a[B.status],B.always(b)}return this};r.url=((a||r.url)+"").replace(fc,"").replace(ic,W[1]+
"//");r.dataTypes=m.trim(r.dataType||"*").toLowerCase().split(Y);null==r.crossDomain&&(n=eb.exec(r.url.toLowerCase()),r.crossDomain=!(!n||n[1]==W[1]&&n[2]==W[2]&&(n[3]||("http:"===n[1]?80:443))==(W[3]||("http:"===W[1]?80:443))));r.data&&r.processData&&"string"!=typeof r.data&&(r.data=m.param(r.data,r.traditional));I(ta,r,b,B);if(2===z)return B;p=r.global;r.type=r.type.toUpperCase();r.hasContent=!hc.test(r.type);p&&0===m.active++&&m.event.trigger("ajaxStart");if(!r.hasContent&&(r.data&&(r.url+=(db.test(r.url)?
"&":"?")+r.data,delete r.data),e=r.url,!1===r.cache)){n=m.now();var C=r.url.replace(kc,"$1_="+n);r.url=C+(C===r.url?(db.test(r.url)?"&":"?")+"_="+n:"")}(r.data&&r.hasContent&&!1!==r.contentType||b.contentType)&&B.setRequestHeader("Content-Type",r.contentType);r.ifModified&&(e=e||r.url,m.lastModified[e]&&B.setRequestHeader("If-Modified-Since",m.lastModified[e]),m.etag[e]&&B.setRequestHeader("If-None-Match",m.etag[e]));B.setRequestHeader("Accept",r.dataTypes[0]&&r.accepts[r.dataTypes[0]]?r.accepts[r.dataTypes[0]]+
("*"!==r.dataTypes[0]?", "+hb+"; q=0.01":""):r.accepts["*"]);for(q in r.headers)B.setRequestHeader(q,r.headers[q]);if(!r.beforeSend||!1!==r.beforeSend.call(s,B,r)&&2!==z){A="abort";for(q in{success:1,error:1,complete:1})B[q](r[q]);if(h=I(gb,r,b,B)){B.readyState=1;p&&t.trigger("ajaxSend",[B,r]);r.async&&0<r.timeout&&(l=setTimeout(function(){B.abort("timeout")},r.timeout));try{z=1,h.send(w,d)}catch(D){if(2>z)d(-1,D);else throw D;}}else d(-1,"No Transport");return B}return B.abort()},active:0,lastModified:{},
etag:{}});var ib=[],lc=/\?/,pa=/(=)\?(?=&|$)|\?\?/,mc=m.now();m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=ib.pop()||m.expando+"_"+mc++;return this[a]=!0,a}});m.ajaxPrefilter("json jsonp",function(b,d,e){var f,g,h,l=b.data,n=b.url,p=!1!==b.jsonp,q=p&&pa.test(n),r=p&&!q&&"string"==typeof l&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&pa.test(l);if("jsonp"===b.dataTypes[0]||q||r)return f=b.jsonpCallback=m.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,
g=a[f],q?b.url=n.replace(pa,"$1"+f):r?b.data=l.replace(pa,"$1"+f):p&&(b.url+=(lc.test(n)?"&":"?")+b.jsonp+"="+f),b.converters["script json"]=function(){return h||m.error(f+" was not called"),h[0]},b.dataTypes[0]="json",a[f]=function(){h=arguments},e.always(function(){a[f]=g;b[f]&&(b.jsonpCallback=d.jsonpCallback,ib.push(f));h&&m.isFunction(g)&&g(h[0]);h=g=c}),"script"});m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},
converters:{"text script":function(a){return m.globalEval(a),a}}});m.ajaxPrefilter("script",function(a){a.cache===c&&(a.cache=!1);a.crossDomain&&(a.type="GET",a.global=!1)});m.ajaxTransport("script",function(a){if(a.crossDomain){var b,d=E.head||E.getElementsByTagName("head")[0]||E.documentElement;return{send:function(e,f){b=E.createElement("script");b.async="async";a.scriptCharset&&(b.charset=a.scriptCharset);b.src=a.url;b.onload=b.onreadystatechange=function(a,e){if(e||!b.readyState||/loaded|complete/.test(b.readyState))b.onload=
b.onreadystatechange=null,d&&b.parentNode&&d.removeChild(b),b=c,e||f(200,"success")};d.insertBefore(b,d.firstChild)},abort:function(){b&&b.onload(0,1)}}}});var fa,Ba=a.ActiveXObject?function(){for(var a in fa)fa[a](0,1)}:!1,nc=0;m.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&G()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:G;(function(a){m.extend(m.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})})(m.ajaxSettings.xhr());m.support.ajax&&
m.ajaxTransport(function(b){if(!b.crossDomain||m.support.cors){var d;return{send:function(e,f){var g,h,l=b.xhr();b.username?l.open(b.type,b.url,b.async,b.username,b.password):l.open(b.type,b.url,b.async);if(b.xhrFields)for(h in b.xhrFields)l[h]=b.xhrFields[h];b.mimeType&&l.overrideMimeType&&l.overrideMimeType(b.mimeType);b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)l.setRequestHeader(h,e[h])}catch(n){}l.send(b.hasContent&&b.data||null);d=function(a,
e){var h,n,p,q,r;try{if(d&&(e||4===l.readyState))if(d=c,g&&(l.onreadystatechange=m.noop,Ba&&delete fa[g]),e)4!==l.readyState&&l.abort();else{h=l.status;p=l.getAllResponseHeaders();q={};(r=l.responseXML)&&r.documentElement&&(q.xml=r);try{q.text=l.responseText}catch(s){}try{n=l.statusText}catch(t){n=""}h||!b.isLocal||b.crossDomain?1223===h&&(h=204):h=q.text?200:404}}catch(u){e||f(-1,u)}q&&f(h,n,q,p)};b.async?4===l.readyState?setTimeout(d,0):(g=++nc,Ba&&(fa||(fa={},m(a).unload(Ba)),fa[g]=d),l.onreadystatechange=
d):d()},abort:function(){d&&d(0,1)}}}});var la,qa,oc=/^(?:toggle|show|hide)$/,pc=RegExp("^(?:([-+])=|)("+na+")([a-z%]*)$","i"),qc=/queueHooks$/,ma=[function(a,b,c){var d,e,f,g,h,l,n=this,p=a.style,q={},r=[],s=a.nodeType&&v(a);c.queue||(h=m._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,l=h.empty.fire,h.empty.fire=function(){h.unqueued||l()}),h.unqueued++,n.always(function(){n.always(function(){h.unqueued--;m.queue(a,"fx").length||h.empty.fire()})}));1===a.nodeType&&("height"in b||"width"in b)&&
(c.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===m.css(a,"display")&&"none"===m.css(a,"float")&&(m.support.inlineBlockNeedsLayout&&"inline"!==A(a.nodeName)?p.zoom=1:p.display="inline-block"));c.overflow&&(p.overflow="hidden",m.support.shrinkWrapBlocks||n.done(function(){p.overflow=c.overflow[0];p.overflowX=c.overflow[1];p.overflowY=c.overflow[2]}));for(d in b)e=b[d],oc.exec(e)&&(delete b[d],e!==(s?"hide":"show")&&r.push(d));if(e=r.length)for(f=m._data(a,"fxshow")||m._data(a,"fxshow",{}),
s?m(a).show():n.done(function(){m(a).hide()}),n.done(function(){var b;m.removeData(a,"fxshow",!0);for(b in q)m.style(a,b,q[b])}),d=0;d<e;d++)b=r[d],g=n.createTween(b,s?f[b]:0),q[b]=f[b]||m.style(a,b),b in f||(f[b]=g.start,s&&(g.end=g.start,g.start="width"===b||"height"===b?1:0))}],$={"*":[function(a,b){var c,d,e,f=this.createTween(a,b),g=pc.exec(b),h=f.cur(),l=+h||0,n=1;if(g){c=+g[2];d=g[3]||(m.cssNumber[a]?"":"px");if("px"!==d&&l){l=m.css(f.elem,a,!0)||c||1;do e=n=n||".5",l/=n,m.style(f.elem,a,l+
d),n=f.cur()/h;while(1!==n&&n!==e)}f.unit=d;f.start=l;f.end=g[1]?l+(g[1]+1)*c:c}return f}]};m.Animation=m.extend(B,{tweener:function(a,b){m.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],$[c]=$[c]||[],$[c].unshift(b)},prefilter:function(a,b){b?ma.unshift(a):ma.push(a)}});m.Tween=H;H.prototype={constructor:H,init:function(a,b,c,d,e,f){this.elem=a;this.prop=c;this.easing=e||"swing";this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=f||(m.cssNumber[c]?
"":"px")},cur:function(){var a=H.propHooks[this.prop];return a&&a.get?a.get(this):H.propHooks._default.get(this)},run:function(a){var b,c=H.propHooks[this.prop];return this.pos=b=m.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration),this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):H.propHooks._default.set(this),this}};H.prototype.init.prototype=H.prototype;H.propHooks={_default:{get:function(a){var b;
return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=m.css(a.elem,a.prop,!1,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){m.fx.step[a.prop]?m.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[m.cssProps[a.prop]]||m.cssHooks[a.prop])?m.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}};H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}};m.each(["toggle","show","hide"],function(a,b){var c=m.fn[b];
m.fn[b]=function(d,e,f){return null==d||"boolean"==typeof d||!a&&m.isFunction(d)&&m.isFunction(e)?c.apply(this,arguments):this.animate(ga(b,!0),d,e,f)}});m.fn.extend({fadeTo:function(a,b,c,d){return this.filter(v).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=m.isEmptyObject(a),f=m.speed(b,c,d);b=function(){var b=B(this,m.extend({},a),f);e&&b.stop(!0)};return e||!1===f.queue?this.each(b):this.queue(f.queue,b)},stop:function(a,b,d){var e=function(a){var b=
a.stop;delete a.stop;b(d)};return"string"!=typeof a&&(d=b,b=a,a=c),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=m.timers,g=m._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&qc.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem!==this||null!=a&&f[c].queue!==a||(f[c].anim.stop(d),b=!1,f.splice(c,1));!b&&d||m.dequeue(this,a)})}});m.each({slideDown:ga("show"),slideUp:ga("hide"),slideToggle:ga("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},
fadeToggle:{opacity:"toggle"}},function(a,b){m.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});m.speed=function(a,b,c){var d=a&&"object"==typeof a?m.extend({},a):{complete:c||!c&&b||m.isFunction(a)&&a,duration:a,easing:c&&b||b&&!m.isFunction(b)&&b};d.duration=m.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in m.fx.speeds?m.fx.speeds[d.duration]:m.fx.speeds._default;if(null==d.queue||!0===d.queue)d.queue="fx";return d.old=d.complete,d.complete=function(){m.isFunction(d.old)&&d.old.call(this);
d.queue&&m.dequeue(this,d.queue)},d};m.easing={linear:function(a){return a},swing:function(a){return 0.5-Math.cos(a*Math.PI)/2}};m.timers=[];m.fx=H.prototype.init;m.fx.tick=function(){for(var a,b=m.timers,c=0;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||m.fx.stop()};m.fx.timer=function(a){a()&&m.timers.push(a)&&!qa&&(qa=setInterval(m.fx.tick,m.fx.interval))};m.fx.interval=13;m.fx.stop=function(){clearInterval(qa);qa=null};m.fx.speeds={slow:600,fast:200,_default:400};m.fx.step={};
m.expr&&m.expr.filters&&(m.expr.filters.animated=function(a){return m.grep(m.timers,function(b){return a===b.elem}).length});var jb=/^(?:body|html)$/i;m.fn.offset=function(a){if(arguments.length)return a===c?this:this.each(function(b){m.offset.setOffset(this,a,b)});var b,d,e,f,g,h,l,n,p,q,r=this[0],s=r&&r.ownerDocument;if(s)return(e=s.body)===r?m.offset.bodyOffset(r):(d=s.documentElement,m.contains(d,r)?(b=r.getBoundingClientRect(),f=Ca(s),g=d.clientTop||e.clientTop||0,h=d.clientLeft||e.clientLeft||
0,l=f.pageYOffset||d.scrollTop,n=f.pageXOffset||d.scrollLeft,p=b.top+l-g,q=b.left+n-h,{top:p,left:q}):{top:0,left:0})};m.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return m.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(m.css(a,"marginTop"))||0,c+=parseFloat(m.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=m.css(a,"position");"static"===d&&(a.style.position="relative");var e=m(a),f=e.offset(),g=m.css(a,"top"),h=m.css(a,"left"),l={},n={},p,q;
("absolute"===d||"fixed"===d)&&-1<m.inArray("auto",[g,h])?(n=e.position(),p=n.top,q=n.left):(p=parseFloat(g)||0,q=parseFloat(h)||0);m.isFunction(b)&&(b=b.call(a,c,f));null!=b.top&&(l.top=b.top-f.top+p);null!=b.left&&(l.left=b.left-f.left+q);"using"in b?b.using.call(a,l):e.css(l)}};m.fn.extend({position:function(){if(this[0]){var a=this[0],b=this.offsetParent(),c=this.offset(),d=jb.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(m.css(a,"marginTop"))||0,c.left-=parseFloat(m.css(a,
"marginLeft"))||0,d.top+=parseFloat(m.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(m.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||E.body;a&&!jb.test(a.nodeName)&&"static"===m.css(a,"position");)a=a.offsetParent;return a||E.body})}});m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var d=/Y/.test(b);m.fn[a]=function(e){return m.access(this,function(a,e,f){var g=Ca(a);
if(f===c)return g?b in g?g[b]:g.document.documentElement[e]:a[e];g?g.scrollTo(d?m(g).scrollLeft():f,d?f:m(g).scrollTop()):a[e]=f},a,e,arguments.length,null)}});m.each({Height:"height",Width:"width"},function(a,b){m.each({padding:"inner"+a,content:b,"":"outer"+a},function(d,e){m.fn[e]=function(e,f){var g=arguments.length&&(d||"boolean"!=typeof e),h=d||(!0===e||!0===f?"margin":"border");return m.access(this,function(b,d,e){var f;return m.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?
(f=b.documentElement,Math.max(b.body["scroll"+a],f["scroll"+a],b.body["offset"+a],f["offset"+a],f["client"+a])):e===c?m.css(b,d,e,h):m.style(b,d,e,h)},b,g?e:c,g)}})});a.jQuery=a.$=m;"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return m})})(window);
